var dn=Object.defineProperty;var pn=(f,t,r)=>t in f?dn(f,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):f[t]=r;var ln=(f,t,r)=>pn(f,typeof t!="symbol"?t+"":t,r);import{createElementBlock,openBlock,createElementVNode,createTextVNode,withDirectives,toDisplayString,vModelText}from"vue";let annotationCanvasMixins=biigle.$require("annotations.stores.canvasMixins"),Echo=biigle.$require("echo"),Events=biigle.$require("events"),handleErrorResponse=biigle.$require("handleErrorResponse"),Keyboard=biigle.$require("keyboard"),Messages=biigle.$require("messages"),Resource=biigle.$require("resource"),SettingsTabPlugins=biigle.$require("annotations.components.settingsTabPlugins"),Styles=biigle.$require("annotations.stores.styles"),throttle=biigle.$require("utils.throttle");const _export_sfc=(f,t)=>{const r=f.__vccOpts||f;for(const[i,s]of t)r[i]=s;return r},_sfc_main$1={props:{settings:{type:Object,required:!0}},data(){return{steps:[2e3,1e3,500,200,100],stepNames:["slower","slow","medium","fast","faster"],stepIndex:2}},computed:{stepName(){return this.stepNames[this.stepIndex]}},watch:{stepIndex(f){let t=this.steps[f];Events.emit("settings.samThrottleInterval",t),this.settings.set("samRefreshRateStep",f)}},created(){this.settings.has("samRefreshRateStep")&&(this.stepIndex=this.settings.get("samRefreshRateStep"))}},_hoisted_1={class:"sidebar-tab__section"},_hoisted_2={title:"Refresh rate for updating Magic SAM proposals"},_hoisted_3=["textContent"];function _sfc_render(f,t,r,i,s,c){return openBlock(),createElementBlock("div",_hoisted_1,[createElementVNode("h5",_hoisted_2,[t[1]||(t[1]=createTextVNode("Magic SAM refresh rate (")),createElementVNode("span",{textContent:toDisplayString(c.stepName)},null,8,_hoisted_3),t[2]||(t[2]=createTextVNode(")"))]),t[3]||(t[3]=createTextVNode()),withDirectives(createElementVNode("input",{type:"range",min:"0",max:"4",step:"1","onUpdate:modelValue":t[0]||(t[0]=a=>s.stepIndex=a),onmouseup:"this.blur()"},null,512),[[vModelText,s.stepIndex]])])}const Plugin=_export_sfc(_sfc_main$1,[["render",_sfc_render]]);SettingsTabPlugins&&(SettingsTabPlugins.magicSam=Plugin);const ImageEmbeddingApi=Resource("api/v1/images{/id}/sam-embedding");class BaseEvent{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}const ObjectEventType={PROPERTYCHANGE:"propertychange"};class Disposable{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function binarySearch(f,t,r){let i,s;r=r||ascending;let c=0,a=f.length,h=!1;for(;c<a;)i=c+(a-c>>1),s=+r(f[i],t),s<0?c=i+1:(a=i,h=!s);return h?c:~c}function ascending(f,t){return f>t?1:f<t?-1:0}function linearFindNearest(f,t,r){if(f[0]<=t)return 0;const i=f.length;if(t<=f[i-1])return i-1;if(typeof r=="function"){for(let s=1;s<i;++s){const c=f[s];if(c===t)return s;if(c<t)return r(t,f[s-1],c)>0?s-1:s}return i-1}if(r>0){for(let s=1;s<i;++s)if(f[s]<t)return s-1;return i-1}if(r<0){for(let s=1;s<i;++s)if(f[s]<=t)return s;return i-1}for(let s=1;s<i;++s){if(f[s]==t)return s;if(f[s]<t)return f[s-1]-t<t-f[s]?s-1:s}return i-1}function reverseSubArray(f,t,r){for(;t<r;){const i=f[t];f[t]=f[r],f[r]=i,++t,--r}}function extend$1(f,t){const r=Array.isArray(t)?t:[t],i=r.length;for(let s=0;s<i;s++)f[f.length]=r[s]}function equals$2(f,t){const r=f.length;if(r!==t.length)return!1;for(let i=0;i<r;i++)if(f[i]!==t[i])return!1;return!0}function TRUE(){return!0}function VOID(){}function memoizeOne(f){let t=!1,r,i,s;return function(){const c=Array.prototype.slice.call(arguments);return(!t||this!==s||!equals$2(c,i))&&(t=!0,s=this,i=c,r=f.apply(this,arguments)),r}}function clear(f){for(const t in f)delete f[t]}function isEmpty$1(f){let t;for(t in f)return!1;return!t}class Target extends Disposable{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,r){if(!t||!r)return;const i=this.listeners_||(this.listeners_={}),s=i[t]||(i[t]=[]);s.includes(r)||s.push(r)}dispatchEvent(t){const r=typeof t=="string",i=r?t:t.type,s=this.listeners_&&this.listeners_[i];if(!s)return;const c=r?new BaseEvent(t):t;c.target||(c.target=this.eventTarget_||this);const a=this.dispatching_||(this.dispatching_={}),h=this.pendingRemovals_||(this.pendingRemovals_={});i in a||(a[i]=0,h[i]=0),++a[i];let p;for(let d=0,l=s.length;d<l;++d)if("handleEvent"in s[d]?p=s[d].handleEvent(c):p=s[d].call(this,c),p===!1||c.propagationStopped){p=!1;break}if(--a[i]===0){let d=h[i];for(delete h[i];d--;)this.removeEventListener(i,VOID);delete a[i]}return p}disposeInternal(){this.listeners_&&clear(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(t,r){if(!this.listeners_)return;const i=this.listeners_[t];if(!i)return;const s=i.indexOf(r);s!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[s]=VOID,++this.pendingRemovals_[t]):(i.splice(s,1),i.length===0&&delete this.listeners_[t]))}}const EventType={CHANGE:"change"};function listen(f,t,r,i,s){if(i&&i!==f&&(r=r.bind(i)),s){const a=r;r=function(){f.removeEventListener(t,r),a.apply(this,arguments)}}const c={target:f,type:t,listener:r};return f.addEventListener(t,r),c}function listenOnce(f,t,r,i){return listen(f,t,r,i,!0)}function unlistenByKey(f){f&&f.target&&(f.target.removeEventListener(f.type,f.listener),clear(f))}class Observable extends Target{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(EventType.CHANGE)}getRevision(){return this.revision_}onInternal(t,r){if(Array.isArray(t)){const i=t.length,s=new Array(i);for(let c=0;c<i;++c)s[c]=listen(this,t[c],r);return s}return listen(this,t,r)}onceInternal(t,r){let i;if(Array.isArray(t)){const s=t.length;i=new Array(s);for(let c=0;c<s;++c)i[c]=listenOnce(this,t[c],r)}else i=listenOnce(this,t,r);return r.ol_key=i,i}unInternal(t,r){const i=r.ol_key;if(i)unByKey(i);else if(Array.isArray(t))for(let s=0,c=t.length;s<c;++s)this.removeEventListener(t[s],r);else this.removeEventListener(t,r)}}function unByKey(f){if(Array.isArray(f))for(let t=0,r=f.length;t<r;++t)unlistenByKey(f[t]);else unlistenByKey(f)}function abstract(){throw new Error("Unimplemented abstract method.")}let uidCounter_=0;function getUid(f){return f.ol_uid||(f.ol_uid=String(++uidCounter_))}class ObjectEvent extends BaseEvent{constructor(t,r,i){super(t),this.key=r,this.oldValue=i}}class BaseObject extends Observable{constructor(t){super(),this.on,this.once,this.un,getUid(this),this.values_=null,t!==void 0&&this.setProperties(t)}get(t){let r;return this.values_&&this.values_.hasOwnProperty(t)&&(r=this.values_[t]),r}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,r){let i;i=`change:${t}`,this.hasListener(i)&&this.dispatchEvent(new ObjectEvent(i,t,r)),i=ObjectEventType.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new ObjectEvent(i,t,r))}addChangeListener(t,r){this.addEventListener(`change:${t}`,r)}removeChangeListener(t,r){this.removeEventListener(`change:${t}`,r)}set(t,r,i){const s=this.values_||(this.values_={});if(i)s[t]=r;else{const c=s[t];s[t]=r,c!==r&&this.notify(t,c)}}setProperties(t,r){for(const i in t)this.set(i,t[i],r)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,r){if(this.values_&&t in this.values_){const i=this.values_[t];delete this.values_[t],isEmpty$1(this.values_)&&(this.values_=null),r||this.notify(t,i)}}}function assert(f,t){if(!f)throw new Error(t)}class Feature extends BaseObject{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){const r=t;this.setGeometry(r)}else{const r=t;this.setProperties(r)}}clone(){const t=new Feature(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const r=this.getGeometry();r&&t.setGeometry(r.clone());const i=this.getStyle();return i&&t.setStyle(i),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(unlistenByKey(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=listen(t,EventType.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?createStyleFunction(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function createStyleFunction(f){if(typeof f=="function")return f;let t;return Array.isArray(f)?t=f:(assert(typeof f.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),t=[f]),function(){return t}}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(f){return f&&f.__esModule&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f}function getAugmentedNamespace(f){if(Object.prototype.hasOwnProperty.call(f,"__esModule"))return f;var t=f.default;if(typeof t=="function"){var r=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(f).forEach(function(i){var s=Object.getOwnPropertyDescriptor(f,i);Object.defineProperty(r,i,s.get?s:{enumerable:!0,get:function(){return f[i]}})}),r}var magicWand={exports:{}};/*
 Magic wand tool (fuzzy selection) by color

 @package magic-wand-tool
 @author Ryasnoy Paul <ryasnoypaul@gmail.com>
 @version 1.1.7
 @license MIT
 @copyright (c) 2014-2020, Ryasnoy Paul <ryasnoypaul@gmail.com>

*/var hasRequiredMagicWand;function requireMagicWand(){return hasRequiredMagicWand||(hasRequiredMagicWand=1,function(f){var t=function(){var r={};r.floodFill=function(h,p,d,l,n,e){return e?s(h,p,d,l,n):i(h,p,d,l,n)};function i(h,p,d,l,n){var e,o,u,g,m,y,b,_,x,w,T=h.data,S=h.width,I=h.height,v=h.bytes,A=-1,L=S+1,N=-1,$=I+1,D=d*S+p,R=new Uint8Array(S*I),O=new Uint8Array(n||S*I);if(O[D]===1)return null;D=D*v;var F=[T[D],T[D+1],T[D+2],T[D+3]],z=[{y:d,left:p-1,right:p+1,dir:1}];do{for(g=z.shift(),w=!1,o=g.left+1;o<g.right;o++)if(b=g.y*S,D=(b+o)*v,O[b+o]!==1&&(e=T[D]-F[0],!(e>l||e<-l)&&(e=T[D+1]-F[1],!(e>l||e<-l)&&(e=T[D+2]-F[2],!(e>l||e<-l))))){for(w=!0,R[b+o]=1,O[b+o]=1,y=o-1;y>-1&&(_=b+y,D=_*v,!(O[_]===1||(e=T[D]-F[0],e>l||e<-l)||(e=T[D+1]-F[1],e>l||e<-l)||(e=T[D+2]-F[2],e>l||e<-l)));)R[_]=1,O[_]=1,y--;for(m=o+1;m<S&&(x=b+m,D=x*v,!(O[x]===1||(e=T[D]-F[0],e>l||e<-l)||(e=T[D+1]-F[1],e>l||e<-l)||(e=T[D+2]-F[2],e>l||e<-l)));)R[x]=1,O[x]=1,m++;y<L&&(L=y+1),m>A&&(A=m-1),u=g.y-g.dir,u>=0&&u<I&&(y<g.left&&z.push({y:u,left:y,right:g.left,dir:-g.dir}),g.right<m&&z.push({y:u,left:g.right,right:m,dir:-g.dir})),u=g.y+g.dir,u>=0&&u<I&&y<m&&z.push({y:u,left:y,right:m,dir:g.dir})}w&&(g.y<$&&($=g.y),g.y>N&&(N=g.y))}while(z.length>0);return{data:R,width:h.width,height:h.height,bounds:{minX:L,minY:$,maxX:A,maxY:N}}}function s(h,p,d,l,n){var e,o,u,g,m,y,b,_,x,w,T=h.data,S=h.width,I=h.height,v=h.bytes,A=-1,L=S+1,N=-1,$=I+1,D=d*S+p,R=new Uint8Array(S*I),O=new Uint8Array(n||S*I);if(O[D]===1)return null;D=D*v;var F=[T[D],T[D+1],T[D+2],T[D+3]],z=[{y:d,left:p-1,right:p+1,dir:1}];do{for(g=z.shift(),w=!1,o=g.left+1;o<g.right;o++)if(b=g.y*S,D=(b+o)*v,O[b+o]!==1&&(w=!0,R[b+o]=1,O[b+o]=1,e=T[D]-F[0],!(e>l||e<-l)&&(e=T[D+1]-F[1],!(e>l||e<-l)&&(e=T[D+2]-F[2],!(e>l||e<-l))))){for(y=o-1;y>-1&&(_=b+y,D=_*v,!(O[_]===1||(R[_]=1,O[_]=1,y--,e=T[D]-F[0],e>l||e<-l)||(e=T[D+1]-F[1],e>l||e<-l)||(e=T[D+2]-F[2],e>l||e<-l))););for(m=o+1;m<S&&(x=b+m,D=x*v,!(O[x]===1||(R[x]=1,O[x]=1,m++,e=T[D]-F[0],e>l||e<-l)||(e=T[D+1]-F[1],e>l||e<-l)||(e=T[D+2]-F[2],e>l||e<-l))););y<L&&(L=y+1),m>A&&(A=m-1),u=g.y-g.dir,u>=0&&u<I&&(y<g.left&&z.push({y:u,left:y,right:g.left,dir:-g.dir}),g.right<m&&z.push({y:u,left:g.right,right:m,dir:-g.dir})),u=g.y+g.dir,u>=0&&u<I&&y<m&&z.push({y:u,left:y,right:m,dir:g.dir})}w&&(g.y<$&&($=g.y),g.y>N&&(N=g.y))}while(z.length>0);return{data:R,width:h.width,height:h.height,bounds:{minX:L,minY:$,maxX:A,maxY:N}}}r.gaussBlur=function(h,p){var d,l,n,e,o,u,g,m,y=p*2+1,b=p*p,_=new Float32Array(y),x=0,w=h.width,T=h.height,S=h.data,I=h.bounds.minX,v=h.bounds.maxX,A=h.bounds.minY,L=h.bounds.maxY;for(d=0;d<p;d++){var N=(p-d)*(p-d),$=Math.exp(-N/(2*b))/(2*Math.PI*b);_[p+d]=_[p-d]=$,x+=2*$}for(d=0;d<y;d++)_[d]/=x;var D=new Uint8Array(w*T),R=p+w,O=p+T;for(o=A;o<L+1;o++)for(e=I;e<v+1;e++){for(u=0,l=o*w+e,g=p-e>0?p-e:0,m=R-e<y?R-e:y,n=l-p,d=g;d<m;d++)u+=S[n+d]*_[d];for(g=p-o>0?p-o:0,m=O-o<y?O-o:y,n=l-p*w,d=g;d<m;d++)u+=S[n+d*w]*_[d];D[l]=u>.5?1:0}return{data:D,width:w,height:T,bounds:{minX:I,minY:A,maxX:v,maxY:L}}};function c(h,p,d){var l,n,e,o,u,g,m,y=h.width,b=h.height,_=h.data,x=new Uint8Array(_),w=h.bounds.minX,T=h.bounds.maxX,S=h.bounds.minY,I=h.bounds.maxY,v=y*b,A=new Uint8Array(v),L=[],N=Math.max(w,1),$=Math.min(T,y-2),D=Math.max(S,1),R=Math.min(I,b-2);if(d&&d.length>0)for(u=0;u<v;u++)d[u]===1&&(x[u]=1);for(o=D;o<R+1;o++)for(l=N;l<$+1;l++)u=o*y+l,_[u]!==0&&(g=u+y,m=u-y,(x[u+1]===0||x[u-1]===0||x[g]===0||x[g+1]===0||x[g-1]===0||x[m]===0||x[m+1]===0||x[m-1]===0)&&L.push(u));if(w==0)for(o=S;o<I+1;o++)_[o*y]===1&&L.push(o*y);if(T==y-1)for(o=S;o<I+1;o++)_[o*y+T]===1&&L.push(o*y+T);if(S==0)for(l=w;l<T+1;l++)_[l]===1&&L.push(l);if(I==b-1)for(l=w;l<T+1;l++)_[I*y+l]===1&&L.push(I*y+l);var O=[],F,z,W=p+y,Z=p+b,J=p*2+1;for(v=L.length,e=0;e<v;e++){for(u=L[e],A[u]=1,O.push(u),l=u%y,o=(u-l)/y,F=p-l>0?p-l:0,z=W-l<J?W-l:J,g=u-p,n=F;n<z;n++)m=g+n,A[m]===0&&(A[m]=1,O.push(m));for(F=p-o>0?p-o:0,z=Z-o<J?Z-o:J,g=u-p*y,n=F;n<z;n++)m=g+n*y,A[m]===0&&(A[m]=1,O.push(m))}return O}r.gaussBlurOnlyBorder=function(h,p,d){var l=c(h,p,d),n,e,o,u,g,m,y,b,_,x,w,T=p*2+1,S=2*p*p,I=new Float32Array(T),v=0,A=h.width,L=h.height,N=h.data,$=h.bounds.minX,D=h.bounds.maxX,R=h.bounds.minY,O=h.bounds.maxY,F=l.length;for(o=0;o<p;o++)e=(p-o)*(p-o),n=Math.exp(-e/S)/Math.PI,I[p+o]=I[p-o]=n,v+=2*n;for(o=0;o<T;o++)I[o]/=v;var z=new Uint8Array(N),W=p+A,Z=p+L;for(o=0;o<F;o++){for(g=l[o],_=0,y=g%A,b=(g-y)/A,x=p-y>0?p-y:0,w=W-y<T?W-y:T,m=g-p,u=x;u<w;u++)_+=N[m+u]*I[u];if(_>.5){z[g]=1,y<$&&($=y),y>D&&(D=y),b<R&&(R=b),b>O&&(O=b);continue}for(x=p-b>0?p-b:0,w=Z-b<T?Z-b:T,m=g-p*A,u=x;u<w;u++)_+=N[m+u*A]*I[u];_>.5?(z[g]=1,y<$&&($=y),y>D&&(D=y),b<R&&(R=b),b>O&&(O=b)):z[g]=0}return{data:z,width:A,height:L,bounds:{minX:$,minY:R,maxX:D,maxY:O}}},r.createBorderMask=function(h){var p,d,l,n,e,o=h.width,u=h.height,g=h.data,m=h.bounds.minX,y=h.bounds.maxX,b=h.bounds.minY,_=h.bounds.maxY,x=y-m+1,w=_-b+1,T=new Uint8Array(x*w),S=Math.max(m,1),I=Math.min(y,o-2),v=Math.max(b,1),A=Math.min(_,u-2);for(d=v;d<A+1;d++)for(p=S;p<I+1;p++)l=d*o+p,g[l]!==0&&(n=l+o,e=l-o,(g[l+1]===0||g[l-1]===0||g[n]===0||g[n+1]===0||g[n-1]===0||g[e]===0||g[e+1]===0||g[e-1]===0)&&(T[(d-b)*x+(p-m)]=1));if(m==0)for(d=b;d<_+1;d++)g[d*o]===1&&(T[(d-b)*x]=1);if(y==o-1)for(d=b;d<_+1;d++)g[d*o+y]===1&&(T[(d-b)*x+(y-m)]=1);if(b==0)for(p=m;p<y+1;p++)g[p]===1&&(T[p-m]=1);if(_==u-1)for(p=m;p<y+1;p++)g[_*o+p]===1&&(T[(_-b)*x+(p-m)]=1);return{data:T,width:x,height:w,offset:{x:m,y:b}}},r.getBorderIndices=function(h){var p,d,l,n,e,o=h.width,u=h.height,g=h.data,m=[],y=o-1,b=u-1;for(d=1;d<b;d++)for(p=1;p<y;p++)l=d*o+p,g[l]!==0&&(n=l+o,e=l-o,(g[l+1]===0||g[l-1]===0||g[n]===0||g[n+1]===0||g[n-1]===0||g[e]===0||g[e+1]===0||g[e-1]===0)&&m.push(l));for(d=0;d<u;d++)g[d*o]===1&&m.push(d*o);for(p=0;p<o;p++)g[p]===1&&m.push(p);for(l=o-1,d=0;d<u;d++)g[d*o+l]===1&&m.push(d*o+l);for(l=(u-1)*o,p=0;p<o;p++)g[l+p]===1&&m.push(l+p);return m};function a(h){var p,d,l=h.width,n=h.data,e=h.bounds.minX,o=h.bounds.maxX,u=h.bounds.minY,g=h.bounds.maxY,m=o-e+3,y=g-u+3,b=new Uint8Array(m*y);for(d=u;d<g+1;d++)for(p=e;p<o+1;p++)n[d*l+p]===1&&(b[(d-u+1)*m+(p-e+1)]=1);return{data:b,width:m,height:y,offset:{x:e-1,y:u-1}}}return r.traceContours=function(h){var p=a(h),d=[],l=0,n=p.width,e=n*2,o=p.height,u=p.data,g=p.offset.x,m=p.offset.y,y=new Uint8Array(u),b,_,x,w,T,S,I,v,A,L,N,$,D,R,O,F=[[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1],[0,-1],[1,-1]];for(w=1;w<o-1;w++)for(x=1;x<n-1;x++)if(T=w*n+x,u[T]===1){for(b=-n;b<e;b+=e)if(u[T+b]===0&&y[T+b]===0){for(v=b===n,l++,I=[],A=v?2:6,$=D=L={x,y:w},N=null;;){for(y[$.y*n+$.x]=l,_=0;_<8;_++){if(A=(A+1)%8,O=F[A],R={x:$.x+O[0],y:$.y+O[1]},S=R.y*n+R.x,u[S]===1){y[S]=l;break}y[S]=-1,R=null}if(R===null)break;if($=R,N){if(D.x===L.x&&D.y===L.y&&$.x===N.x&&$.y===N.y)break}else N=R;I.push({x:D.x+g,y:D.y+m}),D=$,A=(A+4)%8}R!=null&&(I.push({x:L.x+g,y:L.y+m}),d.push({inner:v,label:l,points:I}))}}return d},r.simplifyContours=function(h,p,d){var l=h.length,n=[],e,o,u,g,m,y,b,_,x,w,T,S,I,v,A,L,N,$,D,R,O;for(o=0;o<l;o++){if(g=h[o],m=g.points,y=g.points.length,y<d){for(b=[],u=0;u<y;u++)b.push({x:m[u].x,y:m[u].y});n.push({inner:g.inner,label:g.label,points:b,initialCount:y});continue}_=[0,y-1],x=[{first:0,last:y-1}];do if(w=x.shift(),!(w.last<=w.first+1)){for(T=-1,S=w.first,e=w.first+1;e<w.last;e++)D=m[e],R=m[w.first],O=m[w.last],N=D.x-R.x,$=D.y-R.y,v=Math.sqrt(N*N+$*$),N=D.x-O.x,$=D.y-O.y,A=Math.sqrt(N*N+$*$),N=R.x-O.x,$=R.y-O.y,L=Math.sqrt(N*N+$*$),v>=Math.sqrt(A*A+L*L)?I=A:A>=Math.sqrt(v*v+L*L)?I=v:I=Math.abs(($*D.x-N*D.y+R.x*O.y-O.x*R.y)/L),I>T&&(S=e,T=I);T>p&&(_.push(S),x.push({first:w.first,last:S}),x.push({first:S,last:w.last}))}while(x.length>0);for(b=[],y=_.length,_.sort(function(F,z){return F-z}),u=0;u<y;u++)b.push({x:m[_[u]].x,y:m[_[u]].y});n.push({inner:g.inner,label:g.label,points:b,initialCount:g.points.length})}return n},r}();f!==null&&(f.exports=t),typeof window<"u"&&window!==null&&(window.MagicWand=t)}(magicWand)),magicWand.exports}var magicWandExports=requireMagicWand();const MagicWand=getDefaultExportFromCjs(magicWandExports);var browserPonyfill={exports:{}},hasRequiredBrowserPonyfill;function requireBrowserPonyfill(){return hasRequiredBrowserPonyfill||(hasRequiredBrowserPonyfill=1,function(f,t){var r=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof commonjsGlobal<"u"&&commonjsGlobal,i=function(){function c(){this.fetch=!1,this.DOMException=r.DOMException}return c.prototype=r,new c}();(function(c){(function(a){var h=typeof c<"u"&&c||typeof self<"u"&&self||typeof commonjsGlobal<"u"&&commonjsGlobal||{},p={searchParams:"URLSearchParams"in h,iterable:"Symbol"in h&&"iterator"in Symbol,blob:"FileReader"in h&&"Blob"in h&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in h,arrayBuffer:"ArrayBuffer"in h};function d(R){return R&&DataView.prototype.isPrototypeOf(R)}if(p.arrayBuffer)var l=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],n=ArrayBuffer.isView||function(R){return R&&l.indexOf(Object.prototype.toString.call(R))>-1};function e(R){if(typeof R!="string"&&(R=String(R)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(R)||R==="")throw new TypeError('Invalid character in header field name: "'+R+'"');return R.toLowerCase()}function o(R){return typeof R!="string"&&(R=String(R)),R}function u(R){var O={next:function(){var F=R.shift();return{done:F===void 0,value:F}}};return p.iterable&&(O[Symbol.iterator]=function(){return O}),O}function g(R){this.map={},R instanceof g?R.forEach(function(O,F){this.append(F,O)},this):Array.isArray(R)?R.forEach(function(O){if(O.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+O.length);this.append(O[0],O[1])},this):R&&Object.getOwnPropertyNames(R).forEach(function(O){this.append(O,R[O])},this)}g.prototype.append=function(R,O){R=e(R),O=o(O);var F=this.map[R];this.map[R]=F?F+", "+O:O},g.prototype.delete=function(R){delete this.map[e(R)]},g.prototype.get=function(R){return R=e(R),this.has(R)?this.map[R]:null},g.prototype.has=function(R){return this.map.hasOwnProperty(e(R))},g.prototype.set=function(R,O){this.map[e(R)]=o(O)},g.prototype.forEach=function(R,O){for(var F in this.map)this.map.hasOwnProperty(F)&&R.call(O,this.map[F],F,this)},g.prototype.keys=function(){var R=[];return this.forEach(function(O,F){R.push(F)}),u(R)},g.prototype.values=function(){var R=[];return this.forEach(function(O){R.push(O)}),u(R)},g.prototype.entries=function(){var R=[];return this.forEach(function(O,F){R.push([F,O])}),u(R)},p.iterable&&(g.prototype[Symbol.iterator]=g.prototype.entries);function m(R){if(!R._noBody){if(R.bodyUsed)return Promise.reject(new TypeError("Already read"));R.bodyUsed=!0}}function y(R){return new Promise(function(O,F){R.onload=function(){O(R.result)},R.onerror=function(){F(R.error)}})}function b(R){var O=new FileReader,F=y(O);return O.readAsArrayBuffer(R),F}function _(R){var O=new FileReader,F=y(O),z=/charset=([A-Za-z0-9_-]+)/.exec(R.type),W=z?z[1]:"utf-8";return O.readAsText(R,W),F}function x(R){for(var O=new Uint8Array(R),F=new Array(O.length),z=0;z<O.length;z++)F[z]=String.fromCharCode(O[z]);return F.join("")}function w(R){if(R.slice)return R.slice(0);var O=new Uint8Array(R.byteLength);return O.set(new Uint8Array(R)),O.buffer}function T(){return this.bodyUsed=!1,this._initBody=function(R){this.bodyUsed=this.bodyUsed,this._bodyInit=R,R?typeof R=="string"?this._bodyText=R:p.blob&&Blob.prototype.isPrototypeOf(R)?this._bodyBlob=R:p.formData&&FormData.prototype.isPrototypeOf(R)?this._bodyFormData=R:p.searchParams&&URLSearchParams.prototype.isPrototypeOf(R)?this._bodyText=R.toString():p.arrayBuffer&&p.blob&&d(R)?(this._bodyArrayBuffer=w(R.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):p.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(R)||n(R))?this._bodyArrayBuffer=w(R):this._bodyText=R=Object.prototype.toString.call(R):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof R=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):p.searchParams&&URLSearchParams.prototype.isPrototypeOf(R)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},p.blob&&(this.blob=function(){var R=m(this);if(R)return R;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var R=m(this);return R||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(p.blob)return this.blob().then(b);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var R=m(this);if(R)return R;if(this._bodyBlob)return _(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(x(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},p.formData&&(this.formData=function(){return this.text().then(A)}),this.json=function(){return this.text().then(JSON.parse)},this}var S=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function I(R){var O=R.toUpperCase();return S.indexOf(O)>-1?O:R}function v(R,O){if(!(this instanceof v))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');O=O||{};var F=O.body;if(R instanceof v){if(R.bodyUsed)throw new TypeError("Already read");this.url=R.url,this.credentials=R.credentials,O.headers||(this.headers=new g(R.headers)),this.method=R.method,this.mode=R.mode,this.signal=R.signal,!F&&R._bodyInit!=null&&(F=R._bodyInit,R.bodyUsed=!0)}else this.url=String(R);if(this.credentials=O.credentials||this.credentials||"same-origin",(O.headers||!this.headers)&&(this.headers=new g(O.headers)),this.method=I(O.method||this.method||"GET"),this.mode=O.mode||this.mode||null,this.signal=O.signal||this.signal||function(){if("AbortController"in h){var Z=new AbortController;return Z.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&F)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(F),(this.method==="GET"||this.method==="HEAD")&&(O.cache==="no-store"||O.cache==="no-cache")){var z=/([?&])_=[^&]*/;if(z.test(this.url))this.url=this.url.replace(z,"$1_="+new Date().getTime());else{var W=/\?/;this.url+=(W.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}v.prototype.clone=function(){return new v(this,{body:this._bodyInit})};function A(R){var O=new FormData;return R.trim().split("&").forEach(function(F){if(F){var z=F.split("="),W=z.shift().replace(/\+/g," "),Z=z.join("=").replace(/\+/g," ");O.append(decodeURIComponent(W),decodeURIComponent(Z))}}),O}function L(R){var O=new g,F=R.replace(/\r?\n[\t ]+/g," ");return F.split("\r").map(function(z){return z.indexOf(`
`)===0?z.substr(1,z.length):z}).forEach(function(z){var W=z.split(":"),Z=W.shift().trim();if(Z){var J=W.join(":").trim();try{O.append(Z,J)}catch(nt){console.warn("Response "+nt.message)}}}),O}T.call(v.prototype);function N(R,O){if(!(this instanceof N))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(O||(O={}),this.type="default",this.status=O.status===void 0?200:O.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=O.statusText===void 0?"":""+O.statusText,this.headers=new g(O.headers),this.url=O.url||"",this._initBody(R)}T.call(N.prototype),N.prototype.clone=function(){return new N(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new g(this.headers),url:this.url})},N.error=function(){var R=new N(null,{status:200,statusText:""});return R.ok=!1,R.status=0,R.type="error",R};var $=[301,302,303,307,308];N.redirect=function(R,O){if($.indexOf(O)===-1)throw new RangeError("Invalid status code");return new N(null,{status:O,headers:{location:R}})},a.DOMException=h.DOMException;try{new a.DOMException}catch{a.DOMException=function(O,F){this.message=O,this.name=F;var z=Error(O);this.stack=z.stack},a.DOMException.prototype=Object.create(Error.prototype),a.DOMException.prototype.constructor=a.DOMException}function D(R,O){return new Promise(function(F,z){var W=new v(R,O);if(W.signal&&W.signal.aborted)return z(new a.DOMException("Aborted","AbortError"));var Z=new XMLHttpRequest;function J(){Z.abort()}Z.onload=function(){var K={statusText:Z.statusText,headers:L(Z.getAllResponseHeaders()||"")};W.url.indexOf("file://")===0&&(Z.status<200||Z.status>599)?K.status=200:K.status=Z.status,K.url="responseURL"in Z?Z.responseURL:K.headers.get("X-Request-URL");var st="response"in Z?Z.response:Z.responseText;setTimeout(function(){F(new N(st,K))},0)},Z.onerror=function(){setTimeout(function(){z(new TypeError("Network request failed"))},0)},Z.ontimeout=function(){setTimeout(function(){z(new TypeError("Network request timed out"))},0)},Z.onabort=function(){setTimeout(function(){z(new a.DOMException("Aborted","AbortError"))},0)};function nt(K){try{return K===""&&h.location.href?h.location.href:K}catch{return K}}if(Z.open(W.method,nt(W.url),!0),W.credentials==="include"?Z.withCredentials=!0:W.credentials==="omit"&&(Z.withCredentials=!1),"responseType"in Z&&(p.blob?Z.responseType="blob":p.arrayBuffer&&(Z.responseType="arraybuffer")),O&&typeof O.headers=="object"&&!(O.headers instanceof g||h.Headers&&O.headers instanceof h.Headers)){var wt=[];Object.getOwnPropertyNames(O.headers).forEach(function(K){wt.push(e(K)),Z.setRequestHeader(K,o(O.headers[K]))}),W.headers.forEach(function(K,st){wt.indexOf(st)===-1&&Z.setRequestHeader(st,K)})}else W.headers.forEach(function(K,st){Z.setRequestHeader(st,K)});W.signal&&(W.signal.addEventListener("abort",J),Z.onreadystatechange=function(){Z.readyState===4&&W.signal.removeEventListener("abort",J)}),Z.send(typeof W._bodyInit>"u"?null:W._bodyInit)})}return D.polyfill=!0,h.fetch||(h.fetch=D,h.Headers=g,h.Request=v,h.Response=N),a.Headers=g,a.Request=v,a.Response=N,a.fetch=D,Object.defineProperty(a,"__esModule",{value:!0}),a})({})})(i),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var s=r.fetch?r:i;t=s.fetch,t.default=s.fetch,t.fetch=s.fetch,t.Headers=s.Headers,t.Request=s.Request,t.Response=s.Response,f.exports=t}(browserPonyfill,browserPonyfill.exports)),browserPonyfill.exports}var browserPonyfillExports=requireBrowserPonyfill();const fetch$1=getDefaultExportFromCjs(browserPonyfillExports);class npyjs{constructor(t){t&&console.error(["No arguments accepted to npyjs constructor.","For usage, go to https://github.com/jhuapl-boss/npyjs."].join(" ")),this.dtypes={"<u1":{name:"uint8",size:8,arrayConstructor:Uint8Array},"|u1":{name:"uint8",size:8,arrayConstructor:Uint8Array},"<u2":{name:"uint16",size:16,arrayConstructor:Uint16Array},"|i1":{name:"int8",size:8,arrayConstructor:Int8Array},"<i2":{name:"int16",size:16,arrayConstructor:Int16Array},"<u4":{name:"uint32",size:32,arrayConstructor:Int32Array},"<i4":{name:"int32",size:32,arrayConstructor:Int32Array},"<u8":{name:"uint64",size:64,arrayConstructor:BigUint64Array},"<i8":{name:"int64",size:64,arrayConstructor:BigInt64Array},"<f4":{name:"float32",size:32,arrayConstructor:Float32Array},"<f8":{name:"float64",size:64,arrayConstructor:Float64Array}}}parse(t){const r=new DataView(t.slice(8,10)).getUint8(0),i=10+r,s=new TextDecoder("utf-8").decode(new Uint8Array(t.slice(10,10+r))),c=JSON.parse(s.toLowerCase().replace(/'/g,'"').replace("(","[").replace(/,*\),*/g,"]")),a=c.shape,h=this.dtypes[c.descr],p=new h.arrayConstructor(t,i);return{dtype:h.name,data:p,shape:a,fortranOrder:c.fortran_order}}async load(t,r,i){i=i||{};const c=await(await fetch$1(t,{...i})).arrayBuffer(),a=this.parse(c);return r?r(a):a}}const InteractionProperty={ACTIVE:"active"};function easeIn(f){return Math.pow(f,3)}function easeOut(f){return 1-easeIn(1-f)}function inAndOut(f){return 3*f*f-2*f*f*f}class Interaction extends BaseObject{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(InteractionProperty.ACTIVE)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(InteractionProperty.ACTIVE,t)}setMap(t){this.map_=t}}const MapBrowserEventType={POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup"};class PointerInteraction extends Interaction{constructor(t){t=t||{},super(t),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let r=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==MapBrowserEventType.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==MapBrowserEventType.POINTERUP){const i=this.handleUpEvent(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==MapBrowserEventType.POINTERDOWN){const i=this.handleDownEvent(t);this.handlingDownUpSequence=i,r=this.stopDown(i)}else t.type==MapBrowserEventType.POINTERMOVE&&this.handleMoveEvent(t);return!r}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}}new Array(6);function create(){return[1,0,0,1,0,0]}function setFromArray(f,t){return f[0]=t[0],f[1]=t[1],f[2]=t[2],f[3]=t[3],f[4]=t[4],f[5]=t[5],f}function apply(f,t){const r=t[0],i=t[1];return t[0]=f[0]*r+f[2]*i+f[4],t[1]=f[1]*r+f[3]*i+f[5],t}function compose(f,t,r,i,s,c,a,h){const p=Math.sin(c),d=Math.cos(c);return f[0]=i*d,f[1]=s*p,f[2]=-i*p,f[3]=s*d,f[4]=a*i*d-h*i*p+t,f[5]=a*s*p+h*s*d+r,f}function makeInverse(f,t){const r=determinant(t);assert(r!==0,"Transformation matrix cannot be inverted");const i=t[0],s=t[1],c=t[2],a=t[3],h=t[4],p=t[5];return f[0]=a/r,f[1]=-s/r,f[2]=-c/r,f[3]=i/r,f[4]=(c*p-a*h)/r,f[5]=-(i*p-s*h)/r,f}function determinant(f){return f[0]*f[3]-f[1]*f[2]}const matrixPrecision=[1e6,1e6,1e6,1e6,2,2];function toString$1(f){return"matrix("+f.map((r,i)=>Math.round(r*matrixPrecision[i])/matrixPrecision[i]).join(", ")+")"}const Relationship={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function buffer(f,t,r){return r?(r[0]=f[0]-t,r[1]=f[1]-t,r[2]=f[2]+t,r[3]=f[3]+t,r):[f[0]-t,f[1]-t,f[2]+t,f[3]+t]}function clone(f,t){return f.slice()}function closestSquaredDistanceXY(f,t,r){let i,s;return t<f[0]?i=f[0]-t:f[2]<t?i=t-f[2]:i=0,r<f[1]?s=f[1]-r:f[3]<r?s=r-f[3]:s=0,i*i+s*s}function containsCoordinate(f,t){return containsXY(f,t[0],t[1])}function containsExtent(f,t){return f[0]<=t[0]&&t[2]<=f[2]&&f[1]<=t[1]&&t[3]<=f[3]}function containsXY(f,t,r){return f[0]<=t&&t<=f[2]&&f[1]<=r&&r<=f[3]}function coordinateRelationship(f,t){const r=f[0],i=f[1],s=f[2],c=f[3],a=t[0],h=t[1];let p=Relationship.UNKNOWN;return a<r?p=p|Relationship.LEFT:a>s&&(p=p|Relationship.RIGHT),h<i?p=p|Relationship.BELOW:h>c&&(p=p|Relationship.ABOVE),p===Relationship.UNKNOWN&&(p=Relationship.INTERSECTING),p}function createEmpty(){return[1/0,1/0,-1/0,-1/0]}function createOrUpdate(f,t,r,i,s){return s?(s[0]=f,s[1]=t,s[2]=r,s[3]=i,s):[f,t,r,i]}function createOrUpdateEmpty(f){return createOrUpdate(1/0,1/0,-1/0,-1/0,f)}function createOrUpdateFromCoordinate(f,t){const r=f[0],i=f[1];return createOrUpdate(r,i,r,i,t)}function createOrUpdateFromFlatCoordinates(f,t,r,i,s){const c=createOrUpdateEmpty(s);return extendFlatCoordinates(c,f,t,r,i)}function equals$1(f,t){return f[0]==t[0]&&f[2]==t[2]&&f[1]==t[1]&&f[3]==t[3]}function extendCoordinate(f,t){t[0]<f[0]&&(f[0]=t[0]),t[0]>f[2]&&(f[2]=t[0]),t[1]<f[1]&&(f[1]=t[1]),t[1]>f[3]&&(f[3]=t[1])}function extendFlatCoordinates(f,t,r,i,s){for(;r<i;r+=s)extendXY(f,t[r],t[r+1]);return f}function extendXY(f,t,r){f[0]=Math.min(f[0],t),f[1]=Math.min(f[1],r),f[2]=Math.max(f[2],t),f[3]=Math.max(f[3],r)}function forEachCorner(f,t){let r;return r=t(getBottomLeft(f)),r||(r=t(getBottomRight(f)),r)||(r=t(getTopRight(f)),r)||(r=t(getTopLeft(f)),r)?r:!1}function getBottomLeft(f){return[f[0],f[1]]}function getBottomRight(f){return[f[2],f[1]]}function getCenter(f){return[(f[0]+f[2])/2,(f[1]+f[3])/2]}function getForViewAndSize(f,t,r,i,s){const[c,a,h,p,d,l,n,e]=getRotatedViewport(f,t,r,i);return createOrUpdate(Math.min(c,h,d,n),Math.min(a,p,l,e),Math.max(c,h,d,n),Math.max(a,p,l,e),s)}function getRotatedViewport(f,t,r,i){const s=t*i[0]/2,c=t*i[1]/2,a=Math.cos(r),h=Math.sin(r),p=s*a,d=s*h,l=c*a,n=c*h,e=f[0],o=f[1];return[e-p+n,o-d-l,e-p-n,o-d+l,e+p-n,o+d+l,e+p+n,o+d-l,e-p+n,o-d-l]}function getHeight(f){return f[3]-f[1]}function getTopLeft(f){return[f[0],f[3]]}function getTopRight(f){return[f[2],f[3]]}function getWidth(f){return f[2]-f[0]}function intersects$1(f,t){return f[0]<=t[2]&&f[2]>=t[0]&&f[1]<=t[3]&&f[3]>=t[1]}function isEmpty(f){return f[2]<f[0]||f[3]<f[1]}function returnOrUpdate(f,t){return t?(t[0]=f[0],t[1]=f[1],t[2]=f[2],t[3]=f[3],t):f}function intersectsSegment(f,t,r){let i=!1;const s=coordinateRelationship(f,t),c=coordinateRelationship(f,r);if(s===Relationship.INTERSECTING||c===Relationship.INTERSECTING)i=!0;else{const a=f[0],h=f[1],p=f[2],d=f[3],l=t[0],n=t[1],e=r[0],o=r[1],u=(o-n)/(e-l);let g,m;c&Relationship.ABOVE&&!(s&Relationship.ABOVE)&&(g=e-(o-d)/u,i=g>=a&&g<=p),!i&&c&Relationship.RIGHT&&!(s&Relationship.RIGHT)&&(m=o-(e-p)*u,i=m>=h&&m<=d),!i&&c&Relationship.BELOW&&!(s&Relationship.BELOW)&&(g=e-(o-h)/u,i=g>=a&&g<=p),!i&&c&Relationship.LEFT&&!(s&Relationship.LEFT)&&(m=o-(e-a)*u,i=m>=h&&m<=d)}return i}function wrapX$1(f,t){const r=t.getExtent(),i=getCenter(f);if(t.canWrapX()&&(i[0]<r[0]||i[0]>=r[2])){const s=getWidth(r),a=Math.floor((i[0]-r[0])/s)*s;f[0]-=a,f[2]-=a}return f}function wrapAndSliceX(f,t,r){if(t.canWrapX()){const i=t.getExtent();if(!isFinite(f[0])||!isFinite(f[2]))return[[i[0],f[1],i[2],f[3]]];wrapX$1(f,t);const s=getWidth(i);if(getWidth(f)>s)return[[i[0],f[1],i[2],f[3]]];if(f[0]<i[0])return[[f[0]+s,f[1],i[2],f[3]],[i[0],f[1],f[2],f[3]]];if(f[2]>i[2])return[[f[0],f[1],i[2],f[3]],[i[0],f[1],f[2]-s,f[3]]]}return[f]}const METERS_PER_UNIT$1={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class Projection{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||METERS_PER_UNIT$1[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const RADIUS$1=6378137,HALF_SIZE=Math.PI*RADIUS$1,EXTENT$1=[-HALF_SIZE,-HALF_SIZE,HALF_SIZE,HALF_SIZE],WORLD_EXTENT=[-180,-85,180,85],MAX_SAFE_Y=RADIUS$1*Math.log(Math.tan(Math.PI/2));class EPSG3857Projection extends Projection{constructor(t){super({code:t,units:"m",extent:EXTENT$1,global:!0,worldExtent:WORLD_EXTENT,getPointResolution:function(r,i){return r/Math.cosh(i[1]/RADIUS$1)}})}}const PROJECTIONS$1=[new EPSG3857Projection("EPSG:3857"),new EPSG3857Projection("EPSG:102100"),new EPSG3857Projection("EPSG:102113"),new EPSG3857Projection("EPSG:900913"),new EPSG3857Projection("http://www.opengis.net/def/crs/EPSG/0/3857"),new EPSG3857Projection("http://www.opengis.net/gml/srs/epsg.xml#3857")];function fromEPSG4326(f,t,r){const i=f.length;r=r>1?r:2,t===void 0&&(r>2?t=f.slice():t=new Array(i));for(let s=0;s<i;s+=r){t[s]=HALF_SIZE*f[s]/180;let c=RADIUS$1*Math.log(Math.tan(Math.PI*(+f[s+1]+90)/360));c>MAX_SAFE_Y?c=MAX_SAFE_Y:c<-MAX_SAFE_Y&&(c=-MAX_SAFE_Y),t[s+1]=c}return t}function toEPSG4326(f,t,r){const i=f.length;r=r>1?r:2,t===void 0&&(r>2?t=f.slice():t=new Array(i));for(let s=0;s<i;s+=r)t[s]=180*f[s]/HALF_SIZE,t[s+1]=360*Math.atan(Math.exp(f[s+1]/RADIUS$1))/Math.PI-90;return t}const RADIUS=6378137,EXTENT=[-180,-90,180,90],METERS_PER_UNIT=Math.PI*RADIUS/180;class EPSG4326Projection extends Projection{constructor(t,r){super({code:t,units:"degrees",extent:EXTENT,axisOrientation:r,global:!0,metersPerUnit:METERS_PER_UNIT,worldExtent:EXTENT})}}const PROJECTIONS=[new EPSG4326Projection("CRS:84"),new EPSG4326Projection("EPSG:4326","neu"),new EPSG4326Projection("urn:ogc:def:crs:OGC:1.3:CRS84"),new EPSG4326Projection("urn:ogc:def:crs:OGC:2:84"),new EPSG4326Projection("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new EPSG4326Projection("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new EPSG4326Projection("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let cache$1={};function get$3(f){return cache$1[f]||cache$1[f.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function add$2(f,t){cache$1[f]=t}let transforms={};function add$1(f,t,r){const i=f.getCode(),s=t.getCode();i in transforms||(transforms[i]={}),transforms[i][s]=r}function get$2(f,t){let r;return f in transforms&&t in transforms[f]&&(r=transforms[f][t]),r}function clamp(f,t,r){return Math.min(Math.max(f,t),r)}function squaredSegmentDistance(f,t,r,i,s,c){const a=s-r,h=c-i;if(a!==0||h!==0){const p=((f-r)*a+(t-i)*h)/(a*a+h*h);p>1?(r=s,i=c):p>0&&(r+=a*p,i+=h*p)}return squaredDistance(f,t,r,i)}function squaredDistance(f,t,r,i){const s=r-f,c=i-t;return s*s+c*c}function toRadians(f){return f*Math.PI/180}function modulo(f,t){const r=f%t;return r*t<0?r+t:r}function lerp(f,t,r){return f+r*(t-f)}function toFixed(f,t){const r=Math.pow(10,t);return Math.round(f*r)/r}function add(f,t){return f[0]+=+t[0],f[1]+=+t[1],f}function equals(f,t){let r=!0;for(let i=f.length-1;i>=0;--i)if(f[i]!=t[i]){r=!1;break}return r}function rotate$1(f,t){const r=Math.cos(t),i=Math.sin(t),s=f[0]*r-f[1]*i,c=f[1]*r+f[0]*i;return f[0]=s,f[1]=c,f}function wrapX(f,t){if(t.canWrapX()){const r=getWidth(t.getExtent()),i=getWorldsAway(f,t,r);i&&(f[0]-=i*r)}return f}function getWorldsAway(f,t,r){const i=t.getExtent();let s=0;return t.canWrapX()&&(f[0]<i[0]||f[0]>i[2])&&(r=r||getWidth(i),s=Math.floor((f[0]-i[0])/r)),s}function warn(...f){console.warn(...f)}let showCoordinateWarning=!0;function disableCoordinateWarning(f){showCoordinateWarning=!1}function cloneTransform(f,t){if(t!==void 0){for(let r=0,i=f.length;r<i;++r)t[r]=f[r];t=t}else t=f.slice();return t}function identityTransform(f,t){if(t!==void 0&&f!==t){for(let r=0,i=f.length;r<i;++r)t[r]=f[r];f=t}return f}function addProjection(f){add$2(f.getCode(),f),add$1(f,f,cloneTransform)}function addProjections(f){f.forEach(addProjection)}function get$1(f){return typeof f=="string"?get$3(f):f||null}function addEquivalentProjections(f){addProjections(f),f.forEach(function(t){f.forEach(function(r){t!==r&&add$1(t,r,cloneTransform)})})}function addEquivalentTransforms(f,t,r,i){f.forEach(function(s){t.forEach(function(c){add$1(s,c,r),add$1(c,s,i)})})}function createProjection(f,t){return f?typeof f=="string"?get$1(f):f:get$1(t)}function getTransformFromProjections(f,t){const r=f.getCode(),i=t.getCode();let s=get$2(r,i);return s||(s=identityTransform),s}function getTransform(f,t){const r=get$1(f),i=get$1(t);return getTransformFromProjections(r,i)}function toUserCoordinate(f,t){return f}function fromUserCoordinate(f,t){return showCoordinateWarning&&!equals(f,[0,0])&&f[0]>=-180&&f[0]<=180&&f[1]>=-90&&f[1]<=90&&(showCoordinateWarning=!1,warn("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),f}function toUserExtent(f,t){return f}function fromUserExtent(f,t){return f}function addCommon(){addEquivalentProjections(PROJECTIONS$1),addEquivalentProjections(PROJECTIONS),addEquivalentTransforms(PROJECTIONS,PROJECTIONS$1,fromEPSG4326,toEPSG4326)}addCommon();function transform2D(f,t,r,i,s,c){c=c||[];let a=0;for(let h=t;h<r;h+=i){const p=f[h],d=f[h+1];c[a++]=s[0]*p+s[2]*d+s[4],c[a++]=s[1]*p+s[3]*d+s[5]}return c&&c.length!=a&&(c.length=a),c}function rotate(f,t,r,i,s,c,a){a=a||[];const h=Math.cos(s),p=Math.sin(s),d=c[0],l=c[1];let n=0;for(let e=t;e<r;e+=i){const o=f[e]-d,u=f[e+1]-l;a[n++]=d+o*h-u*p,a[n++]=l+o*p+u*h;for(let g=e+2;g<e+i;++g)a[n++]=f[g]}return a&&a.length!=n&&(a.length=n),a}function scale(f,t,r,i,s,c,a,h){h=h||[];const p=a[0],d=a[1];let l=0;for(let n=t;n<r;n+=i){const e=f[n]-p,o=f[n+1]-d;h[l++]=p+s*e,h[l++]=d+c*o;for(let u=n+2;u<n+i;++u)h[l++]=f[u]}return h&&h.length!=l&&(h.length=l),h}function translate(f,t,r,i,s,c,a){a=a||[];let h=0;for(let p=t;p<r;p+=i){a[h++]=f[p]+s,a[h++]=f[p+1]+c;for(let d=p+2;d<p+i;++d)a[h++]=f[d]}return a&&a.length!=h&&(a.length=h),a}const tmpTransform$1=create();class Geometry extends BaseObject{constructor(){super(),this.extent_=createEmpty(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=memoizeOne((t,r,i)=>{if(!i)return this.getSimplifiedGeometry(r);const s=this.clone();return s.applyTransform(i),s.getSimplifiedGeometry(r)})}simplifyTransformed(t,r){return this.simplifyTransformedInternal(this.getRevision(),t,r)}clone(){return abstract()}closestPointXY(t,r,i,s){return abstract()}containsXY(t,r){const i=this.getClosestPoint([t,r]);return i[0]===t&&i[1]===r}getClosestPoint(t,r){return r=r||[NaN,NaN],this.closestPointXY(t[0],t[1],r,1/0),r}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return abstract()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const r=this.computeExtent(this.extent_);(isNaN(r[0])||isNaN(r[1]))&&createOrUpdateEmpty(r),this.extentRevision_=this.getRevision()}return returnOrUpdate(this.extent_,t)}rotate(t,r){abstract()}scale(t,r,i){abstract()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return abstract()}getType(){return abstract()}applyTransform(t){abstract()}intersectsExtent(t){return abstract()}translate(t,r){abstract()}transform(t,r){const i=get$1(t),s=i.getUnits()=="tile-pixels"?function(c,a,h){const p=i.getExtent(),d=i.getWorldExtent(),l=getHeight(d)/getHeight(p);return compose(tmpTransform$1,d[0],d[3],l,-l,0,0,0),transform2D(c,0,c.length,h,tmpTransform$1,a),getTransform(i,r)(c,a,h)}:getTransform(i,r);return this.applyTransform(s),this}}class SimpleGeometry extends Geometry{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return createOrUpdateFromFlatCoordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return abstract()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const r=this.getSimplifiedGeometryInternal(t);return r.getFlatCoordinates().length<this.flatCoordinates.length?r:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,r){this.stride=getStrideForLayout(t),this.layout=t,this.flatCoordinates=r}setCoordinates(t,r){abstract()}setLayout(t,r,i){let s;if(t)s=getStrideForLayout(t);else{for(let c=0;c<i;++c){if(r.length===0){this.layout="XY",this.stride=2;return}r=r[0]}s=r.length,t=getLayoutForStride(s)}this.layout=t,this.stride=s}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(t,r){const i=this.getFlatCoordinates();if(i){const s=this.getStride();rotate(i,0,i.length,s,t,r,i),this.changed()}}scale(t,r,i){r===void 0&&(r=t),i||(i=getCenter(this.getExtent()));const s=this.getFlatCoordinates();if(s){const c=this.getStride();scale(s,0,s.length,c,t,r,i,s),this.changed()}}translate(t,r){const i=this.getFlatCoordinates();if(i){const s=this.getStride();translate(i,0,i.length,s,t,r,i),this.changed()}}}function getLayoutForStride(f){let t;return f==2?t="XY":f==3?t="XYZ":f==4&&(t="XYZM"),t}function getStrideForLayout(f){let t;return f=="XY"?t=2:f=="XYZ"||f=="XYM"?t=3:f=="XYZM"&&(t=4),t}function transformGeom2D(f,t,r){const i=f.getFlatCoordinates();if(!i)return null;const s=f.getStride();return transform2D(i,0,i.length,s,t,r)}function assignClosest(f,t,r,i,s,c,a){const h=f[t],p=f[t+1],d=f[r]-h,l=f[r+1]-p;let n;if(d===0&&l===0)n=t;else{const e=((s-h)*d+(c-p)*l)/(d*d+l*l);if(e>1)n=r;else if(e>0){for(let o=0;o<i;++o)a[o]=lerp(f[t+o],f[r+o],e);a.length=i;return}else n=t}for(let e=0;e<i;++e)a[e]=f[n+e];a.length=i}function maxSquaredDelta(f,t,r,i,s){let c=f[t],a=f[t+1];for(t+=i;t<r;t+=i){const h=f[t],p=f[t+1],d=squaredDistance(c,a,h,p);d>s&&(s=d),c=h,a=p}return s}function arrayMaxSquaredDelta(f,t,r,i,s){for(let c=0,a=r.length;c<a;++c){const h=r[c];s=maxSquaredDelta(f,t,h,i,s),t=h}return s}function assignClosestPoint(f,t,r,i,s,c,a,h,p,d,l){if(t==r)return d;let n,e;if(s===0){if(e=squaredDistance(a,h,f[t],f[t+1]),e<d){for(n=0;n<i;++n)p[n]=f[t+n];return p.length=i,e}return d}l=l||[NaN,NaN];let o=t+i;for(;o<r;)if(assignClosest(f,o-i,o,i,a,h,l),e=squaredDistance(a,h,l[0],l[1]),e<d){for(d=e,n=0;n<i;++n)p[n]=l[n];p.length=i,o+=i}else o+=i*Math.max((Math.sqrt(e)-Math.sqrt(d))/s|0,1);if(assignClosest(f,r-i,t,i,a,h,l),e=squaredDistance(a,h,l[0],l[1]),e<d){for(d=e,n=0;n<i;++n)p[n]=l[n];p.length=i}return d}function assignClosestArrayPoint(f,t,r,i,s,c,a,h,p,d,l){l=l||[NaN,NaN];for(let n=0,e=r.length;n<e;++n){const o=r[n];d=assignClosestPoint(f,t,o,i,s,c,a,h,p,d,l),t=o}return d}function deflateCoordinate(f,t,r,i){for(let s=0,c=r.length;s<c;++s)f[t++]=r[s];return t}function deflateCoordinates(f,t,r,i){for(let s=0,c=r.length;s<c;++s){const a=r[s];for(let h=0;h<i;++h)f[t++]=a[h]}return t}function deflateCoordinatesArray(f,t,r,i,s){s=s||[];let c=0;for(let a=0,h=r.length;a<h;++a){const p=deflateCoordinates(f,t,r[a],i);s[c++]=p,t=p}return s.length=c,s}function douglasPeucker(f,t,r,i,s,c,a){const h=(r-t)/i;if(h<3){for(;t<r;t+=i)c[a++]=f[t],c[a++]=f[t+1];return a}const p=new Array(h);p[0]=1,p[h-1]=1;const d=[t,r-i];let l=0;for(;d.length>0;){const n=d.pop(),e=d.pop();let o=0;const u=f[e],g=f[e+1],m=f[n],y=f[n+1];for(let b=e+i;b<n;b+=i){const _=f[b],x=f[b+1],w=squaredSegmentDistance(_,x,u,g,m,y);w>o&&(l=b,o=w)}o>s&&(p[(l-t)/i]=1,e+i<l&&d.push(e,l),l+i<n&&d.push(l,n))}for(let n=0;n<h;++n)p[n]&&(c[a++]=f[t+n*i],c[a++]=f[t+n*i+1]);return a}function douglasPeuckerArray(f,t,r,i,s,c,a,h){for(let p=0,d=r.length;p<d;++p){const l=r[p];a=douglasPeucker(f,t,l,i,s,c,a),h.push(a),t=l}return a}function snap(f,t){return t*Math.round(f/t)}function quantize(f,t,r,i,s,c,a){if(t==r)return a;let h=snap(f[t],s),p=snap(f[t+1],s);t+=i,c[a++]=h,c[a++]=p;let d,l;do if(d=snap(f[t],s),l=snap(f[t+1],s),t+=i,t==r)return c[a++]=d,c[a++]=l,a;while(d==h&&l==p);for(;t<r;){const n=snap(f[t],s),e=snap(f[t+1],s);if(t+=i,n==d&&e==l)continue;const o=d-h,u=l-p,g=n-h,m=e-p;if(o*m==u*g&&(o<0&&g<o||o==g||o>0&&g>o)&&(u<0&&m<u||u==m||u>0&&m>u)){d=n,l=e;continue}c[a++]=d,c[a++]=l,h=d,p=l,d=n,l=e}return c[a++]=d,c[a++]=l,a}function quantizeArray(f,t,r,i,s,c,a,h){for(let p=0,d=r.length;p<d;++p){const l=r[p];a=quantize(f,t,l,i,s,c,a),h.push(a),t=l}return a}function inflateCoordinates(f,t,r,i,s){s=s!==void 0?s:[];let c=0;for(let a=t;a<r;a+=i)s[c++]=f.slice(a,a+i);return s.length=c,s}function inflateCoordinatesArray(f,t,r,i,s){s=s!==void 0?s:[];let c=0;for(let a=0,h=r.length;a<h;++a){const p=r[a];s[c++]=inflateCoordinates(f,t,p,i,s[c]),t=p}return s.length=c,s}function inflateMultiCoordinatesArray(f,t,r,i,s){s=s!==void 0?s:[];let c=0;for(let a=0,h=r.length;a<h;++a){const p=r[a];s[c++]=p.length===1&&p[0]===t?[]:inflateCoordinatesArray(f,t,p,i,s[c]),t=p[p.length-1]}return s.length=c,s}function linearRing(f,t,r,i){let s=0,c=f[r-i],a=f[r-i+1];for(;t<r;t+=i){const h=f[t],p=f[t+1];s+=a*h-c*p,c=h,a=p}return s/2}function linearRings(f,t,r,i){let s=0;for(let c=0,a=r.length;c<a;++c){const h=r[c];s+=linearRing(f,t,h,i),t=h}return s}class LinearRing extends SimpleGeometry{constructor(t,r){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,r!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(r,t):this.setCoordinates(t,r)}clone(){return new LinearRing(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,r,i,s){return s<closestSquaredDistanceXY(this.getExtent(),t,r)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(maxSquaredDelta(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),assignClosestPoint(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,r,i,s))}getArea(){return linearRing(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return inflateCoordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const r=[];return r.length=douglasPeucker(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,r,0),new LinearRing(r,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,r){this.setLayout(r,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=deflateCoordinates(this.flatCoordinates,0,t,this.stride),this.changed()}}class Point extends SimpleGeometry{constructor(t,r){super(),this.setCoordinates(t,r)}clone(){const t=new Point(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,r,i,s){const c=this.flatCoordinates,a=squaredDistance(t,r,c[0],c[1]);if(a<s){const h=this.stride;for(let p=0;p<h;++p)i[p]=c[p];return i.length=h,a}return s}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return createOrUpdateFromCoordinate(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return containsXY(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,r){this.setLayout(r,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=deflateCoordinate(this.flatCoordinates,0,t,this.stride),this.changed()}}function linearRingContainsExtent(f,t,r,i,s){return!forEachCorner(s,function(a){return!linearRingContainsXY(f,t,r,i,a[0],a[1])})}function linearRingContainsXY(f,t,r,i,s,c){let a=0,h=f[r-i],p=f[r-i+1];for(;t<r;t+=i){const d=f[t],l=f[t+1];p<=c?l>c&&(d-h)*(c-p)-(s-h)*(l-p)>0&&a++:l<=c&&(d-h)*(c-p)-(s-h)*(l-p)<0&&a--,h=d,p=l}return a!==0}function linearRingsContainsXY(f,t,r,i,s,c){if(r.length===0||!linearRingContainsXY(f,t,r[0],i,s,c))return!1;for(let a=1,h=r.length;a<h;++a)if(linearRingContainsXY(f,r[a-1],r[a],i,s,c))return!1;return!0}function getInteriorPointOfArray(f,t,r,i,s,c,a){let h,p,d,l,n,e,o;const u=s[c+1],g=[];for(let b=0,_=r.length;b<_;++b){const x=r[b];for(l=f[x-i],e=f[x-i+1],h=t;h<x;h+=i)n=f[h],o=f[h+1],(u<=e&&o<=u||e<=u&&u<=o)&&(d=(u-e)/(o-e)*(n-l)+l,g.push(d)),l=n,e=o}let m=NaN,y=-1/0;for(g.sort(ascending),l=g[0],h=1,p=g.length;h<p;++h){n=g[h];const b=Math.abs(n-l);b>y&&(d=(l+n)/2,linearRingsContainsXY(f,t,r,i,d,u)&&(m=d,y=b)),l=n}return isNaN(m)&&(m=s[c]),a?(a.push(m,u,y),a):[m,u,y]}function getInteriorPointsOfMultiArray(f,t,r,i,s){let c=[];for(let a=0,h=r.length;a<h;++a){const p=r[a];c=getInteriorPointOfArray(f,t,p,i,s,2*a,c),t=p[p.length-1]}return c}function forEach(f,t,r,i,s){let c;for(t+=i;t<r;t+=i)if(c=s(f.slice(t-i,t),f.slice(t,t+i)),c)return c;return!1}function intersectsLineString(f,t,r,i,s){const c=extendFlatCoordinates(createEmpty(),f,t,r,i);return intersects$1(s,c)?containsExtent(s,c)||c[0]>=s[0]&&c[2]<=s[2]||c[1]>=s[1]&&c[3]<=s[3]?!0:forEach(f,t,r,i,function(a,h){return intersectsSegment(s,a,h)}):!1}function intersectsLinearRing(f,t,r,i,s){return!!(intersectsLineString(f,t,r,i,s)||linearRingContainsXY(f,t,r,i,s[0],s[1])||linearRingContainsXY(f,t,r,i,s[0],s[3])||linearRingContainsXY(f,t,r,i,s[2],s[1])||linearRingContainsXY(f,t,r,i,s[2],s[3]))}function intersectsLinearRingArray(f,t,r,i,s){if(!intersectsLinearRing(f,t,r[0],i,s))return!1;if(r.length===1)return!0;for(let c=1,a=r.length;c<a;++c)if(linearRingContainsExtent(f,r[c-1],r[c],i,s)&&!intersectsLineString(f,r[c-1],r[c],i,s))return!1;return!0}function coordinates(f,t,r,i){for(;t<r-i;){for(let s=0;s<i;++s){const c=f[t+s];f[t+s]=f[r-i+s],f[r-i+s]=c}t+=i,r-=i}}function linearRingIsClockwise(f,t,r,i){let s=0,c=f[r-i],a=f[r-i+1];for(;t<r;t+=i){const h=f[t],p=f[t+1];s+=(h-c)*(p+a),c=h,a=p}return s===0?void 0:s>0}function linearRingsAreOriented(f,t,r,i,s){s=s!==void 0?s:!1;for(let c=0,a=r.length;c<a;++c){const h=r[c],p=linearRingIsClockwise(f,t,h,i);if(c===0){if(s&&p||!s&&!p)return!1}else if(s&&!p||!s&&p)return!1;t=h}return!0}function orientLinearRings(f,t,r,i,s){s=s!==void 0?s:!1;for(let c=0,a=r.length;c<a;++c){const h=r[c],p=linearRingIsClockwise(f,t,h,i);(c===0?s&&p||!s&&!p:s&&!p||!s&&p)&&coordinates(f,t,h,i),t=h}return t}function inflateEnds(f,t){const r=[];let i=0,s=0,c;for(let a=0,h=t.length;a<h;++a){const p=t[a],d=linearRingIsClockwise(f,i,p,2);if(c===void 0&&(c=d),d===c)r.push(t.slice(s,a+1));else{if(r.length===0)continue;r[r.length-1].push(t[s])}s=a+1,i=p}return r}class Polygon extends SimpleGeometry{constructor(t,r,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,r!==void 0&&i?(this.setFlatCoordinates(r,t),this.ends_=i):this.setCoordinates(t,r)}appendLinearRing(t){this.flatCoordinates?extend$1(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Polygon(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,r,i,s){return s<closestSquaredDistanceXY(this.getExtent(),t,r)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(arrayMaxSquaredDelta(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),assignClosestArrayPoint(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,r,i,s))}containsXY(t,r){return linearRingsContainsXY(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,r)}getArea(){return linearRings(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let r;return t!==void 0?(r=this.getOrientedFlatCoordinates().slice(),orientLinearRings(r,0,this.ends_,this.stride,t)):r=this.flatCoordinates,inflateCoordinatesArray(r,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=getCenter(this.getExtent());this.flatInteriorPoint_=getInteriorPointOfArray(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Point(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new LinearRing(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,r=this.flatCoordinates,i=this.ends_,s=[];let c=0;for(let a=0,h=i.length;a<h;++a){const p=i[a],d=new LinearRing(r.slice(c,p),t);s.push(d),c=p}return s}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;linearRingsAreOriented(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=orientLinearRings(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const r=[],i=[];return r.length=quantizeArray(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),r,0,i),new Polygon(r,"XY",i)}getType(){return"Polygon"}intersectsExtent(t){return intersectsLinearRingArray(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,r){this.setLayout(r,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=deflateCoordinatesArray(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function fromExtent(f){if(isEmpty(f))throw new Error("Cannot create polygon from empty extent");const t=f[0],r=f[1],i=f[2],s=f[3],c=[t,r,t,s,i,s,i,r,t,r];return new Polygon(c,"XY",[c.length])}const LayerProperty={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class BaseLayer extends BaseObject{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const r=Object.assign({},t);typeof t.properties=="object"&&(delete r.properties,Object.assign(r,t.properties)),r[LayerProperty.OPACITY]=t.opacity!==void 0?t.opacity:1,assert(typeof r[LayerProperty.OPACITY]=="number","Layer opacity must be a number"),r[LayerProperty.VISIBLE]=t.visible!==void 0?t.visible:!0,r[LayerProperty.Z_INDEX]=t.zIndex,r[LayerProperty.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,r[LayerProperty.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,r[LayerProperty.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,r[LayerProperty.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,this.className_=r.className!==void 0?r.className:"ol-layer",delete r.className,this.setProperties(r),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const r=this.state_||{layer:this,managed:t===void 0?!0:t},i=this.getZIndex();return r.opacity=clamp(Math.round(this.getOpacity()*100)/100,0,1),r.visible=this.getVisible(),r.extent=this.getExtent(),r.zIndex=i===void 0&&!r.managed?1/0:i,r.maxResolution=this.getMaxResolution(),r.minResolution=Math.max(this.getMinResolution(),0),r.minZoom=this.getMinZoom(),r.maxZoom=this.getMaxZoom(),this.state_=r,r}getLayersArray(t){return abstract()}getLayerStatesArray(t){return abstract()}getExtent(){return this.get(LayerProperty.EXTENT)}getMaxResolution(){return this.get(LayerProperty.MAX_RESOLUTION)}getMinResolution(){return this.get(LayerProperty.MIN_RESOLUTION)}getMinZoom(){return this.get(LayerProperty.MIN_ZOOM)}getMaxZoom(){return this.get(LayerProperty.MAX_ZOOM)}getOpacity(){return this.get(LayerProperty.OPACITY)}getSourceState(){return abstract()}getVisible(){return this.get(LayerProperty.VISIBLE)}getZIndex(){return this.get(LayerProperty.Z_INDEX)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(LayerProperty.EXTENT,t)}setMaxResolution(t){this.set(LayerProperty.MAX_RESOLUTION,t)}setMinResolution(t){this.set(LayerProperty.MIN_RESOLUTION,t)}setMaxZoom(t){this.set(LayerProperty.MAX_ZOOM,t)}setMinZoom(t){this.set(LayerProperty.MIN_ZOOM,t)}setOpacity(t){assert(typeof t=="number","Layer opacity must be a number"),this.set(LayerProperty.OPACITY,t)}setVisible(t){this.set(LayerProperty.VISIBLE,t)}setZIndex(t){this.set(LayerProperty.Z_INDEX,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}const RenderEventType={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose"},ViewHint={ANIMATING:0,INTERACTING:1},ViewProperty={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},DEFAULT_TILE_SIZE=256;function createExtent(f,t,r){return function(i,s,c,a,h){if(!i)return;if(!s&&!t)return i;const p=t?0:c[0]*s,d=t?0:c[1]*s,l=h?h[0]:0,n=h?h[1]:0;let e=f[0]+p/2+l,o=f[2]-p/2+l,u=f[1]+d/2+n,g=f[3]-d/2+n;e>o&&(e=(o+e)/2,o=e),u>g&&(u=(g+u)/2,g=u);let m=clamp(i[0],e,o),y=clamp(i[1],u,g);if(a&&r&&s){const b=30*s;m+=-b*Math.log(1+Math.max(0,e-i[0])/b)+b*Math.log(1+Math.max(0,i[0]-o)/b),y+=-b*Math.log(1+Math.max(0,u-i[1])/b)+b*Math.log(1+Math.max(0,i[1]-g)/b)}return[m,y]}}function none$1(f){return f}function getViewportClampedResolution(f,t,r,i){const s=getWidth(t)/r[0],c=getHeight(t)/r[1];return i?Math.min(f,Math.max(s,c)):Math.min(f,Math.min(s,c))}function getSmoothClampedResolution(f,t,r){let i=Math.min(f,t);const s=50;return i*=Math.log(1+s*Math.max(0,f/t-1))/s+1,r&&(i=Math.max(i,r),i/=Math.log(1+s*Math.max(0,r/f-1))/s+1),clamp(i,r/2,t*2)}function createSnapToResolutions(f,t,r,i){return t=t!==void 0?t:!0,function(s,c,a,h){if(s!==void 0){const p=f[0],d=f[f.length-1],l=r?getViewportClampedResolution(p,r,a,i):p;if(h)return t?getSmoothClampedResolution(s,l,d):clamp(s,d,l);const n=Math.min(l,s),e=Math.floor(linearFindNearest(f,n,c));return f[e]>l&&e<f.length-1?f[e+1]:f[e]}}}function createSnapToPower(f,t,r,i,s,c){return i=i!==void 0?i:!0,r=r!==void 0?r:0,function(a,h,p,d){if(a!==void 0){const l=s?getViewportClampedResolution(t,s,p,c):t;if(d)return i?getSmoothClampedResolution(a,l,r):clamp(a,r,l);const n=1e-9,e=Math.ceil(Math.log(t/l)/Math.log(f)-n),o=-h*(.5-n)+.5,u=Math.min(l,a),g=Math.floor(Math.log(t/u)/Math.log(f)+o),m=Math.max(e,g),y=t/Math.pow(f,m);return clamp(y,r,l)}}}function createMinMaxResolution(f,t,r,i,s){return r=r!==void 0?r:!0,function(c,a,h,p){if(c!==void 0){const d=i?getViewportClampedResolution(f,i,h,s):f;return!r||!p?clamp(c,t,d):getSmoothClampedResolution(c,d,t)}}}function disable(f){if(f!==void 0)return 0}function none(f){if(f!==void 0)return f}function createSnapToN(f){const t=2*Math.PI/f;return function(r,i){if(i)return r;if(r!==void 0)return r=Math.floor(r/t+.5)*t,r}}function createSnapToZero(f){const t=toRadians(5);return function(r,i){return i||r===void 0?r:Math.abs(r)<=t?0:r}}const DEFAULT_MIN_ZOOM=0;class View extends BaseObject{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=createProjection(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&disableCoordinateWarning(),t.center&&(t.center=fromUserCoordinate(t.center,this.projection_)),t.extent&&(t.extent=fromUserExtent(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const r=Object.assign({},t);for(const h in ViewProperty)delete r[h];this.setProperties(r,!0);const i=createResolutionConstraint(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=i.minZoom;const s=createCenterConstraint(t),c=i.constraint,a=createRotationConstraint(t);this.constraints_={center:s,resolution:c,rotation:a},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let r=this.padding_;this.padding_=t;const i=this.getCenterInternal();if(i){const s=t||[0,0,0,0];r=r||[0,0,0,0];const c=this.getResolution(),a=c/2*(s[3]-r[3]+r[1]-s[1]),h=c/2*(s[0]-r[0]+r[2]-s[2]);this.setCenterInternal([i[0]+a,i[1]-h])}}getUpdatedOptions_(t){const r=this.getProperties();return r.resolution!==void 0?r.resolution=this.getResolution():r.zoom=this.getZoom(),r.center=this.getCenterInternal(),r.rotation=this.getRotation(),Object.assign({},r,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const r=new Array(arguments.length);for(let i=0;i<r.length;++i){let s=arguments[i];s.center&&(s=Object.assign({},s),s.center=fromUserCoordinate(s.center,this.getProjection())),s.anchor&&(s=Object.assign({},s),s.anchor=fromUserCoordinate(s.anchor,this.getProjection())),r[i]=s}this.animateInternal.apply(this,r)}animateInternal(t){let r=arguments.length,i;r>1&&typeof arguments[r-1]=="function"&&(i=arguments[r-1],--r);let s=0;for(;s<r&&!this.isDef();++s){const l=arguments[s];l.center&&this.setCenterInternal(l.center),l.zoom!==void 0?this.setZoom(l.zoom):l.resolution&&this.setResolution(l.resolution),l.rotation!==void 0&&this.setRotation(l.rotation)}if(s===r){i&&animationCallback(i,!0);return}let c=Date.now(),a=this.targetCenter_.slice(),h=this.targetResolution_,p=this.targetRotation_;const d=[];for(;s<r;++s){const l=arguments[s],n={start:c,complete:!1,anchor:l.anchor,duration:l.duration!==void 0?l.duration:1e3,easing:l.easing||inAndOut,callback:i};if(l.center&&(n.sourceCenter=a,n.targetCenter=l.center.slice(),a=n.targetCenter),l.zoom!==void 0?(n.sourceResolution=h,n.targetResolution=this.getResolutionForZoom(l.zoom),h=n.targetResolution):l.resolution&&(n.sourceResolution=h,n.targetResolution=l.resolution,h=n.targetResolution),l.rotation!==void 0){n.sourceRotation=p;const e=modulo(l.rotation-p+Math.PI,2*Math.PI)-Math.PI;n.targetRotation=p+e,p=n.targetRotation}isNoopAnimation(n)?n.complete=!0:c+=n.duration,d.push(n)}this.animations_.push(d),this.setHint(ViewHint.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[ViewHint.ANIMATING]>0}getInteracting(){return this.hints_[ViewHint.INTERACTING]>0}cancelAnimations(){this.setHint(ViewHint.ANIMATING,-this.hints_[ViewHint.ANIMATING]);let t;for(let r=0,i=this.animations_.length;r<i;++r){const s=this.animations_[r];if(s[0].callback&&animationCallback(s[0].callback,!1),!t)for(let c=0,a=s.length;c<a;++c){const h=s[c];if(!h.complete){t=h.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let r=!1;for(let i=this.animations_.length-1;i>=0;--i){const s=this.animations_[i];let c=!0;for(let a=0,h=s.length;a<h;++a){const p=s[a];if(p.complete)continue;const d=t-p.start;let l=p.duration>0?d/p.duration:1;l>=1?(p.complete=!0,l=1):c=!1;const n=p.easing(l);if(p.sourceCenter){const e=p.sourceCenter[0],o=p.sourceCenter[1],u=p.targetCenter[0],g=p.targetCenter[1];this.nextCenter_=p.targetCenter;const m=e+n*(u-e),y=o+n*(g-o);this.targetCenter_=[m,y]}if(p.sourceResolution&&p.targetResolution){const e=n===1?p.targetResolution:p.sourceResolution+n*(p.targetResolution-p.sourceResolution);if(p.anchor){const o=this.getViewportSize_(this.getRotation()),u=this.constraints_.resolution(e,0,o,!0);this.targetCenter_=this.calculateCenterZoom(u,p.anchor)}this.nextResolution_=p.targetResolution,this.targetResolution_=e,this.applyTargetState_(!0)}if(p.sourceRotation!==void 0&&p.targetRotation!==void 0){const e=n===1?modulo(p.targetRotation+Math.PI,2*Math.PI)-Math.PI:p.sourceRotation+n*(p.targetRotation-p.sourceRotation);if(p.anchor){const o=this.constraints_.rotation(e,!0);this.targetCenter_=this.calculateCenterRotate(o,p.anchor)}this.nextRotation_=p.targetRotation,this.targetRotation_=e}if(this.applyTargetState_(!0),r=!0,!p.complete)break}if(c){this.animations_[i]=null,this.setHint(ViewHint.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const a=s[0].callback;a&&animationCallback(a,!0)}}this.animations_=this.animations_.filter(Boolean),r&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,r){let i;const s=this.getCenterInternal();return s!==void 0&&(i=[s[0]-r[0],s[1]-r[1]],rotate$1(i,t-this.getRotation()),add(i,r)),i}calculateCenterZoom(t,r){let i;const s=this.getCenterInternal(),c=this.getResolution();if(s!==void 0&&c!==void 0){const a=r[0]-t*(r[0]-s[0])/c,h=r[1]-t*(r[1]-s[1])/c;i=[a,h]}return i}getViewportSize_(t){const r=this.viewportSize_;if(t){const i=r[0],s=r[1];return[Math.abs(i*Math.cos(t))+Math.abs(s*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(s*Math.cos(t))]}return r}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t&&toUserCoordinate(t,this.getProjection())}getCenterInternal(){return this.get(ViewProperty.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){const r=this.calculateExtentInternal(t);return toUserExtent(r,this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const r=this.getCenterInternal();assert(r,"The view center is not defined");const i=this.getResolution();assert(i!==void 0,"The view resolution is not defined");const s=this.getRotation();return assert(s!==void 0,"The view rotation is not defined"),getForViewAndSize(r,i,s,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(ViewProperty.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,r){return this.getResolutionForExtentInternal(fromUserExtent(t,this.getProjection()),r)}getResolutionForExtentInternal(t,r){r=r||this.getViewportSizeMinusPadding_();const i=getWidth(t)/r[0],s=getHeight(t)/r[1];return Math.max(i,s)}getResolutionForValueFunction(t){t=t||2;const r=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,s=Math.log(r/i)/Math.log(t);return function(c){return r/Math.pow(t,c*s)}}getRotation(){return this.get(ViewProperty.ROTATION)}getValueForResolutionFunction(t){const r=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),s=this.minResolution_,c=Math.log(i/s)/r;return function(a){return Math.log(i/a)/r/c}}getViewportSizeMinusPadding_(t){let r=this.getViewportSize_(t);const i=this.padding_;return i&&(r=[r[0]-i[1]-i[3],r[1]-i[0]-i[2]]),r}getState(){const t=this.getProjection(),r=this.getResolution(),i=this.getRotation();let s=this.getCenterInternal();const c=this.padding_;if(c){const a=this.getViewportSizeMinusPadding_();s=calculateCenterOn(s,this.getViewportSize_(),[a[0]/2+c[3],a[1]/2+c[0]],r,i)}return{center:s.slice(0),projection:t!==void 0?t:null,resolution:r,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const r=this.getResolution();return r!==void 0&&(t=this.getZoomForResolution(r)),t}getZoomForResolution(t){let r=this.minZoom_||0,i,s;if(this.resolutions_){const c=linearFindNearest(this.resolutions_,t,1);r=c,i=this.resolutions_[c],c==this.resolutions_.length-1?s=2:s=i/this.resolutions_[c+1]}else i=this.maxResolution_,s=this.zoomFactor_;return r+Math.log(i/t)/Math.log(s)}getResolutionForZoom(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;const r=clamp(Math.floor(t),0,this.resolutions_.length-2),i=this.resolutions_[r]/this.resolutions_[r+1];return this.resolutions_[r]/Math.pow(i,clamp(t-r,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,r){let i;if(assert(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(t)){assert(!isEmpty(t),"Cannot fit empty extent provided as `geometry`");const s=fromUserExtent(t,this.getProjection());i=fromExtent(s)}else if(t.getType()==="Circle"){const s=fromUserExtent(t.getExtent(),this.getProjection());i=fromExtent(s),i.rotate(this.getRotation(),getCenter(s))}else i=t;this.fitInternal(i,r)}rotatedExtentForGeometry(t){const r=this.getRotation(),i=Math.cos(r),s=Math.sin(-r),c=t.getFlatCoordinates(),a=t.getStride();let h=1/0,p=1/0,d=-1/0,l=-1/0;for(let n=0,e=c.length;n<e;n+=a){const o=c[n]*i-c[n+1]*s,u=c[n]*s+c[n+1]*i;h=Math.min(h,o),p=Math.min(p,u),d=Math.max(d,o),l=Math.max(l,u)}return[h,p,d,l]}fitInternal(t,r){r=r||{};let i=r.size;i||(i=this.getViewportSizeMinusPadding_());const s=r.padding!==void 0?r.padding:[0,0,0,0],c=r.nearest!==void 0?r.nearest:!1;let a;r.minResolution!==void 0?a=r.minResolution:r.maxZoom!==void 0?a=this.getResolutionForZoom(r.maxZoom):a=0;const h=this.rotatedExtentForGeometry(t);let p=this.getResolutionForExtentInternal(h,[i[0]-s[1]-s[3],i[1]-s[0]-s[2]]);p=isNaN(p)?a:Math.max(p,a),p=this.getConstrainedResolution(p,c?0:1);const d=this.getRotation(),l=Math.sin(d),n=Math.cos(d),e=getCenter(h);e[0]+=(s[1]-s[3])/2*p,e[1]+=(s[0]-s[2])/2*p;const o=e[0]*n-e[1]*l,u=e[1]*n+e[0]*l,g=this.getConstrainedCenter([o,u],p),m=r.callback?r.callback:VOID;r.duration!==void 0?this.animateInternal({resolution:p,center:g,duration:r.duration,easing:r.easing},m):(this.targetResolution_=p,this.targetCenter_=g,this.applyTargetState_(!1,!0),animationCallback(m,!0))}centerOn(t,r,i){this.centerOnInternal(fromUserCoordinate(t,this.getProjection()),r,i)}centerOnInternal(t,r,i){this.setCenterInternal(calculateCenterOn(t,r,i,this.getResolution(),this.getRotation()))}calculateCenterShift(t,r,i,s){let c;const a=this.padding_;if(a&&t){const h=this.getViewportSizeMinusPadding_(-i),p=calculateCenterOn(t,s,[h[0]/2+a[3],h[1]/2+a[0]],r,i);c=[t[0]-p[0],t[1]-p[1]]}return c}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(t){const r=toUserCoordinate(this.targetCenter_,this.getProjection());this.setCenter([r[0]+t[0],r[1]+t[1]])}adjustCenterInternal(t){const r=this.targetCenter_;this.setCenterInternal([r[0]+t[0],r[1]+t[1]])}adjustResolution(t,r){r=r&&fromUserCoordinate(r,this.getProjection()),this.adjustResolutionInternal(t,r)}adjustResolutionInternal(t,r){const i=this.getAnimating()||this.getInteracting(),s=this.getViewportSize_(this.getRotation()),c=this.constraints_.resolution(this.targetResolution_*t,0,s,i);r&&(this.targetCenter_=this.calculateCenterZoom(c,r)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,r){this.adjustResolution(Math.pow(this.zoomFactor_,-t),r)}adjustRotation(t,r){r&&(r=fromUserCoordinate(r,this.getProjection())),this.adjustRotationInternal(t,r)}adjustRotationInternal(t,r){const i=this.getAnimating()||this.getInteracting(),s=this.constraints_.rotation(this.targetRotation_+t,i);r&&(this.targetCenter_=this.calculateCenterRotate(s,r)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t&&fromUserCoordinate(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,r){return this.hints_[t]+=r,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,r){const i=this.getAnimating()||this.getInteracting()||r,s=this.constraints_.rotation(this.targetRotation_,i),c=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,0,c,i),h=this.constraints_.center(this.targetCenter_,a,c,i,this.calculateCenterShift(this.targetCenter_,a,s,c));this.get(ViewProperty.ROTATION)!==s&&this.set(ViewProperty.ROTATION,s),this.get(ViewProperty.RESOLUTION)!==a&&(this.set(ViewProperty.RESOLUTION,a),this.set("zoom",this.getZoom(),!0)),(!h||!this.get(ViewProperty.CENTER)||!equals(this.get(ViewProperty.CENTER),h))&&this.set(ViewProperty.CENTER,h),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,r,i){t=t!==void 0?t:200;const s=r||0,c=this.constraints_.rotation(this.targetRotation_),a=this.getViewportSize_(c),h=this.constraints_.resolution(this.targetResolution_,s,a),p=this.constraints_.center(this.targetCenter_,h,a,!1,this.calculateCenterShift(this.targetCenter_,h,c,a));if(t===0&&!this.cancelAnchor_){this.targetResolution_=h,this.targetRotation_=c,this.targetCenter_=p,this.applyTargetState_();return}i=i||(t===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==h||this.getRotation()!==c||!this.getCenterInternal()||!equals(this.getCenterInternal(),p))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:c,center:p,resolution:h,duration:t,easing:easeOut,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(ViewHint.INTERACTING,1)}endInteraction(t,r,i){i=i&&fromUserCoordinate(i,this.getProjection()),this.endInteractionInternal(t,r,i)}endInteractionInternal(t,r,i){this.getInteracting()&&(this.setHint(ViewHint.INTERACTING,-1),this.resolveConstraints(t,r,i))}getConstrainedCenter(t,r){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,r||this.getResolution(),i)}getConstrainedZoom(t,r){const i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,r))}getConstrainedResolution(t,r){r=r||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,r,i)}}function animationCallback(f,t){setTimeout(function(){f(t)},0)}function createCenterConstraint(f){if(f.extent!==void 0){const r=f.smoothExtentConstraint!==void 0?f.smoothExtentConstraint:!0;return createExtent(f.extent,f.constrainOnlyCenter,r)}const t=createProjection(f.projection,"EPSG:3857");if(f.multiWorld!==!0&&t.isGlobal()){const r=t.getExtent().slice();return r[0]=-1/0,r[2]=1/0,createExtent(r,!1,!1)}return none$1}function createResolutionConstraint(f){let t,r,i,a=f.minZoom!==void 0?f.minZoom:DEFAULT_MIN_ZOOM,h=f.maxZoom!==void 0?f.maxZoom:28;const p=f.zoomFactor!==void 0?f.zoomFactor:2,d=f.multiWorld!==void 0?f.multiWorld:!1,l=f.smoothResolutionConstraint!==void 0?f.smoothResolutionConstraint:!0,n=f.showFullExtent!==void 0?f.showFullExtent:!1,e=createProjection(f.projection,"EPSG:3857"),o=e.getExtent();let u=f.constrainOnlyCenter,g=f.extent;if(!d&&!g&&e.isGlobal()&&(u=!1,g=o),f.resolutions!==void 0){const m=f.resolutions;r=m[a],i=m[h]!==void 0?m[h]:m[m.length-1],f.constrainResolution?t=createSnapToResolutions(m,l,!u&&g,n):t=createMinMaxResolution(r,i,l,!u&&g,n)}else{const y=(o?Math.max(getWidth(o),getHeight(o)):360*METERS_PER_UNIT$1.degrees/e.getMetersPerUnit())/DEFAULT_TILE_SIZE/Math.pow(2,DEFAULT_MIN_ZOOM),b=y/Math.pow(2,28-DEFAULT_MIN_ZOOM);r=f.maxResolution,r!==void 0?a=0:r=y/Math.pow(p,a),i=f.minResolution,i===void 0&&(f.maxZoom!==void 0?f.maxResolution!==void 0?i=r/Math.pow(p,h):i=y/Math.pow(p,h):i=b),h=a+Math.floor(Math.log(r/i)/Math.log(p)),i=r/Math.pow(p,h-a),f.constrainResolution?t=createSnapToPower(p,r,i,l,!u&&g,n):t=createMinMaxResolution(r,i,l,!u&&g,n)}return{constraint:t,maxResolution:r,minResolution:i,minZoom:a,zoomFactor:p}}function createRotationConstraint(f){if(f.enableRotation!==void 0?f.enableRotation:!0){const r=f.constrainRotation;return r===void 0||r===!0?createSnapToZero():r===!1?none:typeof r=="number"?createSnapToN(r):none}return disable}function isNoopAnimation(f){return!(f.sourceCenter&&f.targetCenter&&!equals(f.sourceCenter,f.targetCenter)||f.sourceResolution!==f.targetResolution||f.sourceRotation!==f.targetRotation)}function calculateCenterOn(f,t,r,i,s){const c=Math.cos(-s);let a=Math.sin(-s),h=f[0]*c-f[1]*a,p=f[1]*c+f[0]*a;h+=(t[0]/2-r[0])*i,p+=(r[1]-t[1]/2)*i,a=-a;const d=h*c-p*a,l=p*c+h*a;return[d,l]}class Layer extends BaseLayer{constructor(t){const r=Object.assign({},t);delete r.source,super(r),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(LayerProperty.SOURCE,this.handleSourcePropertyChange_);const i=t.source?t.source:null;this.setSource(i)}getLayersArray(t){return t=t||[],t.push(this),t}getLayerStatesArray(t){return t=t||[],t.push(this.getLayerState()),t}getSource(){return this.get(LayerProperty.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(unlistenByKey(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=listen(t,EventType.CHANGE,this.handleSourceChange_,this),t.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)}isVisible(t){let r;const i=this.getMapInternal();!t&&i&&(t=i.getView()),t instanceof View?r={viewState:t.getState(),extent:t.calculateExtent()}:r=t,!r.layerStatesArray&&i&&(r.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let s;r.layerStatesArray?s=r.layerStatesArray.find(a=>a.layer===this):s=this.getLayerState();const c=this.getExtent();return inView(s,r.viewState)&&(!c||intersects$1(c,r.extent))}getAttributions(t){if(!this.isVisible(t))return[];let r;const i=this.getSource();if(i&&(r=i.getAttributions()),!r)return[];const s=t instanceof View?t.getViewStateAndExtent():t;let c=r(s);return Array.isArray(c)||(c=[c]),c}render(t,r){const i=this.getRenderer();return i.prepareFrame(t)?(this.rendered=!0,i.renderFrame(t,r)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(t,r){}renderDeferred(t){const r=this.getRenderer();r&&r.renderDeferred(t)}setMapInternal(t){t||this.unrender(),this.set(LayerProperty.MAP,t)}getMapInternal(){return this.get(LayerProperty.MAP)}setMap(t){this.mapPrecomposeKey_&&(unlistenByKey(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(unlistenByKey(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=listen(t,RenderEventType.PRECOMPOSE,function(r){const s=r.frameState.layerStatesArray,c=this.getLayerState(!1);assert(!s.some(function(a){return a.layer===c.layer}),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),s.push(c)},this),this.mapRenderKey_=listen(this,EventType.CHANGE,t.render,t),this.changed())}setSource(t){this.set(LayerProperty.SOURCE,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}}function inView(f,t){if(!f.visible)return!1;const r=t.resolution;if(r<f.minResolution||r>=f.maxResolution)return!1;const i=t.zoom;return i>f.minZoom&&i<=f.maxZoom}function quickselect(f,t,r,i,s){quickselectStep(f,t,r||0,i||f.length-1,s||defaultCompare)}function quickselectStep(f,t,r,i,s){for(;i>r;){if(i-r>600){var c=i-r+1,a=t-r+1,h=Math.log(c),p=.5*Math.exp(2*h/3),d=.5*Math.sqrt(h*p*(c-p)/c)*(a-c/2<0?-1:1),l=Math.max(r,Math.floor(t-a*p/c+d)),n=Math.min(i,Math.floor(t+(c-a)*p/c+d));quickselectStep(f,t,l,n,s)}var e=f[t],o=r,u=i;for(swap(f,r,t),s(f[i],e)>0&&swap(f,r,i);o<u;){for(swap(f,o,u),o++,u--;s(f[o],e)<0;)o++;for(;s(f[u],e)>0;)u--}s(f[r],e)===0?swap(f,r,u):(u++,swap(f,u,i)),u<=t&&(r=u+1),t<=u&&(i=u-1)}}function swap(f,t,r){var i=f[t];f[t]=f[r],f[r]=i}function defaultCompare(f,t){return f<t?-1:f>t?1:0}let RBush$1=class{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let r=this.data;const i=[];if(!intersects(t,r))return i;const s=this.toBBox,c=[];for(;r;){for(let a=0;a<r.children.length;a++){const h=r.children[a],p=r.leaf?s(h):h;intersects(t,p)&&(r.leaf?i.push(h):contains(t,p)?this._all(h,i):c.push(h))}r=c.pop()}return i}collides(t){let r=this.data;if(!intersects(t,r))return!1;const i=[];for(;r;){for(let s=0;s<r.children.length;s++){const c=r.children[s],a=r.leaf?this.toBBox(c):c;if(intersects(t,a)){if(r.leaf||contains(t,a))return!0;i.push(c)}}r=i.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let i=0;i<t.length;i++)this.insert(t[i]);return this}let r=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=r;else if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){const i=this.data;this.data=r,r=i}this._insert(r,this.data.height-r.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=createNode([]),this}remove(t,r){if(!t)return this;let i=this.data;const s=this.toBBox(t),c=[],a=[];let h,p,d;for(;i||c.length;){if(i||(i=c.pop(),p=c[c.length-1],h=a.pop(),d=!0),i.leaf){const l=findItem(t,i.children,r);if(l!==-1)return i.children.splice(l,1),c.push(i),this._condense(c),this}!d&&!i.leaf&&contains(i,s)?(c.push(i),a.push(h),h=0,p=i,i=i.children[0]):p?(h++,i=p.children[h],d=!1):i=null}return this}toBBox(t){return t}compareMinX(t,r){return t.minX-r.minX}compareMinY(t,r){return t.minY-r.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,r){const i=[];for(;t;)t.leaf?r.push(...t.children):i.push(...t.children),t=i.pop();return r}_build(t,r,i,s){const c=i-r+1;let a=this._maxEntries,h;if(c<=a)return h=createNode(t.slice(r,i+1)),calcBBox(h,this.toBBox),h;s||(s=Math.ceil(Math.log(c)/Math.log(a)),a=Math.ceil(c/Math.pow(a,s-1))),h=createNode([]),h.leaf=!1,h.height=s;const p=Math.ceil(c/a),d=p*Math.ceil(Math.sqrt(a));multiSelect(t,r,i,d,this.compareMinX);for(let l=r;l<=i;l+=d){const n=Math.min(l+d-1,i);multiSelect(t,l,n,p,this.compareMinY);for(let e=l;e<=n;e+=p){const o=Math.min(e+p-1,n);h.children.push(this._build(t,e,o,s-1))}}return calcBBox(h,this.toBBox),h}_chooseSubtree(t,r,i,s){for(;s.push(r),!(r.leaf||s.length-1===i);){let c=1/0,a=1/0,h;for(let p=0;p<r.children.length;p++){const d=r.children[p],l=bboxArea(d),n=enlargedArea(t,d)-l;n<a?(a=n,c=l<c?l:c,h=d):n===a&&l<c&&(c=l,h=d)}r=h||r.children[0]}return r}_insert(t,r,i){const s=i?t:this.toBBox(t),c=[],a=this._chooseSubtree(s,this.data,r,c);for(a.children.push(t),extend(a,s);r>=0&&c[r].children.length>this._maxEntries;)this._split(c,r),r--;this._adjustParentBBoxes(s,c,r)}_split(t,r){const i=t[r],s=i.children.length,c=this._minEntries;this._chooseSplitAxis(i,c,s);const a=this._chooseSplitIndex(i,c,s),h=createNode(i.children.splice(a,i.children.length-a));h.height=i.height,h.leaf=i.leaf,calcBBox(i,this.toBBox),calcBBox(h,this.toBBox),r?t[r-1].children.push(h):this._splitRoot(i,h)}_splitRoot(t,r){this.data=createNode([t,r]),this.data.height=t.height+1,this.data.leaf=!1,calcBBox(this.data,this.toBBox)}_chooseSplitIndex(t,r,i){let s,c=1/0,a=1/0;for(let h=r;h<=i-r;h++){const p=distBBox(t,0,h,this.toBBox),d=distBBox(t,h,i,this.toBBox),l=intersectionArea(p,d),n=bboxArea(p)+bboxArea(d);l<c?(c=l,s=h,a=n<a?n:a):l===c&&n<a&&(a=n,s=h)}return s||i-r}_chooseSplitAxis(t,r,i){const s=t.leaf?this.compareMinX:compareNodeMinX,c=t.leaf?this.compareMinY:compareNodeMinY,a=this._allDistMargin(t,r,i,s),h=this._allDistMargin(t,r,i,c);a<h&&t.children.sort(s)}_allDistMargin(t,r,i,s){t.children.sort(s);const c=this.toBBox,a=distBBox(t,0,r,c),h=distBBox(t,i-r,i,c);let p=bboxMargin(a)+bboxMargin(h);for(let d=r;d<i-r;d++){const l=t.children[d];extend(a,t.leaf?c(l):l),p+=bboxMargin(a)}for(let d=i-r-1;d>=r;d--){const l=t.children[d];extend(h,t.leaf?c(l):l),p+=bboxMargin(h)}return p}_adjustParentBBoxes(t,r,i){for(let s=i;s>=0;s--)extend(r[s],t)}_condense(t){for(let r=t.length-1,i;r>=0;r--)t[r].children.length===0?r>0?(i=t[r-1].children,i.splice(i.indexOf(t[r]),1)):this.clear():calcBBox(t[r],this.toBBox)}};function findItem(f,t,r){if(!r)return t.indexOf(f);for(let i=0;i<t.length;i++)if(r(f,t[i]))return i;return-1}function calcBBox(f,t){distBBox(f,0,f.children.length,t,f)}function distBBox(f,t,r,i,s){s||(s=createNode(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let c=t;c<r;c++){const a=f.children[c];extend(s,f.leaf?i(a):a)}return s}function extend(f,t){return f.minX=Math.min(f.minX,t.minX),f.minY=Math.min(f.minY,t.minY),f.maxX=Math.max(f.maxX,t.maxX),f.maxY=Math.max(f.maxY,t.maxY),f}function compareNodeMinX(f,t){return f.minX-t.minX}function compareNodeMinY(f,t){return f.minY-t.minY}function bboxArea(f){return(f.maxX-f.minX)*(f.maxY-f.minY)}function bboxMargin(f){return f.maxX-f.minX+(f.maxY-f.minY)}function enlargedArea(f,t){return(Math.max(t.maxX,f.maxX)-Math.min(t.minX,f.minX))*(Math.max(t.maxY,f.maxY)-Math.min(t.minY,f.minY))}function intersectionArea(f,t){const r=Math.max(f.minX,t.minX),i=Math.max(f.minY,t.minY),s=Math.min(f.maxX,t.maxX),c=Math.min(f.maxY,t.maxY);return Math.max(0,s-r)*Math.max(0,c-i)}function contains(f,t){return f.minX<=t.minX&&f.minY<=t.minY&&t.maxX<=f.maxX&&t.maxY<=f.maxY}function intersects(f,t){return t.minX<=f.maxX&&t.minY<=f.maxY&&t.maxX>=f.minX&&t.maxY>=f.minY}function createNode(f){return{children:f,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function multiSelect(f,t,r,i,s){const c=[t,r];for(;c.length;){if(r=c.pop(),t=c.pop(),r-t<=i)continue;const a=t+Math.ceil((r-t)/i/2)*i;quickselect(f,a,t,r,s),c.push(t,a,a,r)}}const ImageState={IDLE:0,LOADING:1,LOADED:2,ERROR:3};function toSize(f,t){return Array.isArray(f)?f:(t===void 0?t=[f,f]:(t[0]=f,t[1]=f),t)}class ImageStyle{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=toSize(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new ImageStyle({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return abstract()}getImage(t){return abstract()}getHitDetectionImage(){return abstract()}getPixelRatio(t){return 1}getImageState(){return abstract()}getImageSize(){return abstract()}getOrigin(){return abstract()}getSize(){return abstract()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=toSize(t)}listenImageChange(t){abstract()}load(){abstract()}unlistenImageChange(t){abstract()}ready(){return Promise.resolve()}}const rgb={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]},xyz={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"],whitepoint:{2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}}};xyz.max=xyz.whitepoint[2].D65;xyz.rgb=function(f,t){t=t||xyz.whitepoint[2].E;var r=f[0]/t[0],i=f[1]/t[1],s=f[2]/t[2],c,a,h;return c=r*3.240969941904521+i*-1.537383177570093+s*-.498610760293,a=r*-.96924363628087+i*1.87596750150772+s*.041555057407175,h=r*.055630079696993+i*-.20397695888897+s*1.056971514242878,c=c>.0031308?1.055*Math.pow(c,1/2.4)-.055:c=c*12.92,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a=a*12.92,h=h>.0031308?1.055*Math.pow(h,1/2.4)-.055:h=h*12.92,c=Math.min(Math.max(0,c),1),a=Math.min(Math.max(0,a),1),h=Math.min(Math.max(0,h),1),[c*255,a*255,h*255]};rgb.xyz=function(f,t){var r=f[0]/255,i=f[1]/255,s=f[2]/255;r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92,i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92,s=s>.04045?Math.pow((s+.055)/1.055,2.4):s/12.92;var c=r*.41239079926595+i*.35758433938387+s*.18048078840183,a=r*.21263900587151+i*.71516867876775+s*.072192315360733,h=r*.019330818715591+i*.11919477979462+s*.95053215224966;return t=t||xyz.whitepoint[2].E,[c*t[0],a*t[1],h*t[2]]};var luv={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(f,t,r){var i,s,c,a,h,p,d,l,n,e,o,u,g;if(c=f[0],a=f[1],h=f[2],c===0)return[0,0,0];var m=.0011070564598794539;return t=t||"D65",r=r||2,n=xyz.whitepoint[r][t][0],e=xyz.whitepoint[r][t][1],o=xyz.whitepoint[r][t][2],u=4*n/(n+15*e+3*o),g=9*e/(n+15*e+3*o),i=a/(13*c)+u||0,s=h/(13*c)+g||0,d=c>8?e*Math.pow((c+16)/116,3):e*c*m,p=d*9*i/(4*s)||0,l=d*(12-3*i-20*s)/(4*s)||0,[p,d,l]}};xyz.luv=function(f,t,r){var i,s,c,a,h,p,d,l,n,e,o,u,g,m=.008856451679035631,y=903.2962962962961;t=t||"D65",r=r||2,n=xyz.whitepoint[r][t][0],e=xyz.whitepoint[r][t][1],o=xyz.whitepoint[r][t][2],u=4*n/(n+15*e+3*o),g=9*e/(n+15*e+3*o),p=f[0],d=f[1],l=f[2],i=4*p/(p+15*d+3*l)||0,s=9*d/(p+15*d+3*l)||0;var b=d/e;return c=b<=m?y*b:116*Math.pow(b,1/3)-16,a=13*c*(i-u),h=13*c*(s-g),[c,a,h]};var lchuv={name:"lchuv",channel:["lightness","chroma","hue"],alias:["LCHuv","cielchuv"],min:[0,0,0],max:[100,100,360],luv:function(f){var t=f[0],r=f[1],i=f[2],s,c,a;return a=i/360*2*Math.PI,s=r*Math.cos(a),c=r*Math.sin(a),[t,s,c]},xyz:function(f){return luv.xyz(lchuv.luv(f))}};luv.lchuv=function(f){var t=f[0],r=f[1],i=f[2],s=Math.sqrt(r*r+i*i),c=Math.atan2(i,r),a=c*360/2/Math.PI;return a<0&&(a+=360),[t,s,a]};xyz.lchuv=function(f){return luv.lchuv(xyz.luv(f))};const names={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};var baseHues={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function parse$1(f){var l,n;var t,r=[],i=1,s;if(typeof f=="number")return{space:"rgb",values:[f>>>16,(f&65280)>>>8,f&255],alpha:1};if(typeof f=="number")return{space:"rgb",values:[f>>>16,(f&65280)>>>8,f&255],alpha:1};if(f=String(f).toLowerCase(),names[f])r=names[f].slice(),s="rgb";else if(f==="transparent")i=0,s="rgb",r=[0,0,0];else if(f[0]==="#"){var c=f.slice(1),a=c.length,h=a<=4;i=1,h?(r=[parseInt(c[0]+c[0],16),parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16)],a===4&&(i=parseInt(c[3]+c[3],16)/255)):(r=[parseInt(c[0]+c[1],16),parseInt(c[2]+c[3],16),parseInt(c[4]+c[5],16)],a===8&&(i=parseInt(c[6]+c[7],16)/255)),r[0]||(r[0]=0),r[1]||(r[1]=0),r[2]||(r[2]=0),s="rgb"}else if(t=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(f)){var p=t[1];s=p.replace(/a$/,"");var d=s==="cmyk"?4:s==="gray"?1:3;r=t[2].trim().split(/\s*[,\/]\s*|\s+/),s==="color"&&(s=r.shift()),r=r.map(function(e,o){if(e[e.length-1]==="%")return e=parseFloat(e)/100,o===3?e:s==="rgb"?e*255:s[0]==="h"||s[0]==="l"&&!o?e*100:s==="lab"?e*125:s==="lch"?o<2?e*150:e*360:s[0]==="o"&&!o?e:s==="oklab"?e*.4:s==="oklch"?o<2?e*.4:e*360:e;if(s[o]==="h"||o===2&&s[s.length-1]==="h"){if(baseHues[e]!==void 0)return baseHues[e];if(e.endsWith("deg"))return parseFloat(e);if(e.endsWith("turn"))return parseFloat(e)*360;if(e.endsWith("grad"))return parseFloat(e)*360/400;if(e.endsWith("rad"))return parseFloat(e)*180/Math.PI}return e==="none"?0:parseFloat(e)}),i=r.length>d?r.pop():1}else/[0-9](?:\s|\/|,)/.test(f)&&(r=f.match(/([0-9]+)/g).map(function(e){return parseFloat(e)}),s=((n=(l=f.match(/([a-z])/ig))==null?void 0:l.join(""))==null?void 0:n.toLowerCase())||"rgb");return{space:s,values:r,alpha:i}}var hsl={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(f){var t=f[0]/360,r=f[1]/100,i=f[2]/100,s,c,a,h,p,d=0;if(r===0)return p=i*255,[p,p,p];for(c=i<.5?i*(1+r):i+r-i*r,s=2*i-c,h=[0,0,0];d<3;)a=t+1/3*-(d-1),a<0?a++:a>1&&a--,p=6*a<1?s+(c-s)*6*a:2*a<1?c:3*a<2?s+(c-s)*(2/3-a)*6:s,h[d++]=p*255;return h}};rgb.hsl=function(f){var t=f[0]/255,r=f[1]/255,i=f[2]/255,s=Math.min(t,r,i),c=Math.max(t,r,i),a=c-s,h,p,d;return c===s?h=0:t===c?h=(r-i)/a:r===c?h=2+(i-t)/a:i===c&&(h=4+(t-r)/a),h=Math.min(h*60,360),h<0&&(h+=360),d=(s+c)/2,c===s?p=0:d<=.5?p=a/(c+s):p=a/(2-c-s),[h,p*100,d*100]};function rgba(f){Array.isArray(f)&&f.raw&&(f=String.raw(...arguments)),f instanceof Number&&(f=+f);var t,r=parse$1(f);if(!r.space)return[];const i=r.space[0]==="h"?hsl.min:rgb.min,s=r.space[0]==="h"?hsl.max:rgb.max;return t=Array(3),t[0]=Math.min(Math.max(r.values[0],i[0]),s[0]),t[1]=Math.min(Math.max(r.values[1],i[1]),s[1]),t[2]=Math.min(Math.max(r.values[2],i[2]),s[2]),r.space[0]==="h"&&(t=hsl.rgb(t)),t.push(Math.min(Math.max(r.alpha,0),1)),t}function asString(f){return typeof f=="string"?f:toString(f)}const MAX_CACHE_SIZE=1024,cache={};let cacheSize=0;function withAlpha(f){if(f.length===4)return f;const t=f.slice();return t[3]=1,t}function rgbaToLcha(f){const t=xyz.lchuv(rgb.xyz(f));return t[3]=f[3],t}function lchaToRgba(f){const t=xyz.rgb(lchuv.xyz(f));return t[3]=f[3],t}function fromString(f){if(cache.hasOwnProperty(f))return cache[f];if(cacheSize>=MAX_CACHE_SIZE){let r=0;for(const i in cache)(r++&3)===0&&(delete cache[i],--cacheSize)}const t=rgba(f);if(t.length!==4)throw new Error('Failed to parse "'+f+'" as color');for(const r of t)if(isNaN(r))throw new Error('Failed to parse "'+f+'" as color');return normalize(t),cache[f]=t,++cacheSize,t}function asArray(f){return Array.isArray(f)?f:fromString(f)}function normalize(f){return f[0]=clamp(f[0]+.5|0,0,255),f[1]=clamp(f[1]+.5|0,0,255),f[2]=clamp(f[2]+.5|0,0,255),f[3]=clamp(f[3],0,1),f}function toString(f){let t=f[0];t!=(t|0)&&(t=t+.5|0);let r=f[1];r!=(r|0)&&(r=r+.5|0);let i=f[2];i!=(i|0)&&(i=i+.5|0);const s=f[3]===void 0?1:Math.round(f[3]*1e3)/1e3;return"rgba("+t+","+r+","+i+","+s+")"}function isStringColor(f){try{return fromString(f),!0}catch{return!1}}const ua=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"";ua.includes("firefox");const SAFARI=ua.includes("safari")&&!ua.includes("chrom");SAFARI&&(ua.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(ua));ua.includes("webkit")&&ua.includes("edge");ua.includes("macintosh");const WORKER_OFFSCREEN_CANVAS=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,IMAGE_DECODE=typeof Image<"u"&&Image.prototype.decode;(function(){let f=!1;try{const t=Object.defineProperty({},"passive",{get:function(){f=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return f})();function createCanvasContext2D(f,t,r,i){let s;return r&&r.length?s=r.shift():WORKER_OFFSCREEN_CANVAS?s=new OffscreenCanvas(f||300,t||300):s=document.createElement("canvas"),f&&(s.width=f),t&&(s.height=t),s.getContext("2d",i)}let sharedCanvasContext;function getSharedCanvasContext2D(){return sharedCanvasContext||(sharedCanvasContext=createCanvasContext2D(1,1)),sharedCanvasContext}function releaseCanvas(f){const t=f.canvas;t.width=1,t.height=1,f.clearRect(0,0,1,1)}function load(f,t){return new Promise((r,i)=>{function s(){a(),r(f)}function c(){a(),i(new Error("Image load error"))}function a(){f.removeEventListener("load",s),f.removeEventListener("error",c)}f.addEventListener("load",s),f.addEventListener("error",c)})}function decodeFallback(f,t){return t&&(f.src=t),f.src&&IMAGE_DECODE?new Promise((r,i)=>f.decode().then(()=>r(f)).catch(s=>f.complete&&f.width?r(f):i(s))):load(f)}class IconImageCache{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const r in this.cache_){const i=this.cache_[r];(t++&3)===0&&!i.hasListener()&&(delete this.cache_[r],delete this.patternCache_[r],--this.cacheSize_)}}}get(t,r,i){const s=getCacheKey(t,r,i);return s in this.cache_?this.cache_[s]:null}getPattern(t,r,i){const s=getCacheKey(t,r,i);return s in this.patternCache_?this.patternCache_[s]:null}set(t,r,i,s,c){const a=getCacheKey(t,r,i),h=a in this.cache_;this.cache_[a]=s,c&&(s.getImageState()===ImageState.IDLE&&s.load(),s.getImageState()===ImageState.LOADING?s.ready().then(()=>{this.patternCache_[a]=getSharedCanvasContext2D().createPattern(s.getImage(1),"repeat")}):this.patternCache_[a]=getSharedCanvasContext2D().createPattern(s.getImage(1),"repeat")),h||++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}}function getCacheKey(f,t,r){const i=r?asArray(r):"null";return t+":"+f+":"+i}const shared=new IconImageCache;let taintedTestContext=null;class IconImage extends Target{constructor(t,r,i,s,c){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=i,this.canvas_={},this.color_=c,this.imageState_=s===void 0?ImageState.IDLE:s,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=r,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===ImageState.LOADED){taintedTestContext||(taintedTestContext=createCanvasContext2D(1,1,void 0,{willReadFrequently:!0})),taintedTestContext.drawImage(this.image_,0,0);try{taintedTestContext.getImageData(0,0,1,1),this.tainted_=!1}catch{taintedTestContext=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(EventType.CHANGE)}handleImageError_(){this.imageState_=ImageState.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=ImageState.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],r=this.size_[1],i=createCanvasContext2D(t,r);i.fillRect(0,0,t,r),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===ImageState.IDLE){this.image_||this.initializeImage_(),this.imageState_=ImageState.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&decodeFallback(this.image_,this.src_).then(t=>{this.image_=t,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==ImageState.LOADED)return;const r=this.image_,i=document.createElement("canvas");i.width=Math.ceil(r.width*t),i.height=Math.ceil(r.height*t);const s=i.getContext("2d");s.scale(t,t),s.drawImage(r,0,0),s.globalCompositeOperation="multiply",s.fillStyle=asString(this.color_),s.fillRect(0,0,i.width/t,i.height/t),s.globalCompositeOperation="destination-in",s.drawImage(r,0,0),this.canvas_[t]=i}ready(){return this.ready_||(this.ready_=new Promise(t=>{this.imageState_===ImageState.LOADED||this.imageState_===ImageState.ERROR?t():this.addEventListener(EventType.CHANGE,function r(){(this.imageState_===ImageState.LOADED||this.imageState_===ImageState.ERROR)&&(this.removeEventListener(EventType.CHANGE,r),t())})})),this.ready_}}function get(f,t,r,i,s,c){let a=t===void 0?void 0:shared.get(t,r,s);return a||(a=new IconImage(f,f&&"src"in f?f.src||void 0:t,r,i,s),shared.set(t,r,s,a,c)),c&&a&&!shared.getPattern(t,r,s)&&shared.set(t,r,s,a,c),a}function asColorLike(f){return f?Array.isArray(f)?toString(f):typeof f=="object"&&"src"in f?asCanvasPattern(f):f:null}function asCanvasPattern(f){if(!f.offset||!f.size)return shared.getPattern(f.src,"anonymous",f.color);const t=f.src+":"+f.offset,r=shared.getPattern(t,void 0,f.color);if(r)return r;const i=shared.get(f.src,"anonymous",null);if(i.getImageState()!==ImageState.LOADED)return null;const s=createCanvasContext2D(f.size[0],f.size[1]);return s.drawImage(i.getImage(1),f.offset[0],f.offset[1],f.size[0],f.size[1],0,0,f.size[0],f.size[1]),get(s.canvas,t,void 0,ImageState.LOADED,f.color,!0),shared.getPattern(t,void 0,f.color)}const fontRegEx=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z]+?)\\s*$`].join(""),"i"),fontRegExMatchIndex=["style","variant","weight","size","lineHeight","family"],getFontParameters=function(f){const t=f.match(fontRegEx);if(!t)return null;const r={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let i=0,s=fontRegExMatchIndex.length;i<s;++i){const c=t[i+1];c!==void 0&&(r[fontRegExMatchIndex[i]]=c)}return r.families=r.family.split(/,\s?/),r},defaultFont="10px sans-serif",defaultFillStyle="#000",defaultLineCap="round",defaultLineDash=[],defaultLineDashOffset=0,defaultLineJoin="round",defaultMiterLimit=10,defaultStrokeStyle="#000",defaultTextAlign="center",defaultTextBaseline="middle",defaultPadding=[0,0,0,0],defaultLineWidth=1,checkedFonts=new BaseObject;let measureContext=null,measureFont;const textHeights={},registerFont=function(){const t="32px ",r=["monospace","serif"],i=r.length,s="wmytzilWMYTZIL@#/&?$%10";let c,a;function h(d,l,n){let e=!0;for(let o=0;o<i;++o){const u=r[o];if(a=measureTextWidth(d+" "+l+" "+t+u,s),n!=u){const g=measureTextWidth(d+" "+l+" "+t+n+","+u,s);e=e&&g!=a}}return!!e}function p(){let d=!0;const l=checkedFonts.getKeys();for(let n=0,e=l.length;n<e;++n){const o=l[n];checkedFonts.get(o)<100&&(h.apply(this,o.split(`
`))?(clear(textHeights),measureContext=null,measureFont=void 0,checkedFonts.set(o,100)):(checkedFonts.set(o,checkedFonts.get(o)+1,!0),d=!1))}d&&(clearInterval(c),c=void 0)}return function(d){const l=getFontParameters(d);if(!l)return;const n=l.families;for(let e=0,o=n.length;e<o;++e){const u=n[e],g=l.style+`
`+l.weight+`
`+u;checkedFonts.get(g)===void 0&&(checkedFonts.set(g,100,!0),h(l.style,l.weight,u)||(checkedFonts.set(g,0,!0),c===void 0&&(c=setInterval(p,32))))}}}(),measureTextHeight=function(){let f;return function(t){let r=textHeights[t];if(r==null){if(WORKER_OFFSCREEN_CANVAS){const i=getFontParameters(t),s=measureText(t,"Žg");r=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(s.actualBoundingBoxAscent+s.actualBoundingBoxDescent)}else f||(f=document.createElement("div"),f.innerHTML="M",f.style.minHeight="0",f.style.maxHeight="none",f.style.height="auto",f.style.padding="0",f.style.border="none",f.style.position="absolute",f.style.display="block",f.style.left="-99999px"),f.style.font=t,document.body.appendChild(f),r=f.offsetHeight,document.body.removeChild(f);textHeights[t]=r}return r}}();function measureText(f,t){return measureContext||(measureContext=createCanvasContext2D(1,1)),f!=measureFont&&(measureContext.font=f,measureFont=measureContext.font),measureContext.measureText(t)}function measureTextWidth(f,t){return measureText(f,t).width}function measureAndCacheTextWidth(f,t,r){if(t in r)return r[t];const i=t.split(`
`).reduce((s,c)=>Math.max(s,measureTextWidth(f,c)),0);return r[t]=i,i}function getTextDimensions(f,t){const r=[],i=[],s=[];let c=0,a=0,h=0,p=0;for(let d=0,l=t.length;d<=l;d+=2){const n=t[d];if(n===`
`||d===l){c=Math.max(c,a),s.push(a),a=0,h+=p,p=0;continue}const e=t[d+1]||f.font,o=measureTextWidth(e,n);r.push(o),a+=o;const u=measureTextHeight(e);i.push(u),p=Math.max(p,u)}return{width:c,height:h,widths:r,heights:i,lineWidths:s}}function drawImageOrLabel(f,t,r,i,s,c,a,h,p,d,l){f.save(),r!==1&&(f.globalAlpha===void 0?f.globalAlpha=n=>n.globalAlpha*=r:f.globalAlpha*=r),t&&f.transform.apply(f,t),i.contextInstructions?(f.translate(p,d),f.scale(l[0],l[1]),executeLabelInstructions(i,f)):l[0]<0||l[1]<0?(f.translate(p,d),f.scale(l[0],l[1]),f.drawImage(i,s,c,a,h,0,0,a,h)):f.drawImage(i,s,c,a,h,p,d,a*l[0],h*l[1]),f.restore()}function executeLabelInstructions(f,t){const r=f.contextInstructions;for(let i=0,s=r.length;i<s;i+=2)Array.isArray(r[i+1])?t[r[i]].apply(t,r[i+1]):t[r[i]]=r[i+1]}class RegularShape extends ImageStyle{constructor(t){super({opacity:1,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode}),this.canvases_,this.hitDetectionCanvas_=null,this.fill_=t.fill!==void 0?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius_=t.radius,this.radius2_=t.radius2,this.angle_=t.angle!==void 0?t.angle:0,this.stroke_=t.stroke!==void 0?t.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?ImageState.LOADING:ImageState.LOADED,this.imageState_===ImageState.LOADING&&this.ready().then(()=>this.imageState_=ImageState.LOADED),this.render()}clone(){const t=this.getScale(),r=new RegularShape({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return r.setOpacity(this.getOpacity()),r}getAnchor(){const t=this.size_,r=this.getDisplacement(),i=this.getScaleArray();return[t[0]/2-r[0]/i[0],t[1]/2+r[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){let r=this.canvases_[t];if(!r){const i=this.renderOptions_,s=createCanvasContext2D(i.size*t,i.size*t);this.draw_(i,s,t),r=s.canvas,this.canvases_[t]=r}return r}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius_}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,r,i){if(r===0||this.points_===1/0||t!=="bevel"&&t!=="miter")return r;let s=this.radius_,c=this.radius2_===void 0?s:this.radius2_;if(s<c){const T=s;s=c,c=T}const a=this.radius2_===void 0?this.points_:this.points_*2,h=2*Math.PI/a,p=c*Math.sin(h),d=Math.sqrt(c*c-p*p),l=s-d,n=Math.sqrt(p*p+l*l),e=n/p;if(t==="miter"&&e<=i)return e*r;const o=r/2/e,u=r/2*(l/n),m=Math.sqrt((s+o)*(s+o)+u*u)-s;if(this.radius2_===void 0||t==="bevel")return m*2;const y=s*Math.sin(h),b=Math.sqrt(s*s-y*y),_=c-b,w=Math.sqrt(y*y+_*_)/y;if(w<=i){const T=w*r/2-c-s;return 2*Math.max(m,T)}return m*2}createRenderOptions(){let t=defaultLineCap,r=defaultLineJoin,i=0,s=null,c=0,a,h=0;this.stroke_&&(a=asColorLike(this.stroke_.getColor()??defaultStrokeStyle),h=this.stroke_.getWidth()??defaultLineWidth,s=this.stroke_.getLineDash(),c=this.stroke_.getLineDashOffset()??0,r=this.stroke_.getLineJoin()??defaultLineJoin,t=this.stroke_.getLineCap()??defaultLineCap,i=this.stroke_.getMiterLimit()??defaultMiterLimit);const p=this.calculateLineJoinSize_(r,h,i),d=Math.max(this.radius_,this.radius2_||0),l=Math.ceil(2*d+p);return{strokeStyle:a,strokeWidth:h,size:l,lineCap:t,lineDash:s,lineDashOffset:c,lineJoin:r,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.canvases_={},this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,r,i){if(r.scale(i,i),r.translate(t.size/2,t.size/2),this.createPath_(r),this.fill_){let s=this.fill_.getColor();s===null&&(s=defaultFillStyle),r.fillStyle=asColorLike(s),r.fill()}t.strokeStyle&&(r.strokeStyle=t.strokeStyle,r.lineWidth=t.strokeWidth,t.lineDash&&(r.setLineDash(t.lineDash),r.lineDashOffset=t.lineDashOffset),r.lineCap=t.lineCap,r.lineJoin=t.lineJoin,r.miterLimit=t.miterLimit,r.stroke())}createHitDetectionCanvas_(t){let r;if(this.fill_){let i=this.fill_.getColor(),s=0;typeof i=="string"&&(i=asArray(i)),i===null?s=1:Array.isArray(i)&&(s=i.length===4?i[3]:1),s===0&&(r=createCanvasContext2D(t.size,t.size),this.drawHitDetectionCanvas_(t,r))}return r?r.canvas:this.getImage(1)}createPath_(t){let r=this.points_;const i=this.radius_;if(r===1/0)t.arc(0,0,i,0,2*Math.PI);else{const s=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(r*=2);const c=this.angle_-Math.PI/2,a=2*Math.PI/r;for(let h=0;h<r;h++){const p=c+h*a,d=h%2===0?i:s;t.lineTo(d*Math.cos(p),d*Math.sin(p))}t.closePath()}}drawHitDetectionCanvas_(t,r){r.translate(t.size/2,t.size/2),this.createPath_(r),r.fillStyle=defaultFillStyle,r.fill(),t.strokeStyle&&(r.strokeStyle=t.strokeStyle,r.lineWidth=t.strokeWidth,t.lineDash&&(r.setLineDash(t.lineDash),r.lineDashOffset=t.lineDashOffset),r.lineJoin=t.lineJoin,r.miterLimit=t.miterLimit,r.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class CircleStyle extends RegularShape{constructor(t){t=t||{radius:5},super({points:1/0,fill:t.fill,radius:t.radius,stroke:t.stroke,scale:t.scale!==void 0?t.scale:1,rotation:t.rotation!==void 0?t.rotation:0,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),r=new CircleStyle({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return r.setOpacity(this.getOpacity()),r}setRadius(t){this.radius_=t,this.render()}}class Fill{constructor(t){t=t||{},this.patternImage_=null,this.color_=null,t.color!==void 0&&this.setColor(t.color)}clone(){const t=this.getColor();return new Fill({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){if(t!==null&&typeof t=="object"&&"src"in t){const r=get(null,t.src,"anonymous",void 0,t.offset?null:t.color?t.color:null,!(t.offset&&t.size));r.ready().then(()=>{this.patternImage_=null}),r.getImageState()===ImageState.IDLE&&r.load(),r.getImageState()===ImageState.LOADING&&(this.patternImage_=r)}this.color_=t}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class Stroke{constructor(t){t=t||{},this.color_=t.color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new Stroke({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}class Style{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=defaultGeometryFunction,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&typeof t=="object"&&(t=t.clone()),new Style({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){typeof t=="function"?this.geometryFunction_=t:typeof t=="string"?this.geometryFunction_=function(r){return r.get(t)}:t?t!==void 0&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=defaultGeometryFunction,this.geometry_=t}setZIndex(t){this.zIndex_=t}}function toFunction(f){let t;if(typeof f=="function")t=f;else{let r;Array.isArray(f)?r=f:(assert(typeof f.getZIndex=="function","Expected an `Style` or an array of `Style`"),r=[f]),t=function(){return r}}return t}let defaultStyles=null;function createDefaultStyle(f,t){if(!defaultStyles){const r=new Fill({color:"rgba(255,255,255,0.4)"}),i=new Stroke({color:"#3399CC",width:1.25});defaultStyles=[new Style({image:new CircleStyle({fill:r,stroke:i,radius:5}),fill:r,stroke:i})]}return defaultStyles}function defaultGeometryFunction(f){return f.getGeometry()}function calculateScale(f,t,r,i){return r!==void 0&&i!==void 0?[r/f,i/t]:r!==void 0?r/f:i!==void 0?i/t:1}class Icon extends ImageStyle{constructor(t){t=t||{};const r=t.opacity!==void 0?t.opacity:1,i=t.rotation!==void 0?t.rotation:0,s=t.scale!==void 0?t.scale:1,c=t.rotateWithView!==void 0?t.rotateWithView:!1;super({opacity:r,rotation:i,scale:s,displacement:t.displacement!==void 0?t.displacement:[0,0],rotateWithView:c,declutterMode:t.declutterMode}),this.anchor_=t.anchor!==void 0?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=t.anchorOrigin!==void 0?t.anchorOrigin:"top-left",this.anchorXUnits_=t.anchorXUnits!==void 0?t.anchorXUnits:"fraction",this.anchorYUnits_=t.anchorYUnits!==void 0?t.anchorYUnits:"fraction",this.crossOrigin_=t.crossOrigin!==void 0?t.crossOrigin:null;const a=t.img!==void 0?t.img:null;let h=t.src;assert(!(h!==void 0&&a),"`image` and `src` cannot be provided at the same time"),(h===void 0||h.length===0)&&a&&(h=a.src||getUid(a)),assert(h!==void 0&&h.length>0,"A defined and non-empty `src` or `image` must be provided"),assert(!((t.width!==void 0||t.height!==void 0)&&t.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let p;if(t.src!==void 0?p=ImageState.IDLE:a!==void 0&&("complete"in a?a.complete?p=a.src?ImageState.LOADED:ImageState.IDLE:p=ImageState.LOADING:p=ImageState.LOADED),this.color_=t.color!==void 0?asArray(t.color):null,this.iconImage_=get(a,h,this.crossOrigin_,p,this.color_),this.offset_=t.offset!==void 0?t.offset:[0,0],this.offsetOrigin_=t.offsetOrigin!==void 0?t.offsetOrigin:"top-left",this.origin_=null,this.size_=t.size!==void 0?t.size:null,t.width!==void 0||t.height!==void 0){let d,l;if(t.size)[d,l]=t.size;else{const n=this.getImage(1);if(n.width&&n.height)d=n.width,l=n.height;else if(n instanceof HTMLImageElement){this.initialOptions_=t;const e=()=>{if(this.unlistenImageChange(e),!this.initialOptions_)return;const o=this.iconImage_.getSize();this.setScale(calculateScale(o[0],o[1],t.width,t.height))};this.listenImageChange(e);return}}d!==void 0&&this.setScale(calculateScale(d,l,t.width,t.height))}}clone(){let t,r,i;return this.initialOptions_?(r=this.initialOptions_.width,i=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new Icon({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:r,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const s=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!s)return null;t=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(t[0]*=s[0]),this.anchorYUnits_=="fraction"&&(t[1]*=s[1])}if(this.anchorOrigin_!="top-left"){if(!s)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(t[0]=-t[0]+s[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(t[1]=-t[1]+s[1])}this.normalizedAnchor_=t}const r=this.getDisplacement(),i=this.getScaleArray();return[t[0]-r[0]/i[0],t[1]+r[1]/i[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if(this.offsetOrigin_!="top-left"){const r=this.getSize(),i=this.iconImage_.getSize();if(!r||!i)return null;t=t.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(t[0]=i[0]-r[0]-t[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(t[1]=i[1]-r[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();if(this.size_)return this.size_[0]*t[0];if(this.iconImage_.getImageState()==ImageState.LOADED)return this.iconImage_.getSize()[0]*t[0]}getHeight(){const t=this.getScaleArray();if(this.size_)return this.size_[1]*t[1];if(this.iconImage_.getImageState()==ImageState.LOADED)return this.iconImage_.getSize()[1]*t[1]}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(EventType.CHANGE,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(EventType.CHANGE,t)}ready(){return this.iconImage_.ready()}}const DEFAULT_FILL_COLOR="#333";class Text{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=toSize(t.scale!==void 0?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=t.fill!==void 0?t.fill:new Fill({color:DEFAULT_FILL_COLOR}),this.maxAngle_=t.maxAngle!==void 0?t.maxAngle:Math.PI/4,this.placement_=t.placement!==void 0?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=t.stroke!==void 0?t.stroke:null,this.offsetX_=t.offsetX!==void 0?t.offsetX:0,this.offsetY_=t.offsetY!==void 0?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=t.padding===void 0?null:t.padding,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new Text({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=toSize(t!==void 0?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}let numTypes=0;const NoneType=0,BooleanType=1<<numTypes++,NumberType=1<<numTypes++,StringType=1<<numTypes++,ColorType=1<<numTypes++,NumberArrayType=1<<numTypes++,SizeType=1<<numTypes++,AnyType=Math.pow(2,numTypes)-1,typeNames={[BooleanType]:"boolean",[NumberType]:"number",[StringType]:"string",[ColorType]:"color",[NumberArrayType]:"number[]",[SizeType]:"size"},namedTypes=Object.keys(typeNames).map(Number).sort(ascending);function typeName(f){const t=[];for(const r of namedTypes)includesType(f,r)&&t.push(typeNames[r]);return t.length===0?"untyped":t.length<3?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t[t.length-1]}function includesType(f,t){return(f&t)===t}function overlapsType(f,t){return!!(f&t)}function isType(f,t){return f===t}class LiteralExpression{constructor(t,r){this.type=t,this.value=r}}class CallExpression{constructor(t,r,...i){this.type=t,this.operator=r,this.args=i}}function newParsingContext(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,style:{}}}function getTypeFromHint(f){switch(f){case"string":return StringType;case"color":return ColorType;case"number":return NumberType;case"boolean":return BooleanType;case"number[]":return NumberArrayType;default:throw new Error(`Unrecognized type hint: ${f}`)}}function parse(f,t,r){switch(typeof f){case"boolean":return new LiteralExpression(BooleanType,f);case"number":return new LiteralExpression(r===SizeType?SizeType:NumberType,f);case"string":{let s=StringType;return isStringColor(f)&&(s|=ColorType),isType(s&r,NoneType)||(s&=r),new LiteralExpression(s,f)}}if(!Array.isArray(f))throw new Error("Expression must be an array or a primitive value");if(f.length===0)throw new Error("Empty expression");if(typeof f[0]=="string")return parseCallExpression(f,t,r);for(const s of f)if(typeof s!="number")throw new Error("Expected an array of numbers");let i=NumberArrayType;return f.length===2?i|=SizeType:(f.length===3||f.length===4)&&(i|=ColorType),r&&(i&=r),new LiteralExpression(i,f)}const Ops={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string"},parsers={[Ops.Get]:createParser(([f,t])=>t!==void 0?getTypeFromHint(t.value):AnyType,withArgsCount(1,2),withGetArgs),[Ops.Var]:createParser(([f])=>f.type,withArgsCount(1,1),withVarArgs),[Ops.Id]:createParser(NumberType|StringType,withNoArgs,usesFeatureId),[Ops.Concat]:createParser(StringType,withArgsCount(2,1/0),parseArgsOfType(AnyType)),[Ops.GeometryType]:createParser(StringType,withNoArgs,usesGeometryType),[Ops.Resolution]:createParser(NumberType,withNoArgs),[Ops.Zoom]:createParser(NumberType,withNoArgs),[Ops.Time]:createParser(NumberType,withNoArgs),[Ops.Any]:createParser(BooleanType,withArgsCount(2,1/0),parseArgsOfType(BooleanType)),[Ops.All]:createParser(BooleanType,withArgsCount(2,1/0),parseArgsOfType(BooleanType)),[Ops.Not]:createParser(BooleanType,withArgsCount(1,1),parseArgsOfType(BooleanType)),[Ops.Equal]:createParser(BooleanType,withArgsCount(2,2),parseArgsOfType(AnyType),narrowArgsType),[Ops.NotEqual]:createParser(BooleanType,withArgsCount(2,2),parseArgsOfType(AnyType),narrowArgsType),[Ops.GreaterThan]:createParser(BooleanType,withArgsCount(2,2),parseArgsOfType(AnyType),narrowArgsType),[Ops.GreaterThanOrEqualTo]:createParser(BooleanType,withArgsCount(2,2),parseArgsOfType(AnyType),narrowArgsType),[Ops.LessThan]:createParser(BooleanType,withArgsCount(2,2),parseArgsOfType(AnyType),narrowArgsType),[Ops.LessThanOrEqualTo]:createParser(BooleanType,withArgsCount(2,2),parseArgsOfType(AnyType),narrowArgsType),[Ops.Multiply]:createParser(f=>{let t=NumberType|ColorType;for(let r=0;r<f.length;r++)t&=f[r].type;return t},withArgsCount(2,1/0),parseArgsOfType(NumberType|ColorType),narrowArgsType),[Ops.Coalesce]:createParser(f=>{let t=AnyType;for(let r=1;r<f.length;r+=2)t&=f[r].type;return t&=f[f.length-1].type,t},withArgsCount(2,1/0),parseArgsOfType(AnyType),narrowArgsType),[Ops.Divide]:createParser(NumberType,withArgsCount(2,2),parseArgsOfType(NumberType)),[Ops.Add]:createParser(NumberType,withArgsCount(2,1/0),parseArgsOfType(NumberType)),[Ops.Subtract]:createParser(NumberType,withArgsCount(2,2),parseArgsOfType(NumberType)),[Ops.Clamp]:createParser(NumberType,withArgsCount(3,3),parseArgsOfType(NumberType)),[Ops.Mod]:createParser(NumberType,withArgsCount(2,2),parseArgsOfType(NumberType)),[Ops.Pow]:createParser(NumberType,withArgsCount(2,2),parseArgsOfType(NumberType)),[Ops.Abs]:createParser(NumberType,withArgsCount(1,1),parseArgsOfType(NumberType)),[Ops.Floor]:createParser(NumberType,withArgsCount(1,1),parseArgsOfType(NumberType)),[Ops.Ceil]:createParser(NumberType,withArgsCount(1,1),parseArgsOfType(NumberType)),[Ops.Round]:createParser(NumberType,withArgsCount(1,1),parseArgsOfType(NumberType)),[Ops.Sin]:createParser(NumberType,withArgsCount(1,1),parseArgsOfType(NumberType)),[Ops.Cos]:createParser(NumberType,withArgsCount(1,1),parseArgsOfType(NumberType)),[Ops.Atan]:createParser(NumberType,withArgsCount(1,2),parseArgsOfType(NumberType)),[Ops.Sqrt]:createParser(NumberType,withArgsCount(1,1),parseArgsOfType(NumberType)),[Ops.Match]:createParser(f=>{let t=AnyType;for(let r=2;r<f.length;r+=2)t&=f[r].type;return t&=f[f.length-1].type,t},withArgsCount(4,1/0),withEvenArgs,parseMatchArgs),[Ops.Between]:createParser(BooleanType,withArgsCount(3,3),parseArgsOfType(NumberType)),[Ops.Interpolate]:createParser(f=>{let t=ColorType|NumberType;for(let r=3;r<f.length;r+=2)t&=f[r].type;return t},withArgsCount(6,1/0),withEvenArgs,parseInterpolateArgs),[Ops.Case]:createParser(f=>{let t=AnyType;for(let r=1;r<f.length;r+=2)t&=f[r].type;return t&=f[f.length-1].type,t},withArgsCount(3,1/0),withOddArgs,parseCaseArgs),[Ops.In]:createParser(BooleanType,withArgsCount(2,2),parseInArgs),[Ops.Number]:createParser(NumberType,withArgsCount(1,1/0),parseArgsOfType(AnyType)),[Ops.String]:createParser(StringType,withArgsCount(1,1/0),parseArgsOfType(AnyType)),[Ops.Array]:createParser(f=>f.length===2?NumberArrayType|SizeType:f.length===3||f.length===4?NumberArrayType|ColorType:NumberArrayType,withArgsCount(1,1/0),parseArgsOfType(NumberType)),[Ops.Color]:createParser(ColorType,withArgsCount(1,4),parseArgsOfType(NumberType)),[Ops.Band]:createParser(NumberType,withArgsCount(1,3),parseArgsOfType(NumberType)),[Ops.Palette]:createParser(ColorType,withArgsCount(2,2),parsePaletteArgs),[Ops.ToString]:createParser(StringType,withArgsCount(1,1),parseArgsOfType(BooleanType|NumberType|StringType|ColorType))};function withGetArgs(f,t){const r=parse(f[1],t);if(!(r instanceof LiteralExpression))throw new Error("Expected a literal argument for get operation");if(typeof r.value!="string")throw new Error("Expected a string argument for get operation");if(t.properties.add(r.value),f.length===3){const i=parse(f[2],t);return[r,i]}return[r]}function withVarArgs(f,t,r,i){const s=f[1];if(typeof s!="string")throw new Error("Expected a string argument for var operation");if(t.variables.add(s),!("variables"in t.style)||t.style.variables[s]===void 0)return[new LiteralExpression(AnyType,s)];const c=t.style.variables[s],a=parse(c,t);if(a.value=s,i&&!overlapsType(i,a.type))throw new Error(`The variable ${s} has type ${typeName(a.type)} but the following type was expected: ${typeName(i)}`);return[a]}function usesFeatureId(f,t){t.featureId=!0}function usesGeometryType(f,t){t.geometryType=!0}function withNoArgs(f,t){const r=f[0];if(f.length!==1)throw new Error(`Expected no arguments for ${r} operation`);return[]}function withArgsCount(f,t){return function(r,i){const s=r[0],c=r.length-1;if(f===t){if(c!==f){const a=f===1?"":"s";throw new Error(`Expected ${f} argument${a} for ${s}, got ${c}`)}}else if(c<f||c>t){const a=t===1/0?`${f} or more`:`${f} to ${t}`;throw new Error(`Expected ${a} arguments for ${s}, got ${c}`)}}}function parseArgsOfType(f){return function(t,r){const i=t[0],s=t.length-1,c=new Array(s);for(let a=0;a<s;++a){const h=parse(t[a+1],r);if(!overlapsType(f,h.type)){const p=typeName(f),d=typeName(h.type);throw new Error(`Unexpected type for argument ${a} of ${i} operation, got ${p} but expected ${d}`)}h.type&=f,c[a]=h}return c}}function narrowArgsType(f,t,r){const i=f[0],s=f.length-1;let c=AnyType;for(let h=0;h<r.length;++h)c&=r[h].type;if(c===NoneType)throw new Error(`No common type could be found for arguments of ${i} operation`);const a=new Array(s);for(let h=0;h<s;++h)a[h]=parse(f[h+1],t,c);return a}function withOddArgs(f,t){const r=f[0],i=f.length-1;if(i%2===0)throw new Error(`An odd amount of arguments was expected for operation ${r}, got ${JSON.stringify(i)} instead`)}function withEvenArgs(f,t){const r=f[0],i=f.length-1;if(i%2===1)throw new Error(`An even amount of arguments was expected for operation ${r}, got ${JSON.stringify(i)} instead`)}function parseMatchArgs(f,t,r,i){const s=f.length-1;let a=parse(f[1],t).type;const h=parse(f[f.length-1],t);let p=i!==void 0?i&h.type:h.type;const d=new Array(s-2);for(let n=0;n<s-2;n+=2){const e=parse(f[n+2],t),o=parse(f[n+3],t);a&=e.type,p&=o.type,d[n]=e,d[n+1]=o}const l=StringType|NumberType|BooleanType;if(!overlapsType(l,a))throw new Error(`Expected an input of type ${typeName(l)} for the interpolate operation, got ${typeName(a)} instead`);if(a&=l,isType(p,NoneType))throw new Error("Could not find a common output type for the following match operation: "+JSON.stringify(f));for(let n=0;n<s-2;n+=2){const e=parse(f[n+2],t,a),o=parse(f[n+3],t,p);d[n]=e,d[n+1]=o}return[parse(f[1],t,a),...d,parse(f[f.length-1],t,p)]}function parseInterpolateArgs(f,t,r,i){const s=f[1];let c;switch(s[0]){case"linear":c=1;break;case"exponential":if(c=s[1],typeof c!="number")throw new Error(`Expected a number base for exponential interpolation, got ${JSON.stringify(c)} instead`);break;default:c=null}if(!c)throw new Error(`Invalid interpolation type: ${JSON.stringify(s)}`);c=parse(c,t);let a=parse(f[2],t);if(!overlapsType(NumberType,a.type))throw new Error(`Expected an input of type number for the interpolate operation, got ${typeName(a.type)} instead`);a=parse(f[2],t,NumberType);const h=new Array(f.length-3);for(let p=0;p<h.length;p+=2){let d=parse(f[p+3],t);if(!overlapsType(NumberType,d.type))throw new Error(`Expected all stop input values in the interpolate operation to be of type number, got ${typeName(d.type)} at position ${p+2} instead`);let l=parse(f[p+4],t);if(!overlapsType(NumberType|ColorType,l.type))throw new Error(`Expected all stop output values in the interpolate operation to be a number or color, got ${typeName(l.type)} at position ${p+3} instead`);d=parse(f[p+3],t,NumberType),l=parse(f[p+4],t,NumberType|ColorType),h[p]=d,h[p+1]=l}return[c,a,...h]}function parseCaseArgs(f,t,r,i){const s=parse(f[f.length-1],t,i);let c=i!==void 0?i&s.type:s.type;const a=new Array(f.length-1);for(let h=0;h<a.length-1;h+=2){const p=parse(f[h+1],t),d=parse(f[h+2],t,i);if(!overlapsType(BooleanType,p.type))throw new Error(`Expected all conditions in the case operation to be of type boolean, got ${typeName(p.type)} at position ${h} instead`);c&=d.type,a[h]=p,a[h+1]=d}if(isType(c,NoneType))throw new Error("Could not find a common output type for the following case operation: "+JSON.stringify(f));for(let h=0;h<a.length-1;h+=2)a[h+1]=parse(f[h+2],t,c);return a[a.length-1]=parse(f[f.length-1],t,c),a}function parseInArgs(f,t){let r=f[2];if(!Array.isArray(r))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');if(typeof r[0]=="string"){if(r[0]!=="literal")throw new Error('For the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions.');if(!Array.isArray(r[1]))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');r=r[1]}let i=StringType|NumberType;const s=new Array(r.length);for(let a=0;a<s.length;a++){const h=parse(r[a],t);i&=h.type,s[a]=h}if(isType(i,NoneType))throw new Error("Could not find a common type for the following in operation: "+JSON.stringify(f));return[parse(f[1],t,i),...s]}function parsePaletteArgs(f,t){const r=parse(f[1],t,NumberType);if(r.type!==NumberType)throw new Error(`The first argument of palette must be an number, got ${typeName(r.type)} instead`);const i=f[2];if(!Array.isArray(i))throw new Error("The second argument of palette must be an array");const s=new Array(i.length);for(let c=0;c<s.length;c++){const a=parse(i[c],t,ColorType);if(!(a instanceof LiteralExpression))throw new Error(`The palette color at index ${c} must be a literal value`);if(!overlapsType(a.type,ColorType))throw new Error(`The palette color at index ${c} should be of type color, got ${typeName(a.type)} instead`);s[c]=a}return[r,...s]}function createParser(f,...t){return function(r,i,s){const c=r[0];let a=[];for(let p=0;p<t.length;p++)a=t[p](r,i,a,s)||a;let h=typeof f=="function"?f(a):f;if(s!==void 0){if(!overlapsType(h,s))throw new Error(`The following expression was expected to return ${typeName(s)}, but returns ${typeName(h)} instead: ${JSON.stringify(r)}`);h&=s}if(h===NoneType)throw new Error(`No matching type was found for the following expression: ${JSON.stringify(r)}`);return new CallExpression(h,c,...a)}}function parseCallExpression(f,t,r){const i=f[0],s=parsers[i];if(!s)throw new Error(`Unknown operator: ${i}`);return s(f,t,r)}function computeGeometryType(f){if(!f)return"";const t=f.getType();switch(t){case"Point":case"LineString":case"Polygon":return t;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return t.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return computeGeometryType(f.getGeometries()[0]);default:return""}}function newEvaluationContext(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function buildExpression(f,t,r){const i=parse(f,r);if(!overlapsType(t,i.type)){const s=typeName(t),c=typeName(i.type);throw new Error(`Expected expression to be of type ${s}, got ${c}`)}return compileExpression(i)}function compileExpression(f,t){if(f instanceof LiteralExpression){if(f.type===ColorType&&typeof f.value=="string"){const i=fromString(f.value);return function(){return i}}return function(){return f.value}}const r=f.operator;switch(r){case Ops.Number:case Ops.String:case Ops.Coalesce:return compileAssertionExpression(f);case Ops.Get:case Ops.Var:return compileAccessorExpression(f);case Ops.Id:return i=>i.featureId;case Ops.GeometryType:return i=>i.geometryType;case Ops.Concat:{const i=f.args.map(s=>compileExpression(s));return s=>"".concat(...i.map(c=>c(s).toString()))}case Ops.Resolution:return i=>i.resolution;case Ops.Any:case Ops.All:case Ops.Between:case Ops.In:case Ops.Not:return compileLogicalExpression(f);case Ops.Equal:case Ops.NotEqual:case Ops.LessThan:case Ops.LessThanOrEqualTo:case Ops.GreaterThan:case Ops.GreaterThanOrEqualTo:return compileComparisonExpression(f);case Ops.Multiply:case Ops.Divide:case Ops.Add:case Ops.Subtract:case Ops.Clamp:case Ops.Mod:case Ops.Pow:case Ops.Abs:case Ops.Floor:case Ops.Ceil:case Ops.Round:case Ops.Sin:case Ops.Cos:case Ops.Atan:case Ops.Sqrt:return compileNumericExpression(f);case Ops.Case:return compileCaseExpression(f);case Ops.Match:return compileMatchExpression(f);case Ops.Interpolate:return compileInterpolateExpression(f);case Ops.ToString:return compileConvertExpression(f);default:throw new Error(`Unsupported operator ${r}`)}}function compileAssertionExpression(f,t){const r=f.operator,i=f.args.length,s=new Array(i);for(let c=0;c<i;++c)s[c]=compileExpression(f.args[c]);switch(r){case Ops.Coalesce:return c=>{for(let a=0;a<i;++a){const h=s[a](c);if(typeof h<"u"&&h!==null)return h}throw new Error("Expected one of the values to be non-null")};case Ops.Number:case Ops.String:return c=>{for(let a=0;a<i;++a){const h=s[a](c);if(typeof h===r)return h}throw new Error(`Expected one of the values to be a ${r}`)};default:throw new Error(`Unsupported assertion operator ${r}`)}}function compileAccessorExpression(f,t){const i=f.args[0].value;switch(f.operator){case Ops.Get:return s=>s.properties[i];case Ops.Var:return s=>s.variables[i];default:throw new Error(`Unsupported accessor operator ${f.operator}`)}}function compileComparisonExpression(f,t){const r=f.operator,i=compileExpression(f.args[0]),s=compileExpression(f.args[1]);switch(r){case Ops.Equal:return c=>i(c)===s(c);case Ops.NotEqual:return c=>i(c)!==s(c);case Ops.LessThan:return c=>i(c)<s(c);case Ops.LessThanOrEqualTo:return c=>i(c)<=s(c);case Ops.GreaterThan:return c=>i(c)>s(c);case Ops.GreaterThanOrEqualTo:return c=>i(c)>=s(c);default:throw new Error(`Unsupported comparison operator ${r}`)}}function compileLogicalExpression(f,t){const r=f.operator,i=f.args.length,s=new Array(i);for(let c=0;c<i;++c)s[c]=compileExpression(f.args[c]);switch(r){case Ops.Any:return c=>{for(let a=0;a<i;++a)if(s[a](c))return!0;return!1};case Ops.All:return c=>{for(let a=0;a<i;++a)if(!s[a](c))return!1;return!0};case Ops.Between:return c=>{const a=s[0](c),h=s[1](c),p=s[2](c);return a>=h&&a<=p};case Ops.In:return c=>{const a=s[0](c);for(let h=1;h<i;++h)if(a===s[h](c))return!0;return!1};case Ops.Not:return c=>!s[0](c);default:throw new Error(`Unsupported logical operator ${r}`)}}function compileNumericExpression(f,t){const r=f.operator,i=f.args.length,s=new Array(i);for(let c=0;c<i;++c)s[c]=compileExpression(f.args[c]);switch(r){case Ops.Multiply:return c=>{let a=1;for(let h=0;h<i;++h)a*=s[h](c);return a};case Ops.Divide:return c=>s[0](c)/s[1](c);case Ops.Add:return c=>{let a=0;for(let h=0;h<i;++h)a+=s[h](c);return a};case Ops.Subtract:return c=>s[0](c)-s[1](c);case Ops.Clamp:return c=>{const a=s[0](c),h=s[1](c);if(a<h)return h;const p=s[2](c);return a>p?p:a};case Ops.Mod:return c=>s[0](c)%s[1](c);case Ops.Pow:return c=>Math.pow(s[0](c),s[1](c));case Ops.Abs:return c=>Math.abs(s[0](c));case Ops.Floor:return c=>Math.floor(s[0](c));case Ops.Ceil:return c=>Math.ceil(s[0](c));case Ops.Round:return c=>Math.round(s[0](c));case Ops.Sin:return c=>Math.sin(s[0](c));case Ops.Cos:return c=>Math.cos(s[0](c));case Ops.Atan:return i===2?c=>Math.atan2(s[0](c),s[1](c)):c=>Math.atan(s[0](c));case Ops.Sqrt:return c=>Math.sqrt(s[0](c));default:throw new Error(`Unsupported numeric operator ${r}`)}}function compileCaseExpression(f,t){const r=f.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=compileExpression(f.args[s]);return s=>{for(let c=0;c<r-1;c+=2)if(i[c](s))return i[c+1](s);return i[r-1](s)}}function compileMatchExpression(f,t){const r=f.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=compileExpression(f.args[s]);return s=>{const c=i[0](s);for(let a=1;a<r;a+=2)if(c===i[a](s))return i[a+1](s);return i[r-1](s)}}function compileInterpolateExpression(f,t){const r=f.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=compileExpression(f.args[s]);return s=>{const c=i[0](s),a=i[1](s);let h,p;for(let d=2;d<r;d+=2){const l=i[d](s);let n=i[d+1](s);const e=Array.isArray(n);if(e&&(n=withAlpha(n)),l>=a)return d===2?n:e?interpolateColor(c,a,h,p,l,n):interpolateNumber(c,a,h,p,l,n);h=l,p=n}return p}}function compileConvertExpression(f,t){const r=f.operator,i=f.args.length,s=new Array(i);for(let c=0;c<i;++c)s[c]=compileExpression(f.args[c]);switch(r){case Ops.ToString:return c=>{const a=s[0](c);return f.args[0].type===ColorType?toString(a):a.toString()};default:throw new Error(`Unsupported convert operator ${r}`)}}function interpolateNumber(f,t,r,i,s,c){const a=s-r;if(a===0)return i;const h=t-r,p=f===1?h/a:(Math.pow(f,h)-1)/(Math.pow(f,a)-1);return i+p*(c-i)}function interpolateColor(f,t,r,i,s,c){if(s-r===0)return i;const h=rgbaToLcha(i),p=rgbaToLcha(c);let d=p[2]-h[2];d>180?d-=360:d<-180&&(d+=360);const l=[interpolateNumber(f,t,r,h[0],s,p[0]),interpolateNumber(f,t,r,h[1],s,p[1]),h[2]+interpolateNumber(f,t,r,0,s,d),interpolateNumber(f,t,r,i[3],s,c[3])];return normalize(lchaToRgba(l))}function always(f){return!0}function rulesToStyleFunction(f){const t=newParsingContext(),r=buildRuleSet(f,t),i=newEvaluationContext();return function(s,c){if(i.properties=s.getPropertiesInternal(),i.resolution=c,t.featureId){const a=s.getId();a!==void 0?i.featureId=a:i.featureId=null}return t.geometryType&&(i.geometryType=computeGeometryType(s.getGeometry())),r(i)}}function flatStylesToStyleFunction(f){const t=newParsingContext(),r=f.length,i=new Array(r);for(let a=0;a<r;++a)i[a]=buildStyle(f[a],t);const s=newEvaluationContext(),c=new Array(r);return function(a,h){if(s.properties=a.getPropertiesInternal(),s.resolution=h,t.featureId){const d=a.getId();d!==void 0?s.featureId=d:s.featureId=null}let p=0;for(let d=0;d<r;++d){const l=i[d](s);l&&(c[p]=l,p+=1)}return c.length=p,c}}function buildRuleSet(f,t){const r=f.length,i=new Array(r);for(let s=0;s<r;++s){const c=f[s],a="filter"in c?buildExpression(c.filter,BooleanType,t):always;let h;if(Array.isArray(c.style)){const p=c.style.length;h=new Array(p);for(let d=0;d<p;++d)h[d]=buildStyle(c.style[d],t)}else h=[buildStyle(c.style,t)];i[s]={filter:a,styles:h}}return function(s){const c=[];let a=!1;for(let h=0;h<r;++h){const p=i[h].filter;if(p(s)&&!(f[h].else&&a)){a=!0;for(const d of i[h].styles){const l=d(s);l&&c.push(l)}}}return c}}function buildStyle(f,t){const r=buildFill(f,"",t),i=buildStroke(f,"",t),s=buildText(f,t),c=buildImage(f,t),a=numberEvaluator(f,"z-index",t);if(!r&&!i&&!s&&!c&&!isEmpty$1(f))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(f));const h=new Style;return function(p){let d=!0;if(r){const l=r(p);l&&(d=!1),h.setFill(l)}if(i){const l=i(p);l&&(d=!1),h.setStroke(l)}if(s){const l=s(p);l&&(d=!1),h.setText(l)}if(c){const l=c(p);l&&(d=!1),h.setImage(l)}return a&&h.setZIndex(a(p)),d?null:h}}function buildFill(f,t,r){let i;if(t+"fill-pattern-src"in f?i=patternEvaluator(f,t+"fill-",r):i=colorLikeEvaluator(f,t+"fill-color",r),!i)return null;const s=new Fill;return function(c){const a=i(c);return a==="none"?null:(s.setColor(a),s)}}function buildStroke(f,t,r){const i=numberEvaluator(f,t+"stroke-width",r),s=colorLikeEvaluator(f,t+"stroke-color",r);if(!i&&!s)return null;const c=stringEvaluator(f,t+"stroke-line-cap",r),a=stringEvaluator(f,t+"stroke-line-join",r),h=numberArrayEvaluator(f,t+"stroke-line-dash",r),p=numberEvaluator(f,t+"stroke-line-dash-offset",r),d=numberEvaluator(f,t+"stroke-miter-limit",r),l=new Stroke;return function(n){if(s){const e=s(n);if(e==="none")return null;l.setColor(e)}if(i&&l.setWidth(i(n)),c){const e=c(n);if(e!=="butt"&&e!=="round"&&e!=="square")throw new Error("Expected butt, round, or square line cap");l.setLineCap(e)}if(a){const e=a(n);if(e!=="bevel"&&e!=="round"&&e!=="miter")throw new Error("Expected bevel, round, or miter line join");l.setLineJoin(e)}return h&&l.setLineDash(h(n)),p&&l.setLineDashOffset(p(n)),d&&l.setMiterLimit(d(n)),l}}function buildText(f,t){const r="text-",i=stringEvaluator(f,r+"value",t);if(!i)return null;const s=buildFill(f,r,t),c=buildFill(f,r+"background-",t),a=buildStroke(f,r,t),h=buildStroke(f,r+"background-",t),p=stringEvaluator(f,r+"font",t),d=numberEvaluator(f,r+"max-angle",t),l=numberEvaluator(f,r+"offset-x",t),n=numberEvaluator(f,r+"offset-y",t),e=booleanEvaluator(f,r+"overflow",t),o=stringEvaluator(f,r+"placement",t),u=numberEvaluator(f,r+"repeat",t),g=sizeLikeEvaluator(f,r+"scale",t),m=booleanEvaluator(f,r+"rotate-with-view",t),y=numberEvaluator(f,r+"rotation",t),b=stringEvaluator(f,r+"align",t),_=stringEvaluator(f,r+"justify",t),x=stringEvaluator(f,r+"baseline",t),w=numberArrayEvaluator(f,r+"padding",t),T=optionalDeclutterMode(f,r+"declutter-mode"),S=new Text({declutterMode:T});return function(I){if(S.setText(i(I)),s&&S.setFill(s(I)),c&&S.setBackgroundFill(c(I)),a&&S.setStroke(a(I)),h&&S.setBackgroundStroke(h(I)),p&&S.setFont(p(I)),d&&S.setMaxAngle(d(I)),l&&S.setOffsetX(l(I)),n&&S.setOffsetY(n(I)),e&&S.setOverflow(e(I)),o){const v=o(I);if(v!=="point"&&v!=="line")throw new Error("Expected point or line for text-placement");S.setPlacement(v)}if(u&&S.setRepeat(u(I)),g&&S.setScale(g(I)),m&&S.setRotateWithView(m(I)),y&&S.setRotation(y(I)),b){const v=b(I);if(v!=="left"&&v!=="center"&&v!=="right"&&v!=="end"&&v!=="start")throw new Error("Expected left, right, center, start, or end for text-align");S.setTextAlign(v)}if(_){const v=_(I);if(v!=="left"&&v!=="right"&&v!=="center")throw new Error("Expected left, right, or center for text-justify");S.setJustify(v)}if(x){const v=x(I);if(v!=="bottom"&&v!=="top"&&v!=="middle"&&v!=="alphabetic"&&v!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");S.setTextBaseline(v)}return w&&S.setPadding(w(I)),S}}function buildImage(f,t){return"icon-src"in f?buildIcon(f,t):"shape-points"in f?buildShape(f,t):"circle-radius"in f?buildCircle(f,t):null}function buildIcon(f,t){const r="icon-",i=r+"src",s=requireString(f[i],i),c=coordinateEvaluator(f,r+"anchor",t),a=sizeLikeEvaluator(f,r+"scale",t),h=numberEvaluator(f,r+"opacity",t),p=coordinateEvaluator(f,r+"displacement",t),d=numberEvaluator(f,r+"rotation",t),l=booleanEvaluator(f,r+"rotate-with-view",t),n=optionalIconOrigin(f,r+"anchor-origin"),e=optionalIconAnchorUnits(f,r+"anchor-x-units"),o=optionalIconAnchorUnits(f,r+"anchor-y-units"),u=optionalColorLike(f,r+"color"),g=optionalString(f,r+"cross-origin"),m=optionalNumberArray(f,r+"offset"),y=optionalIconOrigin(f,r+"offset-origin"),b=optionalNumber(f,r+"width"),_=optionalNumber(f,r+"height"),x=optionalSize(f,r+"size"),w=optionalDeclutterMode(f,r+"declutter-mode"),T=new Icon({src:s,anchorOrigin:n,anchorXUnits:e,anchorYUnits:o,color:u,crossOrigin:g,offset:m,offsetOrigin:y,height:_,width:b,size:x,declutterMode:w});return function(S){return h&&T.setOpacity(h(S)),p&&T.setDisplacement(p(S)),d&&T.setRotation(d(S)),l&&T.setRotateWithView(l(S)),a&&T.setScale(a(S)),c&&T.setAnchor(c(S)),T}}function buildShape(f,t){const r="shape-",i=r+"points",s=r+"radius",c=requireNumber(f[i],i),a=requireNumber(f[s],s),h=buildFill(f,r,t),p=buildStroke(f,r,t),d=sizeLikeEvaluator(f,r+"scale",t),l=coordinateEvaluator(f,r+"displacement",t),n=numberEvaluator(f,r+"rotation",t),e=booleanEvaluator(f,r+"rotate-with-view",t),o=optionalNumber(f,r+"radius2"),u=optionalNumber(f,r+"angle"),g=optionalDeclutterMode(f,r+"declutter-mode"),m=new RegularShape({points:c,radius:a,radius2:o,angle:u,declutterMode:g});return function(y){return h&&m.setFill(h(y)),p&&m.setStroke(p(y)),l&&m.setDisplacement(l(y)),n&&m.setRotation(n(y)),e&&m.setRotateWithView(e(y)),d&&m.setScale(d(y)),m}}function buildCircle(f,t){const r="circle-",i=buildFill(f,r,t),s=buildStroke(f,r,t),c=numberEvaluator(f,r+"radius",t),a=sizeLikeEvaluator(f,r+"scale",t),h=coordinateEvaluator(f,r+"displacement",t),p=numberEvaluator(f,r+"rotation",t),d=booleanEvaluator(f,r+"rotate-with-view",t),l=optionalDeclutterMode(f,r+"declutter-mode"),n=new CircleStyle({radius:5,declutterMode:l});return function(e){return c&&n.setRadius(c(e)),i&&n.setFill(i(e)),s&&n.setStroke(s(e)),h&&n.setDisplacement(h(e)),p&&n.setRotation(p(e)),d&&n.setRotateWithView(d(e)),a&&n.setScale(a(e)),n}}function numberEvaluator(f,t,r){if(!(t in f))return;const i=buildExpression(f[t],NumberType,r);return function(s){return requireNumber(i(s),t)}}function stringEvaluator(f,t,r){if(!(t in f))return null;const i=buildExpression(f[t],StringType,r);return function(s){return requireString(i(s),t)}}function patternEvaluator(f,t,r){const i=stringEvaluator(f,t+"pattern-src",r),s=sizeEvaluator(f,t+"pattern-offset",r),c=sizeEvaluator(f,t+"pattern-size",r),a=colorLikeEvaluator(f,t+"color",r);return function(h){return{src:i(h),offset:s&&s(h),size:c&&c(h),color:a&&a(h)}}}function booleanEvaluator(f,t,r){if(!(t in f))return null;const i=buildExpression(f[t],BooleanType,r);return function(s){const c=i(s);if(typeof c!="boolean")throw new Error(`Expected a boolean for ${t}`);return c}}function colorLikeEvaluator(f,t,r){if(!(t in f))return null;const i=buildExpression(f[t],ColorType|StringType,r);return function(s){return requireColorLike(i(s),t)}}function numberArrayEvaluator(f,t,r){if(!(t in f))return null;const i=buildExpression(f[t],NumberArrayType,r);return function(s){return requireNumberArray(i(s),t)}}function coordinateEvaluator(f,t,r){if(!(t in f))return null;const i=buildExpression(f[t],NumberArrayType,r);return function(s){const c=requireNumberArray(i(s),t);if(c.length!==2)throw new Error(`Expected two numbers for ${t}`);return c}}function sizeEvaluator(f,t,r){if(!(t in f))return null;const i=buildExpression(f[t],NumberArrayType,r);return function(s){return requireSize(i(s),t)}}function sizeLikeEvaluator(f,t,r){if(!(t in f))return null;const i=buildExpression(f[t],NumberArrayType|NumberType,r);return function(s){return requireSizeLike(i(s),t)}}function optionalNumber(f,t){const r=f[t];if(r!==void 0){if(typeof r!="number")throw new Error(`Expected a number for ${t}`);return r}}function optionalSize(f,t){const r=f[t];if(r!==void 0){if(typeof r=="number")return toSize(r);if(!Array.isArray(r))throw new Error(`Expected a number or size array for ${t}`);if(r.length!==2||typeof r[0]!="number"||typeof r[1]!="number")throw new Error(`Expected a number or size array for ${t}`);return r}}function optionalString(f,t){const r=f[t];if(r!==void 0){if(typeof r!="string")throw new Error(`Expected a string for ${t}`);return r}}function optionalIconOrigin(f,t){const r=f[t];if(r!==void 0){if(r!=="bottom-left"&&r!=="bottom-right"&&r!=="top-left"&&r!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${t}`);return r}}function optionalIconAnchorUnits(f,t){const r=f[t];if(r!==void 0){if(r!=="pixels"&&r!=="fraction")throw new Error(`Expected pixels or fraction for ${t}`);return r}}function optionalNumberArray(f,t){const r=f[t];if(r!==void 0)return requireNumberArray(r,t)}function optionalDeclutterMode(f,t){const r=f[t];if(r!==void 0){if(typeof r!="string")throw new Error(`Expected a string for ${t}`);if(r!=="declutter"&&r!=="obstacle"&&r!=="none")throw new Error(`Expected declutter, obstacle, or none for ${t}`);return r}}function optionalColorLike(f,t){const r=f[t];if(r!==void 0)return requireColorLike(r,t)}function requireNumberArray(f,t){if(!Array.isArray(f))throw new Error(`Expected an array for ${t}`);const r=f.length;for(let i=0;i<r;++i)if(typeof f[i]!="number")throw new Error(`Expected an array of numbers for ${t}`);return f}function requireString(f,t){if(typeof f!="string")throw new Error(`Expected a string for ${t}`);return f}function requireNumber(f,t){if(typeof f!="number")throw new Error(`Expected a number for ${t}`);return f}function requireColorLike(f,t){if(typeof f=="string")return f;const r=requireNumberArray(f,t),i=r.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${t}`);return r}function requireSize(f,t){const r=requireNumberArray(f,t);if(r.length!==2)throw new Error(`Expected an array of two numbers for ${t}`);return r}function requireSizeLike(f,t){return typeof f=="number"?f:requireSize(f,t)}const Property$1={RENDER_ORDER:"renderOrder"};class BaseVectorLayer extends Layer{constructor(t){t=t||{};const r=Object.assign({},t);delete r.style,delete r.renderBuffer,delete r.updateWhileAnimating,delete r.updateWhileInteracting,super(r),this.declutter_=t.declutter?String(t.declutter):void 0,this.renderBuffer_=t.renderBuffer!==void 0?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=t.updateWhileAnimating!==void 0?t.updateWhileAnimating:!1,this.updateWhileInteracting_=t.updateWhileInteracting!==void 0?t.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(Property$1.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t,r){const i=this.getDeclutter();i in t.declutter||(t.declutter[i]=new RBush$1(9)),this.getRenderer().renderDeclutter(t,r)}setRenderOrder(t){this.set(Property$1.RENDER_ORDER,t)}setStyle(t){this.style_=t===void 0?createDefaultStyle:t;const r=toStyleLike(t);this.styleFunction_=t===null?void 0:toFunction(r),this.changed()}}function toStyleLike(f){if(f===void 0)return createDefaultStyle;if(!f)return null;if(typeof f=="function"||f instanceof Style)return f;if(!Array.isArray(f))return flatStylesToStyleFunction([f]);if(f.length===0)return[];const t=f.length,r=f[0];if(r instanceof Style){const s=new Array(t);for(let c=0;c<t;++c){const a=f[c];if(!(a instanceof Style))throw new Error("Expected a list of style instances");s[c]=a}return s}if("style"in r){const s=new Array(t);for(let c=0;c<t;++c){const a=f[c];if(!("style"in a))throw new Error("Expected a list of rules with a style property");s[c]=a}return rulesToStyleFunction(s)}return flatStylesToStyleFunction(f)}const Instruction={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12,ELLIPSE:13},fillInstruction=[Instruction.FILL],strokeInstruction=[Instruction.STROKE],beginPathInstruction=[Instruction.BEGIN_PATH],closePathInstruction=[Instruction.CLOSE_PATH];class VectorContext{drawCustom(t,r,i,s,c){}drawGeometry(t){}setStyle(t){}drawCircle(t,r,i){}drawEllipse(t,r,i){}drawFeature(t,r,i){}drawGeometryCollection(t,r,i){}drawLineString(t,r,i){}drawMultiLineString(t,r,i){}drawMultiPoint(t,r,i){}drawMultiPolygon(t,r,i){}drawPoint(t,r,i){}drawPolygon(t,r,i){}drawText(t,r,i){}setFillStrokeStyle(t,r){}setImageStyle(t,r){}setTextStyle(t,r){}}class CanvasBuilder extends VectorContext{constructor(t,r,i,s){super(),this.tolerance=t,this.maxExtent=r,this.pixelRatio=s,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const r=this.pixelRatio;return r==1?t:t.map(function(i){return i*r})}appendFlatPointCoordinates(t,r){const i=this.getBufferedMaxExtent(),s=this.tmpCoordinate_,c=this.coordinates;let a=c.length;for(let h=0,p=t.length;h<p;h+=r)s[0]=t[h],s[1]=t[h+1],containsCoordinate(i,s)&&(c[a++]=s[0],c[a++]=s[1]);return a}appendFlatLineCoordinates(t,r,i,s,c,a){const h=this.coordinates;let p=h.length;const d=this.getBufferedMaxExtent();a&&(r+=s);let l=t[r],n=t[r+1];const e=this.tmpCoordinate_;let o=!0,u,g,m;for(u=r+s;u<i;u+=s)e[0]=t[u],e[1]=t[u+1],m=coordinateRelationship(d,e),m!==g?(o&&(h[p++]=l,h[p++]=n,o=!1),h[p++]=e[0],h[p++]=e[1]):m===Relationship.INTERSECTING?(h[p++]=e[0],h[p++]=e[1],o=!1):o=!0,l=e[0],n=e[1],g=m;return(c&&o||u===r+s)&&(h[p++]=l,h[p++]=n),p}drawCustomCoordinates_(t,r,i,s,c){for(let a=0,h=i.length;a<h;++a){const p=i[a],d=this.appendFlatLineCoordinates(t,r,p,s,!1,!1);c.push(d),r=p}return r}drawCustom(t,r,i,s,c){this.beginGeometry(t,r,c);const a=t.getType(),h=t.getStride(),p=this.coordinates.length;let d,l,n,e,o;switch(a){case"MultiPolygon":d=t.getOrientedFlatCoordinates(),e=[];const u=t.getEndss();o=0;for(let g=0,m=u.length;g<m;++g){const y=[];o=this.drawCustomCoordinates_(d,o,u[g],h,y),e.push(y)}this.instructions.push([Instruction.CUSTOM,p,e,t,i,inflateMultiCoordinatesArray,c]),this.hitDetectionInstructions.push([Instruction.CUSTOM,p,e,t,s||i,inflateMultiCoordinatesArray,c]);break;case"Polygon":case"MultiLineString":n=[],d=a=="Polygon"?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),o=this.drawCustomCoordinates_(d,0,t.getEnds(),h,n),this.instructions.push([Instruction.CUSTOM,p,n,t,i,inflateCoordinatesArray,c]),this.hitDetectionInstructions.push([Instruction.CUSTOM,p,n,t,s||i,inflateCoordinatesArray,c]);break;case"LineString":case"Circle":d=t.getFlatCoordinates(),l=this.appendFlatLineCoordinates(d,0,d.length,h,!1,!1),this.instructions.push([Instruction.CUSTOM,p,l,t,i,inflateCoordinates,c]),this.hitDetectionInstructions.push([Instruction.CUSTOM,p,l,t,s||i,inflateCoordinates,c]);break;case"MultiPoint":d=t.getFlatCoordinates(),l=this.appendFlatPointCoordinates(d,h),l>p&&(this.instructions.push([Instruction.CUSTOM,p,l,t,i,inflateCoordinates,c]),this.hitDetectionInstructions.push([Instruction.CUSTOM,p,l,t,s||i,inflateCoordinates,c]));break;case"Point":d=t.getFlatCoordinates(),this.coordinates.push(d[0],d[1]),l=this.coordinates.length,this.instructions.push([Instruction.CUSTOM,p,l,t,i,void 0,c]),this.hitDetectionInstructions.push([Instruction.CUSTOM,p,l,t,s||i,void 0,c]);break}this.endGeometry(r)}beginGeometry(t,r,i){this.beginGeometryInstruction1_=[Instruction.BEGIN_GEOMETRY,r,0,t,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Instruction.BEGIN_GEOMETRY,r,0,t,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;t.reverse();let r;const i=t.length;let s,c,a=-1;for(r=0;r<i;++r)s=t[r],c=s[0],c==Instruction.END_GEOMETRY?a=r:c==Instruction.BEGIN_GEOMETRY&&(s[2]=r,reverseSubArray(this.hitDetectionInstructions,a,r),a=-1)}setFillStrokeStyle(t,r){const i=this.state;if(t){const s=t.getColor();i.fillPatternScale=s&&typeof s=="object"&&"src"in s?this.pixelRatio:1,i.fillStyle=asColorLike(s||defaultFillStyle)}else i.fillStyle=void 0;if(r){const s=r.getColor();i.strokeStyle=asColorLike(s||defaultStrokeStyle);const c=r.getLineCap();i.lineCap=c!==void 0?c:defaultLineCap;const a=r.getLineDash();i.lineDash=a?a.slice():defaultLineDash;const h=r.getLineDashOffset();i.lineDashOffset=h||defaultLineDashOffset;const p=r.getLineJoin();i.lineJoin=p!==void 0?p:defaultLineJoin;const d=r.getWidth();i.lineWidth=d!==void 0?d:defaultLineWidth;const l=r.getMiterLimit();i.miterLimit=l!==void 0?l:defaultMiterLimit,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0}createFill(t){const r=t.fillStyle,i=[Instruction.SET_FILL_STYLE,r];return typeof r!="string"&&i.push(t.fillPatternScale),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[Instruction.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,r){const i=t.fillStyle;(typeof i!="string"||t.currentFillStyle!=i)&&(i!==void 0&&this.instructions.push(r.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,r){const i=t.strokeStyle,s=t.lineCap,c=t.lineDash,a=t.lineDashOffset,h=t.lineJoin,p=t.lineWidth,d=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=s||c!=t.currentLineDash&&!equals$2(t.currentLineDash,c)||t.currentLineDashOffset!=a||t.currentLineJoin!=h||t.currentLineWidth!=p||t.currentMiterLimit!=d)&&(i!==void 0&&r.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=s,t.currentLineDash=c,t.currentLineDashOffset=a,t.currentLineJoin=h,t.currentLineWidth=p,t.currentMiterLimit=d)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const r=[Instruction.END_GEOMETRY,t];this.instructions.push(r),this.hitDetectionInstructions.push(r)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=clone(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;buffer(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class CanvasImageBuilder extends CanvasBuilder{constructor(t,r,i,s){super(t,r,i,s),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,r,i){if(!this.image_||this.maxExtent&&!containsCoordinate(this.maxExtent,t.getFlatCoordinates()))return;this.beginGeometry(t,r,i);const s=t.getFlatCoordinates(),c=t.getStride(),a=this.coordinates.length,h=this.appendFlatPointCoordinates(s,c);this.instructions.push([Instruction.DRAW_IMAGE,a,h,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Instruction.DRAW_IMAGE,a,h,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(r)}drawMultiPoint(t,r,i){if(!this.image_)return;this.beginGeometry(t,r,i);const s=t.getFlatCoordinates(),c=[];for(let p=0,d=s.length;p<d;p+=t.getStride())(!this.maxExtent||containsCoordinate(this.maxExtent,s.slice(p,p+2)))&&c.push(s[p],s[p+1]);const a=this.coordinates.length,h=this.appendFlatPointCoordinates(c,2);this.instructions.push([Instruction.DRAW_IMAGE,a,h,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Instruction.DRAW_IMAGE,a,h,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(r)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,r){const i=t.getAnchor(),s=t.getSize(),c=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=s[1],this.opacity_=t.getOpacity(),this.originX_=c[0],this.originY_=c[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=s[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=r}}class CanvasLineStringBuilder extends CanvasBuilder{constructor(t,r,i,s){super(t,r,i,s)}drawFlatCoordinates_(t,r,i,s){const c=this.coordinates.length,a=this.appendFlatLineCoordinates(t,r,i,s,!1,!1),h=[Instruction.MOVE_TO_LINE_TO,c,a];return this.instructions.push(h),this.hitDetectionInstructions.push(h),i}drawLineString(t,r,i){const s=this.state,c=s.strokeStyle,a=s.lineWidth;if(c===void 0||a===void 0)return;this.updateStrokeStyle(s,this.applyStroke),this.beginGeometry(t,r,i),this.hitDetectionInstructions.push([Instruction.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,defaultLineDash,defaultLineDashOffset],beginPathInstruction);const h=t.getFlatCoordinates(),p=t.getStride();this.drawFlatCoordinates_(h,0,h.length,p),this.hitDetectionInstructions.push(strokeInstruction),this.endGeometry(r)}drawMultiLineString(t,r,i){const s=this.state,c=s.strokeStyle,a=s.lineWidth;if(c===void 0||a===void 0)return;this.updateStrokeStyle(s,this.applyStroke),this.beginGeometry(t,r,i),this.hitDetectionInstructions.push([Instruction.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,defaultLineDash,defaultLineDashOffset],beginPathInstruction);const h=t.getEnds(),p=t.getFlatCoordinates(),d=t.getStride();let l=0;for(let n=0,e=h.length;n<e;++n)l=this.drawFlatCoordinates_(p,l,h[n],d);this.hitDetectionInstructions.push(strokeInstruction),this.endGeometry(r)}finish(){const t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(strokeInstruction),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(strokeInstruction),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(beginPathInstruction)}}class CanvasPolygonBuilder extends CanvasBuilder{constructor(t,r,i,s){super(t,r,i,s)}drawFlatCoordinatess_(t,r,i,s){const c=this.state,a=c.fillStyle!==void 0,h=c.strokeStyle!==void 0,p=i.length;this.instructions.push(beginPathInstruction),this.hitDetectionInstructions.push(beginPathInstruction);for(let d=0;d<p;++d){const l=i[d],n=this.coordinates.length,e=this.appendFlatLineCoordinates(t,r,l,s,!0,!h),o=[Instruction.MOVE_TO_LINE_TO,n,e];this.instructions.push(o),this.hitDetectionInstructions.push(o),h&&(this.instructions.push(closePathInstruction),this.hitDetectionInstructions.push(closePathInstruction)),r=l}return a&&(this.instructions.push(fillInstruction),this.hitDetectionInstructions.push(fillInstruction)),h&&(this.instructions.push(strokeInstruction),this.hitDetectionInstructions.push(strokeInstruction)),r}drawCircle(t,r,i){const s=this.state,c=s.fillStyle,a=s.strokeStyle;if(c===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,r,i),s.fillStyle!==void 0&&this.hitDetectionInstructions.push([Instruction.SET_FILL_STYLE,defaultFillStyle]),s.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Instruction.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,defaultLineDash,defaultLineDashOffset]);const h=t.getFlatCoordinates(),p=t.getStride(),d=this.coordinates.length;this.appendFlatLineCoordinates(h,0,h.length,p,!1,!1);const l=[Instruction.CIRCLE,d];this.instructions.push(beginPathInstruction,l),this.hitDetectionInstructions.push(beginPathInstruction,l),s.fillStyle!==void 0&&(this.instructions.push(fillInstruction),this.hitDetectionInstructions.push(fillInstruction)),s.strokeStyle!==void 0&&(this.instructions.push(strokeInstruction),this.hitDetectionInstructions.push(strokeInstruction)),this.endGeometry(r)}drawEllipse(t,r,i){const s=this.state,c=s.fillStyle,a=s.strokeStyle;if(c===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,r,i),this.hitDetectionInstructions.push([Instruction.SET_FILL_STYLE,defaultFillStyle]),s.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Instruction.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,s.lineDash,s.lineDashOffset]);const h=t.getFlatCoordinates(),p=this.coordinates.length;Array.prototype.push.apply(this.coordinates,h);const d=this.coordinates.length,l=[Instruction.ELLIPSE,p,d];this.instructions.push(beginPathInstruction,l),this.hitDetectionInstructions.push(beginPathInstruction,l),this.hitDetectionInstructions.push(fillInstruction),s.fillStyle!==void 0&&this.instructions.push(fillInstruction),s.strokeStyle!==void 0&&(this.instructions.push(strokeInstruction),this.hitDetectionInstructions.push(strokeInstruction)),this.endGeometry(r)}drawPolygon(t,r,i){const s=this.state,c=s.fillStyle,a=s.strokeStyle;if(c===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,r,i),s.fillStyle!==void 0&&this.hitDetectionInstructions.push([Instruction.SET_FILL_STYLE,defaultFillStyle]),s.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Instruction.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,defaultLineDash,defaultLineDashOffset]);const h=t.getEnds(),p=t.getOrientedFlatCoordinates(),d=t.getStride();this.drawFlatCoordinatess_(p,0,h,d),this.endGeometry(r)}drawMultiPolygon(t,r,i){const s=this.state,c=s.fillStyle,a=s.strokeStyle;if(c===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,r,i),s.fillStyle!==void 0&&this.hitDetectionInstructions.push([Instruction.SET_FILL_STYLE,defaultFillStyle]),s.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Instruction.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,defaultLineDash,defaultLineDashOffset]);const h=t.getEndss(),p=t.getOrientedFlatCoordinates(),d=t.getStride();let l=0;for(let n=0,e=h.length;n<e;++n)l=this.drawFlatCoordinatess_(p,l,h[n],d);this.endGeometry(r)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(t!==0){const r=this.coordinates;for(let i=0,s=r.length;i<s;++i)r[i]=snap(r[i],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;t.fillStyle!==void 0&&this.updateFillStyle(t,this.createFill),t.strokeStyle!==void 0&&this.updateStrokeStyle(t,this.applyStroke)}}function lineChunk(f,t,r,i,s){const c=[];let a=r,h=0,p=t.slice(r,2);for(;h<f&&a+s<i;){const[d,l]=p.slice(-2),n=t[a+s],e=t[a+s+1],o=Math.sqrt((n-d)*(n-d)+(e-l)*(e-l));if(h+=o,h>=f){const u=(f-h+o)/o,g=lerp(d,n,u),m=lerp(l,e,u);p.push(g,m),c.push(p),p=[g,m],h==f&&(a+=s),h=0}else if(h<f)p.push(t[a+s],t[a+s+1]),a+=s;else{const u=o-h,g=lerp(d,n,u/o),m=lerp(l,e,u/o);p.push(g,m),c.push(p),p=[g,m],h=0,a+=s}}return h>0&&c.push(p),c}function matchingChunk(f,t,r,i,s){let c=r,a=r,h=0,p=0,d=r,l,n,e,o,u,g,m,y,b,_;for(n=r;n<i;n+=s){const x=t[n],w=t[n+1];u!==void 0&&(b=x-u,_=w-g,o=Math.sqrt(b*b+_*_),m!==void 0&&(p+=e,l=Math.acos((m*b+y*_)/(e*o)),l>f&&(p>h&&(h=p,c=d,a=n),p=0,d=n-s)),e=o,m=b,y=_),u=x,g=w}return p+=o,p>h?[d,n]:[c,a]}const TEXT_ALIGN={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class CanvasTextBuilder extends CanvasBuilder{constructor(t,r,i,s){super(t,r,i,s),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[defaultFillStyle]={fillStyle:defaultFillStyle},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,r,i){const s=this.textFillState_,c=this.textStrokeState_,a=this.textState_;if(this.text_===""||!a||!s&&!c)return;const h=this.coordinates;let p=h.length;const d=t.getType();let l=null,n=t.getStride();if(a.placement==="line"&&(d=="LineString"||d=="MultiLineString"||d=="Polygon"||d=="MultiPolygon")){if(!intersects$1(this.maxExtent,t.getExtent()))return;let e;if(l=t.getFlatCoordinates(),d=="LineString")e=[l.length];else if(d=="MultiLineString")e=t.getEnds();else if(d=="Polygon")e=t.getEnds().slice(0,1);else if(d=="MultiPolygon"){const m=t.getEndss();e=[];for(let y=0,b=m.length;y<b;++y)e.push(m[y][0])}this.beginGeometry(t,r,i);const o=a.repeat,u=o?void 0:a.textAlign;let g=0;for(let m=0,y=e.length;m<y;++m){let b;o?b=lineChunk(o*this.resolution,l,g,e[m],n):b=[l.slice(g,e[m])];for(let _=0,x=b.length;_<x;++_){const w=b[_];let T=0,S=w.length;if(u==null){const v=matchingChunk(a.maxAngle,w,0,w.length,2);T=v[0],S=v[1]}for(let v=T;v<S;v+=n)h.push(w[v],w[v+1]);const I=h.length;g=e[m],this.drawChars_(p,I),p=I}}this.endGeometry(r)}else{let e=a.overflow?null:[];switch(d){case"Point":case"MultiPoint":l=t.getFlatCoordinates();break;case"LineString":l=t.getFlatMidpoint();break;case"Circle":l=t.getCenter();break;case"MultiLineString":l=t.getFlatMidpoints(),n=2;break;case"Polygon":l=t.getFlatInteriorPoint(),a.overflow||e.push(l[2]/this.resolution),n=3;break;case"MultiPolygon":const b=t.getFlatInteriorPoints();l=[];for(let _=0,x=b.length;_<x;_+=3)a.overflow||e.push(b[_+2]/this.resolution),l.push(b[_],b[_+1]);if(l.length===0)return;n=2;break}const o=this.appendFlatPointCoordinates(l,n);if(o===p)return;if(e&&(o-p)/2!==l.length/n){let b=p/2;e=e.filter((_,x)=>{const w=h[(b+x)*2]===l[x*n]&&h[(b+x)*2+1]===l[x*n+1];return w||--b,w})}this.saveTextStates_(),(a.backgroundFill||a.backgroundStroke)&&(this.setFillStrokeStyle(a.backgroundFill,a.backgroundStroke),a.backgroundFill&&this.updateFillStyle(this.state,this.createFill),a.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,r,i);let u=a.padding;if(u!=defaultPadding&&(a.scale[0]<0||a.scale[1]<0)){let b=a.padding[0],_=a.padding[1],x=a.padding[2],w=a.padding[3];a.scale[0]<0&&(_=-_,w=-w),a.scale[1]<0&&(b=-b,x=-x),u=[b,_,x,w]}const g=this.pixelRatio;this.instructions.push([Instruction.DRAW_IMAGE,p,o,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,u==defaultPadding?defaultPadding:u.map(function(b){return b*g}),!!a.backgroundFill,!!a.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,e]);const m=1/g,y=this.state.fillStyle;a.backgroundFill&&(this.state.fillStyle=defaultFillStyle,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([Instruction.DRAW_IMAGE,p,o,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[m,m],NaN,this.declutterMode_,this.declutterImageWithText_,u,!!a.backgroundFill,!!a.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?defaultFillStyle:this.fillKey_,this.textOffsetX_,this.textOffsetY_,e]),a.backgroundFill&&(this.state.fillStyle=y,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(r)}}saveTextStates_(){const t=this.textStrokeState_,r=this.textState_,i=this.textFillState_,s=this.strokeKey_;t&&(s in this.strokeStates||(this.strokeStates[s]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const c=this.textKey_;c in this.textStates||(this.textStates[c]={font:r.font,textAlign:r.textAlign||defaultTextAlign,justify:r.justify,textBaseline:r.textBaseline||defaultTextBaseline,scale:r.scale});const a=this.fillKey_;i&&(a in this.fillStates||(this.fillStates[a]={fillStyle:i.fillStyle}))}drawChars_(t,r){const i=this.textStrokeState_,s=this.textState_,c=this.strokeKey_,a=this.textKey_,h=this.fillKey_;this.saveTextStates_();const p=this.pixelRatio,d=TEXT_ALIGN[s.textBaseline],l=this.textOffsetY_*p,n=this.text_,e=i?i.lineWidth*Math.abs(s.scale[0])/2:0;this.instructions.push([Instruction.DRAW_CHARS,t,r,d,s.overflow,h,s.maxAngle,p,l,c,e*p,n,a,1,this.declutterMode_]),this.hitDetectionInstructions.push([Instruction.DRAW_CHARS,t,r,d,s.overflow,h&&defaultFillStyle,s.maxAngle,p,l,c,e*p,n,a,1/p,this.declutterMode_])}setTextStyle(t,r){let i,s,c;if(!t)this.text_="";else{const a=t.getFill();a?(s=this.textFillState_,s||(s={},this.textFillState_=s),s.fillStyle=asColorLike(a.getColor()||defaultFillStyle)):(s=null,this.textFillState_=s);const h=t.getStroke();if(!h)c=null,this.textStrokeState_=c;else{c=this.textStrokeState_,c||(c={},this.textStrokeState_=c);const u=h.getLineDash(),g=h.getLineDashOffset(),m=h.getWidth(),y=h.getMiterLimit();c.lineCap=h.getLineCap()||defaultLineCap,c.lineDash=u?u.slice():defaultLineDash,c.lineDashOffset=g===void 0?defaultLineDashOffset:g,c.lineJoin=h.getLineJoin()||defaultLineJoin,c.lineWidth=m===void 0?defaultLineWidth:m,c.miterLimit=y===void 0?defaultMiterLimit:y,c.strokeStyle=asColorLike(h.getColor()||defaultStrokeStyle)}i=this.textState_;const p=t.getFont()||defaultFont;registerFont(p);const d=t.getScaleArray();i.overflow=t.getOverflow(),i.font=p,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||defaultTextBaseline,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||defaultPadding,i.scale=d===void 0?[1,1]:d;const l=t.getOffsetX(),n=t.getOffsetY(),e=t.getRotateWithView(),o=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=l===void 0?0:l,this.textOffsetY_=n===void 0?0:n,this.textRotateWithView_=e===void 0?!1:e,this.textRotation_=o===void 0?0:o,this.strokeKey_=c?(typeof c.strokeStyle=="string"?c.strokeStyle:getUid(c.strokeStyle))+c.lineCap+c.lineDashOffset+"|"+c.lineWidth+c.lineJoin+c.miterLimit+"["+c.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=s&&s.fillStyle?typeof s.fillStyle=="string"?s.fillStyle:"|"+getUid(s.fillStyle):""}this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=r}}const BATCH_CONSTRUCTORS={Circle:CanvasPolygonBuilder,Default:CanvasBuilder,Image:CanvasImageBuilder,LineString:CanvasLineStringBuilder,Polygon:CanvasPolygonBuilder,Text:CanvasTextBuilder,Ellipse:CanvasPolygonBuilder};class BuilderGroup{constructor(t,r,i,s){this.tolerance_=t,this.maxExtent_=r,this.pixelRatio_=s,this.resolution_=i,this.buildersByZIndex_={}}finish(){const t={};for(const r in this.buildersByZIndex_){t[r]=t[r]||{};const i=this.buildersByZIndex_[r];for(const s in i){const c=i[s].finish();t[r][s]=c}}return t}getBuilder(t,r){const i=t!==void 0?t.toString():"0";let s=this.buildersByZIndex_[i];s===void 0&&(s={},this.buildersByZIndex_[i]=s);let c=s[r];if(c===void 0){const a=BATCH_CONSTRUCTORS[r];c=new a(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),s[r]=c}return c}}class LayerRenderer extends Observable{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t}getFeatures(t){return abstract()}getData(t){return null}prepareFrame(t){return abstract()}renderFrame(t,r){return abstract()}loadedTileCallback(t,r,i){t[r]||(t[r]={}),t[r][i.tileCoord.toString()]=i}createLoadedTileFinder(t,r,i){return(s,c)=>{const a=this.loadedTileCallback.bind(this,i,s);return t.forEachLoadedTile(r,s,c,a)}}forEachFeatureAtCoordinate(t,r,i,s,c){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const r=t.target;(r.getState()===ImageState.LOADED||r.getState()===ImageState.ERROR)&&this.renderIfReadyAndVisible()}loadImage(t){let r=t.getState();return r!=ImageState.LOADED&&r!=ImageState.ERROR&&t.addEventListener(EventType.CHANGE,this.boundHandleImageChange_),r==ImageState.IDLE&&(t.load(),r=t.getState()),r==ImageState.LOADED}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&t.getSourceState()==="ready"&&t.changed()}renderDeferred(t){}disposeInternal(){delete this.layer_,super.disposeInternal()}}class RenderEvent extends BaseEvent{constructor(t,r,i,s){super(t),this.inversePixelTransform=r,this.frameState=i,this.context=s}}class ZIndexContext{constructor(){ln(this,"pushMethodArgs_",(...t)=>(this.instructions_[this.zIndex+this.offset_].push(t),this));this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(getSharedCanvasContext2D(),{get:(t,r)=>{if(typeof getSharedCanvasContext2D()[r]=="function")return this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(r),this.pushMethodArgs_},set:(t,r,i)=>(this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(r,i),!0)})}pushFunction(t){this.instructions_[this.zIndex+this.offset_].push(t)}getContext(){return this.context_}draw(t){this.instructions_.forEach(r=>{for(let i=0,s=r.length;i<s;++i){const c=r[i];if(typeof c=="function"){c(t);continue}const a=r[++i];if(typeof t[c]=="function")t[c](...a);else{if(typeof a=="function"){t[c]=a(t);continue}t[c]=a}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const canvasPool=[];let pixelContext=null;function createPixelContext(){pixelContext=createCanvasContext2D(1,1,void 0,{willReadFrequently:!0})}class CanvasLayerRenderer extends LayerRenderer{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=create(),this.pixelTransform=create(),this.inversePixelTransform=create(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(t,r,i){pixelContext||createPixelContext(),pixelContext.clearRect(0,0,1,1);let s;try{pixelContext.drawImage(t,r,i,1,1,0,0,1,1),s=pixelContext.getImageData(0,0,1,1).data}catch{return pixelContext=null,null}return s}getBackground(t){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(t.viewState.resolution)),i||void 0}useContainer(t,r,i){const s=this.getLayer().getClassName();let c,a;if(t&&t.className===s&&(!i||t&&t.style.backgroundColor&&equals$2(asArray(t.style.backgroundColor),asArray(i)))){const h=t.firstElementChild;h instanceof HTMLCanvasElement&&(a=h.getContext("2d"))}if(a&&a.canvas.style.transform===r?(this.container=t,this.context=a,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){c=document.createElement("div"),c.className=s;let h=c.style;h.position="absolute",h.width="100%",h.height="100%",a=createCanvasContext2D();const p=a.canvas;c.appendChild(p),h=p.style,h.position="absolute",h.left="0",h.transformOrigin="top left",this.container=c,this.context=a}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(t,r,i){const s=getTopLeft(i),c=getTopRight(i),a=getBottomRight(i),h=getBottomLeft(i);apply(r.coordinateToPixelTransform,s),apply(r.coordinateToPixelTransform,c),apply(r.coordinateToPixelTransform,a),apply(r.coordinateToPixelTransform,h);const p=this.inversePixelTransform;apply(p,s),apply(p,c),apply(p,a),apply(p,h),t.save(),t.beginPath(),t.moveTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(c[0]),Math.round(c[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.lineTo(Math.round(h[0]),Math.round(h[1])),t.clip()}prepareContainer(t,r){const i=t.extent,s=t.viewState.resolution,c=t.viewState.rotation,a=t.pixelRatio,h=Math.round(getWidth(i)/s*a),p=Math.round(getHeight(i)/s*a);compose(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/a,1/a,c,-h/2,-p/2),makeInverse(this.inversePixelTransform,this.pixelTransform);const d=toString$1(this.pixelTransform);if(this.useContainer(r,d,this.getBackground(t)),!this.containerReused){const l=this.context.canvas;l.width!=h||l.height!=p?(l.width=h,l.height=p):this.context.clearRect(0,0,h,p),d!==l.style.transform&&(l.style.transform=d)}}dispatchRenderEvent_(t,r,i){const s=this.getLayer();if(s.hasListener(t)){const c=new RenderEvent(t,this.inversePixelTransform,i,r);s.dispatchEvent(c)}}preRender(t,r){this.frameState=r,!r.declutter&&this.dispatchRenderEvent_(RenderEventType.PRERENDER,t,r)}postRender(t,r){r.declutter||this.dispatchRenderEvent_(RenderEventType.POSTRENDER,t,r)}renderDeferredInternal(t){}getRenderContext(t){return t.declutter&&!this.deferredContext_&&(this.deferredContext_=new ZIndexContext),t.declutter?this.deferredContext_.getContext():this.context}renderDeferred(t){t.declutter&&(this.dispatchRenderEvent_(RenderEventType.PRERENDER,this.context,t),t.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(t),this.dispatchRenderEvent_(RenderEventType.POSTRENDER,this.context,t))}getRenderTransform(t,r,i,s,c,a,h){const p=c/2,d=a/2,l=s/r,n=-l,e=-t[0]+h,o=-t[1];return compose(this.tempTransform,p,d,l,n,-i,e,o)}disposeInternal(){delete this.frameState,super.disposeInternal()}}function drawTextOnPath(f,t,r,i,s,c,a,h,p,d,l,n){let e=f[t],o=f[t+1],u=0,g=0,m=0,y=0;function b(){u=e,g=o,t+=i,e=f[t],o=f[t+1],y+=m,m=Math.sqrt((e-u)*(e-u)+(o-g)*(o-g))}do b();while(t<r-i&&y+m<c);let _=m===0?0:(c-y)/m;const x=lerp(u,e,_),w=lerp(g,o,_),T=t-i,S=y,I=c+h*p(d,s,l);for(;t<r-i&&y+m<I;)b();_=m===0?0:(I-y)/m;const v=lerp(u,e,_),A=lerp(g,o,_);let L;if(n){const O=[x,w,v,A];rotate(O,0,4,2,n,O,O),L=O[0]>O[2]}else L=x>v;const N=Math.PI,$=[],D=T+i===t;t=T,m=0,y=S,e=f[t],o=f[t+1];let R;if(D){b(),R=Math.atan2(o-g,e-u),L&&(R+=R>0?-N:N);const O=(v+x)/2,F=(A+w)/2;return $[0]=[O,F,(I-c)/2,R,s],$}s=s.replace(/\n/g," ");for(let O=0,F=s.length;O<F;){b();let z=Math.atan2(o-g,e-u);if(L&&(z+=z>0?-N:N),R!==void 0){let K=z-R;if(K+=K>N?-2*N:K<-N?2*N:0,Math.abs(K)>a)return null}R=z;const W=O;let Z=0;for(;O<F;++O){const K=L?F-O-1:O,st=h*p(d,s[K],l);if(t+i<r&&y+m<c+Z+st/2)break;Z+=st}if(O===W)continue;const J=L?s.substring(F-W,F-O):s.substring(W,O);_=m===0?0:(c+Z/2-y)/m;const nt=lerp(u,e,_),wt=lerp(g,o,_);$.push([nt,wt,Z/2,z,J]),c+=Z}return $}function lineStringLength(f,t,r,i){let s=f[t],c=f[t+1],a=0;for(let h=t+i;h<r;h+=i){const p=f[h],d=f[h+1];a+=Math.sqrt((p-s)*(p-s)+(d-c)*(d-c)),s=p,c=d}return a}const tmpExtent=createEmpty(),p1=[],p2=[],p3=[],p4=[];function getDeclutterBox(f){return f[3].declutterBox}const rtlRegEx=new RegExp("[֑-ࣿיִ-﷿ﹰ-ﻼࠀ-࿿-]");function horizontalTextAlign(f,t){return t==="start"?t=rtlRegEx.test(f)?"right":"left":t==="end"&&(t=rtlRegEx.test(f)?"left":"right"),TEXT_ALIGN[t]}function createTextChunks(f,t,r){return r>0&&f.push(`
`,""),f.push(t,""),f}class Executor{constructor(t,r,i,s,c){this.overlaps=i,this.pixelRatio=r,this.resolution=t,this.alignAndScaleFill_,this.instructions=s.instructions,this.coordinates=s.coordinates,this.coordinateCache_={},this.renderedTransform_=create(),this.hitDetectionInstructions=s.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=s.fillStates||{},this.strokeStates=s.strokeStates||{},this.textStates=s.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=c?new ZIndexContext:null}getZIndexContext(){return this.zIndexContext_}createLabel(t,r,i,s){const c=t+r+i+s;if(this.labels_[c])return this.labels_[c];const a=s?this.strokeStates[s]:null,h=i?this.fillStates[i]:null,p=this.textStates[r],d=this.pixelRatio,l=[p.scale[0]*d,p.scale[1]*d],n=Array.isArray(t),e=p.justify?TEXT_ALIGN[p.justify]:horizontalTextAlign(Array.isArray(t)?t[0]:t,p.textAlign||defaultTextAlign),o=s&&a.lineWidth?a.lineWidth:0,u=n?t:t.split(`
`).reduce(createTextChunks,[]),{width:g,height:m,widths:y,heights:b,lineWidths:_}=getTextDimensions(p,u),x=g+o,w=[],T=(x+2)*l[0],S=(m+o)*l[1],I={width:T<0?Math.floor(T):Math.ceil(T),height:S<0?Math.floor(S):Math.ceil(S),contextInstructions:w};(l[0]!=1||l[1]!=1)&&w.push("scale",l),s&&(w.push("strokeStyle",a.strokeStyle),w.push("lineWidth",o),w.push("lineCap",a.lineCap),w.push("lineJoin",a.lineJoin),w.push("miterLimit",a.miterLimit),w.push("setLineDash",[a.lineDash]),w.push("lineDashOffset",a.lineDashOffset)),i&&w.push("fillStyle",h.fillStyle),w.push("textBaseline","middle"),w.push("textAlign","center");const v=.5-e;let A=e*x+v*o;const L=[],N=[];let $=0,D=0,R=0,O=0,F;for(let z=0,W=u.length;z<W;z+=2){const Z=u[z];if(Z===`
`){D+=$,$=0,A=e*x+v*o,++O;continue}const J=u[z+1]||p.font;J!==F&&(s&&L.push("font",J),i&&N.push("font",J),F=J),$=Math.max($,b[R]);const nt=[Z,A+v*y[R]+e*(y[R]-_[O]),.5*(o+$)+D];A+=y[R],s&&L.push("strokeText",nt),i&&N.push("fillText",nt),++R}return Array.prototype.push.apply(w,L),Array.prototype.push.apply(w,N),this.labels_[c]=I,I}replayTextBackground_(t,r,i,s,c,a,h){t.beginPath(),t.moveTo.apply(t,r),t.lineTo.apply(t,i),t.lineTo.apply(t,s),t.lineTo.apply(t,c),t.lineTo.apply(t,r),a&&(this.alignAndScaleFill_=a[2],this.fill_(t)),h&&(this.setStrokeStyle_(t,h),t.stroke())}calculateImageOrLabelDimensions_(t,r,i,s,c,a,h,p,d,l,n,e,o,u,g,m){h*=e[0],p*=e[1];let y=i-h,b=s-p;const _=c+d>t?t-d:c,x=a+l>r?r-l:a,w=u[3]+_*e[0]+u[1],T=u[0]+x*e[1]+u[2],S=y-u[3],I=b-u[0];(g||n!==0)&&(p1[0]=S,p4[0]=S,p1[1]=I,p2[1]=I,p2[0]=S+w,p3[0]=p2[0],p3[1]=I+T,p4[1]=p3[1]);let v;return n!==0?(v=compose(create(),i,s,1,1,n,-i,-s),apply(v,p1),apply(v,p2),apply(v,p3),apply(v,p4),createOrUpdate(Math.min(p1[0],p2[0],p3[0],p4[0]),Math.min(p1[1],p2[1],p3[1],p4[1]),Math.max(p1[0],p2[0],p3[0],p4[0]),Math.max(p1[1],p2[1],p3[1],p4[1]),tmpExtent)):createOrUpdate(Math.min(S,S+w),Math.min(I,I+T),Math.max(S,S+w),Math.max(I,I+T),tmpExtent),o&&(y=Math.round(y),b=Math.round(b)),{drawImageX:y,drawImageY:b,drawImageW:_,drawImageH:x,originX:d,originY:l,declutterBox:{minX:tmpExtent[0],minY:tmpExtent[1],maxX:tmpExtent[2],maxY:tmpExtent[3],value:m},canvasTransform:v,scale:e}}replayImageOrLabel_(t,r,i,s,c,a,h){const p=!!(a||h),d=s.declutterBox,l=h?h[2]*s.scale[0]/2:0;return d.minX-l<=r[0]&&d.maxX+l>=0&&d.minY-l<=r[1]&&d.maxY+l>=0&&(p&&this.replayTextBackground_(t,p1,p2,p3,p4,a,h),drawImageOrLabel(t,s.canvasTransform,c,i,s.originX,s.originY,s.drawImageW,s.drawImageH,s.drawImageX,s.drawImageY,s.scale)),!0}fill_(t){const r=this.alignAndScaleFill_;if(r){const i=apply(this.renderedTransform_,[0,0]),s=512*this.pixelRatio;t.save(),t.translate(i[0]%s,i[1]%s),r!==1&&t.scale(r,r),t.rotate(this.viewRotation_)}t.fill(),r&&t.restore()}setStrokeStyle_(t,r){t.strokeStyle=r[1],t.lineWidth=r[2],t.lineCap=r[3],t.lineJoin=r[4],t.miterLimit=r[5],t.lineDashOffset=r[7],t.setLineDash(r[6])}drawLabelWithPointPlacement_(t,r,i,s){const c=this.textStates[r],a=this.createLabel(t,r,s,i),h=this.strokeStates[i],p=this.pixelRatio,d=horizontalTextAlign(Array.isArray(t)?t[0]:t,c.textAlign||defaultTextAlign),l=TEXT_ALIGN[c.textBaseline||defaultTextBaseline],n=h&&h.lineWidth?h.lineWidth:0,e=a.width/p-2*c.scale[0],o=d*e+2*(.5-d)*n,u=l*a.height/p+2*(.5-l)*n;return{label:a,anchorX:o,anchorY:u}}execute_(t,r,i,s,c,a,h,p){const d=this.zIndexContext_;let l;this.pixelCoordinates_&&equals$2(i,this.renderedTransform_)?l=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),l=transform2D(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),setFromArray(this.renderedTransform_,i));let n=0;const e=s.length;let o=0,u,g,m,y,b,_,x,w,T,S,I,v,A,L=0,N=0,$=null,D=null;const R=this.coordinateCache_,O=this.viewRotation_,F=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,z={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:O},W=this.instructions!=s||this.overlaps?0:200;let Z,J,nt,wt;for(;n<e;){const K=s[n];switch(K[0]){case Instruction.BEGIN_GEOMETRY:Z=K[1],wt=K[3],Z.getGeometry()?h!==void 0&&!intersects$1(h,wt.getExtent())?n=K[2]+1:++n:n=K[2],d&&(d.zIndex=K[4]);break;case Instruction.BEGIN_PATH:L>W&&(this.fill_(t),L=0),N>W&&(t.stroke(),N=0),!L&&!N&&(t.beginPath(),b=NaN,_=NaN),++n;break;case Instruction.CIRCLE:o=K[1];const Tt=l[o],xt=l[o+1],$t=l[o+2],Qt=l[o+3],Ot=$t-Tt,Ft=Qt-xt,Mt=Math.sqrt(Ot*Ot+Ft*Ft);t.moveTo(Tt+Mt,xt),t.arc(Tt,xt,Mt,0,2*Math.PI,!0),++n;break;case Instruction.ELLIPSE:o=K[1],u=K[2];const St=l[o],vt=l[o+1],jt=l[o+2],Gt=l[o+3],zt=l[o+4],Xt=l[o+5],Kt=l[o+6],Wt=l[o+7];if(u-o===8){const Ct=(zt-St)*.2761424,Bt=(Xt-vt)*.2761424,Pt=(Kt-jt)*.2761424,Lt=(Wt-Gt)*.2761424;t.moveTo(St,vt),t.bezierCurveTo(St-Pt,vt-Lt,jt-Ct,Gt-Bt,jt,Gt),t.bezierCurveTo(jt+Ct,Gt+Bt,zt-Pt,Xt-Lt,zt,Xt),t.bezierCurveTo(zt+Pt,Xt+Lt,Kt+Ct,Wt+Bt,Kt,Wt),t.bezierCurveTo(Kt-Ct,Wt-Bt,St+Pt,vt+Lt,St,vt)}++n;break;case Instruction.CLOSE_PATH:t.closePath(),++n;break;case Instruction.CUSTOM:o=K[1],u=K[2];const Yt=K[3],It=K[4],Ht=K[5];z.geometry=Yt,z.feature=Z,n in R||(R[n]=[]);const qt=R[n];Ht?Ht(l,o,u,2,qt):(qt[0]=l[o],qt[1]=l[o+1],qt.length=2),d&&(d.zIndex=K[6]),It(qt,z),++n;break;case Instruction.DRAW_IMAGE:o=K[1],u=K[2],T=K[3],g=K[4],m=K[5];let ct=K[6];const Ee=K[7],xe=K[8],Oe=K[9],ee=K[10];let le=K[11];const ve=K[12];let Dt=K[13];y=K[14]||"declutter";const te=K[15];if(!T&&K.length>=20){S=K[19],I=K[20],v=K[21],A=K[22];const Ct=this.drawLabelWithPointPlacement_(S,I,v,A);T=Ct.label,K[3]=T;const Bt=K[23];g=(Ct.anchorX-Bt)*this.pixelRatio,K[4]=g;const Pt=K[24];m=(Ct.anchorY-Pt)*this.pixelRatio,K[5]=m,ct=T.height,K[6]=ct,Dt=T.width,K[13]=Dt}let ot;K.length>25&&(ot=K[25]);let ne,de,pe;K.length>17?(ne=K[16],de=K[17],pe=K[18]):(ne=defaultPadding,de=!1,pe=!1),ee&&F?le+=O:!ee&&!F&&(le-=O);let oe=0;for(;o<u;o+=2){if(ot&&ot[oe++]<Dt/this.pixelRatio)continue;const Ct=this.calculateImageOrLabelDimensions_(T.width,T.height,l[o],l[o+1],Dt,ct,g,m,xe,Oe,le,ve,c,ne,de||pe,Z),Bt=[t,r,T,Ct,Ee,de?$:null,pe?D:null];if(p){let Pt,Lt,Ut;if(te){const M=u-o;if(!te[M]){te[M]={args:Bt,declutterMode:y};continue}const B=te[M];Pt=B.args,Lt=B.declutterMode,delete te[M],Ut=getDeclutterBox(Pt)}let Zt,P;if(Pt&&(Lt!=="declutter"||!p.collides(Ut))&&(Zt=!0),(y!=="declutter"||!p.collides(Ct.declutterBox))&&(P=!0),Lt==="declutter"&&y==="declutter"){const M=Zt&&P;Zt=M,P=M}Zt&&(Lt!=="none"&&p.insert(Ut),this.replayImageOrLabel_.apply(this,Pt)),P&&(y!=="none"&&p.insert(Ct.declutterBox),this.replayImageOrLabel_.apply(this,Bt))}else this.replayImageOrLabel_.apply(this,Bt)}++n;break;case Instruction.DRAW_CHARS:const bt=K[1],ce=K[2],ge=K[3],me=K[4];A=K[5];const lt=K[6],at=K[7],ut=K[8];v=K[9];const ye=K[10];S=K[11],I=K[12];const he=[K[13],K[13]];y=K[14]||"declutter";const be=this.textStates[I],se=be.font,ae=[be.scale[0]*at,be.scale[1]*at];let ue;se in this.widths_?ue=this.widths_[se]:(ue={},this.widths_[se]=ue);const Te=lineStringLength(l,bt,ce,2),Se=Math.abs(ae[0])*measureAndCacheTextWidth(se,S,ue);if(me||Se<=Te){const Ct=this.textStates[I].textAlign,Bt=(Te-Se)*horizontalTextAlign(S,Ct),Pt=drawTextOnPath(l,bt,ce,2,S,Bt,lt,Math.abs(ae[0]),measureAndCacheTextWidth,se,ue,F?0:this.viewRotation_);t:if(Pt){const Lt=[];let Ut,Zt,P,M,B;if(v)for(Ut=0,Zt=Pt.length;Ut<Zt;++Ut){B=Pt[Ut],P=B[4],M=this.createLabel(P,I,"",v),g=B[2]+(ae[0]<0?-ye:ye),m=ge*M.height+(.5-ge)*2*ye*ae[1]/ae[0]-ut;const U=this.calculateImageOrLabelDimensions_(M.width,M.height,B[0],B[1],M.width,M.height,g,m,0,0,B[3],he,!1,defaultPadding,!1,Z);if(p&&y==="declutter"&&p.collides(U.declutterBox))break t;Lt.push([t,r,M,U,1,null,null])}if(A)for(Ut=0,Zt=Pt.length;Ut<Zt;++Ut){B=Pt[Ut],P=B[4],M=this.createLabel(P,I,A,""),g=B[2],m=ge*M.height-ut;const U=this.calculateImageOrLabelDimensions_(M.width,M.height,B[0],B[1],M.width,M.height,g,m,0,0,B[3],he,!1,defaultPadding,!1,Z);if(p&&y==="declutter"&&p.collides(U.declutterBox))break t;Lt.push([t,r,M,U,1,null,null])}p&&y!=="none"&&p.load(Lt.map(getDeclutterBox));for(let U=0,G=Lt.length;U<G;++U)this.replayImageOrLabel_.apply(this,Lt[U])}}++n;break;case Instruction.END_GEOMETRY:if(a!==void 0){Z=K[1];const Ct=a(Z,wt,y);if(Ct)return Ct}++n;break;case Instruction.FILL:W?L++:this.fill_(t),++n;break;case Instruction.MOVE_TO_LINE_TO:for(o=K[1],u=K[2],J=l[o],nt=l[o+1],t.moveTo(J,nt),b=J+.5|0,_=nt+.5|0,o+=2;o<u;o+=2)J=l[o],nt=l[o+1],x=J+.5|0,w=nt+.5|0,(o==u-2||x!==b||w!==_)&&(t.lineTo(J,nt),b=x,_=w);++n;break;case Instruction.SET_FILL_STYLE:$=K,this.alignAndScaleFill_=K[2],L&&(this.fill_(t),L=0,N&&(t.stroke(),N=0)),t.fillStyle=K[1],++n;break;case Instruction.SET_STROKE_STYLE:D=K,N&&(t.stroke(),N=0),this.setStrokeStyle_(t,K),++n;break;case Instruction.STROKE:W?N++:t.stroke(),++n;break;default:++n;break}}L&&this.fill_(t),N&&t.stroke()}execute(t,r,i,s,c,a){this.viewRotation_=s,this.execute_(t,r,i,this.instructions,c,void 0,void 0,a)}executeHitDetection(t,r,i,s,c){return this.viewRotation_=i,this.execute_(t,[t.canvas.width,t.canvas.height],r,this.hitDetectionInstructions,!0,s,c)}}const ALL=["Polygon","Circle","Ellipse","LineString","Image","Text","Default"],DECLUTTER=["Image","Text"],NON_DECLUTTER=ALL.filter(f=>!DECLUTTER.includes(f));class ExecutorGroup{constructor(t,r,i,s,c,a,h){this.maxExtent_=t,this.overlaps_=s,this.pixelRatio_=i,this.resolution_=r,this.renderBuffer_=a,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=create(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(c,h)}clip(t,r){const i=this.getClipCoords(r);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t,r){for(const i in t){let s=this.executorsByZIndex_[i];s===void 0&&(s={},this.executorsByZIndex_[i]=s);const c=t[i];for(const a in c){const h=c[a];s[a]=new Executor(this.resolution_,this.pixelRatio_,this.overlaps_,h,r)}}}hasExecutors(t){for(const r in this.executorsByZIndex_){const i=this.executorsByZIndex_[r];for(let s=0,c=t.length;s<c;++s)if(t[s]in i)return!0}return!1}forEachFeatureAtCoordinate(t,r,i,s,c,a){s=Math.round(s);const h=s*2+1,p=compose(this.hitDetectionTransform_,s+.5,s+.5,1/r,-1/r,-i,-t[0],-t[1]),d=!this.hitDetectionContext_;d&&(this.hitDetectionContext_=createCanvasContext2D(h,h,void 0,{willReadFrequently:!0}));const l=this.hitDetectionContext_;l.canvas.width!==h||l.canvas.height!==h?(l.canvas.width=h,l.canvas.height=h):d||l.clearRect(0,0,h,h);let n;this.renderBuffer_!==void 0&&(n=createEmpty(),extendCoordinate(n,t),buffer(n,r*(this.renderBuffer_+s),n));const e=getPixelIndexArray(s);let o;function u(w,T,S){const I=l.getImageData(0,0,h,h).data;for(let v=0,A=e.length;v<A;v++)if(I[e[v]]>0){if(!a||S==="none"||o!=="Image"&&o!=="Text"||a.includes(w)){const L=(e[v]-3)/4,N=s-L%h,$=s-(L/h|0),D=c(w,T,N*N+$*$);if(D)return D}l.clearRect(0,0,h,h);break}}const g=Object.keys(this.executorsByZIndex_).map(Number);g.sort(ascending);let m,y,b,_,x;for(m=g.length-1;m>=0;--m){const w=g[m].toString();for(b=this.executorsByZIndex_[w],y=ALL.length-1;y>=0;--y)if(o=ALL[y],_=b[o],_!==void 0&&(x=_.executeHitDetection(l,p,i,u,n),x))return x}}getClipCoords(t){const r=this.maxExtent_;if(!r)return null;const i=r[0],s=r[1],c=r[2],a=r[3],h=[i,s,i,a,c,a,c,s];return transform2D(h,0,8,2,t,h),h}isEmpty(){return isEmpty$1(this.executorsByZIndex_)}execute(t,r,i,s,c,a,h){const p=Object.keys(this.executorsByZIndex_).map(Number);p.sort(ascending),a=a||ALL;const d=ALL.length;let l,n,e,o,u;for(h&&p.reverse(),l=0,n=p.length;l<n;++l){const g=p[l].toString();for(u=this.executorsByZIndex_[g],e=0,o=a.length;e<o;++e){const m=a[e],y=u[m];if(y!==void 0){const b=h===null?void 0:y.getZIndexContext(),_=b?b.getContext():t,x=this.maxExtent_&&m!=="Image"&&m!=="Text";if(x&&(_.save(),this.clip(_,i)),!b||m==="Text"||m==="Image"?y.execute(_,r,i,s,c,h):b.pushFunction(w=>y.execute(w,r,i,s,c,h)),x&&_.restore(),b){b.offset();const w=p[l]*d+e;this.deferredZIndexContexts_[w]||(this.deferredZIndexContexts_[w]=[]),this.deferredZIndexContexts_[w].push(b)}}}}this.renderedContext_=t}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const t=this.deferredZIndexContexts_,r=Object.keys(t).map(Number).sort(ascending);for(let i=0,s=r.length;i<s;++i)t[r[i]].forEach(c=>{c.draw(this.renderedContext_),c.clear()}),t[r[i]].length=0}}const circlePixelIndexArrayCache={};function getPixelIndexArray(f){if(circlePixelIndexArrayCache[f]!==void 0)return circlePixelIndexArrayCache[f];const t=f*2+1,r=f*f,i=new Array(r+1);for(let c=0;c<=f;++c)for(let a=0;a<=f;++a){const h=c*c+a*a;if(h>r)break;let p=i[h];p||(p=[],i[h]=p),p.push(((f+c)*t+(f+a))*4+3),c>0&&p.push(((f-c)*t+(f+a))*4+3),a>0&&(p.push(((f+c)*t+(f-a))*4+3),c>0&&p.push(((f-c)*t+(f-a))*4+3))}const s=[];for(let c=0,a=i.length;c<a;++c)i[c]&&s.push(...i[c]);return circlePixelIndexArrayCache[f]=s,s}class CanvasImmediateRenderer extends VectorContext{constructor(t,r,i,s,c,a,h){super(),this.context_=t,this.pixelRatio_=r,this.extent_=i,this.transform_=s,this.transformRotation_=s?toFixed(Math.atan2(s[1],s[0]),10):0,this.viewRotation_=c,this.squaredTolerance_=a,this.userTransform_=h,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=create()}drawImages_(t,r,i,s){if(!this.image_)return;const c=transform2D(t,r,i,s,this.transform_,this.pixelCoordinates_),a=this.context_,h=this.tmpLocalTransform_,p=a.globalAlpha;this.imageOpacity_!=1&&(a.globalAlpha=p*this.imageOpacity_);let d=this.imageRotation_;this.transformRotation_===0&&(d-=this.viewRotation_),this.imageRotateWithView_&&(d+=this.viewRotation_);for(let l=0,n=c.length;l<n;l+=2){const e=c[l]-this.imageAnchorX_,o=c[l+1]-this.imageAnchorY_;if(d!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const u=e+this.imageAnchorX_,g=o+this.imageAnchorY_;compose(h,u,g,1,1,d,-u,-g),a.save(),a.transform.apply(a,h),a.translate(u,g),a.scale(this.imageScale_[0],this.imageScale_[1]),a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),a.restore()}else a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,e,o,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(a.globalAlpha=p)}drawText_(t,r,i,s){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const c=transform2D(t,r,i,s,this.transform_,this.pixelCoordinates_),a=this.context_;let h=this.textRotation_;for(this.transformRotation_===0&&(h-=this.viewRotation_),this.textRotateWithView_&&(h+=this.viewRotation_);r<i;r+=s){const p=c[r]+this.textOffsetX_,d=c[r+1]+this.textOffsetY_;h!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(a.save(),a.translate(p-this.textOffsetX_,d-this.textOffsetY_),a.rotate(h),a.translate(this.textOffsetX_,this.textOffsetY_),a.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&a.strokeText(this.text_,0,0),this.textFillState_&&a.fillText(this.text_,0,0),a.restore()):(this.textStrokeState_&&a.strokeText(this.text_,p,d),this.textFillState_&&a.fillText(this.text_,p,d))}}moveToLineTo_(t,r,i,s,c){const a=this.context_,h=transform2D(t,r,i,s,this.transform_,this.pixelCoordinates_);a.moveTo(h[0],h[1]);let p=h.length;c&&(p-=2);for(let d=2;d<p;d+=2)a.lineTo(h[d],h[d+1]);return c&&a.closePath(),i}drawRings_(t,r,i,s){for(let c=0,a=i.length;c<a;++c)r=this.moveToLineTo_(t,r,i[c],s,!0);return r}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!intersects$1(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const r=transformGeom2D(t,this.transform_,this.pixelCoordinates_),i=r[2]-r[0],s=r[3]-r[1],c=Math.sqrt(i*i+s*s),a=this.context_;a.beginPath(),a.arc(r[0],r[1],c,0,2*Math.PI),this.fillState_&&a.fill(),this.strokeState_&&a.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":case"Rectangle":case"Ellipse":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t);break}}drawFeature(t,r){const i=r.getGeometryFunction()(t);i&&(this.setStyle(r),this.drawGeometry(i))}drawGeometryCollection(t){const r=t.getGeometriesArray();for(let i=0,s=r.length;i<s;++i)this.drawGeometry(r[i])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const r=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(r,0,r.length,i),this.text_!==""&&this.drawText_(r,0,r.length,i)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const r=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(r,0,r.length,i),this.text_!==""&&this.drawText_(r,0,r.length,i)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!intersects$1(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const r=this.context_,i=t.getFlatCoordinates();r.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),r.stroke()}if(this.text_!==""){const r=t.getFlatMidpoint();this.drawText_(r,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const r=t.getExtent();if(intersects$1(this.extent_,r)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,s=t.getFlatCoordinates();let c=0;const a=t.getEnds(),h=t.getStride();i.beginPath();for(let p=0,d=a.length;p<d;++p)c=this.moveToLineTo_(s,c,a[p],h,!1);i.stroke()}if(this.text_!==""){const i=t.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!intersects$1(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const r=this.context_;r.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&r.fill(),this.strokeState_&&r.stroke()}if(this.text_!==""){const r=t.getFlatInteriorPoint();this.drawText_(r,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!intersects$1(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const r=this.context_,i=t.getOrientedFlatCoordinates();let s=0;const c=t.getEndss(),a=t.getStride();r.beginPath();for(let h=0,p=c.length;h<p;++h){const d=c[h];s=this.drawRings_(i,s,d,a)}this.fillState_&&r.fill(),this.strokeState_&&r.stroke()}if(this.text_!==""){const r=t.getFlatInteriorPoints();this.drawText_(r,0,r.length,2)}}}setContextFillState_(t){const r=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,r.fillStyle=t.fillStyle):(r.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const r=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,r.lineCap=t.lineCap),equals$2(i.lineDash,t.lineDash)||r.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,r.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,r.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,r.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,r.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,r.strokeStyle=t.strokeStyle)):(r.lineCap=t.lineCap,r.setLineDash(t.lineDash),r.lineDashOffset=t.lineDashOffset,r.lineJoin=t.lineJoin,r.lineWidth=t.lineWidth,r.miterLimit=t.miterLimit,r.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const r=this.context_,i=this.contextTextState_,s=t.textAlign?t.textAlign:defaultTextAlign;i?(i.font!=t.font&&(i.font=t.font,r.font=t.font),i.textAlign!=s&&(i.textAlign=s,r.textAlign=s),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,r.textBaseline=t.textBaseline)):(r.font=t.font,r.textAlign=s,r.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:s,textBaseline:t.textBaseline})}setFillStrokeStyle(t,r){if(!t)this.fillState_=null;else{const i=t.getColor();this.fillState_={fillStyle:asColorLike(i||defaultFillStyle)}}if(!r)this.strokeState_=null;else{const i=r.getColor(),s=r.getLineCap(),c=r.getLineDash(),a=r.getLineDashOffset(),h=r.getLineJoin(),p=r.getWidth(),d=r.getMiterLimit(),l=c||defaultLineDash;this.strokeState_={lineCap:s!==void 0?s:defaultLineCap,lineDash:this.pixelRatio_===1?l:l.map(n=>n*this.pixelRatio_),lineDashOffset:(a||defaultLineDashOffset)*this.pixelRatio_,lineJoin:h!==void 0?h:defaultLineJoin,lineWidth:(p!==void 0?p:defaultLineWidth)*this.pixelRatio_,miterLimit:d!==void 0?d:defaultMiterLimit,strokeStyle:asColorLike(i||defaultStrokeStyle)}}}setImageStyle(t){let r;if(!t||!(r=t.getSize())){this.image_=null;return}const i=t.getPixelRatio(this.pixelRatio_),s=t.getAnchor(),c=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=s[0]*i,this.imageAnchorY_=s[1]*i,this.imageHeight_=r[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=c[0],this.imageOriginY_=c[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const a=t.getScaleArray();this.imageScale_=[a[0]*this.pixelRatio_/i,a[1]*this.pixelRatio_/i],this.imageWidth_=r[0]*i}setTextStyle(t){if(!t)this.text_="";else{const r=t.getFill();if(!r)this.textFillState_=null;else{const o=r.getColor();this.textFillState_={fillStyle:asColorLike(o||defaultFillStyle)}}const i=t.getStroke();if(!i)this.textStrokeState_=null;else{const o=i.getColor(),u=i.getLineCap(),g=i.getLineDash(),m=i.getLineDashOffset(),y=i.getLineJoin(),b=i.getWidth(),_=i.getMiterLimit();this.textStrokeState_={lineCap:u!==void 0?u:defaultLineCap,lineDash:g||defaultLineDash,lineDashOffset:m||defaultLineDashOffset,lineJoin:y!==void 0?y:defaultLineJoin,lineWidth:b!==void 0?b:defaultLineWidth,miterLimit:_!==void 0?_:defaultMiterLimit,strokeStyle:asColorLike(o||defaultStrokeStyle)}}const s=t.getFont(),c=t.getOffsetX(),a=t.getOffsetY(),h=t.getRotateWithView(),p=t.getRotation(),d=t.getScaleArray(),l=t.getText(),n=t.getTextAlign(),e=t.getTextBaseline();this.textState_={font:s!==void 0?s:defaultFont,textAlign:n!==void 0?n:defaultTextAlign,textBaseline:e!==void 0?e:defaultTextBaseline},this.text_=l!==void 0?Array.isArray(l)?l.reduce((o,u,g)=>o+=g%2?" ":u,""):l:"",this.textOffsetX_=c!==void 0?this.pixelRatio_*c:0,this.textOffsetY_=a!==void 0?this.pixelRatio_*a:0,this.textRotateWithView_=h!==void 0?h:!1,this.textRotation_=p!==void 0?p:0,this.textScale_=[this.pixelRatio_*d[0],this.pixelRatio_*d[1]]}}}const HIT_DETECT_RESOLUTION=.5;function createHitDetectionImageData(f,t,r,i,s,c,a,h,p){const d=s,l=f[0]*HIT_DETECT_RESOLUTION,n=f[1]*HIT_DETECT_RESOLUTION,e=createCanvasContext2D(l,n);e.imageSmoothingEnabled=!1;const o=e.canvas,u=new CanvasImmediateRenderer(e,HIT_DETECT_RESOLUTION,s,null,a,h,null),g=r.length,m=Math.floor((256*256*256-1)/g),y={};for(let _=1;_<=g;++_){const x=r[_-1],w=x.getStyleFunction()||i;if(!w)continue;let T=w(x,c);if(!T)continue;Array.isArray(T)||(T=[T]);const I=(_*m).toString(16).padStart(7,"#00000");for(let v=0,A=T.length;v<A;++v){const L=T[v],N=L.getGeometryFunction()(x);if(!N||!intersects$1(d,N.getExtent()))continue;const $=L.clone(),D=$.getFill();D&&D.setColor(I);const R=$.getStroke();R&&(R.setColor(I),R.setLineDash(null)),$.setText(void 0);const O=L.getImage();if(O){const Z=O.getImageSize();if(!Z)continue;const J=createCanvasContext2D(Z[0],Z[1],void 0,{alpha:!1}),nt=J.canvas;J.fillStyle=I,J.fillRect(0,0,nt.width,nt.height),$.setImage(new Icon({img:nt,anchor:O.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:O.getOrigin(),opacity:1,size:O.getSize(),scale:O.getScale(),rotation:O.getRotation(),rotateWithView:O.getRotateWithView()}))}const F=$.getZIndex()||0;let z=y[F];z||(z={},y[F]=z,z.Polygon=[],z.Circle=[],z.LineString=[],z.Point=[]);const W=N.getType();if(W==="GeometryCollection"){const Z=N.getGeometriesArrayRecursive();for(let J=0,nt=Z.length;J<nt;++J){const wt=Z[J];z[wt.getType().replace("Multi","")].push(wt,$)}}else z[W.replace("Multi","")].push(N,$)}}const b=Object.keys(y).map(Number).sort(ascending);for(let _=0,x=b.length;_<x;++_){const w=y[b[_]];for(const T in w){const S=w[T];for(let I=0,v=S.length;I<v;I+=2){u.setStyle(S[I+1]);for(let A=0,L=t.length;A<L;++A)u.setTransform(t[A]),u.drawGeometry(S[I])}}}return e.getImageData(0,0,o.width,o.height)}function hitDetect(f,t,r){const i=[];if(r){const s=Math.floor(Math.round(f[0])*HIT_DETECT_RESOLUTION),c=Math.floor(Math.round(f[1])*HIT_DETECT_RESOLUTION),a=(clamp(s,0,r.width-1)+clamp(c,0,r.height-1)*r.width)*4,h=r.data[a],p=r.data[a+1],l=r.data[a+2]+256*(p+256*h),n=Math.floor((256*256*256-1)/t.length);l&&l%n===0&&i.push(t[l/n-1])}return i}const SIMPLIFY_TOLERANCE=.5,GEOMETRY_RENDERERS={Point:renderPointGeometry,LineString:renderLineStringGeometry,Polygon:renderPolygonGeometry,MultiPoint:renderMultiPointGeometry,MultiLineString:renderMultiLineStringGeometry,MultiPolygon:renderMultiPolygonGeometry,GeometryCollection:renderGeometryCollectionGeometry,Circle:renderCircleGeometry,Rectangle:renderPolygonGeometry,Ellipse:renderEllipseGeometry};function defaultOrder(f,t){return parseInt(getUid(f),10)-parseInt(getUid(t),10)}function getSquaredTolerance(f,t){const r=getTolerance(f,t);return r*r}function getTolerance(f,t){return SIMPLIFY_TOLERANCE*f/t}function renderCircleGeometry(f,t,r,i,s){const c=r.getFill(),a=r.getStroke();if(c||a){const p=f.getBuilder(r.getZIndex(),"Circle");p.setFillStrokeStyle(c,a),p.drawCircle(t,i,s)}const h=r.getText();if(h&&h.getText()){const p=f.getBuilder(r.getZIndex(),"Text");p.setTextStyle(h),p.drawText(t,i)}}function renderFeature(f,t,r,i,s,c,a,h){const p=[],d=r.getImage();if(d){let e=!0;const o=d.getImageState();o==ImageState.LOADED||o==ImageState.ERROR?e=!1:o==ImageState.IDLE&&d.load(),e&&p.push(d.ready())}const l=r.getFill();l&&l.loading()&&p.push(l.ready());const n=p.length>0;return n&&Promise.all(p).then(()=>s(null)),renderFeatureInternal(f,t,r,i,c,a,h),n}function renderFeatureInternal(f,t,r,i,s,c,a){const h=r.getGeometryFunction()(t);if(!h)return;const p=h.simplifyTransformed(i,s);if(r.getRenderer())renderGeometry(f,p,r,t,a);else{const l=GEOMETRY_RENDERERS[p.getType()];l(f,p,r,t,a,c)}}function renderGeometry(f,t,r,i,s){if(t.getType()=="GeometryCollection"){const a=t.getGeometries();for(let h=0,p=a.length;h<p;++h)renderGeometry(f,a[h],r,i,s);return}f.getBuilder(r.getZIndex(),"Default").drawCustom(t,i,r.getRenderer(),r.getHitDetectionRenderer(),s)}function renderGeometryCollectionGeometry(f,t,r,i,s,c){const a=t.getGeometriesArray();let h,p;for(h=0,p=a.length;h<p;++h){const d=GEOMETRY_RENDERERS[a[h].getType()];d(f,a[h],r,i,s,c)}}function renderLineStringGeometry(f,t,r,i,s){const c=r.getStroke();if(c){const h=f.getBuilder(r.getZIndex(),"LineString");h.setFillStrokeStyle(null,c),h.drawLineString(t,i,s)}const a=r.getText();if(a&&a.getText()){const h=f.getBuilder(r.getZIndex(),"Text");h.setTextStyle(a),h.drawText(t,i,s)}}function renderMultiLineStringGeometry(f,t,r,i,s){const c=r.getStroke();if(c){const h=f.getBuilder(r.getZIndex(),"LineString");h.setFillStrokeStyle(null,c),h.drawMultiLineString(t,i,s)}const a=r.getText();if(a&&a.getText()){const h=f.getBuilder(r.getZIndex(),"Text");h.setTextStyle(a),h.drawText(t,i,s)}}function renderMultiPolygonGeometry(f,t,r,i,s){const c=r.getFill(),a=r.getStroke();if(a||c){const p=f.getBuilder(r.getZIndex(),"Polygon");p.setFillStrokeStyle(c,a),p.drawMultiPolygon(t,i,s)}const h=r.getText();if(h&&h.getText()){const p=f.getBuilder(r.getZIndex(),"Text");p.setTextStyle(h),p.drawText(t,i,s)}}function renderPointGeometry(f,t,r,i,s,c){const a=r.getImage(),h=r.getText(),p=h&&h.getText(),d=c&&a&&p?{}:void 0;if(a){if(a.getImageState()!=ImageState.LOADED)return;const l=f.getBuilder(r.getZIndex(),"Image");l.setImageStyle(a,d),l.drawPoint(t,i,s)}if(p){const l=f.getBuilder(r.getZIndex(),"Text");l.setTextStyle(h,d),l.drawText(t,i,s)}}function renderMultiPointGeometry(f,t,r,i,s,c){const a=r.getImage(),h=a&&a.getOpacity()!==0,p=r.getText(),d=p&&p.getText(),l=c&&h&&d?{}:void 0;if(h){if(a.getImageState()!=ImageState.LOADED)return;const n=f.getBuilder(r.getZIndex(),"Image");n.setImageStyle(a,l),n.drawMultiPoint(t,i,s)}if(d){const n=f.getBuilder(r.getZIndex(),"Text");n.setTextStyle(p,l),n.drawText(t,i,s)}}function renderPolygonGeometry(f,t,r,i,s){const c=r.getFill(),a=r.getStroke();if(c||a){const p=f.getBuilder(r.getZIndex(),"Polygon");p.setFillStrokeStyle(c,a),p.drawPolygon(t,i,s)}const h=r.getText();if(h&&h.getText()){const p=f.getBuilder(r.getZIndex(),"Text");p.setTextStyle(h),p.drawText(t,i,s)}}function renderEllipseGeometry(f,t,r,i,s){const c=r.getFill(),a=r.getStroke();if(c||a){const p=f.getBuilder(r.getZIndex(),"Ellipse");p.setFillStrokeStyle(c,a),p.drawEllipse(t,i,s)}const h=r.getText();if(h&&h.getText()){const p=f.getBuilder(r.getZIndex(),"Text");p.setTextStyle(h),p.drawText(t,i,s)}}class CanvasVectorLayerRenderer extends CanvasLayerRenderer{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=createEmpty(),this.wrappedRenderedExtent_=createEmpty(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(t,r,i){const s=r.extent,c=r.viewState,a=c.center,h=c.resolution,p=c.projection,d=c.rotation,l=p.getExtent(),n=this.getLayer().getSource(),e=this.getLayer().getDeclutter(),o=r.pixelRatio,u=r.viewHints,g=!(u[ViewHint.ANIMATING]||u[ViewHint.INTERACTING]),m=this.context,y=Math.round(getWidth(s)/h*o),b=Math.round(getHeight(s)/h*o),_=n.getWrapX()&&p.canWrapX(),x=_?getWidth(l):null,w=_?Math.ceil((s[2]-l[2])/x)+1:1;let T=_?Math.floor((s[0]-l[0])/x):0;do{let S=this.getRenderTransform(a,h,0,o,y,b,T*x);r.declutter&&(S=S.slice(0)),t.execute(m,[m.canvas.width,m.canvas.height],S,d,g,i===void 0?ALL:i?DECLUTTER:NON_DECLUTTER,i?e&&r.declutter[e]:void 0)}while(++T<w)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=createCanvasContext2D(this.context.canvas.width,this.context.canvas.height,canvasPool))}resetDrawContext_(){if(this.opacity_!==1){const t=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=t,releaseCanvas(this.context),canvasPool.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(t){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,t,!0)}renderDeferredInternal(t){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(t,r){const i=t.layerStatesArray[t.layerIndex];this.opacity_=i.opacity;const s=t.viewState;this.prepareContainer(t,r);const c=this.context,a=this.replayGroup_;let h=a&&!a.isEmpty();if(!h&&!(this.getLayer().hasListener(RenderEventType.PRERENDER)||this.getLayer().hasListener(RenderEventType.POSTRENDER)))return null;if(this.setDrawContext_(),this.preRender(c,t),s.projection,this.clipped_=!1,h&&i.extent&&this.clipping){const p=fromUserExtent(i.extent);h=intersects$1(p,t.extent),this.clipped_=h&&!containsExtent(p,t.extent),this.clipped_&&this.clipUnrotated(c,t,p)}return h&&this.renderWorlds(a,t,this.getLayer().getDeclutter()?!1:void 0),!t.declutter&&this.clipped_&&c.restore(),this.postRender(c,t),this.renderedRotation_!==s.rotation&&(this.renderedRotation_=s.rotation,this.hitDetectionImageData_=null),t.declutter||this.resetDrawContext_(),this.container}getFeatures(t){return new Promise(r=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),s=this.renderedCenter_,c=this.renderedResolution_,a=this.renderedRotation_,h=this.renderedProjection_,p=this.wrappedRenderedExtent_,d=this.getLayer(),l=[],n=i[0]*HIT_DETECT_RESOLUTION,e=i[1]*HIT_DETECT_RESOLUTION;l.push(this.getRenderTransform(s,c,a,HIT_DETECT_RESOLUTION,n,e,0).slice());const o=d.getSource(),u=h.getExtent();if(o.getWrapX()&&h.canWrapX()&&!containsExtent(u,p)){let g=p[0];const m=getWidth(u);let y=0,b;for(;g<u[0];)--y,b=m*y,l.push(this.getRenderTransform(s,c,a,HIT_DETECT_RESOLUTION,n,e,b).slice()),g+=m;for(y=0,g=p[2];g>u[2];)++y,b=m*y,l.push(this.getRenderTransform(s,c,a,HIT_DETECT_RESOLUTION,n,e,b).slice()),g-=m}this.hitDetectionImageData_=createHitDetectionImageData(i,l,this.renderedFeatures_,d.getStyleFunction(),p,c,a,getSquaredTolerance(c,this.renderedPixelRatio_))}r(hitDetect(t,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(t,r,i,s,c){if(!this.replayGroup_)return;const a=r.viewState.resolution,h=r.viewState.rotation,p=this.getLayer(),d={},l=function(u,g,m){const y=getUid(u),b=d[y];if(b){if(b!==!0&&m<b.distanceSq){if(m===0)return d[y]=!0,c.splice(c.lastIndexOf(b),1),s(u,p,g);b.geometry=g,b.distanceSq=m}}else{if(m===0)return d[y]=!0,s(u,p,g);c.push(d[y]={feature:u,layer:p,geometry:g,distanceSq:m,callback:s})}};let n;const e=[this.replayGroup_],o=this.getLayer().getDeclutter();return e.some(u=>n=u.forEachFeatureAtCoordinate(t,a,h,i,l,o&&r.declutter[o]?r.declutter[o].all().map(g=>g.value):null)),n}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const r=this.getLayer(),i=r.getSource();if(!i)return!1;const s=t.viewHints[ViewHint.ANIMATING],c=t.viewHints[ViewHint.INTERACTING],a=r.getUpdateWhileAnimating(),h=r.getUpdateWhileInteracting();if(this.ready&&!a&&s||!h&&c)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const p=t.extent,d=t.viewState,l=d.projection,n=d.resolution,e=t.pixelRatio,o=r.getRevision(),u=r.getRenderBuffer();let g=r.getRenderOrder();g===void 0&&(g=defaultOrder);const m=d.center.slice(),y=buffer(p,u*n),b=y.slice(),_=[y.slice()],x=l.getExtent();if(i.getWrapX()&&l.canWrapX()&&!containsExtent(x,t.extent)){const D=getWidth(x),R=Math.max(getWidth(y)/2,D);y[0]=x[0]-R,y[2]=x[2]+R,wrapX(m,l);const O=wrapX$1(_[0],l);O[0]<x[0]&&O[2]<x[2]?_.push([O[0]+D,O[1],O[2]+D,O[3]]):O[0]>x[0]&&O[2]>x[2]&&_.push([O[0]-D,O[1],O[2]-D,O[3]])}if(this.ready&&this.renderedResolution_==n&&this.renderedRevision_==o&&this.renderedRenderOrder_==g&&this.renderedFrameDeclutter_===!!t.declutter&&containsExtent(this.wrappedRenderedExtent_,y))return equals$2(this.renderedExtent_,b)||(this.hitDetectionImageData_=null,this.renderedExtent_=b),this.renderedCenter_=m,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const w=new BuilderGroup(getTolerance(n,e),y,n,e);let T;for(let D=0,R=_.length;D<R;++D)i.loadFeatures(_[D],n,l);const S=getSquaredTolerance(n,e);let I=!0;const v=(D,R)=>{let O;const F=D.getStyleFunction()||r.getStyleFunction();if(F&&(O=F(D,n)),O){const z=this.renderFeature(D,S,O,w,T,this.getLayer().getDeclutter(),R);I=I&&!z}},A=toUserExtent(y),L=i.getFeaturesInExtent(A);g&&L.sort(g);for(let D=0,R=L.length;D<R;++D)v(L[D],D);this.renderedFeatures_=L,this.ready=I;const N=w.finish(),$=new ExecutorGroup(y,n,e,i.getOverlaps(),N,r.getRenderBuffer(),!!t.declutter);return this.renderedResolution_=n,this.renderedRevision_=o,this.renderedRenderOrder_=g,this.renderedFrameDeclutter_=!!t.declutter,this.renderedExtent_=b,this.wrappedRenderedExtent_=y,this.renderedCenter_=m,this.renderedProjection_=l,this.renderedPixelRatio_=e,this.replayGroup_=$,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,r,i,s,c,a,h){if(!i)return!1;let p=!1;if(Array.isArray(i))for(let d=0,l=i.length;d<l;++d)p=renderFeature(s,t,i[d],r,this.boundHandleStyleImageChange_,c,a,h)||p;else p=renderFeature(s,t,i,r,this.boundHandleStyleImageChange_,c,a,h);return p}}class VectorLayer extends BaseVectorLayer{constructor(t){super(t)}createRenderer(){return new CanvasVectorLayerRenderer(this)}}const CollectionEventType={ADD:"add",REMOVE:"remove"},Property={LENGTH:"length"};class CollectionEvent extends BaseEvent{constructor(t,r,i){super(t),this.element=r,this.index=i}}class Collection extends BaseObject{constructor(t,r){if(super(),this.on,this.once,this.un,r=r||{},this.unique_=!!r.unique,this.array_=t||[],this.unique_)for(let i=0,s=this.array_.length;i<s;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let r=0,i=t.length;r<i;++r)this.push(t[r]);return this}forEach(t){const r=this.array_;for(let i=0,s=r.length;i<s;++i)t(r[i],i,r)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(Property.LENGTH)}insertAt(t,r){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(r),this.array_.splice(t,0,r),this.updateLength_(),this.dispatchEvent(new CollectionEvent(CollectionEventType.ADD,r,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const r=this.getLength();return this.insertAt(r,t),this.getLength()}remove(t){const r=this.array_;for(let i=0,s=r.length;i<s;++i)if(r[i]===t)return this.removeAt(i)}removeAt(t){if(t<0||t>=this.getLength())return;const r=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new CollectionEvent(CollectionEventType.REMOVE,r,t)),r}setAt(t,r){const i=this.getLength();if(t>=i){this.insertAt(t,r);return}if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(r,t);const s=this.array_[t];this.array_[t]=r,this.dispatchEvent(new CollectionEvent(CollectionEventType.REMOVE,s,t)),this.dispatchEvent(new CollectionEvent(CollectionEventType.ADD,r,t))}updateLength_(){this.set(Property.LENGTH,this.array_.length)}assertUnique_(t,r){for(let i=0,s=this.array_.length;i<s;++i)if(this.array_[i]===t&&i!==r)throw new Error("Duplicate item added to a unique collection")}}class RBush{constructor(t){this.rbush_=new RBush$1(t),this.items_={}}insert(t,r){const i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:r};this.rbush_.insert(i),this.items_[getUid(r)]=i}load(t,r){const i=new Array(r.length);for(let s=0,c=r.length;s<c;s++){const a=t[s],h=r[s],p={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],value:h};i[s]=p,this.items_[getUid(h)]=p}this.rbush_.load(i)}remove(t){const r=getUid(t),i=this.items_[r];return delete this.items_[r],this.rbush_.remove(i)!==null}update(t,r){const i=this.items_[getUid(r)],s=[i.minX,i.minY,i.maxX,i.maxY];equals$1(s,t)||(this.remove(r),this.insert(t,r))}getAll(){return this.rbush_.all().map(function(r){return r.value})}getInExtent(t){const r={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(r).map(function(s){return s.value})}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,r){return this.forEach_(this.getInExtent(t),r)}forEach_(t,r){let i;for(let s=0,c=t.length;s<c;s++)if(i=r(t[s]),i)return i;return i}isEmpty(){return isEmpty$1(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const r=this.rbush_.toJSON();return createOrUpdate(r.minX,r.minY,r.maxX,r.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const r in t.items_)this.items_[r]=t.items_[r]}}function interpolatePoint(f,t,r,i,s,c,a){let h,p;const d=(r-t)/i;if(d===1)h=t;else if(d===2)h=t,p=s;else if(d!==0){let l=f[t],n=f[t+1],e=0;const o=[0];for(let m=t+i;m<r;m+=i){const y=f[m],b=f[m+1];e+=Math.sqrt((y-l)*(y-l)+(b-n)*(b-n)),o.push(e),l=y,n=b}const u=s*e,g=binarySearch(o,u);g<0?(p=(u-o[-g-2])/(o[-g-1]-o[-g-2]),h=t+(-g-2)*i):h=t+g*i}a=a>1?a:2,c=c||new Array(a);for(let l=0;l<a;++l)c[l]=h===void 0?NaN:p===void 0?f[h+l]:lerp(f[h+l],f[h+i+l],p);return c}function linearRingss(f,t,r,i){const s=[];let c=createEmpty();for(let a=0,h=r.length;a<h;++a){const p=r[a];c=createOrUpdateFromFlatCoordinates(f,t,p[0],i),s.push((c[0]+c[2])/2,(c[1]+c[3])/2),t=p[p.length-1]}return s}const tmpTransform=create();class RenderFeature{constructor(t,r,i,s,c,a){this.styleFunction,this.extent_,this.id_=a,this.type_=t,this.flatCoordinates_=r,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=c,this.squaredTolerance_,this.stride_=s,this.simplifiedGeometry_}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?createOrUpdateFromCoordinate(this.flatCoordinates_):createOrUpdateFromFlatCoordinates(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=getCenter(this.getExtent());this.flatInteriorPoints_=getInteriorPointOfArray(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=inflateEnds(this.flatCoordinates_,this.ends_),r=linearRingss(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=getInteriorPointsOfMultiArray(this.flatCoordinates_,0,t,2,r)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=interpolatePoint(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let r=0;const i=this.ends_;for(let s=0,c=i.length;s<c;++s){const a=i[s],h=interpolatePoint(t,r,a,2,.5);extend$1(this.flatMidpoints_,h),r=a}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,r){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){t=get$1(t);const r=t.getExtent(),i=t.getWorldExtent();if(r&&i){const s=getHeight(i)/getHeight(r);compose(tmpTransform,i[0],i[3],s,-s,0,0,0),transform2D(this.flatCoordinates_,0,this.flatCoordinates_.length,2,tmpTransform,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){var t;return new RenderFeature(this.type_,this.flatCoordinates_.slice(),(t=this.ends_)==null?void 0:t.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=memoizeOne((t,r)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),r&&this.simplifiedGeometry_.applyTransform(r);const i=this.simplifiedGeometry_.getFlatCoordinates();let s;switch(this.type_){case"LineString":i.length=douglasPeucker(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,i,0),s=[i.length];break;case"MultiLineString":s=[],i.length=douglasPeuckerArray(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,i,0,s);break;case"Polygon":s=[],i.length=quantizeArray(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),i,0,s);break}return s&&(this.simplifiedGeometry_=new RenderFeature(this.type_,i,s,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_}),this}}RenderFeature.prototype.getFlatCoordinates=RenderFeature.prototype.getOrientedFlatCoordinates;class Source extends BaseObject{constructor(t){super(),this.projection=get$1(t.projection),this.attributions_=adaptAttributions(t.attributions),this.attributionsCollapsible_=t.attributionsCollapsible!==void 0?t.attributionsCollapsible:!0,this.loading=!1,this.state_=t.state!==void 0?t.state:"ready",this.wrapX_=t.wrapX!==void 0?t.wrapX:!1,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const r=this;this.viewPromise_=new Promise(function(i,s){r.viewResolver=i,r.viewRejector=s})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=adaptAttributions(t),this.changed()}setState(t){this.state_=t,this.changed()}}function adaptAttributions(f){return f?Array.isArray(f)?function(t){return f}:typeof f=="function"?f:function(t){return[f]}:null}const VectorEventType={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};function all(f,t){return[[-1/0,-1/0,1/0,1/0]]}let withCredentials=!1;function loadFeaturesXhr(f,t,r,i,s,c,a){const h=new XMLHttpRequest;h.open("GET",typeof f=="function"?f(r,i,s):f,!0),t.getType()=="arraybuffer"&&(h.responseType="arraybuffer"),h.withCredentials=withCredentials,h.onload=function(p){if(!h.status||h.status>=200&&h.status<300){const d=t.getType();try{let l;d=="text"||d=="json"?l=h.responseText:d=="xml"?l=h.responseXML||h.responseText:d=="arraybuffer"&&(l=h.response),l?c(t.readFeatures(l,{extent:r,featureProjection:s}),t.readProjection(l)):a()}catch{a()}}else a()},h.onerror=a,h.send()}function xhr(f,t){return function(r,i,s,c,a){const h=this;loadFeaturesXhr(f,t,r,i,s,function(p,d){h.addFeatures(p),c!==void 0&&c(p)},a||VOID)}}class VectorSourceEvent extends BaseEvent{constructor(t,r,i){super(t),this.feature=r,this.features=i}}class VectorSource extends Source{constructor(t){t=t||{},super({attributions:t.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:t.wrapX!==void 0?t.wrapX:!0}),this.on,this.once,this.un,this.loader_=VOID,this.format_=t.format,this.overlaps_=t.overlaps===void 0?!0:t.overlaps,this.url_=t.url,t.loader!==void 0?this.loader_=t.loader:this.url_!==void 0&&(assert(this.format_,"`format` must be set when `url` is set"),this.loader_=xhr(this.url_,this.format_)),this.strategy_=t.strategy!==void 0?t.strategy:all;const r=t.useSpatialIndex!==void 0?t.useSpatialIndex:!0;this.featuresRtree_=r?new RBush:null,this.loadedExtentsRtree_=new RBush,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,s;Array.isArray(t.features)?s=t.features:t.features&&(i=t.features,s=i.getArray()),!r&&i===void 0&&(i=new Collection(s)),s!==void 0&&this.addFeaturesInternal(s),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const r=getUid(t);if(!this.addToIndex_(r,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(r,t);const i=t.getGeometry();if(i){const s=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(s,t)}else this.nullGeometryFeatures_[r]=t;this.dispatchEvent(new VectorSourceEvent(VectorEventType.ADDFEATURE,t))}setupChangeEvents_(t,r){r instanceof RenderFeature||(this.featureChangeKeys_[t]=[listen(r,EventType.CHANGE,this.handleFeatureChange_,this),listen(r,ObjectEventType.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(t,r){let i=!0;if(r.getId()!==void 0){const s=String(r.getId());if(!(s in this.idIndex_))this.idIndex_[s]=r;else if(r instanceof RenderFeature){const c=this.idIndex_[s];c instanceof RenderFeature?Array.isArray(c)?c.push(r):this.idIndex_[s]=[c,r]:i=!1}else i=!1}return i&&(assert(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=r),i}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const r=[],i=[],s=[];for(let c=0,a=t.length;c<a;c++){const h=t[c],p=getUid(h);this.addToIndex_(p,h)&&i.push(h)}for(let c=0,a=i.length;c<a;c++){const h=i[c],p=getUid(h);this.setupChangeEvents_(p,h);const d=h.getGeometry();if(d){const l=d.getExtent();r.push(l),s.push(h)}else this.nullGeometryFeatures_[p]=h}if(this.featuresRtree_&&this.featuresRtree_.load(r,s),this.hasListener(VectorEventType.ADDFEATURE))for(let c=0,a=i.length;c<a;c++)this.dispatchEvent(new VectorSourceEvent(VectorEventType.ADDFEATURE,i[c]))}bindFeaturesCollection_(t){let r=!1;this.addEventListener(VectorEventType.ADDFEATURE,function(i){r||(r=!0,t.push(i.feature),r=!1)}),this.addEventListener(VectorEventType.REMOVEFEATURE,function(i){r||(r=!0,t.remove(i.feature),r=!1)}),t.addEventListener(CollectionEventType.ADD,i=>{r||(r=!0,this.addFeature(i.element),r=!1)}),t.addEventListener(CollectionEventType.REMOVE,i=>{r||(r=!0,this.removeFeature(i.element),r=!1)}),this.featuresCollection_=t}clear(t){if(t){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(unlistenByKey);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){const i=s=>{this.removeFeatureInternal(s)};this.featuresRtree_.forEach(i);for(const s in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[s])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const r=new VectorSourceEvent(VectorEventType.CLEAR);this.dispatchEvent(r),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,r){const i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,function(s){const c=s.getGeometry();if(c instanceof RenderFeature||c.intersectsCoordinate(t))return r(s)})}forEachFeatureInExtent(t,r){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,r);this.featuresCollection_&&this.featuresCollection_.forEach(r)}forEachFeatureIntersectingExtent(t,r){return this.forEachFeatureInExtent(t,function(i){const s=i.getGeometry();if(s instanceof RenderFeature||s.intersectsExtent(t)){const c=r(i);if(c)return c}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),isEmpty$1(this.nullGeometryFeatures_)||extend$1(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const r=[];return this.forEachFeatureAtCoordinateDirect(t,function(i){r.push(i)}),r}getFeaturesInExtent(t,r){if(this.featuresRtree_){if(!(r&&r.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const s=wrapAndSliceX(t,r);return[].concat(...s.map(c=>this.featuresRtree_.getInExtent(c)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,r){const i=t[0],s=t[1];let c=null;const a=[NaN,NaN];let h=1/0;const p=[-1/0,-1/0,1/0,1/0];return r=r||TRUE,this.featuresRtree_.forEachInExtent(p,function(d){if(r(d)){const l=d.getGeometry(),n=h;if(h=l instanceof RenderFeature?0:l.closestPointXY(i,s,a,h),h<n){c=d;const e=Math.sqrt(h);p[0]=i-e,p[1]=s-e,p[2]=i+e,p[3]=s+e}}}),c}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const r=this.idIndex_[t.toString()];return r!==void 0?r:null}getFeatureByUid(t){const r=this.uidIndex_[t];return r!==void 0?r:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const r=t.target,i=getUid(r),s=r.getGeometry();if(!s)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(r),this.nullGeometryFeatures_[i]=r);else{const a=s.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(a,r)):this.featuresRtree_&&this.featuresRtree_.update(a,r)}const c=r.getId();if(c!==void 0){const a=c.toString();this.idIndex_[a]!==r&&(this.removeFromIdIndex_(r),this.idIndex_[a]=r)}else this.removeFromIdIndex_(r),this.uidIndex_[i]=r;this.changed(),this.dispatchEvent(new VectorSourceEvent(VectorEventType.CHANGEFEATURE,r))}hasFeature(t){const r=t.getId();return r!==void 0?r in this.idIndex_:getUid(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&isEmpty$1(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(t,r,i){const s=this.loadedExtentsRtree_,c=this.strategy_(t,r,i);for(let a=0,h=c.length;a<h;++a){const p=c[a];s.forEachInExtent(p,function(l){return containsExtent(l.extent,p)})||(++this.loadingExtentsCount_,this.dispatchEvent(new VectorSourceEvent(VectorEventType.FEATURESLOADSTART)),this.loader_.call(this,p,r,i,l=>{--this.loadingExtentsCount_,this.dispatchEvent(new VectorSourceEvent(VectorEventType.FEATURESLOADEND,void 0,l))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new VectorSourceEvent(VectorEventType.FEATURESLOADERROR))}),s.insert(p,{extent:p.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const r=this.loadedExtentsRtree_;let i;r.forEachInExtent(t,function(s){if(equals$1(s.extent,t))return i=s,!0}),i&&r.remove(i)}removeFeatures(t){const r=[];for(let i=0,s=t.length;i<s;++i){const c=t[i],a=this.removeFeatureInternal(c);a&&r.push(a)}r.length>0&&this.changed()}removeFeature(t){if(!t)return;this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const r=getUid(t);if(!(r in this.uidIndex_))return;r in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[r]:this.featuresRtree_&&this.featuresRtree_.remove(t);const i=this.featureChangeKeys_[r];i==null||i.forEach(unlistenByKey),delete this.featureChangeKeys_[r];const s=t.getId();if(s!==void 0){const c=s.toString(),a=this.idIndex_[c];a===t?delete this.idIndex_[c]:Array.isArray(a)&&(a.splice(a.indexOf(t),1),a.length===1&&(this.idIndex_[c]=a[0]))}return delete this.uidIndex_[r],this.hasListener(VectorEventType.REMOVEFEATURE)&&this.dispatchEvent(new VectorSourceEvent(VectorEventType.REMOVEFEATURE,t)),t}removeFromIdIndex_(t){let r=!1;for(const i in this.idIndex_){const s=this.idIndex_[i];if(t instanceof RenderFeature&&Array.isArray(s)&&s.includes(t))s.splice(s.indexOf(t),1);else if(this.idIndex_[i]===t){delete this.idIndex_[i],r=!0;break}}return r}setLoader(t){this.loader_=t}setUrl(t){assert(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(xhr(t,this.format_))}}var ortWeb_min={exports:{}};const backends={},backendsSortedByPriority=[],registerBackend=(f,t,r)=>{if(t&&typeof t.init=="function"&&typeof t.createSessionHandler=="function"){const i=backends[f];if(i===void 0)backends[f]={backend:t,priority:r};else{if(i.priority>r)return;if(i.priority===r&&i.backend!==t)throw new Error(`cannot register backend "${f}" using priority ${r}`)}if(r>=0){const s=backendsSortedByPriority.indexOf(f);s!==-1&&backendsSortedByPriority.splice(s,1);for(let c=0;c<backendsSortedByPriority.length;c++)if(backends[backendsSortedByPriority[c]].priority<=r){backendsSortedByPriority.splice(c,0,f);return}backendsSortedByPriority.push(f)}return}throw new TypeError("not a valid backend")},resolveBackend=async f=>{const t=f.length===0?backendsSortedByPriority:f,r=[];for(const i of t){const s=backends[i];if(s){if(s.initialized)return s.backend;if(s.aborted)continue;const c=!!s.initPromise;try{return c||(s.initPromise=s.backend.init()),await s.initPromise,s.initialized=!0,s.backend}catch(a){c||r.push({name:i,err:a}),s.aborted=!0}finally{delete s.initPromise}}}throw new Error(`no available backend found. ERR: ${r.map(i=>`[${i.name}] ${i.err}`).join(", ")}`)};class EnvImpl{constructor(){this.wasm={},this.webgl={},this.logLevelInternal="warning"}set logLevel(t){if(t!==void 0){if(typeof t!="string"||["verbose","info","warning","error","fatal"].indexOf(t)===-1)throw new Error(`Unsupported logging level: ${t}`);this.logLevelInternal=t}}get logLevel(){return this.logLevelInternal}}const env=new EnvImpl,isBigInt64ArrayAvailable=typeof BigInt64Array<"u"&&typeof BigInt64Array.from=="function",isBigUint64ArrayAvailable=typeof BigUint64Array<"u"&&typeof BigUint64Array.from=="function",NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array]]),NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]);isBigInt64ArrayAvailable&&(NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.set("int64",BigInt64Array),NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP.set(BigInt64Array,"int64"));isBigUint64ArrayAvailable&&(NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.set("uint64",BigUint64Array),NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP.set(BigUint64Array,"uint64"));const calculateSize=f=>{let t=1;for(let r=0;r<f.length;r++){const i=f[r];if(typeof i!="number"||!Number.isSafeInteger(i))throw new TypeError(`dims[${r}] must be an integer, got: ${i}`);if(i<0)throw new RangeError(`dims[${r}] must be a non-negative integer, got: ${i}`);t*=i}return t};let Tensor$1=class Ie{constructor(t,r,i){let s,c,a;if(typeof t=="string")if(s=t,a=i,t==="string"){if(!Array.isArray(r))throw new TypeError("A string tensor's data must be a string array.");c=r}else{const p=NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.get(t);if(p===void 0)throw new TypeError(`Unsupported tensor type: ${t}.`);if(Array.isArray(r))c=p.from(r);else if(r instanceof p)c=r;else throw new TypeError(`A ${s} tensor's data must be type of ${p}`)}else if(a=r,Array.isArray(t)){if(t.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");const p=typeof t[0];if(p==="string")s="string",c=t;else if(p==="boolean")s="bool",c=Uint8Array.from(t);else throw new TypeError(`Invalid element type of data array: ${p}.`)}else{const p=NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP.get(t.constructor);if(p===void 0)throw new TypeError(`Unsupported type for tensor data: ${t.constructor}.`);s=p,c=t}if(a===void 0)a=[c.length];else if(!Array.isArray(a))throw new TypeError("A tensor's dims must be a number array");const h=calculateSize(a);if(h!==c.length)throw new Error(`Tensor's size(${h}) does not match data length(${c.length}).`);this.dims=a,this.type=s,this.data=c,this.size=h}static bufferToTensor(t,r){if(t===void 0)throw new Error("Image buffer must be defined");if(r.height===void 0||r.width===void 0)throw new Error("Image height and width must be defined");const{height:i,width:s}=r,c=r.norm;let a,h;c===void 0||c.mean===void 0?a=255:a=c.mean,c===void 0||c.bias===void 0?h=0:h=c.bias;const p=r.bitmapFormat!==void 0?r.bitmapFormat:"RGBA",d=r.tensorFormat!==void 0&&r.tensorFormat!==void 0?r.tensorFormat:"RGB",l=i*s,n=d==="RGBA"?new Float32Array(l*4):new Float32Array(l*3);let e=4,o=0,u=1,g=2,m=3,y=0,b=l,_=l*2,x=-1;p==="RGB"&&(e=3,o=0,u=1,g=2,m=-1),d==="RGBA"?x=l*3:d==="RBG"?(y=0,_=l,b=l*2):d==="BGR"&&(_=0,b=l,y=l*2);for(let T=0;T<l;T++,o+=e,g+=e,u+=e,m+=e)n[y++]=(t[o]+h)/a,n[b++]=(t[u]+h)/a,n[_++]=(t[g]+h)/a,x!==-1&&m!==-1&&(n[x++]=(t[m]+h)/a);return d==="RGBA"?new Ie("float32",n,[1,4,i,s]):new Ie("float32",n,[1,3,i,s])}static async fromImage(t,r){const i=typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement,s=typeof ImageData<"u"&&t instanceof ImageData,c=typeof ImageBitmap<"u"&&t instanceof ImageBitmap,a=typeof String<"u"&&(t instanceof String||typeof t=="string");let h,p={};if(i){const d=document.createElement("canvas"),l=d.getContext("2d");if(l!=null){let n=t.naturalHeight,e=t.naturalWidth;if(r!==void 0&&r.resizedHeight!==void 0&&r.resizedWidth!==void 0&&(n=r.resizedHeight,e=r.resizedWidth),r!==void 0){if(p=r,r.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");if(p.tensorFormat="RGBA",r.height!==void 0&&r.height!==n)throw new Error("Image input config height doesn't match HTMLImageElement height");if(p.height=n,r.width!==void 0&&r.width!==e)throw new Error("Image input config width doesn't match HTMLImageElement width");p.width=e}else p.tensorFormat="RGBA",p.height=n,p.width=e;d.width=e,d.height=n,l.drawImage(t,0,0,e,n),h=l.getImageData(0,0,e,n).data}else throw new Error("Can not access image data")}else if(s){const d="RGBA";let l,n;if(r!==void 0&&r.resizedWidth!==void 0&&r.resizedHeight!==void 0?(l=r.resizedHeight,n=r.resizedWidth):(l=t.height,n=t.width),r!==void 0){if(p=r,r.bitmapFormat!==void 0&&r.bitmapFormat!==d)throw new Error("Image input config format must be RGBA for ImageData");p.bitmapFormat="RGBA"}else p.bitmapFormat="RGBA";if(p.height=l,p.width=n,r!==void 0){const e=document.createElement("canvas");e.width=n,e.height=l;const o=e.getContext("2d");if(o!=null)o.putImageData(t,0,0),h=o.getImageData(0,0,n,l).data;else throw new Error("Can not access image data")}else h=t.data}else if(c){if(r===void 0)throw new Error("Please provide image config with format for Imagebitmap");if(r.bitmapFormat!==void 0)throw new Error("Image input config format must be defined for ImageBitmap");const d=document.createElement("canvas").getContext("2d");if(d!=null){const l=t.height,n=t.width;if(d.drawImage(t,0,0,n,l),h=d.getImageData(0,0,n,l).data,r!==void 0){if(r.height!==void 0&&r.height!==l)throw new Error("Image input config height doesn't match ImageBitmap height");if(p.height=l,r.width!==void 0&&r.width!==n)throw new Error("Image input config width doesn't match ImageBitmap width");p.width=n}else p.height=l,p.width=n;return Ie.bufferToTensor(h,p)}else throw new Error("Can not access image data")}else{if(a)return new Promise((d,l)=>{const n=document.createElement("canvas"),e=n.getContext("2d");if(!t||!e)return l();const o=new Image;o.crossOrigin="Anonymous",o.src=t,o.onload=()=>{n.width=o.width,n.height=o.height,e.drawImage(o,0,0,n.width,n.height);const u=e.getImageData(0,0,n.width,n.height);if(r!==void 0){if(r.height!==void 0&&r.height!==n.height)throw new Error("Image input config height doesn't match ImageBitmap height");if(p.height=n.height,r.width!==void 0&&r.width!==n.width)throw new Error("Image input config width doesn't match ImageBitmap width");p.width=n.width}else p.height=n.height,p.width=n.width;d(Ie.bufferToTensor(u.data,p))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(h!==void 0)return Ie.bufferToTensor(h,p);throw new Error("Input data provided is not supported - aborted tensor creation")}toImageData(t){var r,i;const s=document.createElement("canvas").getContext("2d");let c;if(s!=null){const a=this.dims[3],h=this.dims[2],p=this.dims[1],d=t!==void 0&&t.format!==void 0?t.format:"RGB",l=t!==void 0&&((r=t.norm)===null||r===void 0?void 0:r.mean)!==void 0?t.norm.mean:255,n=t!==void 0&&((i=t.norm)===null||i===void 0?void 0:i.bias)!==void 0?t.norm.bias:0,e=h*a;if(t!==void 0){if(t.height!==void 0&&t.height!==h)throw new Error("Image output config height doesn't match tensor height");if(t.width!==void 0&&t.width!==a)throw new Error("Image output config width doesn't match tensor width");if(t.format!==void 0&&p===4&&t.format!=="RGBA"||p===3&&t.format!=="RGB"&&t.format!=="BGR")throw new Error("Tensor format doesn't match input tensor dims")}const o=4;let u=0,g=1,m=2,y=3,b=0,_=e,x=e*2,w=-1;d==="RGBA"?(b=0,_=e,x=e*2,w=e*3):d==="RGB"?(b=0,_=e,x=e*2):d==="RBG"&&(b=0,x=e,_=e*2),c=s.createImageData(a,h);for(let T=0;T<h*a;u+=o,g+=o,m+=o,y+=o,T++)c.data[u]=(this.data[b++]-n)*l,c.data[g]=(this.data[_++]-n)*l,c.data[m]=(this.data[x++]-n)*l,c.data[y]=w===-1?255:(this.data[w++]-n)*l}else throw new Error("Can not access image data");return c}reshape(t){return new Ie(this.type,this.data,t)}};const Tensor=Tensor$1;let InferenceSession$1=class cn{constructor(t){this.handler=t}async run(t,r,i){const s={};let c={};if(typeof t!="object"||t===null||t instanceof Tensor||Array.isArray(t))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let a=!0;if(typeof r=="object"){if(r===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(r instanceof Tensor)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(r)){if(r.length===0)throw new TypeError("'fetches' cannot be an empty array.");a=!1;for(const d of r){if(typeof d!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(d)===-1)throw new RangeError(`'fetches' contains invalid output name: ${d}.`);s[d]=null}if(typeof i=="object"&&i!==null)c=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else{let d=!1;const l=Object.getOwnPropertyNames(r);for(const n of this.outputNames)if(l.indexOf(n)!==-1){const e=r[n];(e===null||e instanceof Tensor)&&(d=!0,a=!1,s[n]=e)}if(d){if(typeof i=="object"&&i!==null)c=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else c=r}}else if(typeof r<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(const d of this.inputNames)if(typeof t[d]>"u")throw new Error(`input '${d}' is missing in 'feeds'.`);if(a)for(const d of this.outputNames)s[d]=null;const h=await this.handler.run(t,s,c),p={};for(const d in h)Object.hasOwnProperty.call(h,d)&&(p[d]=new Tensor(h[d].type,h[d].data,h[d].dims));return p}static async create(t,r,i,s){let c,a={};if(typeof t=="string"){if(c=t,typeof r=="object"&&r!==null)a=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof Uint8Array){if(c=t,typeof r=="object"&&r!==null)a=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer){const n=t;let e=0,o=t.byteLength;if(typeof r=="object"&&r!==null)a=r;else if(typeof r=="number"){if(e=r,!Number.isSafeInteger(e))throw new RangeError("'byteOffset' must be an integer.");if(e<0||e>=n.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${n.byteLength}).`);if(o=t.byteLength-e,typeof i=="number"){if(o=i,!Number.isSafeInteger(o))throw new RangeError("'byteLength' must be an integer.");if(o<=0||e+o>n.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${n.byteLength-e}].`);if(typeof s=="object"&&s!==null)a=s;else if(typeof s<"u")throw new TypeError("'options' must be an object.")}else if(typeof i<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof r<"u")throw new TypeError("'options' must be an object.");c=new Uint8Array(n,e,o)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");const p=(a.executionProviders||[]).map(n=>typeof n=="string"?n:n.name),l=await(await resolveBackend(p)).createSessionHandler(c,a);return new cn(l)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}};const InferenceSession=InferenceSession$1,lib=Object.freeze(Object.defineProperty({__proto__:null,InferenceSession,Tensor,env,registerBackend},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(lib);/*!
* ONNX Runtime Web v1.14.0
* Copyright (c) Microsoft Corporation. All rights reserved.
* Licensed under the MIT License.
*/var hasRequiredOrtWeb_min;function requireOrtWeb_min(){return hasRequiredOrtWeb_min||(hasRequiredOrtWeb_min=1,function(module,exports){(function(f,t){module.exports=t(require$$0)})(self,__WEBPACK_EXTERNAL_MODULE__1670__=>(()=>{var __webpack_modules__={3474:(f,t,r)=>{var i,s=(i=(i=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(c){function a(){return W.buffer!=J&&St(W.buffer),nt}function h(){return W.buffer!=J&&St(W.buffer),wt}function p(){return W.buffer!=J&&St(W.buffer),K}function d(){return W.buffer!=J&&St(W.buffer),st}function l(){return W.buffer!=J&&St(W.buffer),Tt}var n,e,o;c=c||{},n||(n=c!==void 0?c:{}),n.ready=new Promise(function(E,C){e=E,o=C});var u,g,m,y,b,_,x=Object.assign({},n),w="./this.program",T=(E,C)=>{throw C},S=typeof window=="object",I=typeof importScripts=="function",v=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",A=n.ENVIRONMENT_IS_PTHREAD||!1,L="";function N(E){return n.locateFile?n.locateFile(E,L):L+E}if(v){let E;L=I?r(908).dirname(L)+"/":"//",_=()=>{b||(y=r(1384),b=r(908))},u=function(C,k){return _(),C=b.normalize(C),y.readFileSync(C,k?void 0:"utf8")},m=C=>((C=u(C,!0)).buffer||(C=new Uint8Array(C)),C),g=(C,k,j)=>{_(),C=b.normalize(C),y.readFile(C,function(V,H){V?j(V):k(H.buffer)})},1<process.argv.length&&(w=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",function(C){if(!(C instanceof ee))throw C}),process.on("unhandledRejection",function(C){throw C}),T=(C,k)=>{if(Wt())throw process.exitCode=C,k;k instanceof ee||F("exiting due to exception: "+k),process.exit(C)},n.inspect=function(){return"[Emscripten Module object]"};try{E=r(9925)}catch(C){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),C}r.g.Worker=E.Worker}else(S||I)&&(I?L=self.location.href:typeof document<"u"&&document.currentScript&&(L=document.currentScript.src),i&&(L=i),L=L.indexOf("blob:")!==0?L.substr(0,L.replace(/[?#].*/,"").lastIndexOf("/")+1):"",v||(u=E=>{var C=new XMLHttpRequest;return C.open("GET",E,!1),C.send(null),C.responseText},I&&(m=E=>{var C=new XMLHttpRequest;return C.open("GET",E,!1),C.responseType="arraybuffer",C.send(null),new Uint8Array(C.response)}),g=(E,C,k)=>{var j=new XMLHttpRequest;j.open("GET",E,!0),j.responseType="arraybuffer",j.onload=()=>{j.status==200||j.status==0&&j.response?C(j.response):k()},j.onerror=k,j.send(null)}));v&&typeof performance>"u"&&(r.g.performance=r(6953).performance);var $=console.log.bind(console),D=console.warn.bind(console);v&&(_(),$=E=>y.writeSync(1,E+`
`),D=E=>y.writeSync(2,E+`
`));var R,O=n.print||$,F=n.printErr||D;Object.assign(n,x),x=null,n.thisProgram&&(w=n.thisProgram),n.quit&&(T=n.quit),n.wasmBinary&&(R=n.wasmBinary);var z=n.noExitRuntime||!1;typeof WebAssembly!="object"&&ct("no native wasm support detected");var W,Z,J,nt,wt,K,st,Tt,xt=!1,$t=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Qt(E,C,k){var j=(C>>>=0)+k;for(k=C;E[k]&&!(k>=j);)++k;if(16<k-C&&E.buffer&&$t)return $t.decode(E.buffer instanceof SharedArrayBuffer?E.slice(C,k):E.subarray(C,k));for(j="";C<k;){var V=E[C++];if(128&V){var H=63&E[C++];if((224&V)==192)j+=String.fromCharCode((31&V)<<6|H);else{var tt=63&E[C++];65536>(V=(240&V)==224?(15&V)<<12|H<<6|tt:(7&V)<<18|H<<12|tt<<6|63&E[C++])?j+=String.fromCharCode(V):(V-=65536,j+=String.fromCharCode(55296|V>>10,56320|1023&V))}}else j+=String.fromCharCode(V)}return j}function Ot(E,C){return(E>>>=0)?Qt(h(),E,C):""}function Ft(E,C,k,j){if(!(0<j))return 0;var V=k>>>=0;j=k+j-1;for(var H=0;H<E.length;++H){var tt=E.charCodeAt(H);if(55296<=tt&&57343>=tt&&(tt=65536+((1023&tt)<<10)|1023&E.charCodeAt(++H)),127>=tt){if(k>=j)break;C[k++>>>0]=tt}else{if(2047>=tt){if(k+1>=j)break;C[k++>>>0]=192|tt>>6}else{if(65535>=tt){if(k+2>=j)break;C[k++>>>0]=224|tt>>12}else{if(k+3>=j)break;C[k++>>>0]=240|tt>>18,C[k++>>>0]=128|tt>>12&63}C[k++>>>0]=128|tt>>6&63}C[k++>>>0]=128|63&tt}}return C[k>>>0]=0,k-V}function Mt(E){for(var C=0,k=0;k<E.length;++k){var j=E.charCodeAt(k);127>=j?C++:2047>=j?C+=2:55296<=j&&57343>=j?(C+=4,++k):C+=3}return C}function St(E){J=E,n.HEAP8=nt=new Int8Array(E),n.HEAP16=new Int16Array(E),n.HEAP32=K=new Int32Array(E),n.HEAPU8=wt=new Uint8Array(E),n.HEAPU16=new Uint16Array(E),n.HEAPU32=st=new Uint32Array(E),n.HEAPF32=new Float32Array(E),n.HEAPF64=Tt=new Float64Array(E)}A&&(J=n.buffer);var vt=n.INITIAL_MEMORY||16777216;if(A)W=n.wasmMemory,J=n.buffer;else if(n.wasmMemory)W=n.wasmMemory;else if(!((W=new WebAssembly.Memory({initial:vt/65536,maximum:65536,shared:!0})).buffer instanceof SharedArrayBuffer))throw F("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),v&&console.log("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and also use a recent version)"),Error("bad memory");W&&(J=W.buffer),vt=J.byteLength,St(J);var jt,Gt=[],zt=[],Xt=[],Kt=[];function Wt(){return z||!1}function Yt(){var E=n.preRun.shift();Gt.unshift(E)}var It,Ht=0,qt=null;function ct(E){throw A?postMessage({cmd:"onAbort",arg:E}):n.onAbort&&n.onAbort(E),F(E="Aborted("+E+")"),xt=!0,E=new WebAssembly.RuntimeError(E+". Build with -sASSERTIONS for more info."),o(E),E}function Ee(){return It.startsWith("data:application/octet-stream;base64,")}function xe(){var E=It;try{if(E==It&&R)return new Uint8Array(R);if(m)return m(E);throw"both async and sync fetching of the wasm failed"}catch(C){ct(C)}}It="ort-wasm-threaded.wasm",Ee()||(It=N(It));var Oe={};function ee(E){this.name="ExitStatus",this.message="Program terminated with exit("+E+")",this.status=E}function le(E){(E=ot.Vb[E])||ct(),ot.mc(E)}function ve(E){var C=ot.Cc();if(!C)return 6;ot.ac.push(C),ot.Vb[E.Ub]=C,C.Ub=E.Ub;var k={cmd:"run",start_routine:E.Ic,arg:E.zc,pthread_ptr:E.Ub};return C.$b=()=>{k.time=performance.now(),C.postMessage(k,E.Nc)},C.loaded&&(C.$b(),delete C.$b),0}function Dt(E){if(A)return et(1,1,E);Wt()||(ot.oc(),n.onExit&&n.onExit(E),xt=!0),T(E,new ee(E))}function te(E,C){if(!C&&A)throw pe(E),"unwind";Wt()||A||(ze(),ne(Xt),Ge(0),ke[1].length&&Me(1,10),ke[2].length&&Me(2,10),ot.oc()),Dt(E)}var ot={Yb:[],ac:[],qc:[],Vb:{},fc:function(){A&&ot.Ec()},Pc:function(){},Ec:function(){ot.receiveObjectTransfer=ot.Gc,ot.threadInitTLS=ot.pc,ot.setExitStatus=ot.nc,z=!1},nc:function(){},oc:function(){for(var E of Object.values(ot.Vb))ot.mc(E);for(E of ot.Yb)E.terminate();ot.Yb=[]},mc:function(E){var C=E.Ub;delete ot.Vb[C],ot.Yb.push(E),ot.ac.splice(ot.ac.indexOf(E),1),E.Ub=0,Fe(C)},Gc:function(){},pc:function(){ot.qc.forEach(E=>E())},Fc:function(E,C){E.onmessage=k=>{var j=(k=k.data).cmd;if(E.Ub&&(ot.Bc=E.Ub),k.targetThread&&k.targetThread!=Pe()){var V=ot.Vb[k.Qc];V?V.postMessage(k,k.transferList):F('Internal error! Worker sent a message "'+j+'" to target pthread '+k.targetThread+", but that thread no longer exists!")}else j==="processProxyingQueue"?B(k.queue):j==="spawnThread"?ve(k):j==="cleanupThread"?le(k.thread):j==="killThread"?(k=k.thread,j=ot.Vb[k],delete ot.Vb[k],j.terminate(),Fe(k),ot.ac.splice(ot.ac.indexOf(j),1),j.Ub=0):j==="cancelThread"?ot.Vb[k.thread].postMessage({cmd:"cancel"}):j==="loaded"?(E.loaded=!0,C&&C(E),E.$b&&(E.$b(),delete E.$b)):j==="print"?O("Thread "+k.threadId+": "+k.text):j==="printErr"?F("Thread "+k.threadId+": "+k.text):j==="alert"?alert("Thread "+k.threadId+": "+k.text):k.target==="setimmediate"?E.postMessage(k):j==="onAbort"?n.onAbort&&n.onAbort(k.arg):j&&F("worker sent an unknown command "+j);ot.Bc=void 0},E.onerror=k=>{throw F("worker sent an error! "+k.filename+":"+k.lineno+": "+k.message),k},v&&(E.on("message",function(k){E.onmessage({data:k})}),E.on("error",function(k){E.onerror(k)}),E.on("detachedExit",function(){})),E.postMessage({cmd:"load",urlOrBlob:n.mainScriptUrlOrBlob||i,wasmMemory:W,wasmModule:Z})},yc:function(){var E=N("ort-wasm-threaded.worker.js");ot.Yb.push(new Worker(E))},Cc:function(){return ot.Yb.length==0&&(ot.yc(),ot.Fc(ot.Yb[0])),ot.Yb.pop()}};function ne(E){for(;0<E.length;)E.shift()(n)}function de(E){var C=dt();return E=E(),ft(C),E}function pe(E){if(A)return et(2,0,E);try{te(E)}catch(C){C instanceof ee||C=="unwind"||T(1,C)}}n.PThread=ot,n.establishStackSpace=function(){var E=Pe(),C=p()[E+44>>2>>>0];E=p()[E+48>>2>>>0],Ye(C,C-E),ft(C)};var oe=[];function bt(E){var C=oe[E];return C||(E>=oe.length&&(oe.length=E+1),oe[E]=C=jt.get(E)),C}n.invokeEntryPoint=function(E,C){E=bt(E)(C),Wt()?ot.nc(E):Xe(E)};var ce,ge,me=[],lt=0,at=0;function ut(E){this.Zb=E,this.Sb=E-24,this.xc=function(C){d()[this.Sb+4>>2>>>0]=C},this.bc=function(){return d()[this.Sb+4>>2>>>0]},this.wc=function(C){d()[this.Sb+8>>2>>>0]=C},this.Dc=function(){return d()[this.Sb+8>>2>>>0]},this.rc=function(){p()[this.Sb>>2>>>0]=0},this.hc=function(C){C=C?1:0,a()[this.Sb+12>>0>>>0]=C},this.uc=function(){return a()[this.Sb+12>>0>>>0]!=0},this.ic=function(C){C=C?1:0,a()[this.Sb+13>>0>>>0]=C},this.kc=function(){return a()[this.Sb+13>>0>>>0]!=0},this.fc=function(C,k){this.cc(0),this.xc(C),this.wc(k),this.rc(),this.hc(!1),this.ic(!1)},this.sc=function(){Atomics.add(p(),this.Sb>>2,1)},this.Hc=function(){return Atomics.sub(p(),this.Sb>>2,1)===1},this.cc=function(C){d()[this.Sb+16>>2>>>0]=C},this.tc=function(){return d()[this.Sb+16>>2>>>0]},this.vc=function(){if(Ze(this.bc()))return d()[this.Zb>>2>>>0];var C=this.tc();return C!==0?C:this.Zb}}function ye(E){return Ve(new ut(E).Sb)}function he(E,C,k,j){return A?et(3,1,E,C,k,j):be(E,C,k,j)}function be(E,C,k,j){if(typeof SharedArrayBuffer>"u")return F("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var V=[];return A&&V.length===0?he(E,C,k,j):(E={Ic:k,Ub:E,zc:j,Nc:V},A?(E.Oc="spawnThread",postMessage(E,V),0):ve(E))}function se(E,C,k){return A?et(4,1,E,C,k):0}function ae(E,C){if(A)return et(5,1,E,C)}function ue(E,C){if(A)return et(6,1,E,C)}function Te(E,C,k){if(A)return et(7,1,E,C,k)}function Se(E,C,k){return A?et(8,1,E,C,k):0}function Ct(E,C){if(A)return et(9,1,E,C)}function Bt(E,C,k){if(A)return et(10,1,E,C,k)}function Pt(E,C,k,j){if(A)return et(11,1,E,C,k,j)}function Lt(E,C,k,j){if(A)return et(12,1,E,C,k,j)}function Ut(E,C,k,j){if(A)return et(13,1,E,C,k,j)}function Zt(E){if(A)return et(14,1,E)}function P(E,C){if(A)return et(15,1,E,C)}function M(E,C,k){if(A)return et(16,1,E,C,k)}function B(E){Atomics.store(p(),E>>2,1),Pe()&&qe(E),Atomics.compareExchange(p(),E>>2,1,0)}function U(E){return d()[E>>>2]+4294967296*p()[E+4>>>2]}function G(E,C,k,j,V,H){return A?et(17,1,E,C,k,j,V,H):-52}function Y(E,C,k,j,V,H){if(A)return et(18,1,E,C,k,j,V,H)}function Q(E){var C=Mt(E)+1,k=Le(C);return k&&Ft(E,a(),k,C),k}function rt(E,C,k){function j(mt){return(mt=mt.toTimeString().match(/\(([A-Za-z ]+)\)$/))?mt[1]:"GMT"}if(A)return et(19,1,E,C,k);var V=new Date().getFullYear(),H=new Date(V,0,1),tt=new Date(V,6,1);V=H.getTimezoneOffset();var it=tt.getTimezoneOffset(),gt=Math.max(V,it);p()[E>>2>>>0]=60*gt,p()[C>>2>>>0]=+(V!=it),E=j(H),C=j(tt),E=Q(E),C=Q(C),it<V?(d()[k>>2>>>0]=E,d()[k+4>>2>>>0]=C):(d()[k>>2>>>0]=C,d()[k+4>>2>>>0]=E)}function et(E,C){var k=arguments.length-2,j=arguments;return de(()=>{for(var V=Ne(8*k),H=V>>3,tt=0;tt<k;tt++){var it=j[2+tt];l()[H+tt>>>0]=it}return He(E,k,V,C)})}n.executeNotifiedProxyingQueue=B,ge=v?()=>{var E=process.hrtime();return 1e3*E[0]+E[1]/1e6}:A?()=>performance.now()-n.__performance_now_clock_drift:()=>performance.now();var ht,Et=[],Vt={};function Nt(){if(!ht){var E,C={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:w||"./this.program"};for(E in Vt)Vt[E]===void 0?delete C[E]:C[E]=Vt[E];var k=[];for(E in C)k.push(E+"="+C[E]);ht=k}return ht}function q(E,C){if(A)return et(20,1,E,C);var k=0;return Nt().forEach(function(j,V){var H=C+k;for(V=d()[E+4*V>>2>>>0]=H,H=0;H<j.length;++H)a()[V++>>0>>>0]=j.charCodeAt(H);a()[V>>0>>>0]=0,k+=j.length+1}),0}function yt(E,C){if(A)return et(21,1,E,C);var k=Nt();d()[E>>2>>>0]=k.length;var j=0;return k.forEach(function(V){j+=V.length+1}),d()[C>>2>>>0]=j,0}function At(E){return A?et(22,1,E):52}function re(E,C,k,j){return A?et(23,1,E,C,k,j):52}function _e(E,C,k,j,V){return A?et(24,1,E,C,k,j,V):70}var ke=[null,[],[]];function Me(E,C){var k=ke[E];C===0||C===10?((E===1?O:F)(Qt(k,0)),k.length=0):k.push(C)}function $e(E,C,k,j){if(A)return et(25,1,E,C,k,j);for(var V=0,H=0;H<k;H++){var tt=d()[C>>2>>>0],it=d()[C+4>>2>>>0];C+=8;for(var gt=0;gt<it;gt++)Me(E,h()[tt+gt>>>0]);V+=it}return d()[j>>2>>>0]=V,0}var Jt=0;function Ce(E){return E%4==0&&(E%100!=0||E%400==0)}var je=[31,29,31,30,31,30,31,31,30,31,30,31],Be=[31,28,31,30,31,30,31,31,30,31,30,31];function Ue(E,C,k,j){function V(X,_t,Rt){for(X=typeof X=="number"?X.toString():X||"";X.length<_t;)X=Rt[0]+X;return X}function H(X,_t){return V(X,_t,"0")}function tt(X,_t){function Rt(Ae){return 0>Ae?-1:0<Ae?1:0}var we;return(we=Rt(X.getFullYear()-_t.getFullYear()))===0&&(we=Rt(X.getMonth()-_t.getMonth()))===0&&(we=Rt(X.getDate()-_t.getDate())),we}function it(X){switch(X.getDay()){case 0:return new Date(X.getFullYear()-1,11,29);case 1:return X;case 2:return new Date(X.getFullYear(),0,3);case 3:return new Date(X.getFullYear(),0,2);case 4:return new Date(X.getFullYear(),0,1);case 5:return new Date(X.getFullYear()-1,11,31);case 6:return new Date(X.getFullYear()-1,11,30)}}function gt(X){var _t=X.Wb;for(X=new Date(new Date(X.Xb+1900,0,1).getTime());0<_t;){var Rt=X.getMonth(),we=(Ce(X.getFullYear())?je:Be)[Rt];if(!(_t>we-X.getDate())){X.setDate(X.getDate()+_t);break}_t-=we-X.getDate()+1,X.setDate(1),11>Rt?X.setMonth(Rt+1):(X.setMonth(0),X.setFullYear(X.getFullYear()+1))}return Rt=new Date(X.getFullYear()+1,0,4),_t=it(new Date(X.getFullYear(),0,4)),Rt=it(Rt),0>=tt(_t,X)?0>=tt(Rt,X)?X.getFullYear()+1:X.getFullYear():X.getFullYear()-1}var mt=p()[j+40>>2>>>0];for(var kt in j={Lc:p()[j>>2>>>0],Kc:p()[j+4>>2>>>0],dc:p()[j+8>>2>>>0],jc:p()[j+12>>2>>>0],ec:p()[j+16>>2>>>0],Xb:p()[j+20>>2>>>0],Tb:p()[j+24>>2>>>0],Wb:p()[j+28>>2>>>0],Rc:p()[j+32>>2>>>0],Jc:p()[j+36>>2>>>0],Mc:mt?Ot(mt):""},k=Ot(k),mt={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})k=k.replace(new RegExp(kt,"g"),mt[kt]);var fe="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),ie="January February March April May June July August September October November December".split(" ");for(kt in mt={"%a":function(X){return fe[X.Tb].substring(0,3)},"%A":function(X){return fe[X.Tb]},"%b":function(X){return ie[X.ec].substring(0,3)},"%B":function(X){return ie[X.ec]},"%C":function(X){return H((X.Xb+1900)/100|0,2)},"%d":function(X){return H(X.jc,2)},"%e":function(X){return V(X.jc,2," ")},"%g":function(X){return gt(X).toString().substring(2)},"%G":function(X){return gt(X)},"%H":function(X){return H(X.dc,2)},"%I":function(X){return(X=X.dc)==0?X=12:12<X&&(X-=12),H(X,2)},"%j":function(X){for(var _t=0,Rt=0;Rt<=X.ec-1;_t+=(Ce(X.Xb+1900)?je:Be)[Rt++]);return H(X.jc+_t,3)},"%m":function(X){return H(X.ec+1,2)},"%M":function(X){return H(X.Kc,2)},"%n":function(){return`
`},"%p":function(X){return 0<=X.dc&&12>X.dc?"AM":"PM"},"%S":function(X){return H(X.Lc,2)},"%t":function(){return"	"},"%u":function(X){return X.Tb||7},"%U":function(X){return H(Math.floor((X.Wb+7-X.Tb)/7),2)},"%V":function(X){var _t=Math.floor((X.Wb+7-(X.Tb+6)%7)/7);if(2>=(X.Tb+371-X.Wb-2)%7&&_t++,_t)_t==53&&((Rt=(X.Tb+371-X.Wb)%7)==4||Rt==3&&Ce(X.Xb)||(_t=1));else{_t=52;var Rt=(X.Tb+7-X.Wb-1)%7;(Rt==4||Rt==5&&Ce(X.Xb%400-1))&&_t++}return H(_t,2)},"%w":function(X){return X.Tb},"%W":function(X){return H(Math.floor((X.Wb+7-(X.Tb+6)%7)/7),2)},"%y":function(X){return(X.Xb+1900).toString().substring(2)},"%Y":function(X){return X.Xb+1900},"%z":function(X){var _t=0<=(X=X.Jc);return X=Math.abs(X)/60,(_t?"+":"-")+("0000"+(X/60*100+X%60)).slice(-4)},"%Z":function(X){return X.Mc},"%%":function(){return"%"}},k=k.replace(/%%/g,"\0\0"),mt)k.includes(kt)&&(k=k.replace(new RegExp(kt,"g"),mt[kt](j)));return kt=function(X){var _t=Array(Mt(X)+1);return Ft(X,_t,0,_t.length),_t}(k=k.replace(/\0\0/g,"%")),kt.length>C?0:(function(X,_t){a().set(X,_t>>>0)}(kt,E),kt.length-1)}ot.fc();var hn=[null,Dt,pe,he,se,ae,ue,Te,Se,Ct,Bt,Pt,Lt,Ut,Zt,P,M,G,Y,rt,q,yt,At,re,_e,$e],fn={b:function(E){return Le(E+24)+24},n:function(E){return(E=new ut(E)).uc()||(E.hc(!0),lt--),E.ic(!1),me.push(E),E.sc(),E.vc()},ma:function(E){throw F("Unexpected exception thrown, this is not properly supported - aborting"),xt=!0,E},x:function(){pt(0);var E=me.pop();if(E.Hc()&&!E.kc()){var C=E.Dc();C&&bt(C)(E.Zb),ye(E.Zb)}at=0},e:function(){var E=at;if(!E)return Jt=0;var C=new ut(E);C.cc(E);var k=C.bc();if(!k)return Jt=0,E;for(var j=Array.prototype.slice.call(arguments),V=0;V<j.length;V++){var H=j[V];if(H===0||H===k)break;if(De(H,k,C.Sb+16))return Jt=H,E}return Jt=k,E},l:function(){var E=at;if(!E)return Jt=0;var C=new ut(E);C.cc(E);var k=C.bc();if(!k)return Jt=0,E;for(var j=Array.prototype.slice.call(arguments),V=0;V<j.length;V++){var H=j[V];if(H===0||H===k)break;if(De(H,k,C.Sb+16))return Jt=H,E}return Jt=k,E},h:function(){var E=at;if(!E)return Jt=0;var C=new ut(E);C.cc(E);var k=C.bc();if(!k)return Jt=0,E;for(var j=Array.prototype.slice.call(arguments),V=0;V<j.length;V++){var H=j[V];if(H===0||H===k)break;if(De(H,k,C.Sb+16))return Jt=H,E}return Jt=k,E},t:ye,M:function(){var E=me.pop();E||ct("no exception to throw");var C=E.Zb;throw E.kc()||(me.push(E),E.ic(!0),E.hc(!1),lt++),at=C,C},c:function(E,C,k){throw new ut(E).fc(C,k),at=E,lt++,E},pa:function(){return lt},Fa:function(E){We(E,!I,1,!S),ot.pc()},T:function(E){A?postMessage({cmd:"cleanupThread",thread:E}):le(E)},xa:be,j:function(E){throw at||(at=E),E},H:se,Ma:ae,ua:ue,wa:Te,oa:Se,Ka:Ct,Ca:Bt,Ja:Pt,V:Lt,va:Ut,sa:Zt,La:P,ta:M,Ta:function(){},X:function(){ct("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},Ua:function(){ct("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},W:function(){return Date.now()},ya:function(){return 2097152},Oa:function(){return!0},za:function(E,C,k,j){if(E==C)setTimeout(()=>B(j));else if(A)postMessage({targetThread:E,cmd:"processProxyingQueue",queue:j});else{if(!(E=ot.Vb[E]))return;E.postMessage({cmd:"processProxyingQueue",queue:j})}return 1},Ea:function(){return-1},Pa:function(E,C){E=new Date(1e3*U(E)),p()[C>>2>>>0]=E.getUTCSeconds(),p()[C+4>>2>>>0]=E.getUTCMinutes(),p()[C+8>>2>>>0]=E.getUTCHours(),p()[C+12>>2>>>0]=E.getUTCDate(),p()[C+16>>2>>>0]=E.getUTCMonth(),p()[C+20>>2>>>0]=E.getUTCFullYear()-1900,p()[C+24>>2>>>0]=E.getUTCDay(),E=(E.getTime()-Date.UTC(E.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,p()[C+28>>2>>>0]=E},Qa:function(E,C){E=new Date(1e3*U(E)),p()[C>>2>>>0]=E.getSeconds(),p()[C+4>>2>>>0]=E.getMinutes(),p()[C+8>>2>>>0]=E.getHours(),p()[C+12>>2>>>0]=E.getDate(),p()[C+16>>2>>>0]=E.getMonth(),p()[C+20>>2>>>0]=E.getFullYear()-1900,p()[C+24>>2>>>0]=E.getDay();var k=new Date(E.getFullYear(),0,1),j=(E.getTime()-k.getTime())/864e5|0;p()[C+28>>2>>>0]=j,p()[C+36>>2>>>0]=-60*E.getTimezoneOffset(),j=new Date(E.getFullYear(),6,1).getTimezoneOffset(),E=0|(j!=(k=k.getTimezoneOffset())&&E.getTimezoneOffset()==Math.min(k,j)),p()[C+32>>2>>>0]=E},Ra:function(E){var C=new Date(p()[E+20>>2>>>0]+1900,p()[E+16>>2>>>0],p()[E+12>>2>>>0],p()[E+8>>2>>>0],p()[E+4>>2>>>0],p()[E>>2>>>0],0),k=p()[E+32>>2>>>0],j=C.getTimezoneOffset(),V=new Date(C.getFullYear(),0,1),H=new Date(C.getFullYear(),6,1).getTimezoneOffset(),tt=V.getTimezoneOffset(),it=Math.min(tt,H);return 0>k?p()[E+32>>2>>>0]=+(H!=tt&&it==j):0<k!=(it==j)&&(H=Math.max(tt,H),C.setTime(C.getTime()+6e4*((0<k?it:H)-j))),p()[E+24>>2>>>0]=C.getDay(),k=(C.getTime()-V.getTime())/864e5|0,p()[E+28>>2>>>0]=k,p()[E>>2>>>0]=C.getSeconds(),p()[E+4>>2>>>0]=C.getMinutes(),p()[E+8>>2>>>0]=C.getHours(),p()[E+12>>2>>>0]=C.getDate(),p()[E+16>>2>>>0]=C.getMonth(),C.getTime()/1e3|0},Aa:G,Ba:Y,Sa:function E(C,k,j){E.Ac||(E.Ac=!0,rt(C,k,j))},y:function(){ct("")},U:function(){if(!v&&!I){var E="Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread";ce||(ce={}),ce[E]||(ce[E]=1,v&&(E="warning: "+E),F(E))}},ra:function(){return 4294901760},B:ge,Ia:function(E,C,k){h().copyWithin(E>>>0,C>>>0,C+k>>>0)},F:function(){return v?r(3993).cpus().length:navigator.hardwareConcurrency},Da:function(E,C,k){Et.length=C,k>>=3;for(var j=0;j<C;j++)Et[j]=l()[k+j>>>0];return(0>E?Oe[-E-1]:hn[E]).apply(null,Et)},qa:function(E){var C=h().length;if((E>>>=0)<=C||4294901760<E)return!1;for(var k=1;4>=k;k*=2){var j=C*(1+.2/k);j=Math.min(j,E+100663296);var V=Math;j=Math.max(E,j),V=V.min.call(V,4294901760,j+(65536-j%65536)%65536);t:{try{W.grow(V-J.byteLength+65535>>>16),St(W.buffer);var H=1;break t}catch{}H=void 0}if(H)return!0}return!1},Na:function(){throw"unwind"},Ga:q,Ha:yt,J:te,I:At,S:re,ga:_e,R:$e,d:function(){return Jt},na:function E(C,k){E.lc||(E.lc=function(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var V=new Uint8Array(1);return()=>(crypto.getRandomValues(V),V[0])}if(v)try{var H=r(Object(function(){var tt=new Error("Cannot find module 'crypto'");throw tt.code="MODULE_NOT_FOUND",tt}()));return()=>H.randomBytes(1)[0]}catch{}return()=>ct("randomDevice")}());for(var j=0;j<k;j++)a()[C+j>>0>>>0]=E.lc();return 0},ia:function(E,C,k){var j=dt();try{return bt(E)(C,k)}catch(V){if(ft(j),V!==V+0)throw V;pt(1,0)}},ja:function(E,C,k){var j=dt();try{return bt(E)(C,k)}catch(V){if(ft(j),V!==V+0)throw V;pt(1,0)}},K:function(E){var C=dt();try{return bt(E)()}catch(k){if(ft(C),k!==k+0)throw k;pt(1,0)}},f:function(E,C){var k=dt();try{return bt(E)(C)}catch(j){if(ft(k),j!==j+0)throw j;pt(1,0)}},P:function(E,C,k){var j=dt();try{return bt(E)(C,k)}catch(V){if(ft(j),V!==V+0)throw V;pt(1,0)}},Q:function(E,C,k){var j=dt();try{return bt(E)(C,k)}catch(V){if(ft(j),V!==V+0)throw V;pt(1,0)}},k:function(E,C,k){var j=dt();try{return bt(E)(C,k)}catch(V){if(ft(j),V!==V+0)throw V;pt(1,0)}},p:function(E,C,k,j){var V=dt();try{return bt(E)(C,k,j)}catch(H){if(ft(V),H!==H+0)throw H;pt(1,0)}},q:function(E,C,k,j,V){var H=dt();try{return bt(E)(C,k,j,V)}catch(tt){if(ft(H),tt!==tt+0)throw tt;pt(1,0)}},N:function(E,C,k,j,V,H){var tt=dt();try{return bt(E)(C,k,j,V,H)}catch(it){if(ft(tt),it!==it+0)throw it;pt(1,0)}},s:function(E,C,k,j,V,H){var tt=dt();try{return bt(E)(C,k,j,V,H)}catch(it){if(ft(tt),it!==it+0)throw it;pt(1,0)}},w:function(E,C,k,j,V,H,tt){var it=dt();try{return bt(E)(C,k,j,V,H,tt)}catch(gt){if(ft(it),gt!==gt+0)throw gt;pt(1,0)}},L:function(E,C,k,j,V,H,tt,it){var gt=dt();try{return bt(E)(C,k,j,V,H,tt,it)}catch(mt){if(ft(gt),mt!==mt+0)throw mt;pt(1,0)}},E:function(E,C,k,j,V,H,tt,it,gt,mt,kt,fe){var ie=dt();try{return bt(E)(C,k,j,V,H,tt,it,gt,mt,kt,fe)}catch(X){if(ft(ie),X!==X+0)throw X;pt(1,0)}},aa:function(E,C,k,j,V,H,tt,it){var gt=dt();try{return sn(E,C,k,j,V,H,tt,it)}catch(mt){if(ft(gt),mt!==mt+0)throw mt;pt(1,0)}},_:function(E,C,k,j,V,H,tt){var it=dt();try{return Je(E,C,k,j,V,H,tt)}catch(gt){if(ft(it),gt!==gt+0)throw gt;pt(1,0)}},Z:function(E,C,k,j,V){var H=dt();try{return an(E,C,k,j,V)}catch(tt){if(ft(H),tt!==tt+0)throw tt;pt(1,0)}},ca:function(E,C,k,j){var V=dt();try{return rn(E,C,k,j)}catch(H){if(ft(V),H!==H+0)throw H;pt(1,0)}},$:function(E){var C=dt();try{return Ke(E)}catch(k){if(ft(C),k!==k+0)throw k;pt(1,0)}},ba:function(E,C){var k=dt();try{return on(E,C)}catch(j){if(ft(k),j!==j+0)throw j;pt(1,0)}},Y:function(E,C,k){var j=dt();try{return Qe(E,C,k)}catch(V){if(ft(j),V!==V+0)throw V;pt(1,0)}},g:function(E){var C=dt();try{bt(E)()}catch(k){if(ft(C),k!==k+0)throw k;pt(1,0)}},r:function(E,C){var k=dt();try{bt(E)(C)}catch(j){if(ft(k),j!==j+0)throw j;pt(1,0)}},i:function(E,C,k){var j=dt();try{bt(E)(C,k)}catch(V){if(ft(j),V!==V+0)throw V;pt(1,0)}},ha:function(E,C,k,j){var V=dt();try{bt(E)(C,k,j)}catch(H){if(ft(V),H!==H+0)throw H;pt(1,0)}},m:function(E,C,k,j){var V=dt();try{bt(E)(C,k,j)}catch(H){if(ft(V),H!==H+0)throw H;pt(1,0)}},v:function(E,C,k,j,V){var H=dt();try{bt(E)(C,k,j,V)}catch(tt){if(ft(H),tt!==tt+0)throw tt;pt(1,0)}},u:function(E,C,k,j,V,H){var tt=dt();try{bt(E)(C,k,j,V,H)}catch(it){if(ft(tt),it!==it+0)throw it;pt(1,0)}},O:function(E,C,k,j,V,H,tt){var it=dt();try{bt(E)(C,k,j,V,H,tt)}catch(gt){if(ft(it),gt!==gt+0)throw gt;pt(1,0)}},A:function(E,C,k,j,V,H,tt,it){var gt=dt();try{bt(E)(C,k,j,V,H,tt,it)}catch(mt){if(ft(gt),mt!==mt+0)throw mt;pt(1,0)}},ka:function(E,C,k,j,V,H,tt,it,gt){var mt=dt();try{bt(E)(C,k,j,V,H,tt,it,gt)}catch(kt){if(ft(mt),kt!==kt+0)throw kt;pt(1,0)}},C:function(E,C,k,j,V,H,tt,it,gt,mt,kt){var fe=dt();try{bt(E)(C,k,j,V,H,tt,it,gt,mt,kt)}catch(ie){if(ft(fe),ie!==ie+0)throw ie;pt(1,0)}},D:function(E,C,k,j,V,H,tt,it,gt,mt,kt,fe,ie,X,_t,Rt){var we=dt();try{bt(E)(C,k,j,V,H,tt,it,gt,mt,kt,fe,ie,X,_t,Rt)}catch(Ae){if(ft(we),Ae!==Ae+0)throw Ae;pt(1,0)}},fa:function(E,C,k,j,V,H,tt,it){var gt=dt();try{tn(E,C,k,j,V,H,tt,it)}catch(mt){if(ft(gt),mt!==mt+0)throw mt;pt(1,0)}},da:function(E,C,k,j,V,H,tt,it,gt,mt,kt,fe){var ie=dt();try{nn(E,C,k,j,V,H,tt,it,gt,mt,kt,fe)}catch(X){if(ft(ie),X!==X+0)throw X;pt(1,0)}},ea:function(E,C,k,j,V,H){var tt=dt();try{en(E,C,k,j,V,H)}catch(it){if(ft(tt),it!==it+0)throw it;pt(1,0)}},o:function(E){return E},a:W||n.wasmMemory,G:function(E){Jt=E},la:Ue,z:function(E,C,k,j){return Ue(E,C,k,j)}};(function(){function E(V,H){n.asm=V.exports,ot.qc.push(n.asm.sb),jt=n.asm.ub,zt.unshift(n.asm.Va),Z=H,A||(Ht--,n.monitorRunDependencies&&n.monitorRunDependencies(Ht),Ht==0&&qt&&(V=qt,qt=null,V()))}function C(V){E(V.instance,V.module)}function k(V){return function(){if(!R&&(S||I)){if(typeof fetch=="function"&&!It.startsWith("file://"))return fetch(It,{credentials:"same-origin"}).then(function(H){if(!H.ok)throw"failed to load wasm binary file at '"+It+"'";return H.arrayBuffer()}).catch(function(){return xe()});if(g)return new Promise(function(H,tt){g(It,function(it){H(new Uint8Array(it))},tt)})}return Promise.resolve().then(function(){return xe()})}().then(function(H){return WebAssembly.instantiate(H,j)}).then(function(H){return H}).then(V,function(H){F("failed to asynchronously prepare wasm: "+H),ct(H)})}var j={a:fn};if(A||(Ht++,n.monitorRunDependencies&&n.monitorRunDependencies(Ht)),n.instantiateWasm)try{return n.instantiateWasm(j,E)}catch(V){return F("Module.instantiateWasm callback failed with error: "+V),!1}(R||typeof WebAssembly.instantiateStreaming!="function"||Ee()||It.startsWith("file://")||v||typeof fetch!="function"?k(C):fetch(It,{credentials:"same-origin"}).then(function(V){return WebAssembly.instantiateStreaming(V,j).then(C,function(H){return F("wasm streaming compile failed: "+H),F("falling back to ArrayBuffer instantiation"),k(C)})})).catch(o)})(),n.___wasm_call_ctors=function(){return(n.___wasm_call_ctors=n.asm.Va).apply(null,arguments)},n._OrtInit=function(){return(n._OrtInit=n.asm.Wa).apply(null,arguments)},n._OrtCreateSessionOptions=function(){return(n._OrtCreateSessionOptions=n.asm.Xa).apply(null,arguments)},n._OrtAppendExecutionProvider=function(){return(n._OrtAppendExecutionProvider=n.asm.Ya).apply(null,arguments)},n._OrtAddSessionConfigEntry=function(){return(n._OrtAddSessionConfigEntry=n.asm.Za).apply(null,arguments)},n._OrtReleaseSessionOptions=function(){return(n._OrtReleaseSessionOptions=n.asm._a).apply(null,arguments)},n._OrtCreateSession=function(){return(n._OrtCreateSession=n.asm.$a).apply(null,arguments)},n._OrtReleaseSession=function(){return(n._OrtReleaseSession=n.asm.ab).apply(null,arguments)},n._OrtGetInputCount=function(){return(n._OrtGetInputCount=n.asm.bb).apply(null,arguments)},n._OrtGetOutputCount=function(){return(n._OrtGetOutputCount=n.asm.cb).apply(null,arguments)},n._OrtGetInputName=function(){return(n._OrtGetInputName=n.asm.db).apply(null,arguments)},n._OrtGetOutputName=function(){return(n._OrtGetOutputName=n.asm.eb).apply(null,arguments)},n._OrtFree=function(){return(n._OrtFree=n.asm.fb).apply(null,arguments)},n._OrtCreateTensor=function(){return(n._OrtCreateTensor=n.asm.gb).apply(null,arguments)},n._OrtGetTensorData=function(){return(n._OrtGetTensorData=n.asm.hb).apply(null,arguments)},n._OrtReleaseTensor=function(){return(n._OrtReleaseTensor=n.asm.ib).apply(null,arguments)},n._OrtCreateRunOptions=function(){return(n._OrtCreateRunOptions=n.asm.jb).apply(null,arguments)},n._OrtAddRunConfigEntry=function(){return(n._OrtAddRunConfigEntry=n.asm.kb).apply(null,arguments)},n._OrtReleaseRunOptions=function(){return(n._OrtReleaseRunOptions=n.asm.lb).apply(null,arguments)},n._OrtRun=function(){return(n._OrtRun=n.asm.mb).apply(null,arguments)},n._OrtEndProfiling=function(){return(n._OrtEndProfiling=n.asm.nb).apply(null,arguments)};var Pe=n._pthread_self=function(){return(Pe=n._pthread_self=n.asm.ob).apply(null,arguments)},Le=n._malloc=function(){return(Le=n._malloc=n.asm.pb).apply(null,arguments)},Ve=n._free=function(){return(Ve=n._free=n.asm.qb).apply(null,arguments)},Ge=n._fflush=function(){return(Ge=n._fflush=n.asm.rb).apply(null,arguments)};n.__emscripten_tls_init=function(){return(n.__emscripten_tls_init=n.asm.sb).apply(null,arguments)};var ze=n.___funcs_on_exit=function(){return(ze=n.___funcs_on_exit=n.asm.tb).apply(null,arguments)},We=n.__emscripten_thread_init=function(){return(We=n.__emscripten_thread_init=n.asm.vb).apply(null,arguments)};n.__emscripten_thread_crashed=function(){return(n.__emscripten_thread_crashed=n.asm.wb).apply(null,arguments)};var Re,He=n._emscripten_run_in_main_runtime_thread_js=function(){return(He=n._emscripten_run_in_main_runtime_thread_js=n.asm.xb).apply(null,arguments)},qe=n.__emscripten_proxy_execute_task_queue=function(){return(qe=n.__emscripten_proxy_execute_task_queue=n.asm.yb).apply(null,arguments)},Fe=n.__emscripten_thread_free_data=function(){return(Fe=n.__emscripten_thread_free_data=n.asm.zb).apply(null,arguments)},Xe=n.__emscripten_thread_exit=function(){return(Xe=n.__emscripten_thread_exit=n.asm.Ab).apply(null,arguments)},pt=n._setThrew=function(){return(pt=n._setThrew=n.asm.Bb).apply(null,arguments)},Ye=n._emscripten_stack_set_limits=function(){return(Ye=n._emscripten_stack_set_limits=n.asm.Cb).apply(null,arguments)},dt=n.stackSave=function(){return(dt=n.stackSave=n.asm.Db).apply(null,arguments)},ft=n.stackRestore=function(){return(ft=n.stackRestore=n.asm.Eb).apply(null,arguments)},Ne=n.stackAlloc=function(){return(Ne=n.stackAlloc=n.asm.Fb).apply(null,arguments)},De=n.___cxa_can_catch=function(){return(De=n.___cxa_can_catch=n.asm.Gb).apply(null,arguments)},Ze=n.___cxa_is_pointer_type=function(){return(Ze=n.___cxa_is_pointer_type=n.asm.Hb).apply(null,arguments)},Ke=n.dynCall_j=function(){return(Ke=n.dynCall_j=n.asm.Ib).apply(null,arguments)},Je=n.dynCall_iiiiij=function(){return(Je=n.dynCall_iiiiij=n.asm.Jb).apply(null,arguments)},Qe=n.dynCall_jii=function(){return(Qe=n.dynCall_jii=n.asm.Kb).apply(null,arguments)},tn=n.dynCall_viiiiij=function(){return(tn=n.dynCall_viiiiij=n.asm.Lb).apply(null,arguments)},en=n.dynCall_vjji=function(){return(en=n.dynCall_vjji=n.asm.Mb).apply(null,arguments)},nn=n.dynCall_viiijjjii=function(){return(nn=n.dynCall_viiijjjii=n.asm.Nb).apply(null,arguments)},rn=n.dynCall_iij=function(){return(rn=n.dynCall_iij=n.asm.Ob).apply(null,arguments)},on=n.dynCall_ji=function(){return(on=n.dynCall_ji=n.asm.Pb).apply(null,arguments)},sn=n.dynCall_iiiiiij=function(){return(sn=n.dynCall_iiiiiij=n.asm.Qb).apply(null,arguments)},an=n.dynCall_iiij=function(){return(an=n.dynCall_iiij=n.asm.Rb).apply(null,arguments)};function un(){function E(){if(!Re&&(Re=!0,n.calledRun=!0,!xt)&&(A||ne(zt),e(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),!A)){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;){var C=n.postRun.shift();Kt.unshift(C)}ne(Kt)}}if(!(0<Ht))if(A)e(n),A||ne(zt),postMessage({cmd:"loaded"});else{if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)Yt();ne(Gt),0<Ht||(n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1),E()},1)):E())}}if(n.UTF8ToString=Ot,n.stringToUTF8=function(E,C,k){return Ft(E,h(),C,k)},n.lengthBytesUTF8=Mt,n.keepRuntimeAlive=Wt,n.wasmMemory=W,n.stackSave=dt,n.stackRestore=ft,n.stackAlloc=Ne,n.ExitStatus=ee,n.PThread=ot,qt=function E(){Re||un(),Re||(qt=E)},n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);0<n.preInit.length;)n.preInit.pop()();return un(),c.ready});f.exports=s},932:(f,t,r)=>{var i,s=(i=(i=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(c){var a,h,p;c=c||{},a||(a=c!==void 0?c:{}),a.ready=new Promise(function(P,M){h=P,p=M});var d,l,n,e,o,u,g=Object.assign({},a),m="./this.program",y=(P,M)=>{throw M},b=typeof window=="object",_=typeof importScripts=="function",x=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",w="";x?(w=_?r(908).dirname(w)+"/":"//",u=()=>{o||(e=r(1384),o=r(908))},d=function(P,M){return u(),P=o.normalize(P),e.readFileSync(P,M?void 0:"utf8")},n=P=>((P=d(P,!0)).buffer||(P=new Uint8Array(P)),P),l=(P,M,B)=>{u(),P=o.normalize(P),e.readFile(P,function(U,G){U?B(U):M(G.buffer)})},1<process.argv.length&&(m=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",function(P){if(!(P instanceof zt))throw P}),process.on("unhandledRejection",function(P){throw P}),y=(P,M)=>{if(v||0<$t)throw process.exitCode=P,M;M instanceof zt||I("exiting due to exception: "+M),process.exit(P)},a.inspect=function(){return"[Emscripten Module object]"}):(b||_)&&(_?w=self.location.href:typeof document<"u"&&document.currentScript&&(w=document.currentScript.src),i&&(w=i),w=w.indexOf("blob:")!==0?w.substr(0,w.replace(/[?#].*/,"").lastIndexOf("/")+1):"",d=P=>{var M=new XMLHttpRequest;return M.open("GET",P,!1),M.send(null),M.responseText},_&&(n=P=>{var M=new XMLHttpRequest;return M.open("GET",P,!1),M.responseType="arraybuffer",M.send(null),new Uint8Array(M.response)}),l=(P,M,B)=>{var U=new XMLHttpRequest;U.open("GET",P,!0),U.responseType="arraybuffer",U.onload=()=>{U.status==200||U.status==0&&U.response?M(U.response):B()},U.onerror=B,U.send(null)});var T,S=a.print||console.log.bind(console),I=a.printErr||console.warn.bind(console);Object.assign(a,g),g=null,a.thisProgram&&(m=a.thisProgram),a.quit&&(y=a.quit),a.wasmBinary&&(T=a.wasmBinary);var v=a.noExitRuntime||!1;typeof WebAssembly!="object"&&St("no native wasm support detected");var A,L,N,$,D,R,O=!1,F=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function z(P,M,B){var U=(M>>>=0)+B;for(B=M;P[B]&&!(B>=U);)++B;if(16<B-M&&P.buffer&&F)return F.decode(P.subarray(M,B));for(U="";M<B;){var G=P[M++];if(128&G){var Y=63&P[M++];if((224&G)==192)U+=String.fromCharCode((31&G)<<6|Y);else{var Q=63&P[M++];65536>(G=(240&G)==224?(15&G)<<12|Y<<6|Q:(7&G)<<18|Y<<12|Q<<6|63&P[M++])?U+=String.fromCharCode(G):(G-=65536,U+=String.fromCharCode(55296|G>>10,56320|1023&G))}}else U+=String.fromCharCode(G)}return U}function W(P,M){return(P>>>=0)?z($,P,M):""}function Z(P,M,B,U){if(!(0<U))return 0;var G=B>>>=0;U=B+U-1;for(var Y=0;Y<P.length;++Y){var Q=P.charCodeAt(Y);if(55296<=Q&&57343>=Q&&(Q=65536+((1023&Q)<<10)|1023&P.charCodeAt(++Y)),127>=Q){if(B>=U)break;M[B++>>>0]=Q}else{if(2047>=Q){if(B+1>=U)break;M[B++>>>0]=192|Q>>6}else{if(65535>=Q){if(B+2>=U)break;M[B++>>>0]=224|Q>>12}else{if(B+3>=U)break;M[B++>>>0]=240|Q>>18,M[B++>>>0]=128|Q>>12&63}M[B++>>>0]=128|Q>>6&63}M[B++>>>0]=128|63&Q}}return M[B>>>0]=0,B-G}function J(P){for(var M=0,B=0;B<P.length;++B){var U=P.charCodeAt(B);127>=U?M++:2047>=U?M+=2:55296<=U&&57343>=U?(M+=4,++B):M+=3}return M}function nt(){var P=A.buffer;L=P,a.HEAP8=N=new Int8Array(P),a.HEAP16=new Int16Array(P),a.HEAP32=D=new Int32Array(P),a.HEAPU8=$=new Uint8Array(P),a.HEAPU16=new Uint16Array(P),a.HEAPU32=R=new Uint32Array(P),a.HEAPF32=new Float32Array(P),a.HEAPF64=new Float64Array(P)}var wt,K=[],st=[],Tt=[],xt=[],$t=0;function Qt(){var P=a.preRun.shift();K.unshift(P)}var Ot,Ft=0,Mt=null;function St(P){throw a.onAbort&&a.onAbort(P),I(P="Aborted("+P+")"),O=!0,P=new WebAssembly.RuntimeError(P+". Build with -sASSERTIONS for more info."),p(P),P}function vt(){return Ot.startsWith("data:application/octet-stream;base64,")}if(Ot="ort-wasm.wasm",!vt()){var jt=Ot;Ot=a.locateFile?a.locateFile(jt,w):w+jt}function Gt(){var P=Ot;try{if(P==Ot&&T)return new Uint8Array(T);if(n)return n(P);throw"both async and sync fetching of the wasm failed"}catch(M){St(M)}}function zt(P){this.name="ExitStatus",this.message="Program terminated with exit("+P+")",this.status=P}function Xt(P){for(;0<P.length;)P.shift()(a)}var Kt=[],Wt=0,Yt=0;function It(P){this.Db=P,this.zb=P-24,this.Ub=function(M){R[this.zb+4>>2>>>0]=M},this.Eb=function(){return R[this.zb+4>>2>>>0]},this.Sb=function(M){R[this.zb+8>>2>>>0]=M},this.Wb=function(){return R[this.zb+8>>2>>>0]},this.Tb=function(){D[this.zb>>2>>>0]=0},this.Ib=function(M){N[this.zb+12>>0>>>0]=M?1:0},this.Pb=function(){return N[this.zb+12>>0>>>0]!=0},this.Jb=function(M){N[this.zb+13>>0>>>0]=M?1:0},this.Lb=function(){return N[this.zb+13>>0>>>0]!=0},this.Rb=function(M,B){this.Fb(0),this.Ub(M),this.Sb(B),this.Tb(),this.Ib(!1),this.Jb(!1)},this.Nb=function(){D[this.zb>>2>>>0]+=1},this.Xb=function(){var M=D[this.zb>>2>>>0];return D[this.zb>>2>>>0]=M-1,M===1},this.Fb=function(M){R[this.zb+16>>2>>>0]=M},this.Ob=function(){return R[this.zb+16>>2>>>0]},this.Qb=function(){if(be(this.Eb()))return R[this.Db>>2>>>0];var M=this.Ob();return M!==0?M:this.Db}}function Ht(P){return ce(new It(P).zb)}var qt=[];function ct(P){var M=qt[P];return M||(P>=qt.length&&(qt.length=P+1),qt[P]=M=wt.get(P)),M}function Ee(P){var M=J(P)+1,B=bt(M);return B&&Z(P,N,B,M),B}var xe={};function Oe(){if(!ee){var P,M={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:m||"./this.program"};for(P in xe)xe[P]===void 0?delete M[P]:M[P]=xe[P];var B=[];for(P in M)B.push(P+"="+M[P]);ee=B}return ee}var ee,le=[null,[],[]];function ve(P,M){var B=le[P];M===0||M===10?((P===1?S:I)(z(B,0)),B.length=0):B.push(M)}var Dt=0;function te(P){return P%4==0&&(P%100!=0||P%400==0)}var ot=[31,29,31,30,31,30,31,31,30,31,30,31],ne=[31,28,31,30,31,30,31,31,30,31,30,31];function de(P,M,B,U){function G(q,yt,At){for(q=typeof q=="number"?q.toString():q||"";q.length<yt;)q=At[0]+q;return q}function Y(q,yt){return G(q,yt,"0")}function Q(q,yt){function At(_e){return 0>_e?-1:0<_e?1:0}var re;return(re=At(q.getFullYear()-yt.getFullYear()))===0&&(re=At(q.getMonth()-yt.getMonth()))===0&&(re=At(q.getDate()-yt.getDate())),re}function rt(q){switch(q.getDay()){case 0:return new Date(q.getFullYear()-1,11,29);case 1:return q;case 2:return new Date(q.getFullYear(),0,3);case 3:return new Date(q.getFullYear(),0,2);case 4:return new Date(q.getFullYear(),0,1);case 5:return new Date(q.getFullYear()-1,11,31);case 6:return new Date(q.getFullYear()-1,11,30)}}function et(q){var yt=q.Bb;for(q=new Date(new Date(q.Cb+1900,0,1).getTime());0<yt;){var At=q.getMonth(),re=(te(q.getFullYear())?ot:ne)[At];if(!(yt>re-q.getDate())){q.setDate(q.getDate()+yt);break}yt-=re-q.getDate()+1,q.setDate(1),11>At?q.setMonth(At+1):(q.setMonth(0),q.setFullYear(q.getFullYear()+1))}return At=new Date(q.getFullYear()+1,0,4),yt=rt(new Date(q.getFullYear(),0,4)),At=rt(At),0>=Q(yt,q)?0>=Q(At,q)?q.getFullYear()+1:q.getFullYear():q.getFullYear()-1}var ht=D[U+40>>2>>>0];for(var Et in U={$b:D[U>>2>>>0],Zb:D[U+4>>2>>>0],Gb:D[U+8>>2>>>0],Kb:D[U+12>>2>>>0],Hb:D[U+16>>2>>>0],Cb:D[U+20>>2>>>0],Ab:D[U+24>>2>>>0],Bb:D[U+28>>2>>>0],bc:D[U+32>>2>>>0],Yb:D[U+36>>2>>>0],ac:ht?W(ht):""},B=W(B),ht={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})B=B.replace(new RegExp(Et,"g"),ht[Et]);var Vt="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Nt="January February March April May June July August September October November December".split(" ");for(Et in ht={"%a":function(q){return Vt[q.Ab].substring(0,3)},"%A":function(q){return Vt[q.Ab]},"%b":function(q){return Nt[q.Hb].substring(0,3)},"%B":function(q){return Nt[q.Hb]},"%C":function(q){return Y((q.Cb+1900)/100|0,2)},"%d":function(q){return Y(q.Kb,2)},"%e":function(q){return G(q.Kb,2," ")},"%g":function(q){return et(q).toString().substring(2)},"%G":function(q){return et(q)},"%H":function(q){return Y(q.Gb,2)},"%I":function(q){return(q=q.Gb)==0?q=12:12<q&&(q-=12),Y(q,2)},"%j":function(q){for(var yt=0,At=0;At<=q.Hb-1;yt+=(te(q.Cb+1900)?ot:ne)[At++]);return Y(q.Kb+yt,3)},"%m":function(q){return Y(q.Hb+1,2)},"%M":function(q){return Y(q.Zb,2)},"%n":function(){return`
`},"%p":function(q){return 0<=q.Gb&&12>q.Gb?"AM":"PM"},"%S":function(q){return Y(q.$b,2)},"%t":function(){return"	"},"%u":function(q){return q.Ab||7},"%U":function(q){return Y(Math.floor((q.Bb+7-q.Ab)/7),2)},"%V":function(q){var yt=Math.floor((q.Bb+7-(q.Ab+6)%7)/7);if(2>=(q.Ab+371-q.Bb-2)%7&&yt++,yt)yt==53&&((At=(q.Ab+371-q.Bb)%7)==4||At==3&&te(q.Cb)||(yt=1));else{yt=52;var At=(q.Ab+7-q.Bb-1)%7;(At==4||At==5&&te(q.Cb%400-1))&&yt++}return Y(yt,2)},"%w":function(q){return q.Ab},"%W":function(q){return Y(Math.floor((q.Bb+7-(q.Ab+6)%7)/7),2)},"%y":function(q){return(q.Cb+1900).toString().substring(2)},"%Y":function(q){return q.Cb+1900},"%z":function(q){var yt=0<=(q=q.Yb);return q=Math.abs(q)/60,(yt?"+":"-")+("0000"+(q/60*100+q%60)).slice(-4)},"%Z":function(q){return q.ac},"%%":function(){return"%"}},B=B.replace(/%%/g,"\0\0"),ht)B.includes(Et)&&(B=B.replace(new RegExp(Et,"g"),ht[Et](U)));return Et=function(q){var yt=Array(J(q)+1);return Z(q,yt,0,yt.length),yt}(B=B.replace(/\0\0/g,"%")),Et.length>M?0:(N.set(Et,P>>>0),Et.length-1)}var pe={a:function(P){return bt(P+24)+24},m:function(P){return(P=new It(P)).Pb()||(P.Ib(!0),Wt--),P.Jb(!1),Kt.push(P),P.Nb(),P.Qb()},ia:function(P){throw I("Unexpected exception thrown, this is not properly supported - aborting"),O=!0,P},w:function(){lt(0);var P=Kt.pop();if(P.Xb()&&!P.Lb()){var M=P.Wb();M&&ct(M)(P.Db),Ht(P.Db)}Yt=0},d:function(){var P=Yt;if(!P)return Dt=0;var M=new It(P);M.Fb(P);var B=M.Eb();if(!B)return Dt=0,P;for(var U=Array.prototype.slice.call(arguments),G=0;G<U.length;G++){var Y=U[G];if(Y===0||Y===B)break;if(he(Y,B,M.zb+16))return Dt=Y,P}return Dt=B,P},k:function(){var P=Yt;if(!P)return Dt=0;var M=new It(P);M.Fb(P);var B=M.Eb();if(!B)return Dt=0,P;for(var U=Array.prototype.slice.call(arguments),G=0;G<U.length;G++){var Y=U[G];if(Y===0||Y===B)break;if(he(Y,B,M.zb+16))return Dt=Y,P}return Dt=B,P},g:function(){var P=Yt;if(!P)return Dt=0;var M=new It(P);M.Fb(P);var B=M.Eb();if(!B)return Dt=0,P;for(var U=Array.prototype.slice.call(arguments),G=0;G<U.length;G++){var Y=U[G];if(Y===0||Y===B)break;if(he(Y,B,M.zb+16))return Dt=Y,P}return Dt=B,P},s:Ht,L:function(){var P=Kt.pop();P||St("no exception to throw");var M=P.Db;throw P.Lb()||(Kt.push(P),P.Jb(!0),P.Ib(!1),Wt++),Yt=M,M},b:function(P,M,B){throw new It(P).Rb(M,B),Yt=P,Wt++,P},la:function(){return Wt},i:function(P){throw Yt||(Yt=P),P},H:function(){return 0},Ba:function(){},pa:function(){},ra:function(){},ka:function(){return 0},za:function(){},ua:function(){},ya:function(){},R:function(){},qa:function(){},na:function(){},Aa:function(){},oa:function(){},Ha:function(){},Ja:function(){St("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},Ia:function(){St("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},S:function(){return Date.now()},Ca:function(){return!0},Da:function(P,M){P=new Date(1e3*(R[P>>>2]+4294967296*D[P+4>>>2])),D[M>>2>>>0]=P.getUTCSeconds(),D[M+4>>2>>>0]=P.getUTCMinutes(),D[M+8>>2>>>0]=P.getUTCHours(),D[M+12>>2>>>0]=P.getUTCDate(),D[M+16>>2>>>0]=P.getUTCMonth(),D[M+20>>2>>>0]=P.getUTCFullYear()-1900,D[M+24>>2>>>0]=P.getUTCDay(),D[M+28>>2>>>0]=(P.getTime()-Date.UTC(P.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},Ea:function(P,M){P=new Date(1e3*(R[P>>>2]+4294967296*D[P+4>>>2])),D[M>>2>>>0]=P.getSeconds(),D[M+4>>2>>>0]=P.getMinutes(),D[M+8>>2>>>0]=P.getHours(),D[M+12>>2>>>0]=P.getDate(),D[M+16>>2>>>0]=P.getMonth(),D[M+20>>2>>>0]=P.getFullYear()-1900,D[M+24>>2>>>0]=P.getDay();var B=new Date(P.getFullYear(),0,1);D[M+28>>2>>>0]=(P.getTime()-B.getTime())/864e5|0,D[M+36>>2>>>0]=-60*P.getTimezoneOffset();var U=new Date(P.getFullYear(),6,1).getTimezoneOffset();B=B.getTimezoneOffset(),D[M+32>>2>>>0]=0|(U!=B&&P.getTimezoneOffset()==Math.min(B,U))},Fa:function(P){var M=new Date(D[P+20>>2>>>0]+1900,D[P+16>>2>>>0],D[P+12>>2>>>0],D[P+8>>2>>>0],D[P+4>>2>>>0],D[P>>2>>>0],0),B=D[P+32>>2>>>0],U=M.getTimezoneOffset(),G=new Date(M.getFullYear(),0,1),Y=new Date(M.getFullYear(),6,1).getTimezoneOffset(),Q=G.getTimezoneOffset(),rt=Math.min(Q,Y);return 0>B?D[P+32>>2>>>0]=+(Y!=Q&&rt==U):0<B!=(rt==U)&&(Y=Math.max(Q,Y),M.setTime(M.getTime()+6e4*((0<B?rt:Y)-U))),D[P+24>>2>>>0]=M.getDay(),D[P+28>>2>>>0]=(M.getTime()-G.getTime())/864e5|0,D[P>>2>>>0]=M.getSeconds(),D[P+4>>2>>>0]=M.getMinutes(),D[P+8>>2>>>0]=M.getHours(),D[P+12>>2>>>0]=M.getDate(),D[P+16>>2>>>0]=M.getMonth(),M.getTime()/1e3|0},sa:function(){return-52},ta:function(){},Ga:function P(M,B,U){P.Vb||(P.Vb=!0,function(G,Y,Q){function rt(Nt){return(Nt=Nt.toTimeString().match(/\(([A-Za-z ]+)\)$/))?Nt[1]:"GMT"}var et=new Date().getFullYear(),ht=new Date(et,0,1),Et=new Date(et,6,1);et=ht.getTimezoneOffset();var Vt=Et.getTimezoneOffset();D[G>>2>>>0]=60*Math.max(et,Vt),D[Y>>2>>>0]=+(et!=Vt),G=rt(ht),Y=rt(Et),G=Ee(G),Y=Ee(Y),Vt<et?(R[Q>>2>>>0]=G,R[Q+4>>2>>>0]=Y):(R[Q>>2>>>0]=Y,R[Q+4>>2>>>0]=G)}(M,B,U))},B:function(){St("")},ma:function(){return 4294901760},I:x?()=>{var P=process.hrtime();return 1e3*P[0]+P[1]/1e6}:()=>performance.now(),xa:function(P,M,B){$.copyWithin(P>>>0,M>>>0,M+B>>>0)},G:function(P){var M=$.length;if(4294901760<(P>>>=0))return!1;for(var B=1;4>=B;B*=2){var U=M*(1+.2/B);U=Math.min(U,P+100663296);var G=Math;U=Math.max(P,U),G=G.min.call(G,4294901760,U+(65536-U%65536)%65536);t:{try{A.grow(G-L.byteLength+65535>>>16),nt();var Y=1;break t}catch{}Y=void 0}if(Y)return!0}return!1},va:function(P,M){var B=0;return Oe().forEach(function(U,G){var Y=M+B;for(G=R[P+4*G>>2>>>0]=Y,Y=0;Y<U.length;++Y)N[G++>>0>>>0]=U.charCodeAt(Y);N[G>>0>>>0]=0,B+=U.length+1}),0},wa:function(P,M){var B=Oe();R[P>>2>>>0]=B.length;var U=0;return B.forEach(function(G){U+=G.length+1}),R[M>>2>>>0]=U,0},ba:function(P){v||0<$t||(me(),Xt(Tt),ge(0),le[1].length&&ve(1,10),le[2].length&&ve(2,10)),v||0<$t||(a.onExit&&a.onExit(P),O=!0),y(P,new zt(P))},E:function(){return 52},Q:function(){return 52},ca:function(){return 70},P:function(P,M,B,U){for(var G=0,Y=0;Y<B;Y++){var Q=R[M>>2>>>0],rt=R[M+4>>2>>>0];M+=8;for(var et=0;et<rt;et++)ve(P,$[Q+et>>>0]);G+=rt}return R[U>>2>>>0]=G,0},c:function(){return Dt},ja:function P(M,B){P.Mb||(P.Mb=function(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var G=new Uint8Array(1);return()=>(crypto.getRandomValues(G),G[0])}if(x)try{var Y=r(Object(function(){var Q=new Error("Cannot find module 'crypto'");throw Q.code="MODULE_NOT_FOUND",Q}()));return()=>Y.randomBytes(1)[0]}catch{}return()=>St("randomDevice")}());for(var U=0;U<B;U++)N[M+U>>0>>>0]=P.Mb();return 0},ea:function(P,M,B){var U=at();try{return ct(P)(M,B)}catch(G){if(ut(U),G!==G+0)throw G;lt(1,0)}},fa:function(P,M,B){var U=at();try{return ct(P)(M,B)}catch(G){if(ut(U),G!==G+0)throw G;lt(1,0)}},J:function(P){var M=at();try{return ct(P)()}catch(B){if(ut(M),B!==B+0)throw B;lt(1,0)}},e:function(P,M){var B=at();try{return ct(P)(M)}catch(U){if(ut(B),U!==U+0)throw U;lt(1,0)}},N:function(P,M,B){var U=at();try{return ct(P)(M,B)}catch(G){if(ut(U),G!==G+0)throw G;lt(1,0)}},O:function(P,M,B){var U=at();try{return ct(P)(M,B)}catch(G){if(ut(U),G!==G+0)throw G;lt(1,0)}},j:function(P,M,B){var U=at();try{return ct(P)(M,B)}catch(G){if(ut(U),G!==G+0)throw G;lt(1,0)}},o:function(P,M,B,U){var G=at();try{return ct(P)(M,B,U)}catch(Y){if(ut(G),Y!==Y+0)throw Y;lt(1,0)}},p:function(P,M,B,U,G){var Y=at();try{return ct(P)(M,B,U,G)}catch(Q){if(ut(Y),Q!==Q+0)throw Q;lt(1,0)}},M:function(P,M,B,U,G,Y){var Q=at();try{return ct(P)(M,B,U,G,Y)}catch(rt){if(ut(Q),rt!==rt+0)throw rt;lt(1,0)}},r:function(P,M,B,U,G,Y){var Q=at();try{return ct(P)(M,B,U,G,Y)}catch(rt){if(ut(Q),rt!==rt+0)throw rt;lt(1,0)}},v:function(P,M,B,U,G,Y,Q){var rt=at();try{return ct(P)(M,B,U,G,Y,Q)}catch(et){if(ut(rt),et!==et+0)throw et;lt(1,0)}},K:function(P,M,B,U,G,Y,Q,rt){var et=at();try{return ct(P)(M,B,U,G,Y,Q,rt)}catch(ht){if(ut(et),ht!==ht+0)throw ht;lt(1,0)}},D:function(P,M,B,U,G,Y,Q,rt,et,ht,Et,Vt){var Nt=at();try{return ct(P)(M,B,U,G,Y,Q,rt,et,ht,Et,Vt)}catch(q){if(ut(Nt),q!==q+0)throw q;lt(1,0)}},X:function(P,M,B,U,G,Y,Q,rt){var et=at();try{return Lt(P,M,B,U,G,Y,Q,rt)}catch(ht){if(ut(et),ht!==ht+0)throw ht;lt(1,0)}},V:function(P,M,B,U,G,Y,Q){var rt=at();try{return ae(P,M,B,U,G,Y,Q)}catch(et){if(ut(rt),et!==et+0)throw et;lt(1,0)}},U:function(P,M,B,U,G){var Y=at();try{return Ut(P,M,B,U,G)}catch(Q){if(ut(Y),Q!==Q+0)throw Q;lt(1,0)}},Z:function(P,M,B,U){var G=at();try{return Bt(P,M,B,U)}catch(Y){if(ut(G),Y!==Y+0)throw Y;lt(1,0)}},W:function(P){var M=at();try{return se(P)}catch(B){if(ut(M),B!==B+0)throw B;lt(1,0)}},Y:function(P,M){var B=at();try{return Pt(P,M)}catch(U){if(ut(B),U!==U+0)throw U;lt(1,0)}},T:function(P,M,B){var U=at();try{return ue(P,M,B)}catch(G){if(ut(U),G!==G+0)throw G;lt(1,0)}},f:function(P){var M=at();try{ct(P)()}catch(B){if(ut(M),B!==B+0)throw B;lt(1,0)}},q:function(P,M){var B=at();try{ct(P)(M)}catch(U){if(ut(B),U!==U+0)throw U;lt(1,0)}},h:function(P,M,B){var U=at();try{ct(P)(M,B)}catch(G){if(ut(U),G!==G+0)throw G;lt(1,0)}},da:function(P,M,B,U){var G=at();try{ct(P)(M,B,U)}catch(Y){if(ut(G),Y!==Y+0)throw Y;lt(1,0)}},l:function(P,M,B,U){var G=at();try{ct(P)(M,B,U)}catch(Y){if(ut(G),Y!==Y+0)throw Y;lt(1,0)}},t:function(P,M,B,U,G){var Y=at();try{ct(P)(M,B,U,G)}catch(Q){if(ut(Y),Q!==Q+0)throw Q;lt(1,0)}},u:function(P,M,B,U,G,Y){var Q=at();try{ct(P)(M,B,U,G,Y)}catch(rt){if(ut(Q),rt!==rt+0)throw rt;lt(1,0)}},x:function(P,M,B,U,G,Y,Q){var rt=at();try{ct(P)(M,B,U,G,Y,Q)}catch(et){if(ut(rt),et!==et+0)throw et;lt(1,0)}},z:function(P,M,B,U,G,Y,Q,rt){var et=at();try{ct(P)(M,B,U,G,Y,Q,rt)}catch(ht){if(ut(et),ht!==ht+0)throw ht;lt(1,0)}},ga:function(P,M,B,U,G,Y,Q,rt,et){var ht=at();try{ct(P)(M,B,U,G,Y,Q,rt,et)}catch(Et){if(ut(ht),Et!==Et+0)throw Et;lt(1,0)}},A:function(P,M,B,U,G,Y,Q,rt,et,ht,Et){var Vt=at();try{ct(P)(M,B,U,G,Y,Q,rt,et,ht,Et)}catch(Nt){if(ut(Vt),Nt!==Nt+0)throw Nt;lt(1,0)}},C:function(P,M,B,U,G,Y,Q,rt,et,ht,Et,Vt,Nt,q,yt,At){var re=at();try{ct(P)(M,B,U,G,Y,Q,rt,et,ht,Et,Vt,Nt,q,yt,At)}catch(_e){if(ut(re),_e!==_e+0)throw _e;lt(1,0)}},aa:function(P,M,B,U,G,Y,Q,rt){var et=at();try{Te(P,M,B,U,G,Y,Q,rt)}catch(ht){if(ut(et),ht!==ht+0)throw ht;lt(1,0)}},_:function(P,M,B,U,G,Y,Q,rt,et,ht,Et,Vt){var Nt=at();try{Ct(P,M,B,U,G,Y,Q,rt,et,ht,Et,Vt)}catch(q){if(ut(Nt),q!==q+0)throw q;lt(1,0)}},$:function(P,M,B,U,G,Y){var Q=at();try{Se(P,M,B,U,G,Y)}catch(rt){if(ut(Q),rt!==rt+0)throw rt;lt(1,0)}},n:function(P){return P},F:function(P){Dt=P},ha:de,y:function(P,M,B,U){return de(P,M,B,U)}};(function(){function P(G){a.asm=G.exports,A=a.asm.Ka,nt(),wt=a.asm.ib,st.unshift(a.asm.La),Ft--,a.monitorRunDependencies&&a.monitorRunDependencies(Ft),Ft==0&&Mt&&(G=Mt,Mt=null,G())}function M(G){P(G.instance)}function B(G){return function(){if(!T&&(b||_)){if(typeof fetch=="function"&&!Ot.startsWith("file://"))return fetch(Ot,{credentials:"same-origin"}).then(function(Y){if(!Y.ok)throw"failed to load wasm binary file at '"+Ot+"'";return Y.arrayBuffer()}).catch(function(){return Gt()});if(l)return new Promise(function(Y,Q){l(Ot,function(rt){Y(new Uint8Array(rt))},Q)})}return Promise.resolve().then(function(){return Gt()})}().then(function(Y){return WebAssembly.instantiate(Y,U)}).then(function(Y){return Y}).then(G,function(Y){I("failed to asynchronously prepare wasm: "+Y),St(Y)})}var U={a:pe};if(Ft++,a.monitorRunDependencies&&a.monitorRunDependencies(Ft),a.instantiateWasm)try{return a.instantiateWasm(U,P)}catch(G){return I("Module.instantiateWasm callback failed with error: "+G),!1}(T||typeof WebAssembly.instantiateStreaming!="function"||vt()||Ot.startsWith("file://")||x||typeof fetch!="function"?B(M):fetch(Ot,{credentials:"same-origin"}).then(function(G){return WebAssembly.instantiateStreaming(G,U).then(M,function(Y){return I("wasm streaming compile failed: "+Y),I("falling back to ArrayBuffer instantiation"),B(M)})})).catch(p)})(),a.___wasm_call_ctors=function(){return(a.___wasm_call_ctors=a.asm.La).apply(null,arguments)},a._OrtInit=function(){return(a._OrtInit=a.asm.Ma).apply(null,arguments)},a._OrtCreateSessionOptions=function(){return(a._OrtCreateSessionOptions=a.asm.Na).apply(null,arguments)},a._OrtAppendExecutionProvider=function(){return(a._OrtAppendExecutionProvider=a.asm.Oa).apply(null,arguments)},a._OrtAddSessionConfigEntry=function(){return(a._OrtAddSessionConfigEntry=a.asm.Pa).apply(null,arguments)},a._OrtReleaseSessionOptions=function(){return(a._OrtReleaseSessionOptions=a.asm.Qa).apply(null,arguments)},a._OrtCreateSession=function(){return(a._OrtCreateSession=a.asm.Ra).apply(null,arguments)},a._OrtReleaseSession=function(){return(a._OrtReleaseSession=a.asm.Sa).apply(null,arguments)},a._OrtGetInputCount=function(){return(a._OrtGetInputCount=a.asm.Ta).apply(null,arguments)},a._OrtGetOutputCount=function(){return(a._OrtGetOutputCount=a.asm.Ua).apply(null,arguments)},a._OrtGetInputName=function(){return(a._OrtGetInputName=a.asm.Va).apply(null,arguments)},a._OrtGetOutputName=function(){return(a._OrtGetOutputName=a.asm.Wa).apply(null,arguments)},a._OrtFree=function(){return(a._OrtFree=a.asm.Xa).apply(null,arguments)},a._OrtCreateTensor=function(){return(a._OrtCreateTensor=a.asm.Ya).apply(null,arguments)},a._OrtGetTensorData=function(){return(a._OrtGetTensorData=a.asm.Za).apply(null,arguments)},a._OrtReleaseTensor=function(){return(a._OrtReleaseTensor=a.asm._a).apply(null,arguments)},a._OrtCreateRunOptions=function(){return(a._OrtCreateRunOptions=a.asm.$a).apply(null,arguments)},a._OrtAddRunConfigEntry=function(){return(a._OrtAddRunConfigEntry=a.asm.ab).apply(null,arguments)},a._OrtReleaseRunOptions=function(){return(a._OrtReleaseRunOptions=a.asm.bb).apply(null,arguments)},a._OrtRun=function(){return(a._OrtRun=a.asm.cb).apply(null,arguments)},a._OrtEndProfiling=function(){return(a._OrtEndProfiling=a.asm.db).apply(null,arguments)};var oe,bt=a._malloc=function(){return(bt=a._malloc=a.asm.eb).apply(null,arguments)},ce=a._free=function(){return(ce=a._free=a.asm.fb).apply(null,arguments)},ge=a._fflush=function(){return(ge=a._fflush=a.asm.gb).apply(null,arguments)},me=a.___funcs_on_exit=function(){return(me=a.___funcs_on_exit=a.asm.hb).apply(null,arguments)},lt=a._setThrew=function(){return(lt=a._setThrew=a.asm.jb).apply(null,arguments)},at=a.stackSave=function(){return(at=a.stackSave=a.asm.kb).apply(null,arguments)},ut=a.stackRestore=function(){return(ut=a.stackRestore=a.asm.lb).apply(null,arguments)},ye=a.stackAlloc=function(){return(ye=a.stackAlloc=a.asm.mb).apply(null,arguments)},he=a.___cxa_can_catch=function(){return(he=a.___cxa_can_catch=a.asm.nb).apply(null,arguments)},be=a.___cxa_is_pointer_type=function(){return(be=a.___cxa_is_pointer_type=a.asm.ob).apply(null,arguments)},se=a.dynCall_j=function(){return(se=a.dynCall_j=a.asm.pb).apply(null,arguments)},ae=a.dynCall_iiiiij=function(){return(ae=a.dynCall_iiiiij=a.asm.qb).apply(null,arguments)},ue=a.dynCall_jii=function(){return(ue=a.dynCall_jii=a.asm.rb).apply(null,arguments)},Te=a.dynCall_viiiiij=function(){return(Te=a.dynCall_viiiiij=a.asm.sb).apply(null,arguments)},Se=a.dynCall_vjji=function(){return(Se=a.dynCall_vjji=a.asm.tb).apply(null,arguments)},Ct=a.dynCall_viiijjjii=function(){return(Ct=a.dynCall_viiijjjii=a.asm.ub).apply(null,arguments)},Bt=a.dynCall_iij=function(){return(Bt=a.dynCall_iij=a.asm.vb).apply(null,arguments)},Pt=a.dynCall_ji=function(){return(Pt=a.dynCall_ji=a.asm.wb).apply(null,arguments)},Lt=a.dynCall_iiiiiij=function(){return(Lt=a.dynCall_iiiiiij=a.asm.xb).apply(null,arguments)},Ut=a.dynCall_iiij=function(){return(Ut=a.dynCall_iiij=a.asm.yb).apply(null,arguments)};function Zt(){function P(){if(!oe&&(oe=!0,a.calledRun=!0,!O)){if(Xt(st),h(a),a.onRuntimeInitialized&&a.onRuntimeInitialized(),a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;){var M=a.postRun.shift();xt.unshift(M)}Xt(xt)}}if(!(0<Ft)){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)Qt();Xt(K),0<Ft||(a.setStatus?(a.setStatus("Running..."),setTimeout(function(){setTimeout(function(){a.setStatus("")},1),P()},1)):P())}}if(a.UTF8ToString=W,a.stringToUTF8=function(P,M,B){return Z(P,$,M,B)},a.lengthBytesUTF8=J,a.stackSave=at,a.stackRestore=ut,a.stackAlloc=ye,Mt=function P(){oe||Zt(),oe||(Mt=P)},a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);0<a.preInit.length;)a.preInit.pop()();return Zt(),c.ready});f.exports=s},4537:f=>{f.exports=function(t,r){for(var i=new Array(arguments.length-1),s=0,c=2,a=!0;c<arguments.length;)i[s++]=arguments[c++];return new Promise(function(h,p){i[s]=function(d){if(a)if(a=!1,d)p(d);else{for(var l=new Array(arguments.length-1),n=0;n<l.length;)l[n++]=arguments[n];h.apply(null,l)}};try{t.apply(r||null,i)}catch(d){a&&(a=!1,p(d))}})}},7419:(f,t)=>{var r=t;r.length=function(h){var p=h.length;if(!p)return 0;for(var d=0;--p%4>1&&h.charAt(p)==="=";)++d;return Math.ceil(3*h.length)/4-d};for(var i=new Array(64),s=new Array(123),c=0;c<64;)s[i[c]=c<26?c+65:c<52?c+71:c<62?c-4:c-59|43]=c++;r.encode=function(h,p,d){for(var l,n=null,e=[],o=0,u=0;p<d;){var g=h[p++];switch(u){case 0:e[o++]=i[g>>2],l=(3&g)<<4,u=1;break;case 1:e[o++]=i[l|g>>4],l=(15&g)<<2,u=2;break;case 2:e[o++]=i[l|g>>6],e[o++]=i[63&g],u=0}o>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,e)),o=0)}return u&&(e[o++]=i[l],e[o++]=61,u===1&&(e[o++]=61)),n?(o&&n.push(String.fromCharCode.apply(String,e.slice(0,o))),n.join("")):String.fromCharCode.apply(String,e.slice(0,o))};var a="invalid encoding";r.decode=function(h,p,d){for(var l,n=d,e=0,o=0;o<h.length;){var u=h.charCodeAt(o++);if(u===61&&e>1)break;if((u=s[u])===void 0)throw Error(a);switch(e){case 0:l=u,e=1;break;case 1:p[d++]=l<<2|(48&u)>>4,l=u,e=2;break;case 2:p[d++]=(15&l)<<4|(60&u)>>2,l=u,e=3;break;case 3:p[d++]=(3&l)<<6|u,e=0}}if(e===1)throw Error(a);return d-n},r.test=function(h){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(h)}},9211:f=>{function t(){this._listeners={}}f.exports=t,t.prototype.on=function(r,i,s){return(this._listeners[r]||(this._listeners[r]=[])).push({fn:i,ctx:s||this}),this},t.prototype.off=function(r,i){if(r===void 0)this._listeners={};else if(i===void 0)this._listeners[r]=[];else for(var s=this._listeners[r],c=0;c<s.length;)s[c].fn===i?s.splice(c,1):++c;return this},t.prototype.emit=function(r){var i=this._listeners[r];if(i){for(var s=[],c=1;c<arguments.length;)s.push(arguments[c++]);for(c=0;c<i.length;)i[c].fn.apply(i[c++].ctx,s)}return this}},945:f=>{function t(a){return typeof Float32Array<"u"?function(){var h=new Float32Array([-0]),p=new Uint8Array(h.buffer),d=p[3]===128;function l(u,g,m){h[0]=u,g[m]=p[0],g[m+1]=p[1],g[m+2]=p[2],g[m+3]=p[3]}function n(u,g,m){h[0]=u,g[m]=p[3],g[m+1]=p[2],g[m+2]=p[1],g[m+3]=p[0]}function e(u,g){return p[0]=u[g],p[1]=u[g+1],p[2]=u[g+2],p[3]=u[g+3],h[0]}function o(u,g){return p[3]=u[g],p[2]=u[g+1],p[1]=u[g+2],p[0]=u[g+3],h[0]}a.writeFloatLE=d?l:n,a.writeFloatBE=d?n:l,a.readFloatLE=d?e:o,a.readFloatBE=d?o:e}():function(){function h(d,l,n,e){var o=l<0?1:0;if(o&&(l=-l),l===0)d(1/l>0?0:2147483648,n,e);else if(isNaN(l))d(2143289344,n,e);else if(l>34028234663852886e22)d((o<<31|2139095040)>>>0,n,e);else if(l<11754943508222875e-54)d((o<<31|Math.round(l/1401298464324817e-60))>>>0,n,e);else{var u=Math.floor(Math.log(l)/Math.LN2);d((o<<31|u+127<<23|8388607&Math.round(l*Math.pow(2,-u)*8388608))>>>0,n,e)}}function p(d,l,n){var e=d(l,n),o=2*(e>>31)+1,u=e>>>23&255,g=8388607&e;return u===255?g?NaN:o*(1/0):u===0?1401298464324817e-60*o*g:o*Math.pow(2,u-150)*(g+8388608)}a.writeFloatLE=h.bind(null,r),a.writeFloatBE=h.bind(null,i),a.readFloatLE=p.bind(null,s),a.readFloatBE=p.bind(null,c)}(),typeof Float64Array<"u"?function(){var h=new Float64Array([-0]),p=new Uint8Array(h.buffer),d=p[7]===128;function l(u,g,m){h[0]=u,g[m]=p[0],g[m+1]=p[1],g[m+2]=p[2],g[m+3]=p[3],g[m+4]=p[4],g[m+5]=p[5],g[m+6]=p[6],g[m+7]=p[7]}function n(u,g,m){h[0]=u,g[m]=p[7],g[m+1]=p[6],g[m+2]=p[5],g[m+3]=p[4],g[m+4]=p[3],g[m+5]=p[2],g[m+6]=p[1],g[m+7]=p[0]}function e(u,g){return p[0]=u[g],p[1]=u[g+1],p[2]=u[g+2],p[3]=u[g+3],p[4]=u[g+4],p[5]=u[g+5],p[6]=u[g+6],p[7]=u[g+7],h[0]}function o(u,g){return p[7]=u[g],p[6]=u[g+1],p[5]=u[g+2],p[4]=u[g+3],p[3]=u[g+4],p[2]=u[g+5],p[1]=u[g+6],p[0]=u[g+7],h[0]}a.writeDoubleLE=d?l:n,a.writeDoubleBE=d?n:l,a.readDoubleLE=d?e:o,a.readDoubleBE=d?o:e}():function(){function h(d,l,n,e,o,u){var g=e<0?1:0;if(g&&(e=-e),e===0)d(0,o,u+l),d(1/e>0?0:2147483648,o,u+n);else if(isNaN(e))d(0,o,u+l),d(2146959360,o,u+n);else if(e>17976931348623157e292)d(0,o,u+l),d((g<<31|2146435072)>>>0,o,u+n);else{var m;if(e<22250738585072014e-324)d((m=e/5e-324)>>>0,o,u+l),d((g<<31|m/4294967296)>>>0,o,u+n);else{var y=Math.floor(Math.log(e)/Math.LN2);y===1024&&(y=1023),d(4503599627370496*(m=e*Math.pow(2,-y))>>>0,o,u+l),d((g<<31|y+1023<<20|1048576*m&1048575)>>>0,o,u+n)}}}function p(d,l,n,e,o){var u=d(e,o+l),g=d(e,o+n),m=2*(g>>31)+1,y=g>>>20&2047,b=4294967296*(1048575&g)+u;return y===2047?b?NaN:m*(1/0):y===0?5e-324*m*b:m*Math.pow(2,y-1075)*(b+4503599627370496)}a.writeDoubleLE=h.bind(null,r,0,4),a.writeDoubleBE=h.bind(null,i,4,0),a.readDoubleLE=p.bind(null,s,0,4),a.readDoubleBE=p.bind(null,c,4,0)}(),a}function r(a,h,p){h[p]=255&a,h[p+1]=a>>>8&255,h[p+2]=a>>>16&255,h[p+3]=a>>>24}function i(a,h,p){h[p]=a>>>24,h[p+1]=a>>>16&255,h[p+2]=a>>>8&255,h[p+3]=255&a}function s(a,h){return(a[h]|a[h+1]<<8|a[h+2]<<16|a[h+3]<<24)>>>0}function c(a,h){return(a[h]<<24|a[h+1]<<16|a[h+2]<<8|a[h+3])>>>0}f.exports=t(t)},7199:module=>{function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(f){}return null}module.exports=inquire},6662:f=>{f.exports=function(t,r,i){var s=i||8192,c=s>>>1,a=null,h=s;return function(p){if(p<1||p>c)return t(p);h+p>s&&(a=t(s),h=0);var d=r.call(a,h,h+=p);return 7&h&&(h=1+(7|h)),d}}},4997:(f,t)=>{var r=t;r.length=function(i){for(var s=0,c=0,a=0;a<i.length;++a)(c=i.charCodeAt(a))<128?s+=1:c<2048?s+=2:(64512&c)==55296&&(64512&i.charCodeAt(a+1))==56320?(++a,s+=4):s+=3;return s},r.read=function(i,s,c){if(c-s<1)return"";for(var a,h=null,p=[],d=0;s<c;)(a=i[s++])<128?p[d++]=a:a>191&&a<224?p[d++]=(31&a)<<6|63&i[s++]:a>239&&a<365?(a=((7&a)<<18|(63&i[s++])<<12|(63&i[s++])<<6|63&i[s++])-65536,p[d++]=55296+(a>>10),p[d++]=56320+(1023&a)):p[d++]=(15&a)<<12|(63&i[s++])<<6|63&i[s++],d>8191&&((h||(h=[])).push(String.fromCharCode.apply(String,p)),d=0);return h?(d&&h.push(String.fromCharCode.apply(String,p.slice(0,d))),h.join("")):String.fromCharCode.apply(String,p.slice(0,d))},r.write=function(i,s,c){for(var a,h,p=c,d=0;d<i.length;++d)(a=i.charCodeAt(d))<128?s[c++]=a:a<2048?(s[c++]=a>>6|192,s[c++]=63&a|128):(64512&a)==55296&&(64512&(h=i.charCodeAt(d+1)))==56320?(a=65536+((1023&a)<<10)+(1023&h),++d,s[c++]=a>>18|240,s[c++]=a>>12&63|128,s[c++]=a>>6&63|128,s[c++]=63&a|128):(s[c++]=a>>12|224,s[c++]=a>>6&63|128,s[c++]=63&a|128);return c-p}},3442:(f,t)=>{t.__esModule=!0;var r=function(){function i(s){if(!s)throw new TypeError("Invalid argument; `value` has no value.");this.value=i.EMPTY,s&&i.isGuid(s)&&(this.value=s)}return i.isGuid=function(s){var c=s.toString();return s&&(s instanceof i||i.validator.test(c))},i.create=function(){return new i([i.gen(2),i.gen(1),i.gen(1),i.gen(1),i.gen(3)].join("-"))},i.createEmpty=function(){return new i("emptyguid")},i.parse=function(s){return new i(s)},i.raw=function(){return[i.gen(2),i.gen(1),i.gen(1),i.gen(1),i.gen(3)].join("-")},i.gen=function(s){for(var c="",a=0;a<s;a++)c+=(65536*(1+Math.random())|0).toString(16).substring(1);return c},i.prototype.equals=function(s){return i.isGuid(s)&&this.value===s.toString()},i.prototype.isEmpty=function(){return this.value===i.EMPTY},i.prototype.toString=function(){return this.value},i.prototype.toJSON=function(){return{value:this.value}},i.validator=new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i"),i.EMPTY="00000000-0000-0000-0000-000000000000",i}();t.Guid=r},3720:f=>{f.exports=r;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function r(v,A,L){this.low=0|v,this.high=0|A,this.unsigned=!!L}function i(v){return(v&&v.__isLong__)===!0}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=i;var s={},c={};function a(v,A){var L,N,$;return A?($=0<=(v>>>=0)&&v<256)&&(N=c[v])?N:(L=p(v,(0|v)<0?-1:0,!0),$&&(c[v]=L),L):($=-128<=(v|=0)&&v<128)&&(N=s[v])?N:(L=p(v,v<0?-1:0,!1),$&&(s[v]=L),L)}function h(v,A){if(isNaN(v))return A?y:m;if(A){if(v<0)return y;if(v>=o)return T}else{if(v<=-9223372036854776e3)return S;if(v+1>=u)return w}return v<0?h(-v,A).neg():p(v%e|0,v/e|0,A)}function p(v,A,L){return new r(v,A,L)}r.fromInt=a,r.fromNumber=h,r.fromBits=p;var d=Math.pow;function l(v,A,L){if(v.length===0)throw Error("empty string");if(v==="NaN"||v==="Infinity"||v==="+Infinity"||v==="-Infinity")return m;if(typeof A=="number"?(L=A,A=!1):A=!!A,(L=L||10)<2||36<L)throw RangeError("radix");var N;if((N=v.indexOf("-"))>0)throw Error("interior hyphen");if(N===0)return l(v.substring(1),A,L).neg();for(var $=h(d(L,8)),D=m,R=0;R<v.length;R+=8){var O=Math.min(8,v.length-R),F=parseInt(v.substring(R,R+O),L);if(O<8){var z=h(d(L,O));D=D.mul(z).add(h(F))}else D=(D=D.mul($)).add(h(F))}return D.unsigned=A,D}function n(v,A){return typeof v=="number"?h(v,A):typeof v=="string"?l(v,A):p(v.low,v.high,typeof A=="boolean"?A:v.unsigned)}r.fromString=l,r.fromValue=n;var e=4294967296,o=e*e,u=o/2,g=a(1<<24),m=a(0);r.ZERO=m;var y=a(0,!0);r.UZERO=y;var b=a(1);r.ONE=b;var _=a(1,!0);r.UONE=_;var x=a(-1);r.NEG_ONE=x;var w=p(-1,2147483647,!1);r.MAX_VALUE=w;var T=p(-1,-1,!0);r.MAX_UNSIGNED_VALUE=T;var S=p(0,-2147483648,!1);r.MIN_VALUE=S;var I=r.prototype;I.toInt=function(){return this.unsigned?this.low>>>0:this.low},I.toNumber=function(){return this.unsigned?(this.high>>>0)*e+(this.low>>>0):this.high*e+(this.low>>>0)},I.toString=function(v){if((v=v||10)<2||36<v)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(S)){var A=h(v),L=this.div(A),N=L.mul(A).sub(this);return L.toString(v)+N.toInt().toString(v)}return"-"+this.neg().toString(v)}for(var $=h(d(v,6),this.unsigned),D=this,R="";;){var O=D.div($),F=(D.sub(O.mul($)).toInt()>>>0).toString(v);if((D=O).isZero())return F+R;for(;F.length<6;)F="0"+F;R=""+F+R}},I.getHighBits=function(){return this.high},I.getHighBitsUnsigned=function(){return this.high>>>0},I.getLowBits=function(){return this.low},I.getLowBitsUnsigned=function(){return this.low>>>0},I.getNumBitsAbs=function(){if(this.isNegative())return this.eq(S)?64:this.neg().getNumBitsAbs();for(var v=this.high!=0?this.high:this.low,A=31;A>0&&(v&1<<A)==0;A--);return this.high!=0?A+33:A+1},I.isZero=function(){return this.high===0&&this.low===0},I.eqz=I.isZero,I.isNegative=function(){return!this.unsigned&&this.high<0},I.isPositive=function(){return this.unsigned||this.high>=0},I.isOdd=function(){return(1&this.low)==1},I.isEven=function(){return(1&this.low)==0},I.equals=function(v){return i(v)||(v=n(v)),(this.unsigned===v.unsigned||this.high>>>31!=1||v.high>>>31!=1)&&this.high===v.high&&this.low===v.low},I.eq=I.equals,I.notEquals=function(v){return!this.eq(v)},I.neq=I.notEquals,I.ne=I.notEquals,I.lessThan=function(v){return this.comp(v)<0},I.lt=I.lessThan,I.lessThanOrEqual=function(v){return this.comp(v)<=0},I.lte=I.lessThanOrEqual,I.le=I.lessThanOrEqual,I.greaterThan=function(v){return this.comp(v)>0},I.gt=I.greaterThan,I.greaterThanOrEqual=function(v){return this.comp(v)>=0},I.gte=I.greaterThanOrEqual,I.ge=I.greaterThanOrEqual,I.compare=function(v){if(i(v)||(v=n(v)),this.eq(v))return 0;var A=this.isNegative(),L=v.isNegative();return A&&!L?-1:!A&&L?1:this.unsigned?v.high>>>0>this.high>>>0||v.high===this.high&&v.low>>>0>this.low>>>0?-1:1:this.sub(v).isNegative()?-1:1},I.comp=I.compare,I.negate=function(){return!this.unsigned&&this.eq(S)?S:this.not().add(b)},I.neg=I.negate,I.add=function(v){i(v)||(v=n(v));var A=this.high>>>16,L=65535&this.high,N=this.low>>>16,$=65535&this.low,D=v.high>>>16,R=65535&v.high,O=v.low>>>16,F=0,z=0,W=0,Z=0;return W+=(Z+=$+(65535&v.low))>>>16,z+=(W+=N+O)>>>16,F+=(z+=L+R)>>>16,F+=A+D,p((W&=65535)<<16|(Z&=65535),(F&=65535)<<16|(z&=65535),this.unsigned)},I.subtract=function(v){return i(v)||(v=n(v)),this.add(v.neg())},I.sub=I.subtract,I.multiply=function(v){if(this.isZero())return m;if(i(v)||(v=n(v)),t)return p(t.mul(this.low,this.high,v.low,v.high),t.get_high(),this.unsigned);if(v.isZero())return m;if(this.eq(S))return v.isOdd()?S:m;if(v.eq(S))return this.isOdd()?S:m;if(this.isNegative())return v.isNegative()?this.neg().mul(v.neg()):this.neg().mul(v).neg();if(v.isNegative())return this.mul(v.neg()).neg();if(this.lt(g)&&v.lt(g))return h(this.toNumber()*v.toNumber(),this.unsigned);var A=this.high>>>16,L=65535&this.high,N=this.low>>>16,$=65535&this.low,D=v.high>>>16,R=65535&v.high,O=v.low>>>16,F=65535&v.low,z=0,W=0,Z=0,J=0;return Z+=(J+=$*F)>>>16,W+=(Z+=N*F)>>>16,Z&=65535,W+=(Z+=$*O)>>>16,z+=(W+=L*F)>>>16,W&=65535,z+=(W+=N*O)>>>16,W&=65535,z+=(W+=$*R)>>>16,z+=A*F+L*O+N*R+$*D,p((Z&=65535)<<16|(J&=65535),(z&=65535)<<16|(W&=65535),this.unsigned)},I.mul=I.multiply,I.divide=function(v){if(i(v)||(v=n(v)),v.isZero())throw Error("division by zero");var A,L,N;if(t)return this.unsigned||this.high!==-2147483648||v.low!==-1||v.high!==-1?p((this.unsigned?t.div_u:t.div_s)(this.low,this.high,v.low,v.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?y:m;if(this.unsigned){if(v.unsigned||(v=v.toUnsigned()),v.gt(this))return y;if(v.gt(this.shru(1)))return _;N=y}else{if(this.eq(S))return v.eq(b)||v.eq(x)?S:v.eq(S)?b:(A=this.shr(1).div(v).shl(1)).eq(m)?v.isNegative()?b:x:(L=this.sub(v.mul(A)),N=A.add(L.div(v)));if(v.eq(S))return this.unsigned?y:m;if(this.isNegative())return v.isNegative()?this.neg().div(v.neg()):this.neg().div(v).neg();if(v.isNegative())return this.div(v.neg()).neg();N=m}for(L=this;L.gte(v);){A=Math.max(1,Math.floor(L.toNumber()/v.toNumber()));for(var $=Math.ceil(Math.log(A)/Math.LN2),D=$<=48?1:d(2,$-48),R=h(A),O=R.mul(v);O.isNegative()||O.gt(L);)O=(R=h(A-=D,this.unsigned)).mul(v);R.isZero()&&(R=b),N=N.add(R),L=L.sub(O)}return N},I.div=I.divide,I.modulo=function(v){return i(v)||(v=n(v)),t?p((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,v.low,v.high),t.get_high(),this.unsigned):this.sub(this.div(v).mul(v))},I.mod=I.modulo,I.rem=I.modulo,I.not=function(){return p(~this.low,~this.high,this.unsigned)},I.and=function(v){return i(v)||(v=n(v)),p(this.low&v.low,this.high&v.high,this.unsigned)},I.or=function(v){return i(v)||(v=n(v)),p(this.low|v.low,this.high|v.high,this.unsigned)},I.xor=function(v){return i(v)||(v=n(v)),p(this.low^v.low,this.high^v.high,this.unsigned)},I.shiftLeft=function(v){return i(v)&&(v=v.toInt()),(v&=63)==0?this:v<32?p(this.low<<v,this.high<<v|this.low>>>32-v,this.unsigned):p(0,this.low<<v-32,this.unsigned)},I.shl=I.shiftLeft,I.shiftRight=function(v){return i(v)&&(v=v.toInt()),(v&=63)==0?this:v<32?p(this.low>>>v|this.high<<32-v,this.high>>v,this.unsigned):p(this.high>>v-32,this.high>=0?0:-1,this.unsigned)},I.shr=I.shiftRight,I.shiftRightUnsigned=function(v){if(i(v)&&(v=v.toInt()),(v&=63)==0)return this;var A=this.high;return v<32?p(this.low>>>v|A<<32-v,A>>>v,this.unsigned):p(v===32?A:A>>>v-32,0,this.unsigned)},I.shru=I.shiftRightUnsigned,I.shr_u=I.shiftRightUnsigned,I.toSigned=function(){return this.unsigned?p(this.low,this.high,!1):this},I.toUnsigned=function(){return this.unsigned?this:p(this.low,this.high,!0)},I.toBytes=function(v){return v?this.toBytesLE():this.toBytesBE()},I.toBytesLE=function(){var v=this.high,A=this.low;return[255&A,A>>>8&255,A>>>16&255,A>>>24,255&v,v>>>8&255,v>>>16&255,v>>>24]},I.toBytesBE=function(){var v=this.high,A=this.low;return[v>>>24,v>>>16&255,v>>>8&255,255&v,A>>>24,A>>>16&255,A>>>8&255,255&A]},r.fromBytes=function(v,A,L){return L?r.fromBytesLE(v,A):r.fromBytesBE(v,A)},r.fromBytesLE=function(v,A){return new r(v[0]|v[1]<<8|v[2]<<16|v[3]<<24,v[4]|v[5]<<8|v[6]<<16|v[7]<<24,A)},r.fromBytesBE=function(v,A){return new r(v[4]<<24|v[5]<<16|v[6]<<8|v[7],v[0]<<24|v[1]<<16|v[2]<<8|v[3],A)}},1446:(f,t,r)=>{var i,s,c,a=r(2100),h=a.Reader,p=a.Writer,d=a.util,l=a.roots.default||(a.roots.default={});l.onnx=((c={}).Version=(i={},(s=Object.create(i))[i[0]="_START_VERSION"]=0,s[i[1]="IR_VERSION_2017_10_10"]=1,s[i[2]="IR_VERSION_2017_10_30"]=2,s[i[3]="IR_VERSION_2017_11_3"]=3,s[i[4]="IR_VERSION_2019_1_22"]=4,s[i[5]="IR_VERSION"]=5,s),c.AttributeProto=function(){function n(e){if(this.floats=[],this.ints=[],this.strings=[],this.tensors=[],this.graphs=[],e)for(var o=Object.keys(e),u=0;u<o.length;++u)e[o[u]]!=null&&(this[o[u]]=e[o[u]])}return n.prototype.name="",n.prototype.refAttrName="",n.prototype.docString="",n.prototype.type=0,n.prototype.f=0,n.prototype.i=d.Long?d.Long.fromBits(0,0,!1):0,n.prototype.s=d.newBuffer([]),n.prototype.t=null,n.prototype.g=null,n.prototype.floats=d.emptyArray,n.prototype.ints=d.emptyArray,n.prototype.strings=d.emptyArray,n.prototype.tensors=d.emptyArray,n.prototype.graphs=d.emptyArray,n.create=function(e){return new n(e)},n.encode=function(e,o){if(o||(o=p.create()),e.name!=null&&e.hasOwnProperty("name")&&o.uint32(10).string(e.name),e.f!=null&&e.hasOwnProperty("f")&&o.uint32(21).float(e.f),e.i!=null&&e.hasOwnProperty("i")&&o.uint32(24).int64(e.i),e.s!=null&&e.hasOwnProperty("s")&&o.uint32(34).bytes(e.s),e.t!=null&&e.hasOwnProperty("t")&&l.onnx.TensorProto.encode(e.t,o.uint32(42).fork()).ldelim(),e.g!=null&&e.hasOwnProperty("g")&&l.onnx.GraphProto.encode(e.g,o.uint32(50).fork()).ldelim(),e.floats!=null&&e.floats.length){o.uint32(58).fork();for(var u=0;u<e.floats.length;++u)o.float(e.floats[u]);o.ldelim()}if(e.ints!=null&&e.ints.length){for(o.uint32(66).fork(),u=0;u<e.ints.length;++u)o.int64(e.ints[u]);o.ldelim()}if(e.strings!=null&&e.strings.length)for(u=0;u<e.strings.length;++u)o.uint32(74).bytes(e.strings[u]);if(e.tensors!=null&&e.tensors.length)for(u=0;u<e.tensors.length;++u)l.onnx.TensorProto.encode(e.tensors[u],o.uint32(82).fork()).ldelim();if(e.graphs!=null&&e.graphs.length)for(u=0;u<e.graphs.length;++u)l.onnx.GraphProto.encode(e.graphs[u],o.uint32(90).fork()).ldelim();return e.docString!=null&&e.hasOwnProperty("docString")&&o.uint32(106).string(e.docString),e.type!=null&&e.hasOwnProperty("type")&&o.uint32(160).int32(e.type),e.refAttrName!=null&&e.hasOwnProperty("refAttrName")&&o.uint32(170).string(e.refAttrName),o},n.encodeDelimited=function(e,o){return this.encode(e,o).ldelim()},n.decode=function(e,o){e instanceof h||(e=h.create(e));for(var u=o===void 0?e.len:e.pos+o,g=new l.onnx.AttributeProto;e.pos<u;){var m=e.uint32();switch(m>>>3){case 1:g.name=e.string();break;case 21:g.refAttrName=e.string();break;case 13:g.docString=e.string();break;case 20:g.type=e.int32();break;case 2:g.f=e.float();break;case 3:g.i=e.int64();break;case 4:g.s=e.bytes();break;case 5:g.t=l.onnx.TensorProto.decode(e,e.uint32());break;case 6:g.g=l.onnx.GraphProto.decode(e,e.uint32());break;case 7:if(g.floats&&g.floats.length||(g.floats=[]),(7&m)==2)for(var y=e.uint32()+e.pos;e.pos<y;)g.floats.push(e.float());else g.floats.push(e.float());break;case 8:if(g.ints&&g.ints.length||(g.ints=[]),(7&m)==2)for(y=e.uint32()+e.pos;e.pos<y;)g.ints.push(e.int64());else g.ints.push(e.int64());break;case 9:g.strings&&g.strings.length||(g.strings=[]),g.strings.push(e.bytes());break;case 10:g.tensors&&g.tensors.length||(g.tensors=[]),g.tensors.push(l.onnx.TensorProto.decode(e,e.uint32()));break;case 11:g.graphs&&g.graphs.length||(g.graphs=[]),g.graphs.push(l.onnx.GraphProto.decode(e,e.uint32()));break;default:e.skipType(7&m)}}return g},n.decodeDelimited=function(e){return e instanceof h||(e=new h(e)),this.decode(e,e.uint32())},n.verify=function(e){if(typeof e!="object"||e===null)return"object expected";if(e.name!=null&&e.hasOwnProperty("name")&&!d.isString(e.name))return"name: string expected";if(e.refAttrName!=null&&e.hasOwnProperty("refAttrName")&&!d.isString(e.refAttrName))return"refAttrName: string expected";if(e.docString!=null&&e.hasOwnProperty("docString")&&!d.isString(e.docString))return"docString: string expected";if(e.type!=null&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:}if(e.f!=null&&e.hasOwnProperty("f")&&typeof e.f!="number")return"f: number expected";if(e.i!=null&&e.hasOwnProperty("i")&&!(d.isInteger(e.i)||e.i&&d.isInteger(e.i.low)&&d.isInteger(e.i.high)))return"i: integer|Long expected";if(e.s!=null&&e.hasOwnProperty("s")&&!(e.s&&typeof e.s.length=="number"||d.isString(e.s)))return"s: buffer expected";if(e.t!=null&&e.hasOwnProperty("t")&&(u=l.onnx.TensorProto.verify(e.t)))return"t."+u;if(e.g!=null&&e.hasOwnProperty("g")&&(u=l.onnx.GraphProto.verify(e.g)))return"g."+u;if(e.floats!=null&&e.hasOwnProperty("floats")){if(!Array.isArray(e.floats))return"floats: array expected";for(var o=0;o<e.floats.length;++o)if(typeof e.floats[o]!="number")return"floats: number[] expected"}if(e.ints!=null&&e.hasOwnProperty("ints")){if(!Array.isArray(e.ints))return"ints: array expected";for(o=0;o<e.ints.length;++o)if(!(d.isInteger(e.ints[o])||e.ints[o]&&d.isInteger(e.ints[o].low)&&d.isInteger(e.ints[o].high)))return"ints: integer|Long[] expected"}if(e.strings!=null&&e.hasOwnProperty("strings")){if(!Array.isArray(e.strings))return"strings: array expected";for(o=0;o<e.strings.length;++o)if(!(e.strings[o]&&typeof e.strings[o].length=="number"||d.isString(e.strings[o])))return"strings: buffer[] expected"}if(e.tensors!=null&&e.hasOwnProperty("tensors")){if(!Array.isArray(e.tensors))return"tensors: array expected";for(o=0;o<e.tensors.length;++o)if(u=l.onnx.TensorProto.verify(e.tensors[o]))return"tensors."+u}if(e.graphs!=null&&e.hasOwnProperty("graphs")){if(!Array.isArray(e.graphs))return"graphs: array expected";for(o=0;o<e.graphs.length;++o){var u;if(u=l.onnx.GraphProto.verify(e.graphs[o]))return"graphs."+u}}return null},n.fromObject=function(e){if(e instanceof l.onnx.AttributeProto)return e;var o=new l.onnx.AttributeProto;switch(e.name!=null&&(o.name=String(e.name)),e.refAttrName!=null&&(o.refAttrName=String(e.refAttrName)),e.docString!=null&&(o.docString=String(e.docString)),e.type){case"UNDEFINED":case 0:o.type=0;break;case"FLOAT":case 1:o.type=1;break;case"INT":case 2:o.type=2;break;case"STRING":case 3:o.type=3;break;case"TENSOR":case 4:o.type=4;break;case"GRAPH":case 5:o.type=5;break;case"FLOATS":case 6:o.type=6;break;case"INTS":case 7:o.type=7;break;case"STRINGS":case 8:o.type=8;break;case"TENSORS":case 9:o.type=9;break;case"GRAPHS":case 10:o.type=10}if(e.f!=null&&(o.f=Number(e.f)),e.i!=null&&(d.Long?(o.i=d.Long.fromValue(e.i)).unsigned=!1:typeof e.i=="string"?o.i=parseInt(e.i,10):typeof e.i=="number"?o.i=e.i:typeof e.i=="object"&&(o.i=new d.LongBits(e.i.low>>>0,e.i.high>>>0).toNumber())),e.s!=null&&(typeof e.s=="string"?d.base64.decode(e.s,o.s=d.newBuffer(d.base64.length(e.s)),0):e.s.length&&(o.s=e.s)),e.t!=null){if(typeof e.t!="object")throw TypeError(".onnx.AttributeProto.t: object expected");o.t=l.onnx.TensorProto.fromObject(e.t)}if(e.g!=null){if(typeof e.g!="object")throw TypeError(".onnx.AttributeProto.g: object expected");o.g=l.onnx.GraphProto.fromObject(e.g)}if(e.floats){if(!Array.isArray(e.floats))throw TypeError(".onnx.AttributeProto.floats: array expected");o.floats=[];for(var u=0;u<e.floats.length;++u)o.floats[u]=Number(e.floats[u])}if(e.ints){if(!Array.isArray(e.ints))throw TypeError(".onnx.AttributeProto.ints: array expected");for(o.ints=[],u=0;u<e.ints.length;++u)d.Long?(o.ints[u]=d.Long.fromValue(e.ints[u])).unsigned=!1:typeof e.ints[u]=="string"?o.ints[u]=parseInt(e.ints[u],10):typeof e.ints[u]=="number"?o.ints[u]=e.ints[u]:typeof e.ints[u]=="object"&&(o.ints[u]=new d.LongBits(e.ints[u].low>>>0,e.ints[u].high>>>0).toNumber())}if(e.strings){if(!Array.isArray(e.strings))throw TypeError(".onnx.AttributeProto.strings: array expected");for(o.strings=[],u=0;u<e.strings.length;++u)typeof e.strings[u]=="string"?d.base64.decode(e.strings[u],o.strings[u]=d.newBuffer(d.base64.length(e.strings[u])),0):e.strings[u].length&&(o.strings[u]=e.strings[u])}if(e.tensors){if(!Array.isArray(e.tensors))throw TypeError(".onnx.AttributeProto.tensors: array expected");for(o.tensors=[],u=0;u<e.tensors.length;++u){if(typeof e.tensors[u]!="object")throw TypeError(".onnx.AttributeProto.tensors: object expected");o.tensors[u]=l.onnx.TensorProto.fromObject(e.tensors[u])}}if(e.graphs){if(!Array.isArray(e.graphs))throw TypeError(".onnx.AttributeProto.graphs: array expected");for(o.graphs=[],u=0;u<e.graphs.length;++u){if(typeof e.graphs[u]!="object")throw TypeError(".onnx.AttributeProto.graphs: object expected");o.graphs[u]=l.onnx.GraphProto.fromObject(e.graphs[u])}}return o},n.toObject=function(e,o){o||(o={});var u={};if((o.arrays||o.defaults)&&(u.floats=[],u.ints=[],u.strings=[],u.tensors=[],u.graphs=[]),o.defaults){if(u.name="",u.f=0,d.Long){var g=new d.Long(0,0,!1);u.i=o.longs===String?g.toString():o.longs===Number?g.toNumber():g}else u.i=o.longs===String?"0":0;o.bytes===String?u.s="":(u.s=[],o.bytes!==Array&&(u.s=d.newBuffer(u.s))),u.t=null,u.g=null,u.docString="",u.type=o.enums===String?"UNDEFINED":0,u.refAttrName=""}if(e.name!=null&&e.hasOwnProperty("name")&&(u.name=e.name),e.f!=null&&e.hasOwnProperty("f")&&(u.f=o.json&&!isFinite(e.f)?String(e.f):e.f),e.i!=null&&e.hasOwnProperty("i")&&(typeof e.i=="number"?u.i=o.longs===String?String(e.i):e.i:u.i=o.longs===String?d.Long.prototype.toString.call(e.i):o.longs===Number?new d.LongBits(e.i.low>>>0,e.i.high>>>0).toNumber():e.i),e.s!=null&&e.hasOwnProperty("s")&&(u.s=o.bytes===String?d.base64.encode(e.s,0,e.s.length):o.bytes===Array?Array.prototype.slice.call(e.s):e.s),e.t!=null&&e.hasOwnProperty("t")&&(u.t=l.onnx.TensorProto.toObject(e.t,o)),e.g!=null&&e.hasOwnProperty("g")&&(u.g=l.onnx.GraphProto.toObject(e.g,o)),e.floats&&e.floats.length){u.floats=[];for(var m=0;m<e.floats.length;++m)u.floats[m]=o.json&&!isFinite(e.floats[m])?String(e.floats[m]):e.floats[m]}if(e.ints&&e.ints.length)for(u.ints=[],m=0;m<e.ints.length;++m)typeof e.ints[m]=="number"?u.ints[m]=o.longs===String?String(e.ints[m]):e.ints[m]:u.ints[m]=o.longs===String?d.Long.prototype.toString.call(e.ints[m]):o.longs===Number?new d.LongBits(e.ints[m].low>>>0,e.ints[m].high>>>0).toNumber():e.ints[m];if(e.strings&&e.strings.length)for(u.strings=[],m=0;m<e.strings.length;++m)u.strings[m]=o.bytes===String?d.base64.encode(e.strings[m],0,e.strings[m].length):o.bytes===Array?Array.prototype.slice.call(e.strings[m]):e.strings[m];if(e.tensors&&e.tensors.length)for(u.tensors=[],m=0;m<e.tensors.length;++m)u.tensors[m]=l.onnx.TensorProto.toObject(e.tensors[m],o);if(e.graphs&&e.graphs.length)for(u.graphs=[],m=0;m<e.graphs.length;++m)u.graphs[m]=l.onnx.GraphProto.toObject(e.graphs[m],o);return e.docString!=null&&e.hasOwnProperty("docString")&&(u.docString=e.docString),e.type!=null&&e.hasOwnProperty("type")&&(u.type=o.enums===String?l.onnx.AttributeProto.AttributeType[e.type]:e.type),e.refAttrName!=null&&e.hasOwnProperty("refAttrName")&&(u.refAttrName=e.refAttrName),u},n.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},n.AttributeType=function(){var e={},o=Object.create(e);return o[e[0]="UNDEFINED"]=0,o[e[1]="FLOAT"]=1,o[e[2]="INT"]=2,o[e[3]="STRING"]=3,o[e[4]="TENSOR"]=4,o[e[5]="GRAPH"]=5,o[e[6]="FLOATS"]=6,o[e[7]="INTS"]=7,o[e[8]="STRINGS"]=8,o[e[9]="TENSORS"]=9,o[e[10]="GRAPHS"]=10,o}(),n}(),c.ValueInfoProto=function(){function n(e){if(e)for(var o=Object.keys(e),u=0;u<o.length;++u)e[o[u]]!=null&&(this[o[u]]=e[o[u]])}return n.prototype.name="",n.prototype.type=null,n.prototype.docString="",n.create=function(e){return new n(e)},n.encode=function(e,o){return o||(o=p.create()),e.name!=null&&e.hasOwnProperty("name")&&o.uint32(10).string(e.name),e.type!=null&&e.hasOwnProperty("type")&&l.onnx.TypeProto.encode(e.type,o.uint32(18).fork()).ldelim(),e.docString!=null&&e.hasOwnProperty("docString")&&o.uint32(26).string(e.docString),o},n.encodeDelimited=function(e,o){return this.encode(e,o).ldelim()},n.decode=function(e,o){e instanceof h||(e=h.create(e));for(var u=o===void 0?e.len:e.pos+o,g=new l.onnx.ValueInfoProto;e.pos<u;){var m=e.uint32();switch(m>>>3){case 1:g.name=e.string();break;case 2:g.type=l.onnx.TypeProto.decode(e,e.uint32());break;case 3:g.docString=e.string();break;default:e.skipType(7&m)}}return g},n.decodeDelimited=function(e){return e instanceof h||(e=new h(e)),this.decode(e,e.uint32())},n.verify=function(e){if(typeof e!="object"||e===null)return"object expected";if(e.name!=null&&e.hasOwnProperty("name")&&!d.isString(e.name))return"name: string expected";if(e.type!=null&&e.hasOwnProperty("type")){var o=l.onnx.TypeProto.verify(e.type);if(o)return"type."+o}return e.docString!=null&&e.hasOwnProperty("docString")&&!d.isString(e.docString)?"docString: string expected":null},n.fromObject=function(e){if(e instanceof l.onnx.ValueInfoProto)return e;var o=new l.onnx.ValueInfoProto;if(e.name!=null&&(o.name=String(e.name)),e.type!=null){if(typeof e.type!="object")throw TypeError(".onnx.ValueInfoProto.type: object expected");o.type=l.onnx.TypeProto.fromObject(e.type)}return e.docString!=null&&(o.docString=String(e.docString)),o},n.toObject=function(e,o){o||(o={});var u={};return o.defaults&&(u.name="",u.type=null,u.docString=""),e.name!=null&&e.hasOwnProperty("name")&&(u.name=e.name),e.type!=null&&e.hasOwnProperty("type")&&(u.type=l.onnx.TypeProto.toObject(e.type,o)),e.docString!=null&&e.hasOwnProperty("docString")&&(u.docString=e.docString),u},n.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},n}(),c.NodeProto=function(){function n(e){if(this.input=[],this.output=[],this.attribute=[],e)for(var o=Object.keys(e),u=0;u<o.length;++u)e[o[u]]!=null&&(this[o[u]]=e[o[u]])}return n.prototype.input=d.emptyArray,n.prototype.output=d.emptyArray,n.prototype.name="",n.prototype.opType="",n.prototype.domain="",n.prototype.attribute=d.emptyArray,n.prototype.docString="",n.create=function(e){return new n(e)},n.encode=function(e,o){if(o||(o=p.create()),e.input!=null&&e.input.length)for(var u=0;u<e.input.length;++u)o.uint32(10).string(e.input[u]);if(e.output!=null&&e.output.length)for(u=0;u<e.output.length;++u)o.uint32(18).string(e.output[u]);if(e.name!=null&&e.hasOwnProperty("name")&&o.uint32(26).string(e.name),e.opType!=null&&e.hasOwnProperty("opType")&&o.uint32(34).string(e.opType),e.attribute!=null&&e.attribute.length)for(u=0;u<e.attribute.length;++u)l.onnx.AttributeProto.encode(e.attribute[u],o.uint32(42).fork()).ldelim();return e.docString!=null&&e.hasOwnProperty("docString")&&o.uint32(50).string(e.docString),e.domain!=null&&e.hasOwnProperty("domain")&&o.uint32(58).string(e.domain),o},n.encodeDelimited=function(e,o){return this.encode(e,o).ldelim()},n.decode=function(e,o){e instanceof h||(e=h.create(e));for(var u=o===void 0?e.len:e.pos+o,g=new l.onnx.NodeProto;e.pos<u;){var m=e.uint32();switch(m>>>3){case 1:g.input&&g.input.length||(g.input=[]),g.input.push(e.string());break;case 2:g.output&&g.output.length||(g.output=[]),g.output.push(e.string());break;case 3:g.name=e.string();break;case 4:g.opType=e.string();break;case 7:g.domain=e.string();break;case 5:g.attribute&&g.attribute.length||(g.attribute=[]),g.attribute.push(l.onnx.AttributeProto.decode(e,e.uint32()));break;case 6:g.docString=e.string();break;default:e.skipType(7&m)}}return g},n.decodeDelimited=function(e){return e instanceof h||(e=new h(e)),this.decode(e,e.uint32())},n.verify=function(e){if(typeof e!="object"||e===null)return"object expected";if(e.input!=null&&e.hasOwnProperty("input")){if(!Array.isArray(e.input))return"input: array expected";for(var o=0;o<e.input.length;++o)if(!d.isString(e.input[o]))return"input: string[] expected"}if(e.output!=null&&e.hasOwnProperty("output")){if(!Array.isArray(e.output))return"output: array expected";for(o=0;o<e.output.length;++o)if(!d.isString(e.output[o]))return"output: string[] expected"}if(e.name!=null&&e.hasOwnProperty("name")&&!d.isString(e.name))return"name: string expected";if(e.opType!=null&&e.hasOwnProperty("opType")&&!d.isString(e.opType))return"opType: string expected";if(e.domain!=null&&e.hasOwnProperty("domain")&&!d.isString(e.domain))return"domain: string expected";if(e.attribute!=null&&e.hasOwnProperty("attribute")){if(!Array.isArray(e.attribute))return"attribute: array expected";for(o=0;o<e.attribute.length;++o){var u=l.onnx.AttributeProto.verify(e.attribute[o]);if(u)return"attribute."+u}}return e.docString!=null&&e.hasOwnProperty("docString")&&!d.isString(e.docString)?"docString: string expected":null},n.fromObject=function(e){if(e instanceof l.onnx.NodeProto)return e;var o=new l.onnx.NodeProto;if(e.input){if(!Array.isArray(e.input))throw TypeError(".onnx.NodeProto.input: array expected");o.input=[];for(var u=0;u<e.input.length;++u)o.input[u]=String(e.input[u])}if(e.output){if(!Array.isArray(e.output))throw TypeError(".onnx.NodeProto.output: array expected");for(o.output=[],u=0;u<e.output.length;++u)o.output[u]=String(e.output[u])}if(e.name!=null&&(o.name=String(e.name)),e.opType!=null&&(o.opType=String(e.opType)),e.domain!=null&&(o.domain=String(e.domain)),e.attribute){if(!Array.isArray(e.attribute))throw TypeError(".onnx.NodeProto.attribute: array expected");for(o.attribute=[],u=0;u<e.attribute.length;++u){if(typeof e.attribute[u]!="object")throw TypeError(".onnx.NodeProto.attribute: object expected");o.attribute[u]=l.onnx.AttributeProto.fromObject(e.attribute[u])}}return e.docString!=null&&(o.docString=String(e.docString)),o},n.toObject=function(e,o){o||(o={});var u={};if((o.arrays||o.defaults)&&(u.input=[],u.output=[],u.attribute=[]),o.defaults&&(u.name="",u.opType="",u.docString="",u.domain=""),e.input&&e.input.length){u.input=[];for(var g=0;g<e.input.length;++g)u.input[g]=e.input[g]}if(e.output&&e.output.length)for(u.output=[],g=0;g<e.output.length;++g)u.output[g]=e.output[g];if(e.name!=null&&e.hasOwnProperty("name")&&(u.name=e.name),e.opType!=null&&e.hasOwnProperty("opType")&&(u.opType=e.opType),e.attribute&&e.attribute.length)for(u.attribute=[],g=0;g<e.attribute.length;++g)u.attribute[g]=l.onnx.AttributeProto.toObject(e.attribute[g],o);return e.docString!=null&&e.hasOwnProperty("docString")&&(u.docString=e.docString),e.domain!=null&&e.hasOwnProperty("domain")&&(u.domain=e.domain),u},n.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},n}(),c.ModelProto=function(){function n(e){if(this.opsetImport=[],this.metadataProps=[],e)for(var o=Object.keys(e),u=0;u<o.length;++u)e[o[u]]!=null&&(this[o[u]]=e[o[u]])}return n.prototype.irVersion=d.Long?d.Long.fromBits(0,0,!1):0,n.prototype.opsetImport=d.emptyArray,n.prototype.producerName="",n.prototype.producerVersion="",n.prototype.domain="",n.prototype.modelVersion=d.Long?d.Long.fromBits(0,0,!1):0,n.prototype.docString="",n.prototype.graph=null,n.prototype.metadataProps=d.emptyArray,n.create=function(e){return new n(e)},n.encode=function(e,o){if(o||(o=p.create()),e.irVersion!=null&&e.hasOwnProperty("irVersion")&&o.uint32(8).int64(e.irVersion),e.producerName!=null&&e.hasOwnProperty("producerName")&&o.uint32(18).string(e.producerName),e.producerVersion!=null&&e.hasOwnProperty("producerVersion")&&o.uint32(26).string(e.producerVersion),e.domain!=null&&e.hasOwnProperty("domain")&&o.uint32(34).string(e.domain),e.modelVersion!=null&&e.hasOwnProperty("modelVersion")&&o.uint32(40).int64(e.modelVersion),e.docString!=null&&e.hasOwnProperty("docString")&&o.uint32(50).string(e.docString),e.graph!=null&&e.hasOwnProperty("graph")&&l.onnx.GraphProto.encode(e.graph,o.uint32(58).fork()).ldelim(),e.opsetImport!=null&&e.opsetImport.length)for(var u=0;u<e.opsetImport.length;++u)l.onnx.OperatorSetIdProto.encode(e.opsetImport[u],o.uint32(66).fork()).ldelim();if(e.metadataProps!=null&&e.metadataProps.length)for(u=0;u<e.metadataProps.length;++u)l.onnx.StringStringEntryProto.encode(e.metadataProps[u],o.uint32(114).fork()).ldelim();return o},n.encodeDelimited=function(e,o){return this.encode(e,o).ldelim()},n.decode=function(e,o){e instanceof h||(e=h.create(e));for(var u=o===void 0?e.len:e.pos+o,g=new l.onnx.ModelProto;e.pos<u;){var m=e.uint32();switch(m>>>3){case 1:g.irVersion=e.int64();break;case 8:g.opsetImport&&g.opsetImport.length||(g.opsetImport=[]),g.opsetImport.push(l.onnx.OperatorSetIdProto.decode(e,e.uint32()));break;case 2:g.producerName=e.string();break;case 3:g.producerVersion=e.string();break;case 4:g.domain=e.string();break;case 5:g.modelVersion=e.int64();break;case 6:g.docString=e.string();break;case 7:g.graph=l.onnx.GraphProto.decode(e,e.uint32());break;case 14:g.metadataProps&&g.metadataProps.length||(g.metadataProps=[]),g.metadataProps.push(l.onnx.StringStringEntryProto.decode(e,e.uint32()));break;default:e.skipType(7&m)}}return g},n.decodeDelimited=function(e){return e instanceof h||(e=new h(e)),this.decode(e,e.uint32())},n.verify=function(e){if(typeof e!="object"||e===null)return"object expected";if(e.irVersion!=null&&e.hasOwnProperty("irVersion")&&!(d.isInteger(e.irVersion)||e.irVersion&&d.isInteger(e.irVersion.low)&&d.isInteger(e.irVersion.high)))return"irVersion: integer|Long expected";if(e.opsetImport!=null&&e.hasOwnProperty("opsetImport")){if(!Array.isArray(e.opsetImport))return"opsetImport: array expected";for(var o=0;o<e.opsetImport.length;++o)if(u=l.onnx.OperatorSetIdProto.verify(e.opsetImport[o]))return"opsetImport."+u}if(e.producerName!=null&&e.hasOwnProperty("producerName")&&!d.isString(e.producerName))return"producerName: string expected";if(e.producerVersion!=null&&e.hasOwnProperty("producerVersion")&&!d.isString(e.producerVersion))return"producerVersion: string expected";if(e.domain!=null&&e.hasOwnProperty("domain")&&!d.isString(e.domain))return"domain: string expected";if(e.modelVersion!=null&&e.hasOwnProperty("modelVersion")&&!(d.isInteger(e.modelVersion)||e.modelVersion&&d.isInteger(e.modelVersion.low)&&d.isInteger(e.modelVersion.high)))return"modelVersion: integer|Long expected";if(e.docString!=null&&e.hasOwnProperty("docString")&&!d.isString(e.docString))return"docString: string expected";if(e.graph!=null&&e.hasOwnProperty("graph")&&(u=l.onnx.GraphProto.verify(e.graph)))return"graph."+u;if(e.metadataProps!=null&&e.hasOwnProperty("metadataProps")){if(!Array.isArray(e.metadataProps))return"metadataProps: array expected";for(o=0;o<e.metadataProps.length;++o){var u;if(u=l.onnx.StringStringEntryProto.verify(e.metadataProps[o]))return"metadataProps."+u}}return null},n.fromObject=function(e){if(e instanceof l.onnx.ModelProto)return e;var o=new l.onnx.ModelProto;if(e.irVersion!=null&&(d.Long?(o.irVersion=d.Long.fromValue(e.irVersion)).unsigned=!1:typeof e.irVersion=="string"?o.irVersion=parseInt(e.irVersion,10):typeof e.irVersion=="number"?o.irVersion=e.irVersion:typeof e.irVersion=="object"&&(o.irVersion=new d.LongBits(e.irVersion.low>>>0,e.irVersion.high>>>0).toNumber())),e.opsetImport){if(!Array.isArray(e.opsetImport))throw TypeError(".onnx.ModelProto.opsetImport: array expected");o.opsetImport=[];for(var u=0;u<e.opsetImport.length;++u){if(typeof e.opsetImport[u]!="object")throw TypeError(".onnx.ModelProto.opsetImport: object expected");o.opsetImport[u]=l.onnx.OperatorSetIdProto.fromObject(e.opsetImport[u])}}if(e.producerName!=null&&(o.producerName=String(e.producerName)),e.producerVersion!=null&&(o.producerVersion=String(e.producerVersion)),e.domain!=null&&(o.domain=String(e.domain)),e.modelVersion!=null&&(d.Long?(o.modelVersion=d.Long.fromValue(e.modelVersion)).unsigned=!1:typeof e.modelVersion=="string"?o.modelVersion=parseInt(e.modelVersion,10):typeof e.modelVersion=="number"?o.modelVersion=e.modelVersion:typeof e.modelVersion=="object"&&(o.modelVersion=new d.LongBits(e.modelVersion.low>>>0,e.modelVersion.high>>>0).toNumber())),e.docString!=null&&(o.docString=String(e.docString)),e.graph!=null){if(typeof e.graph!="object")throw TypeError(".onnx.ModelProto.graph: object expected");o.graph=l.onnx.GraphProto.fromObject(e.graph)}if(e.metadataProps){if(!Array.isArray(e.metadataProps))throw TypeError(".onnx.ModelProto.metadataProps: array expected");for(o.metadataProps=[],u=0;u<e.metadataProps.length;++u){if(typeof e.metadataProps[u]!="object")throw TypeError(".onnx.ModelProto.metadataProps: object expected");o.metadataProps[u]=l.onnx.StringStringEntryProto.fromObject(e.metadataProps[u])}}return o},n.toObject=function(e,o){o||(o={});var u={};if((o.arrays||o.defaults)&&(u.opsetImport=[],u.metadataProps=[]),o.defaults){if(d.Long){var g=new d.Long(0,0,!1);u.irVersion=o.longs===String?g.toString():o.longs===Number?g.toNumber():g}else u.irVersion=o.longs===String?"0":0;u.producerName="",u.producerVersion="",u.domain="",d.Long?(g=new d.Long(0,0,!1),u.modelVersion=o.longs===String?g.toString():o.longs===Number?g.toNumber():g):u.modelVersion=o.longs===String?"0":0,u.docString="",u.graph=null}if(e.irVersion!=null&&e.hasOwnProperty("irVersion")&&(typeof e.irVersion=="number"?u.irVersion=o.longs===String?String(e.irVersion):e.irVersion:u.irVersion=o.longs===String?d.Long.prototype.toString.call(e.irVersion):o.longs===Number?new d.LongBits(e.irVersion.low>>>0,e.irVersion.high>>>0).toNumber():e.irVersion),e.producerName!=null&&e.hasOwnProperty("producerName")&&(u.producerName=e.producerName),e.producerVersion!=null&&e.hasOwnProperty("producerVersion")&&(u.producerVersion=e.producerVersion),e.domain!=null&&e.hasOwnProperty("domain")&&(u.domain=e.domain),e.modelVersion!=null&&e.hasOwnProperty("modelVersion")&&(typeof e.modelVersion=="number"?u.modelVersion=o.longs===String?String(e.modelVersion):e.modelVersion:u.modelVersion=o.longs===String?d.Long.prototype.toString.call(e.modelVersion):o.longs===Number?new d.LongBits(e.modelVersion.low>>>0,e.modelVersion.high>>>0).toNumber():e.modelVersion),e.docString!=null&&e.hasOwnProperty("docString")&&(u.docString=e.docString),e.graph!=null&&e.hasOwnProperty("graph")&&(u.graph=l.onnx.GraphProto.toObject(e.graph,o)),e.opsetImport&&e.opsetImport.length){u.opsetImport=[];for(var m=0;m<e.opsetImport.length;++m)u.opsetImport[m]=l.onnx.OperatorSetIdProto.toObject(e.opsetImport[m],o)}if(e.metadataProps&&e.metadataProps.length)for(u.metadataProps=[],m=0;m<e.metadataProps.length;++m)u.metadataProps[m]=l.onnx.StringStringEntryProto.toObject(e.metadataProps[m],o);return u},n.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},n}(),c.StringStringEntryProto=function(){function n(e){if(e)for(var o=Object.keys(e),u=0;u<o.length;++u)e[o[u]]!=null&&(this[o[u]]=e[o[u]])}return n.prototype.key="",n.prototype.value="",n.create=function(e){return new n(e)},n.encode=function(e,o){return o||(o=p.create()),e.key!=null&&e.hasOwnProperty("key")&&o.uint32(10).string(e.key),e.value!=null&&e.hasOwnProperty("value")&&o.uint32(18).string(e.value),o},n.encodeDelimited=function(e,o){return this.encode(e,o).ldelim()},n.decode=function(e,o){e instanceof h||(e=h.create(e));for(var u=o===void 0?e.len:e.pos+o,g=new l.onnx.StringStringEntryProto;e.pos<u;){var m=e.uint32();switch(m>>>3){case 1:g.key=e.string();break;case 2:g.value=e.string();break;default:e.skipType(7&m)}}return g},n.decodeDelimited=function(e){return e instanceof h||(e=new h(e)),this.decode(e,e.uint32())},n.verify=function(e){return typeof e!="object"||e===null?"object expected":e.key!=null&&e.hasOwnProperty("key")&&!d.isString(e.key)?"key: string expected":e.value!=null&&e.hasOwnProperty("value")&&!d.isString(e.value)?"value: string expected":null},n.fromObject=function(e){if(e instanceof l.onnx.StringStringEntryProto)return e;var o=new l.onnx.StringStringEntryProto;return e.key!=null&&(o.key=String(e.key)),e.value!=null&&(o.value=String(e.value)),o},n.toObject=function(e,o){o||(o={});var u={};return o.defaults&&(u.key="",u.value=""),e.key!=null&&e.hasOwnProperty("key")&&(u.key=e.key),e.value!=null&&e.hasOwnProperty("value")&&(u.value=e.value),u},n.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},n}(),c.TensorAnnotation=function(){function n(e){if(this.quantParameterTensorNames=[],e)for(var o=Object.keys(e),u=0;u<o.length;++u)e[o[u]]!=null&&(this[o[u]]=e[o[u]])}return n.prototype.tensorName="",n.prototype.quantParameterTensorNames=d.emptyArray,n.create=function(e){return new n(e)},n.encode=function(e,o){if(o||(o=p.create()),e.tensorName!=null&&e.hasOwnProperty("tensorName")&&o.uint32(10).string(e.tensorName),e.quantParameterTensorNames!=null&&e.quantParameterTensorNames.length)for(var u=0;u<e.quantParameterTensorNames.length;++u)l.onnx.StringStringEntryProto.encode(e.quantParameterTensorNames[u],o.uint32(18).fork()).ldelim();return o},n.encodeDelimited=function(e,o){return this.encode(e,o).ldelim()},n.decode=function(e,o){e instanceof h||(e=h.create(e));for(var u=o===void 0?e.len:e.pos+o,g=new l.onnx.TensorAnnotation;e.pos<u;){var m=e.uint32();switch(m>>>3){case 1:g.tensorName=e.string();break;case 2:g.quantParameterTensorNames&&g.quantParameterTensorNames.length||(g.quantParameterTensorNames=[]),g.quantParameterTensorNames.push(l.onnx.StringStringEntryProto.decode(e,e.uint32()));break;default:e.skipType(7&m)}}return g},n.decodeDelimited=function(e){return e instanceof h||(e=new h(e)),this.decode(e,e.uint32())},n.verify=function(e){if(typeof e!="object"||e===null)return"object expected";if(e.tensorName!=null&&e.hasOwnProperty("tensorName")&&!d.isString(e.tensorName))return"tensorName: string expected";if(e.quantParameterTensorNames!=null&&e.hasOwnProperty("quantParameterTensorNames")){if(!Array.isArray(e.quantParameterTensorNames))return"quantParameterTensorNames: array expected";for(var o=0;o<e.quantParameterTensorNames.length;++o){var u=l.onnx.StringStringEntryProto.verify(e.quantParameterTensorNames[o]);if(u)return"quantParameterTensorNames."+u}}return null},n.fromObject=function(e){if(e instanceof l.onnx.TensorAnnotation)return e;var o=new l.onnx.TensorAnnotation;if(e.tensorName!=null&&(o.tensorName=String(e.tensorName)),e.quantParameterTensorNames){if(!Array.isArray(e.quantParameterTensorNames))throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: array expected");o.quantParameterTensorNames=[];for(var u=0;u<e.quantParameterTensorNames.length;++u){if(typeof e.quantParameterTensorNames[u]!="object")throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: object expected");o.quantParameterTensorNames[u]=l.onnx.StringStringEntryProto.fromObject(e.quantParameterTensorNames[u])}}return o},n.toObject=function(e,o){o||(o={});var u={};if((o.arrays||o.defaults)&&(u.quantParameterTensorNames=[]),o.defaults&&(u.tensorName=""),e.tensorName!=null&&e.hasOwnProperty("tensorName")&&(u.tensorName=e.tensorName),e.quantParameterTensorNames&&e.quantParameterTensorNames.length){u.quantParameterTensorNames=[];for(var g=0;g<e.quantParameterTensorNames.length;++g)u.quantParameterTensorNames[g]=l.onnx.StringStringEntryProto.toObject(e.quantParameterTensorNames[g],o)}return u},n.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},n}(),c.GraphProto=function(){function n(e){if(this.node=[],this.initializer=[],this.input=[],this.output=[],this.valueInfo=[],this.quantizationAnnotation=[],e)for(var o=Object.keys(e),u=0;u<o.length;++u)e[o[u]]!=null&&(this[o[u]]=e[o[u]])}return n.prototype.node=d.emptyArray,n.prototype.name="",n.prototype.initializer=d.emptyArray,n.prototype.docString="",n.prototype.input=d.emptyArray,n.prototype.output=d.emptyArray,n.prototype.valueInfo=d.emptyArray,n.prototype.quantizationAnnotation=d.emptyArray,n.create=function(e){return new n(e)},n.encode=function(e,o){if(o||(o=p.create()),e.node!=null&&e.node.length)for(var u=0;u<e.node.length;++u)l.onnx.NodeProto.encode(e.node[u],o.uint32(10).fork()).ldelim();if(e.name!=null&&e.hasOwnProperty("name")&&o.uint32(18).string(e.name),e.initializer!=null&&e.initializer.length)for(u=0;u<e.initializer.length;++u)l.onnx.TensorProto.encode(e.initializer[u],o.uint32(42).fork()).ldelim();if(e.docString!=null&&e.hasOwnProperty("docString")&&o.uint32(82).string(e.docString),e.input!=null&&e.input.length)for(u=0;u<e.input.length;++u)l.onnx.ValueInfoProto.encode(e.input[u],o.uint32(90).fork()).ldelim();if(e.output!=null&&e.output.length)for(u=0;u<e.output.length;++u)l.onnx.ValueInfoProto.encode(e.output[u],o.uint32(98).fork()).ldelim();if(e.valueInfo!=null&&e.valueInfo.length)for(u=0;u<e.valueInfo.length;++u)l.onnx.ValueInfoProto.encode(e.valueInfo[u],o.uint32(106).fork()).ldelim();if(e.quantizationAnnotation!=null&&e.quantizationAnnotation.length)for(u=0;u<e.quantizationAnnotation.length;++u)l.onnx.TensorAnnotation.encode(e.quantizationAnnotation[u],o.uint32(114).fork()).ldelim();return o},n.encodeDelimited=function(e,o){return this.encode(e,o).ldelim()},n.decode=function(e,o){e instanceof h||(e=h.create(e));for(var u=o===void 0?e.len:e.pos+o,g=new l.onnx.GraphProto;e.pos<u;){var m=e.uint32();switch(m>>>3){case 1:g.node&&g.node.length||(g.node=[]),g.node.push(l.onnx.NodeProto.decode(e,e.uint32()));break;case 2:g.name=e.string();break;case 5:g.initializer&&g.initializer.length||(g.initializer=[]),g.initializer.push(l.onnx.TensorProto.decode(e,e.uint32()));break;case 10:g.docString=e.string();break;case 11:g.input&&g.input.length||(g.input=[]),g.input.push(l.onnx.ValueInfoProto.decode(e,e.uint32()));break;case 12:g.output&&g.output.length||(g.output=[]),g.output.push(l.onnx.ValueInfoProto.decode(e,e.uint32()));break;case 13:g.valueInfo&&g.valueInfo.length||(g.valueInfo=[]),g.valueInfo.push(l.onnx.ValueInfoProto.decode(e,e.uint32()));break;case 14:g.quantizationAnnotation&&g.quantizationAnnotation.length||(g.quantizationAnnotation=[]),g.quantizationAnnotation.push(l.onnx.TensorAnnotation.decode(e,e.uint32()));break;default:e.skipType(7&m)}}return g},n.decodeDelimited=function(e){return e instanceof h||(e=new h(e)),this.decode(e,e.uint32())},n.verify=function(e){if(typeof e!="object"||e===null)return"object expected";if(e.node!=null&&e.hasOwnProperty("node")){if(!Array.isArray(e.node))return"node: array expected";for(var o=0;o<e.node.length;++o)if(u=l.onnx.NodeProto.verify(e.node[o]))return"node."+u}if(e.name!=null&&e.hasOwnProperty("name")&&!d.isString(e.name))return"name: string expected";if(e.initializer!=null&&e.hasOwnProperty("initializer")){if(!Array.isArray(e.initializer))return"initializer: array expected";for(o=0;o<e.initializer.length;++o)if(u=l.onnx.TensorProto.verify(e.initializer[o]))return"initializer."+u}if(e.docString!=null&&e.hasOwnProperty("docString")&&!d.isString(e.docString))return"docString: string expected";if(e.input!=null&&e.hasOwnProperty("input")){if(!Array.isArray(e.input))return"input: array expected";for(o=0;o<e.input.length;++o)if(u=l.onnx.ValueInfoProto.verify(e.input[o]))return"input."+u}if(e.output!=null&&e.hasOwnProperty("output")){if(!Array.isArray(e.output))return"output: array expected";for(o=0;o<e.output.length;++o)if(u=l.onnx.ValueInfoProto.verify(e.output[o]))return"output."+u}if(e.valueInfo!=null&&e.hasOwnProperty("valueInfo")){if(!Array.isArray(e.valueInfo))return"valueInfo: array expected";for(o=0;o<e.valueInfo.length;++o)if(u=l.onnx.ValueInfoProto.verify(e.valueInfo[o]))return"valueInfo."+u}if(e.quantizationAnnotation!=null&&e.hasOwnProperty("quantizationAnnotation")){if(!Array.isArray(e.quantizationAnnotation))return"quantizationAnnotation: array expected";for(o=0;o<e.quantizationAnnotation.length;++o){var u;if(u=l.onnx.TensorAnnotation.verify(e.quantizationAnnotation[o]))return"quantizationAnnotation."+u}}return null},n.fromObject=function(e){if(e instanceof l.onnx.GraphProto)return e;var o=new l.onnx.GraphProto;if(e.node){if(!Array.isArray(e.node))throw TypeError(".onnx.GraphProto.node: array expected");o.node=[];for(var u=0;u<e.node.length;++u){if(typeof e.node[u]!="object")throw TypeError(".onnx.GraphProto.node: object expected");o.node[u]=l.onnx.NodeProto.fromObject(e.node[u])}}if(e.name!=null&&(o.name=String(e.name)),e.initializer){if(!Array.isArray(e.initializer))throw TypeError(".onnx.GraphProto.initializer: array expected");for(o.initializer=[],u=0;u<e.initializer.length;++u){if(typeof e.initializer[u]!="object")throw TypeError(".onnx.GraphProto.initializer: object expected");o.initializer[u]=l.onnx.TensorProto.fromObject(e.initializer[u])}}if(e.docString!=null&&(o.docString=String(e.docString)),e.input){if(!Array.isArray(e.input))throw TypeError(".onnx.GraphProto.input: array expected");for(o.input=[],u=0;u<e.input.length;++u){if(typeof e.input[u]!="object")throw TypeError(".onnx.GraphProto.input: object expected");o.input[u]=l.onnx.ValueInfoProto.fromObject(e.input[u])}}if(e.output){if(!Array.isArray(e.output))throw TypeError(".onnx.GraphProto.output: array expected");for(o.output=[],u=0;u<e.output.length;++u){if(typeof e.output[u]!="object")throw TypeError(".onnx.GraphProto.output: object expected");o.output[u]=l.onnx.ValueInfoProto.fromObject(e.output[u])}}if(e.valueInfo){if(!Array.isArray(e.valueInfo))throw TypeError(".onnx.GraphProto.valueInfo: array expected");for(o.valueInfo=[],u=0;u<e.valueInfo.length;++u){if(typeof e.valueInfo[u]!="object")throw TypeError(".onnx.GraphProto.valueInfo: object expected");o.valueInfo[u]=l.onnx.ValueInfoProto.fromObject(e.valueInfo[u])}}if(e.quantizationAnnotation){if(!Array.isArray(e.quantizationAnnotation))throw TypeError(".onnx.GraphProto.quantizationAnnotation: array expected");for(o.quantizationAnnotation=[],u=0;u<e.quantizationAnnotation.length;++u){if(typeof e.quantizationAnnotation[u]!="object")throw TypeError(".onnx.GraphProto.quantizationAnnotation: object expected");o.quantizationAnnotation[u]=l.onnx.TensorAnnotation.fromObject(e.quantizationAnnotation[u])}}return o},n.toObject=function(e,o){o||(o={});var u={};if((o.arrays||o.defaults)&&(u.node=[],u.initializer=[],u.input=[],u.output=[],u.valueInfo=[],u.quantizationAnnotation=[]),o.defaults&&(u.name="",u.docString=""),e.node&&e.node.length){u.node=[];for(var g=0;g<e.node.length;++g)u.node[g]=l.onnx.NodeProto.toObject(e.node[g],o)}if(e.name!=null&&e.hasOwnProperty("name")&&(u.name=e.name),e.initializer&&e.initializer.length)for(u.initializer=[],g=0;g<e.initializer.length;++g)u.initializer[g]=l.onnx.TensorProto.toObject(e.initializer[g],o);if(e.docString!=null&&e.hasOwnProperty("docString")&&(u.docString=e.docString),e.input&&e.input.length)for(u.input=[],g=0;g<e.input.length;++g)u.input[g]=l.onnx.ValueInfoProto.toObject(e.input[g],o);if(e.output&&e.output.length)for(u.output=[],g=0;g<e.output.length;++g)u.output[g]=l.onnx.ValueInfoProto.toObject(e.output[g],o);if(e.valueInfo&&e.valueInfo.length)for(u.valueInfo=[],g=0;g<e.valueInfo.length;++g)u.valueInfo[g]=l.onnx.ValueInfoProto.toObject(e.valueInfo[g],o);if(e.quantizationAnnotation&&e.quantizationAnnotation.length)for(u.quantizationAnnotation=[],g=0;g<e.quantizationAnnotation.length;++g)u.quantizationAnnotation[g]=l.onnx.TensorAnnotation.toObject(e.quantizationAnnotation[g],o);return u},n.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},n}(),c.TensorProto=function(){function n(e){if(this.dims=[],this.floatData=[],this.int32Data=[],this.stringData=[],this.int64Data=[],this.externalData=[],this.doubleData=[],this.uint64Data=[],e)for(var o=Object.keys(e),u=0;u<o.length;++u)e[o[u]]!=null&&(this[o[u]]=e[o[u]])}return n.prototype.dims=d.emptyArray,n.prototype.dataType=0,n.prototype.segment=null,n.prototype.floatData=d.emptyArray,n.prototype.int32Data=d.emptyArray,n.prototype.stringData=d.emptyArray,n.prototype.int64Data=d.emptyArray,n.prototype.name="",n.prototype.docString="",n.prototype.rawData=d.newBuffer([]),n.prototype.externalData=d.emptyArray,n.prototype.dataLocation=0,n.prototype.doubleData=d.emptyArray,n.prototype.uint64Data=d.emptyArray,n.create=function(e){return new n(e)},n.encode=function(e,o){if(o||(o=p.create()),e.dims!=null&&e.dims.length){o.uint32(10).fork();for(var u=0;u<e.dims.length;++u)o.int64(e.dims[u]);o.ldelim()}if(e.dataType!=null&&e.hasOwnProperty("dataType")&&o.uint32(16).int32(e.dataType),e.segment!=null&&e.hasOwnProperty("segment")&&l.onnx.TensorProto.Segment.encode(e.segment,o.uint32(26).fork()).ldelim(),e.floatData!=null&&e.floatData.length){for(o.uint32(34).fork(),u=0;u<e.floatData.length;++u)o.float(e.floatData[u]);o.ldelim()}if(e.int32Data!=null&&e.int32Data.length){for(o.uint32(42).fork(),u=0;u<e.int32Data.length;++u)o.int32(e.int32Data[u]);o.ldelim()}if(e.stringData!=null&&e.stringData.length)for(u=0;u<e.stringData.length;++u)o.uint32(50).bytes(e.stringData[u]);if(e.int64Data!=null&&e.int64Data.length){for(o.uint32(58).fork(),u=0;u<e.int64Data.length;++u)o.int64(e.int64Data[u]);o.ldelim()}if(e.name!=null&&e.hasOwnProperty("name")&&o.uint32(66).string(e.name),e.rawData!=null&&e.hasOwnProperty("rawData")&&o.uint32(74).bytes(e.rawData),e.doubleData!=null&&e.doubleData.length){for(o.uint32(82).fork(),u=0;u<e.doubleData.length;++u)o.double(e.doubleData[u]);o.ldelim()}if(e.uint64Data!=null&&e.uint64Data.length){for(o.uint32(90).fork(),u=0;u<e.uint64Data.length;++u)o.uint64(e.uint64Data[u]);o.ldelim()}if(e.docString!=null&&e.hasOwnProperty("docString")&&o.uint32(98).string(e.docString),e.externalData!=null&&e.externalData.length)for(u=0;u<e.externalData.length;++u)l.onnx.StringStringEntryProto.encode(e.externalData[u],o.uint32(106).fork()).ldelim();return e.dataLocation!=null&&e.hasOwnProperty("dataLocation")&&o.uint32(112).int32(e.dataLocation),o},n.encodeDelimited=function(e,o){return this.encode(e,o).ldelim()},n.decode=function(e,o){e instanceof h||(e=h.create(e));for(var u=o===void 0?e.len:e.pos+o,g=new l.onnx.TensorProto;e.pos<u;){var m=e.uint32();switch(m>>>3){case 1:if(g.dims&&g.dims.length||(g.dims=[]),(7&m)==2)for(var y=e.uint32()+e.pos;e.pos<y;)g.dims.push(e.int64());else g.dims.push(e.int64());break;case 2:g.dataType=e.int32();break;case 3:g.segment=l.onnx.TensorProto.Segment.decode(e,e.uint32());break;case 4:if(g.floatData&&g.floatData.length||(g.floatData=[]),(7&m)==2)for(y=e.uint32()+e.pos;e.pos<y;)g.floatData.push(e.float());else g.floatData.push(e.float());break;case 5:if(g.int32Data&&g.int32Data.length||(g.int32Data=[]),(7&m)==2)for(y=e.uint32()+e.pos;e.pos<y;)g.int32Data.push(e.int32());else g.int32Data.push(e.int32());break;case 6:g.stringData&&g.stringData.length||(g.stringData=[]),g.stringData.push(e.bytes());break;case 7:if(g.int64Data&&g.int64Data.length||(g.int64Data=[]),(7&m)==2)for(y=e.uint32()+e.pos;e.pos<y;)g.int64Data.push(e.int64());else g.int64Data.push(e.int64());break;case 8:g.name=e.string();break;case 12:g.docString=e.string();break;case 9:g.rawData=e.bytes();break;case 13:g.externalData&&g.externalData.length||(g.externalData=[]),g.externalData.push(l.onnx.StringStringEntryProto.decode(e,e.uint32()));break;case 14:g.dataLocation=e.int32();break;case 10:if(g.doubleData&&g.doubleData.length||(g.doubleData=[]),(7&m)==2)for(y=e.uint32()+e.pos;e.pos<y;)g.doubleData.push(e.double());else g.doubleData.push(e.double());break;case 11:if(g.uint64Data&&g.uint64Data.length||(g.uint64Data=[]),(7&m)==2)for(y=e.uint32()+e.pos;e.pos<y;)g.uint64Data.push(e.uint64());else g.uint64Data.push(e.uint64());break;default:e.skipType(7&m)}}return g},n.decodeDelimited=function(e){return e instanceof h||(e=new h(e)),this.decode(e,e.uint32())},n.verify=function(e){if(typeof e!="object"||e===null)return"object expected";if(e.dims!=null&&e.hasOwnProperty("dims")){if(!Array.isArray(e.dims))return"dims: array expected";for(var o=0;o<e.dims.length;++o)if(!(d.isInteger(e.dims[o])||e.dims[o]&&d.isInteger(e.dims[o].low)&&d.isInteger(e.dims[o].high)))return"dims: integer|Long[] expected"}if(e.dataType!=null&&e.hasOwnProperty("dataType")&&!d.isInteger(e.dataType))return"dataType: integer expected";if(e.segment!=null&&e.hasOwnProperty("segment")&&(u=l.onnx.TensorProto.Segment.verify(e.segment)))return"segment."+u;if(e.floatData!=null&&e.hasOwnProperty("floatData")){if(!Array.isArray(e.floatData))return"floatData: array expected";for(o=0;o<e.floatData.length;++o)if(typeof e.floatData[o]!="number")return"floatData: number[] expected"}if(e.int32Data!=null&&e.hasOwnProperty("int32Data")){if(!Array.isArray(e.int32Data))return"int32Data: array expected";for(o=0;o<e.int32Data.length;++o)if(!d.isInteger(e.int32Data[o]))return"int32Data: integer[] expected"}if(e.stringData!=null&&e.hasOwnProperty("stringData")){if(!Array.isArray(e.stringData))return"stringData: array expected";for(o=0;o<e.stringData.length;++o)if(!(e.stringData[o]&&typeof e.stringData[o].length=="number"||d.isString(e.stringData[o])))return"stringData: buffer[] expected"}if(e.int64Data!=null&&e.hasOwnProperty("int64Data")){if(!Array.isArray(e.int64Data))return"int64Data: array expected";for(o=0;o<e.int64Data.length;++o)if(!(d.isInteger(e.int64Data[o])||e.int64Data[o]&&d.isInteger(e.int64Data[o].low)&&d.isInteger(e.int64Data[o].high)))return"int64Data: integer|Long[] expected"}if(e.name!=null&&e.hasOwnProperty("name")&&!d.isString(e.name))return"name: string expected";if(e.docString!=null&&e.hasOwnProperty("docString")&&!d.isString(e.docString))return"docString: string expected";if(e.rawData!=null&&e.hasOwnProperty("rawData")&&!(e.rawData&&typeof e.rawData.length=="number"||d.isString(e.rawData)))return"rawData: buffer expected";if(e.externalData!=null&&e.hasOwnProperty("externalData")){if(!Array.isArray(e.externalData))return"externalData: array expected";for(o=0;o<e.externalData.length;++o){var u;if(u=l.onnx.StringStringEntryProto.verify(e.externalData[o]))return"externalData."+u}}if(e.dataLocation!=null&&e.hasOwnProperty("dataLocation"))switch(e.dataLocation){default:return"dataLocation: enum value expected";case 0:case 1:}if(e.doubleData!=null&&e.hasOwnProperty("doubleData")){if(!Array.isArray(e.doubleData))return"doubleData: array expected";for(o=0;o<e.doubleData.length;++o)if(typeof e.doubleData[o]!="number")return"doubleData: number[] expected"}if(e.uint64Data!=null&&e.hasOwnProperty("uint64Data")){if(!Array.isArray(e.uint64Data))return"uint64Data: array expected";for(o=0;o<e.uint64Data.length;++o)if(!(d.isInteger(e.uint64Data[o])||e.uint64Data[o]&&d.isInteger(e.uint64Data[o].low)&&d.isInteger(e.uint64Data[o].high)))return"uint64Data: integer|Long[] expected"}return null},n.fromObject=function(e){if(e instanceof l.onnx.TensorProto)return e;var o=new l.onnx.TensorProto;if(e.dims){if(!Array.isArray(e.dims))throw TypeError(".onnx.TensorProto.dims: array expected");o.dims=[];for(var u=0;u<e.dims.length;++u)d.Long?(o.dims[u]=d.Long.fromValue(e.dims[u])).unsigned=!1:typeof e.dims[u]=="string"?o.dims[u]=parseInt(e.dims[u],10):typeof e.dims[u]=="number"?o.dims[u]=e.dims[u]:typeof e.dims[u]=="object"&&(o.dims[u]=new d.LongBits(e.dims[u].low>>>0,e.dims[u].high>>>0).toNumber())}if(e.dataType!=null&&(o.dataType=0|e.dataType),e.segment!=null){if(typeof e.segment!="object")throw TypeError(".onnx.TensorProto.segment: object expected");o.segment=l.onnx.TensorProto.Segment.fromObject(e.segment)}if(e.floatData){if(!Array.isArray(e.floatData))throw TypeError(".onnx.TensorProto.floatData: array expected");for(o.floatData=[],u=0;u<e.floatData.length;++u)o.floatData[u]=Number(e.floatData[u])}if(e.int32Data){if(!Array.isArray(e.int32Data))throw TypeError(".onnx.TensorProto.int32Data: array expected");for(o.int32Data=[],u=0;u<e.int32Data.length;++u)o.int32Data[u]=0|e.int32Data[u]}if(e.stringData){if(!Array.isArray(e.stringData))throw TypeError(".onnx.TensorProto.stringData: array expected");for(o.stringData=[],u=0;u<e.stringData.length;++u)typeof e.stringData[u]=="string"?d.base64.decode(e.stringData[u],o.stringData[u]=d.newBuffer(d.base64.length(e.stringData[u])),0):e.stringData[u].length&&(o.stringData[u]=e.stringData[u])}if(e.int64Data){if(!Array.isArray(e.int64Data))throw TypeError(".onnx.TensorProto.int64Data: array expected");for(o.int64Data=[],u=0;u<e.int64Data.length;++u)d.Long?(o.int64Data[u]=d.Long.fromValue(e.int64Data[u])).unsigned=!1:typeof e.int64Data[u]=="string"?o.int64Data[u]=parseInt(e.int64Data[u],10):typeof e.int64Data[u]=="number"?o.int64Data[u]=e.int64Data[u]:typeof e.int64Data[u]=="object"&&(o.int64Data[u]=new d.LongBits(e.int64Data[u].low>>>0,e.int64Data[u].high>>>0).toNumber())}if(e.name!=null&&(o.name=String(e.name)),e.docString!=null&&(o.docString=String(e.docString)),e.rawData!=null&&(typeof e.rawData=="string"?d.base64.decode(e.rawData,o.rawData=d.newBuffer(d.base64.length(e.rawData)),0):e.rawData.length&&(o.rawData=e.rawData)),e.externalData){if(!Array.isArray(e.externalData))throw TypeError(".onnx.TensorProto.externalData: array expected");for(o.externalData=[],u=0;u<e.externalData.length;++u){if(typeof e.externalData[u]!="object")throw TypeError(".onnx.TensorProto.externalData: object expected");o.externalData[u]=l.onnx.StringStringEntryProto.fromObject(e.externalData[u])}}switch(e.dataLocation){case"DEFAULT":case 0:o.dataLocation=0;break;case"EXTERNAL":case 1:o.dataLocation=1}if(e.doubleData){if(!Array.isArray(e.doubleData))throw TypeError(".onnx.TensorProto.doubleData: array expected");for(o.doubleData=[],u=0;u<e.doubleData.length;++u)o.doubleData[u]=Number(e.doubleData[u])}if(e.uint64Data){if(!Array.isArray(e.uint64Data))throw TypeError(".onnx.TensorProto.uint64Data: array expected");for(o.uint64Data=[],u=0;u<e.uint64Data.length;++u)d.Long?(o.uint64Data[u]=d.Long.fromValue(e.uint64Data[u])).unsigned=!0:typeof e.uint64Data[u]=="string"?o.uint64Data[u]=parseInt(e.uint64Data[u],10):typeof e.uint64Data[u]=="number"?o.uint64Data[u]=e.uint64Data[u]:typeof e.uint64Data[u]=="object"&&(o.uint64Data[u]=new d.LongBits(e.uint64Data[u].low>>>0,e.uint64Data[u].high>>>0).toNumber(!0))}return o},n.toObject=function(e,o){o||(o={});var u={};if((o.arrays||o.defaults)&&(u.dims=[],u.floatData=[],u.int32Data=[],u.stringData=[],u.int64Data=[],u.doubleData=[],u.uint64Data=[],u.externalData=[]),o.defaults&&(u.dataType=0,u.segment=null,u.name="",o.bytes===String?u.rawData="":(u.rawData=[],o.bytes!==Array&&(u.rawData=d.newBuffer(u.rawData))),u.docString="",u.dataLocation=o.enums===String?"DEFAULT":0),e.dims&&e.dims.length){u.dims=[];for(var g=0;g<e.dims.length;++g)typeof e.dims[g]=="number"?u.dims[g]=o.longs===String?String(e.dims[g]):e.dims[g]:u.dims[g]=o.longs===String?d.Long.prototype.toString.call(e.dims[g]):o.longs===Number?new d.LongBits(e.dims[g].low>>>0,e.dims[g].high>>>0).toNumber():e.dims[g]}if(e.dataType!=null&&e.hasOwnProperty("dataType")&&(u.dataType=e.dataType),e.segment!=null&&e.hasOwnProperty("segment")&&(u.segment=l.onnx.TensorProto.Segment.toObject(e.segment,o)),e.floatData&&e.floatData.length)for(u.floatData=[],g=0;g<e.floatData.length;++g)u.floatData[g]=o.json&&!isFinite(e.floatData[g])?String(e.floatData[g]):e.floatData[g];if(e.int32Data&&e.int32Data.length)for(u.int32Data=[],g=0;g<e.int32Data.length;++g)u.int32Data[g]=e.int32Data[g];if(e.stringData&&e.stringData.length)for(u.stringData=[],g=0;g<e.stringData.length;++g)u.stringData[g]=o.bytes===String?d.base64.encode(e.stringData[g],0,e.stringData[g].length):o.bytes===Array?Array.prototype.slice.call(e.stringData[g]):e.stringData[g];if(e.int64Data&&e.int64Data.length)for(u.int64Data=[],g=0;g<e.int64Data.length;++g)typeof e.int64Data[g]=="number"?u.int64Data[g]=o.longs===String?String(e.int64Data[g]):e.int64Data[g]:u.int64Data[g]=o.longs===String?d.Long.prototype.toString.call(e.int64Data[g]):o.longs===Number?new d.LongBits(e.int64Data[g].low>>>0,e.int64Data[g].high>>>0).toNumber():e.int64Data[g];if(e.name!=null&&e.hasOwnProperty("name")&&(u.name=e.name),e.rawData!=null&&e.hasOwnProperty("rawData")&&(u.rawData=o.bytes===String?d.base64.encode(e.rawData,0,e.rawData.length):o.bytes===Array?Array.prototype.slice.call(e.rawData):e.rawData),e.doubleData&&e.doubleData.length)for(u.doubleData=[],g=0;g<e.doubleData.length;++g)u.doubleData[g]=o.json&&!isFinite(e.doubleData[g])?String(e.doubleData[g]):e.doubleData[g];if(e.uint64Data&&e.uint64Data.length)for(u.uint64Data=[],g=0;g<e.uint64Data.length;++g)typeof e.uint64Data[g]=="number"?u.uint64Data[g]=o.longs===String?String(e.uint64Data[g]):e.uint64Data[g]:u.uint64Data[g]=o.longs===String?d.Long.prototype.toString.call(e.uint64Data[g]):o.longs===Number?new d.LongBits(e.uint64Data[g].low>>>0,e.uint64Data[g].high>>>0).toNumber(!0):e.uint64Data[g];if(e.docString!=null&&e.hasOwnProperty("docString")&&(u.docString=e.docString),e.externalData&&e.externalData.length)for(u.externalData=[],g=0;g<e.externalData.length;++g)u.externalData[g]=l.onnx.StringStringEntryProto.toObject(e.externalData[g],o);return e.dataLocation!=null&&e.hasOwnProperty("dataLocation")&&(u.dataLocation=o.enums===String?l.onnx.TensorProto.DataLocation[e.dataLocation]:e.dataLocation),u},n.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},n.DataType=function(){var e={},o=Object.create(e);return o[e[0]="UNDEFINED"]=0,o[e[1]="FLOAT"]=1,o[e[2]="UINT8"]=2,o[e[3]="INT8"]=3,o[e[4]="UINT16"]=4,o[e[5]="INT16"]=5,o[e[6]="INT32"]=6,o[e[7]="INT64"]=7,o[e[8]="STRING"]=8,o[e[9]="BOOL"]=9,o[e[10]="FLOAT16"]=10,o[e[11]="DOUBLE"]=11,o[e[12]="UINT32"]=12,o[e[13]="UINT64"]=13,o[e[14]="COMPLEX64"]=14,o[e[15]="COMPLEX128"]=15,o[e[16]="BFLOAT16"]=16,o}(),n.Segment=function(){function e(o){if(o)for(var u=Object.keys(o),g=0;g<u.length;++g)o[u[g]]!=null&&(this[u[g]]=o[u[g]])}return e.prototype.begin=d.Long?d.Long.fromBits(0,0,!1):0,e.prototype.end=d.Long?d.Long.fromBits(0,0,!1):0,e.create=function(o){return new e(o)},e.encode=function(o,u){return u||(u=p.create()),o.begin!=null&&o.hasOwnProperty("begin")&&u.uint32(8).int64(o.begin),o.end!=null&&o.hasOwnProperty("end")&&u.uint32(16).int64(o.end),u},e.encodeDelimited=function(o,u){return this.encode(o,u).ldelim()},e.decode=function(o,u){o instanceof h||(o=h.create(o));for(var g=u===void 0?o.len:o.pos+u,m=new l.onnx.TensorProto.Segment;o.pos<g;){var y=o.uint32();switch(y>>>3){case 1:m.begin=o.int64();break;case 2:m.end=o.int64();break;default:o.skipType(7&y)}}return m},e.decodeDelimited=function(o){return o instanceof h||(o=new h(o)),this.decode(o,o.uint32())},e.verify=function(o){return typeof o!="object"||o===null?"object expected":o.begin!=null&&o.hasOwnProperty("begin")&&!(d.isInteger(o.begin)||o.begin&&d.isInteger(o.begin.low)&&d.isInteger(o.begin.high))?"begin: integer|Long expected":o.end!=null&&o.hasOwnProperty("end")&&!(d.isInteger(o.end)||o.end&&d.isInteger(o.end.low)&&d.isInteger(o.end.high))?"end: integer|Long expected":null},e.fromObject=function(o){if(o instanceof l.onnx.TensorProto.Segment)return o;var u=new l.onnx.TensorProto.Segment;return o.begin!=null&&(d.Long?(u.begin=d.Long.fromValue(o.begin)).unsigned=!1:typeof o.begin=="string"?u.begin=parseInt(o.begin,10):typeof o.begin=="number"?u.begin=o.begin:typeof o.begin=="object"&&(u.begin=new d.LongBits(o.begin.low>>>0,o.begin.high>>>0).toNumber())),o.end!=null&&(d.Long?(u.end=d.Long.fromValue(o.end)).unsigned=!1:typeof o.end=="string"?u.end=parseInt(o.end,10):typeof o.end=="number"?u.end=o.end:typeof o.end=="object"&&(u.end=new d.LongBits(o.end.low>>>0,o.end.high>>>0).toNumber())),u},e.toObject=function(o,u){u||(u={});var g={};if(u.defaults){if(d.Long){var m=new d.Long(0,0,!1);g.begin=u.longs===String?m.toString():u.longs===Number?m.toNumber():m}else g.begin=u.longs===String?"0":0;d.Long?(m=new d.Long(0,0,!1),g.end=u.longs===String?m.toString():u.longs===Number?m.toNumber():m):g.end=u.longs===String?"0":0}return o.begin!=null&&o.hasOwnProperty("begin")&&(typeof o.begin=="number"?g.begin=u.longs===String?String(o.begin):o.begin:g.begin=u.longs===String?d.Long.prototype.toString.call(o.begin):u.longs===Number?new d.LongBits(o.begin.low>>>0,o.begin.high>>>0).toNumber():o.begin),o.end!=null&&o.hasOwnProperty("end")&&(typeof o.end=="number"?g.end=u.longs===String?String(o.end):o.end:g.end=u.longs===String?d.Long.prototype.toString.call(o.end):u.longs===Number?new d.LongBits(o.end.low>>>0,o.end.high>>>0).toNumber():o.end),g},e.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},e}(),n.DataLocation=function(){var e={},o=Object.create(e);return o[e[0]="DEFAULT"]=0,o[e[1]="EXTERNAL"]=1,o}(),n}(),c.TensorShapeProto=function(){function n(e){if(this.dim=[],e)for(var o=Object.keys(e),u=0;u<o.length;++u)e[o[u]]!=null&&(this[o[u]]=e[o[u]])}return n.prototype.dim=d.emptyArray,n.create=function(e){return new n(e)},n.encode=function(e,o){if(o||(o=p.create()),e.dim!=null&&e.dim.length)for(var u=0;u<e.dim.length;++u)l.onnx.TensorShapeProto.Dimension.encode(e.dim[u],o.uint32(10).fork()).ldelim();return o},n.encodeDelimited=function(e,o){return this.encode(e,o).ldelim()},n.decode=function(e,o){e instanceof h||(e=h.create(e));for(var u=o===void 0?e.len:e.pos+o,g=new l.onnx.TensorShapeProto;e.pos<u;){var m=e.uint32();m>>>3==1?(g.dim&&g.dim.length||(g.dim=[]),g.dim.push(l.onnx.TensorShapeProto.Dimension.decode(e,e.uint32()))):e.skipType(7&m)}return g},n.decodeDelimited=function(e){return e instanceof h||(e=new h(e)),this.decode(e,e.uint32())},n.verify=function(e){if(typeof e!="object"||e===null)return"object expected";if(e.dim!=null&&e.hasOwnProperty("dim")){if(!Array.isArray(e.dim))return"dim: array expected";for(var o=0;o<e.dim.length;++o){var u=l.onnx.TensorShapeProto.Dimension.verify(e.dim[o]);if(u)return"dim."+u}}return null},n.fromObject=function(e){if(e instanceof l.onnx.TensorShapeProto)return e;var o=new l.onnx.TensorShapeProto;if(e.dim){if(!Array.isArray(e.dim))throw TypeError(".onnx.TensorShapeProto.dim: array expected");o.dim=[];for(var u=0;u<e.dim.length;++u){if(typeof e.dim[u]!="object")throw TypeError(".onnx.TensorShapeProto.dim: object expected");o.dim[u]=l.onnx.TensorShapeProto.Dimension.fromObject(e.dim[u])}}return o},n.toObject=function(e,o){o||(o={});var u={};if((o.arrays||o.defaults)&&(u.dim=[]),e.dim&&e.dim.length){u.dim=[];for(var g=0;g<e.dim.length;++g)u.dim[g]=l.onnx.TensorShapeProto.Dimension.toObject(e.dim[g],o)}return u},n.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},n.Dimension=function(){function e(u){if(u)for(var g=Object.keys(u),m=0;m<g.length;++m)u[g[m]]!=null&&(this[g[m]]=u[g[m]])}var o;return e.prototype.dimValue=d.Long?d.Long.fromBits(0,0,!1):0,e.prototype.dimParam="",e.prototype.denotation="",Object.defineProperty(e.prototype,"value",{get:d.oneOfGetter(o=["dimValue","dimParam"]),set:d.oneOfSetter(o)}),e.create=function(u){return new e(u)},e.encode=function(u,g){return g||(g=p.create()),u.dimValue!=null&&u.hasOwnProperty("dimValue")&&g.uint32(8).int64(u.dimValue),u.dimParam!=null&&u.hasOwnProperty("dimParam")&&g.uint32(18).string(u.dimParam),u.denotation!=null&&u.hasOwnProperty("denotation")&&g.uint32(26).string(u.denotation),g},e.encodeDelimited=function(u,g){return this.encode(u,g).ldelim()},e.decode=function(u,g){u instanceof h||(u=h.create(u));for(var m=g===void 0?u.len:u.pos+g,y=new l.onnx.TensorShapeProto.Dimension;u.pos<m;){var b=u.uint32();switch(b>>>3){case 1:y.dimValue=u.int64();break;case 2:y.dimParam=u.string();break;case 3:y.denotation=u.string();break;default:u.skipType(7&b)}}return y},e.decodeDelimited=function(u){return u instanceof h||(u=new h(u)),this.decode(u,u.uint32())},e.verify=function(u){if(typeof u!="object"||u===null)return"object expected";var g={};if(u.dimValue!=null&&u.hasOwnProperty("dimValue")&&(g.value=1,!(d.isInteger(u.dimValue)||u.dimValue&&d.isInteger(u.dimValue.low)&&d.isInteger(u.dimValue.high))))return"dimValue: integer|Long expected";if(u.dimParam!=null&&u.hasOwnProperty("dimParam")){if(g.value===1)return"value: multiple values";if(g.value=1,!d.isString(u.dimParam))return"dimParam: string expected"}return u.denotation!=null&&u.hasOwnProperty("denotation")&&!d.isString(u.denotation)?"denotation: string expected":null},e.fromObject=function(u){if(u instanceof l.onnx.TensorShapeProto.Dimension)return u;var g=new l.onnx.TensorShapeProto.Dimension;return u.dimValue!=null&&(d.Long?(g.dimValue=d.Long.fromValue(u.dimValue)).unsigned=!1:typeof u.dimValue=="string"?g.dimValue=parseInt(u.dimValue,10):typeof u.dimValue=="number"?g.dimValue=u.dimValue:typeof u.dimValue=="object"&&(g.dimValue=new d.LongBits(u.dimValue.low>>>0,u.dimValue.high>>>0).toNumber())),u.dimParam!=null&&(g.dimParam=String(u.dimParam)),u.denotation!=null&&(g.denotation=String(u.denotation)),g},e.toObject=function(u,g){g||(g={});var m={};return g.defaults&&(m.denotation=""),u.dimValue!=null&&u.hasOwnProperty("dimValue")&&(typeof u.dimValue=="number"?m.dimValue=g.longs===String?String(u.dimValue):u.dimValue:m.dimValue=g.longs===String?d.Long.prototype.toString.call(u.dimValue):g.longs===Number?new d.LongBits(u.dimValue.low>>>0,u.dimValue.high>>>0).toNumber():u.dimValue,g.oneofs&&(m.value="dimValue")),u.dimParam!=null&&u.hasOwnProperty("dimParam")&&(m.dimParam=u.dimParam,g.oneofs&&(m.value="dimParam")),u.denotation!=null&&u.hasOwnProperty("denotation")&&(m.denotation=u.denotation),m},e.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},e}(),n}(),c.TypeProto=function(){function n(o){if(o)for(var u=Object.keys(o),g=0;g<u.length;++g)o[u[g]]!=null&&(this[u[g]]=o[u[g]])}var e;return n.prototype.tensorType=null,n.prototype.denotation="",Object.defineProperty(n.prototype,"value",{get:d.oneOfGetter(e=["tensorType"]),set:d.oneOfSetter(e)}),n.create=function(o){return new n(o)},n.encode=function(o,u){return u||(u=p.create()),o.tensorType!=null&&o.hasOwnProperty("tensorType")&&l.onnx.TypeProto.Tensor.encode(o.tensorType,u.uint32(10).fork()).ldelim(),o.denotation!=null&&o.hasOwnProperty("denotation")&&u.uint32(50).string(o.denotation),u},n.encodeDelimited=function(o,u){return this.encode(o,u).ldelim()},n.decode=function(o,u){o instanceof h||(o=h.create(o));for(var g=u===void 0?o.len:o.pos+u,m=new l.onnx.TypeProto;o.pos<g;){var y=o.uint32();switch(y>>>3){case 1:m.tensorType=l.onnx.TypeProto.Tensor.decode(o,o.uint32());break;case 6:m.denotation=o.string();break;default:o.skipType(7&y)}}return m},n.decodeDelimited=function(o){return o instanceof h||(o=new h(o)),this.decode(o,o.uint32())},n.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.tensorType!=null&&o.hasOwnProperty("tensorType")){var u=l.onnx.TypeProto.Tensor.verify(o.tensorType);if(u)return"tensorType."+u}return o.denotation!=null&&o.hasOwnProperty("denotation")&&!d.isString(o.denotation)?"denotation: string expected":null},n.fromObject=function(o){if(o instanceof l.onnx.TypeProto)return o;var u=new l.onnx.TypeProto;if(o.tensorType!=null){if(typeof o.tensorType!="object")throw TypeError(".onnx.TypeProto.tensorType: object expected");u.tensorType=l.onnx.TypeProto.Tensor.fromObject(o.tensorType)}return o.denotation!=null&&(u.denotation=String(o.denotation)),u},n.toObject=function(o,u){u||(u={});var g={};return u.defaults&&(g.denotation=""),o.tensorType!=null&&o.hasOwnProperty("tensorType")&&(g.tensorType=l.onnx.TypeProto.Tensor.toObject(o.tensorType,u),u.oneofs&&(g.value="tensorType")),o.denotation!=null&&o.hasOwnProperty("denotation")&&(g.denotation=o.denotation),g},n.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},n.Tensor=function(){function o(u){if(u)for(var g=Object.keys(u),m=0;m<g.length;++m)u[g[m]]!=null&&(this[g[m]]=u[g[m]])}return o.prototype.elemType=0,o.prototype.shape=null,o.create=function(u){return new o(u)},o.encode=function(u,g){return g||(g=p.create()),u.elemType!=null&&u.hasOwnProperty("elemType")&&g.uint32(8).int32(u.elemType),u.shape!=null&&u.hasOwnProperty("shape")&&l.onnx.TensorShapeProto.encode(u.shape,g.uint32(18).fork()).ldelim(),g},o.encodeDelimited=function(u,g){return this.encode(u,g).ldelim()},o.decode=function(u,g){u instanceof h||(u=h.create(u));for(var m=g===void 0?u.len:u.pos+g,y=new l.onnx.TypeProto.Tensor;u.pos<m;){var b=u.uint32();switch(b>>>3){case 1:y.elemType=u.int32();break;case 2:y.shape=l.onnx.TensorShapeProto.decode(u,u.uint32());break;default:u.skipType(7&b)}}return y},o.decodeDelimited=function(u){return u instanceof h||(u=new h(u)),this.decode(u,u.uint32())},o.verify=function(u){if(typeof u!="object"||u===null)return"object expected";if(u.elemType!=null&&u.hasOwnProperty("elemType")&&!d.isInteger(u.elemType))return"elemType: integer expected";if(u.shape!=null&&u.hasOwnProperty("shape")){var g=l.onnx.TensorShapeProto.verify(u.shape);if(g)return"shape."+g}return null},o.fromObject=function(u){if(u instanceof l.onnx.TypeProto.Tensor)return u;var g=new l.onnx.TypeProto.Tensor;if(u.elemType!=null&&(g.elemType=0|u.elemType),u.shape!=null){if(typeof u.shape!="object")throw TypeError(".onnx.TypeProto.Tensor.shape: object expected");g.shape=l.onnx.TensorShapeProto.fromObject(u.shape)}return g},o.toObject=function(u,g){g||(g={});var m={};return g.defaults&&(m.elemType=0,m.shape=null),u.elemType!=null&&u.hasOwnProperty("elemType")&&(m.elemType=u.elemType),u.shape!=null&&u.hasOwnProperty("shape")&&(m.shape=l.onnx.TensorShapeProto.toObject(u.shape,g)),m},o.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},o}(),n}(),c.OperatorSetIdProto=function(){function n(e){if(e)for(var o=Object.keys(e),u=0;u<o.length;++u)e[o[u]]!=null&&(this[o[u]]=e[o[u]])}return n.prototype.domain="",n.prototype.version=d.Long?d.Long.fromBits(0,0,!1):0,n.create=function(e){return new n(e)},n.encode=function(e,o){return o||(o=p.create()),e.domain!=null&&e.hasOwnProperty("domain")&&o.uint32(10).string(e.domain),e.version!=null&&e.hasOwnProperty("version")&&o.uint32(16).int64(e.version),o},n.encodeDelimited=function(e,o){return this.encode(e,o).ldelim()},n.decode=function(e,o){e instanceof h||(e=h.create(e));for(var u=o===void 0?e.len:e.pos+o,g=new l.onnx.OperatorSetIdProto;e.pos<u;){var m=e.uint32();switch(m>>>3){case 1:g.domain=e.string();break;case 2:g.version=e.int64();break;default:e.skipType(7&m)}}return g},n.decodeDelimited=function(e){return e instanceof h||(e=new h(e)),this.decode(e,e.uint32())},n.verify=function(e){return typeof e!="object"||e===null?"object expected":e.domain!=null&&e.hasOwnProperty("domain")&&!d.isString(e.domain)?"domain: string expected":e.version!=null&&e.hasOwnProperty("version")&&!(d.isInteger(e.version)||e.version&&d.isInteger(e.version.low)&&d.isInteger(e.version.high))?"version: integer|Long expected":null},n.fromObject=function(e){if(e instanceof l.onnx.OperatorSetIdProto)return e;var o=new l.onnx.OperatorSetIdProto;return e.domain!=null&&(o.domain=String(e.domain)),e.version!=null&&(d.Long?(o.version=d.Long.fromValue(e.version)).unsigned=!1:typeof e.version=="string"?o.version=parseInt(e.version,10):typeof e.version=="number"?o.version=e.version:typeof e.version=="object"&&(o.version=new d.LongBits(e.version.low>>>0,e.version.high>>>0).toNumber())),o},n.toObject=function(e,o){o||(o={});var u={};if(o.defaults)if(u.domain="",d.Long){var g=new d.Long(0,0,!1);u.version=o.longs===String?g.toString():o.longs===Number?g.toNumber():g}else u.version=o.longs===String?"0":0;return e.domain!=null&&e.hasOwnProperty("domain")&&(u.domain=e.domain),e.version!=null&&e.hasOwnProperty("version")&&(typeof e.version=="number"?u.version=o.longs===String?String(e.version):e.version:u.version=o.longs===String?d.Long.prototype.toString.call(e.version):o.longs===Number?new d.LongBits(e.version.low>>>0,e.version.high>>>0).toNumber():e.version),u},n.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},n}(),c),f.exports=l},2100:(f,t,r)=>{f.exports=r(9482)},9482:(f,t,r)=>{var i=t;function s(){i.util._configure(),i.Writer._configure(i.BufferWriter),i.Reader._configure(i.BufferReader)}i.build="minimal",i.Writer=r(1173),i.BufferWriter=r(3155),i.Reader=r(1408),i.BufferReader=r(593),i.util=r(9693),i.rpc=r(5994),i.roots=r(5054),i.configure=s,s()},1408:(f,t,r)=>{f.exports=p;var i,s=r(9693),c=s.LongBits,a=s.utf8;function h(g,m){return RangeError("index out of range: "+g.pos+" + "+(m||1)+" > "+g.len)}function p(g){this.buf=g,this.pos=0,this.len=g.length}var d,l=typeof Uint8Array<"u"?function(g){if(g instanceof Uint8Array||Array.isArray(g))return new p(g);throw Error("illegal buffer")}:function(g){if(Array.isArray(g))return new p(g);throw Error("illegal buffer")},n=function(){return s.Buffer?function(g){return(p.create=function(m){return s.Buffer.isBuffer(m)?new i(m):l(m)})(g)}:l};function e(){var g=new c(0,0),m=0;if(!(this.len-this.pos>4)){for(;m<3;++m){if(this.pos>=this.len)throw h(this);if(g.lo=(g.lo|(127&this.buf[this.pos])<<7*m)>>>0,this.buf[this.pos++]<128)return g}return g.lo=(g.lo|(127&this.buf[this.pos++])<<7*m)>>>0,g}for(;m<4;++m)if(g.lo=(g.lo|(127&this.buf[this.pos])<<7*m)>>>0,this.buf[this.pos++]<128)return g;if(g.lo=(g.lo|(127&this.buf[this.pos])<<28)>>>0,g.hi=(g.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return g;if(m=0,this.len-this.pos>4){for(;m<5;++m)if(g.hi=(g.hi|(127&this.buf[this.pos])<<7*m+3)>>>0,this.buf[this.pos++]<128)return g}else for(;m<5;++m){if(this.pos>=this.len)throw h(this);if(g.hi=(g.hi|(127&this.buf[this.pos])<<7*m+3)>>>0,this.buf[this.pos++]<128)return g}throw Error("invalid varint encoding")}function o(g,m){return(g[m-4]|g[m-3]<<8|g[m-2]<<16|g[m-1]<<24)>>>0}function u(){if(this.pos+8>this.len)throw h(this,8);return new c(o(this.buf,this.pos+=4),o(this.buf,this.pos+=4))}p.create=n(),p.prototype._slice=s.Array.prototype.subarray||s.Array.prototype.slice,p.prototype.uint32=(d=4294967295,function(){if(d=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(d=(d|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(d=(d|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(d=(d|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(d=(d|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return d;if((this.pos+=5)>this.len)throw this.pos=this.len,h(this,10);return d}),p.prototype.int32=function(){return 0|this.uint32()},p.prototype.sint32=function(){var g=this.uint32();return g>>>1^-(1&g)|0},p.prototype.bool=function(){return this.uint32()!==0},p.prototype.fixed32=function(){if(this.pos+4>this.len)throw h(this,4);return o(this.buf,this.pos+=4)},p.prototype.sfixed32=function(){if(this.pos+4>this.len)throw h(this,4);return 0|o(this.buf,this.pos+=4)},p.prototype.float=function(){if(this.pos+4>this.len)throw h(this,4);var g=s.float.readFloatLE(this.buf,this.pos);return this.pos+=4,g},p.prototype.double=function(){if(this.pos+8>this.len)throw h(this,4);var g=s.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,g},p.prototype.bytes=function(){var g=this.uint32(),m=this.pos,y=this.pos+g;if(y>this.len)throw h(this,g);return this.pos+=g,Array.isArray(this.buf)?this.buf.slice(m,y):m===y?new this.buf.constructor(0):this._slice.call(this.buf,m,y)},p.prototype.string=function(){var g=this.bytes();return a.read(g,0,g.length)},p.prototype.skip=function(g){if(typeof g=="number"){if(this.pos+g>this.len)throw h(this,g);this.pos+=g}else do if(this.pos>=this.len)throw h(this);while(128&this.buf[this.pos++]);return this},p.prototype.skipType=function(g){switch(g){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(g=7&this.uint32())!=4;)this.skipType(g);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+g+" at offset "+this.pos)}return this},p._configure=function(g){i=g,p.create=n(),i._configure();var m=s.Long?"toLong":"toNumber";s.merge(p.prototype,{int64:function(){return e.call(this)[m](!1)},uint64:function(){return e.call(this)[m](!0)},sint64:function(){return e.call(this).zzDecode()[m](!1)},fixed64:function(){return u.call(this)[m](!0)},sfixed64:function(){return u.call(this)[m](!1)}})}},593:(f,t,r)=>{f.exports=c;var i=r(1408);(c.prototype=Object.create(i.prototype)).constructor=c;var s=r(9693);function c(a){i.call(this,a)}c._configure=function(){s.Buffer&&(c.prototype._slice=s.Buffer.prototype.slice)},c.prototype.string=function(){var a=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+a,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+a,this.len))},c._configure()},5054:f=>{f.exports={}},5994:(f,t,r)=>{t.Service=r(7948)},7948:(f,t,r)=>{f.exports=s;var i=r(9693);function s(c,a,h){if(typeof c!="function")throw TypeError("rpcImpl must be a function");i.EventEmitter.call(this),this.rpcImpl=c,this.requestDelimited=!!a,this.responseDelimited=!!h}(s.prototype=Object.create(i.EventEmitter.prototype)).constructor=s,s.prototype.rpcCall=function c(a,h,p,d,l){if(!d)throw TypeError("request must be specified");var n=this;if(!l)return i.asPromise(c,n,a,h,p,d);if(n.rpcImpl)try{return n.rpcImpl(a,h[n.requestDelimited?"encodeDelimited":"encode"](d).finish(),function(e,o){if(e)return n.emit("error",e,a),l(e);if(o!==null){if(!(o instanceof p))try{o=p[n.responseDelimited?"decodeDelimited":"decode"](o)}catch(u){return n.emit("error",u,a),l(u)}return n.emit("data",o,a),l(null,o)}n.end(!0)})}catch(e){return n.emit("error",e,a),void setTimeout(function(){l(e)},0)}else setTimeout(function(){l(Error("already ended"))},0)},s.prototype.end=function(c){return this.rpcImpl&&(c||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},1945:(f,t,r)=>{f.exports=s;var i=r(9693);function s(p,d){this.lo=p>>>0,this.hi=d>>>0}var c=s.zero=new s(0,0);c.toNumber=function(){return 0},c.zzEncode=c.zzDecode=function(){return this},c.length=function(){return 1};var a=s.zeroHash="\0\0\0\0\0\0\0\0";s.fromNumber=function(p){if(p===0)return c;var d=p<0;d&&(p=-p);var l=p>>>0,n=(p-l)/4294967296>>>0;return d&&(n=~n>>>0,l=~l>>>0,++l>4294967295&&(l=0,++n>4294967295&&(n=0))),new s(l,n)},s.from=function(p){if(typeof p=="number")return s.fromNumber(p);if(i.isString(p)){if(!i.Long)return s.fromNumber(parseInt(p,10));p=i.Long.fromString(p)}return p.low||p.high?new s(p.low>>>0,p.high>>>0):c},s.prototype.toNumber=function(p){if(!p&&this.hi>>>31){var d=1+~this.lo>>>0,l=~this.hi>>>0;return d||(l=l+1>>>0),-(d+4294967296*l)}return this.lo+4294967296*this.hi},s.prototype.toLong=function(p){return i.Long?new i.Long(0|this.lo,0|this.hi,!!p):{low:0|this.lo,high:0|this.hi,unsigned:!!p}};var h=String.prototype.charCodeAt;s.fromHash=function(p){return p===a?c:new s((h.call(p,0)|h.call(p,1)<<8|h.call(p,2)<<16|h.call(p,3)<<24)>>>0,(h.call(p,4)|h.call(p,5)<<8|h.call(p,6)<<16|h.call(p,7)<<24)>>>0)},s.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},s.prototype.zzEncode=function(){var p=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^p)>>>0,this.lo=(this.lo<<1^p)>>>0,this},s.prototype.zzDecode=function(){var p=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^p)>>>0,this.hi=(this.hi>>>1^p)>>>0,this},s.prototype.length=function(){var p=this.lo,d=(this.lo>>>28|this.hi<<4)>>>0,l=this.hi>>>24;return l===0?d===0?p<16384?p<128?1:2:p<2097152?3:4:d<16384?d<128?5:6:d<2097152?7:8:l<128?9:10}},9693:function(f,t,r){var i=t;function s(a,h,p){for(var d=Object.keys(h),l=0;l<d.length;++l)a[d[l]]!==void 0&&p||(a[d[l]]=h[d[l]]);return a}function c(a){function h(p,d){if(!(this instanceof h))return new h(p,d);Object.defineProperty(this,"message",{get:function(){return p}}),Error.captureStackTrace?Error.captureStackTrace(this,h):Object.defineProperty(this,"stack",{value:new Error().stack||""}),d&&s(this,d)}return(h.prototype=Object.create(Error.prototype)).constructor=h,Object.defineProperty(h.prototype,"name",{get:function(){return a}}),h.prototype.toString=function(){return this.name+": "+this.message},h}i.asPromise=r(4537),i.base64=r(7419),i.EventEmitter=r(9211),i.float=r(945),i.inquire=r(7199),i.utf8=r(4997),i.pool=r(6662),i.LongBits=r(1945),i.isNode=!!(r.g!==void 0&&r.g&&r.g.process&&r.g.process.versions&&r.g.process.versions.node),i.global=i.isNode&&r.g||typeof window<"u"&&window||typeof self<"u"&&self||this,i.emptyArray=Object.freeze?Object.freeze([]):[],i.emptyObject=Object.freeze?Object.freeze({}):{},i.isInteger=Number.isInteger||function(a){return typeof a=="number"&&isFinite(a)&&Math.floor(a)===a},i.isString=function(a){return typeof a=="string"||a instanceof String},i.isObject=function(a){return a&&typeof a=="object"},i.isset=i.isSet=function(a,h){var p=a[h];return!(p==null||!a.hasOwnProperty(h))&&(typeof p!="object"||(Array.isArray(p)?p.length:Object.keys(p).length)>0)},i.Buffer=function(){try{var a=i.inquire("buffer").Buffer;return a.prototype.utf8Write?a:null}catch{return null}}(),i._Buffer_from=null,i._Buffer_allocUnsafe=null,i.newBuffer=function(a){return typeof a=="number"?i.Buffer?i._Buffer_allocUnsafe(a):new i.Array(a):i.Buffer?i._Buffer_from(a):typeof Uint8Array>"u"?a:new Uint8Array(a)},i.Array=typeof Uint8Array<"u"?Uint8Array:Array,i.Long=i.global.dcodeIO&&i.global.dcodeIO.Long||i.global.Long||i.inquire("long"),i.key2Re=/^true|false|0|1$/,i.key32Re=/^-?(?:0|[1-9][0-9]*)$/,i.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,i.longToHash=function(a){return a?i.LongBits.from(a).toHash():i.LongBits.zeroHash},i.longFromHash=function(a,h){var p=i.LongBits.fromHash(a);return i.Long?i.Long.fromBits(p.lo,p.hi,h):p.toNumber(!!h)},i.merge=s,i.lcFirst=function(a){return a.charAt(0).toLowerCase()+a.substring(1)},i.newError=c,i.ProtocolError=c("ProtocolError"),i.oneOfGetter=function(a){for(var h={},p=0;p<a.length;++p)h[a[p]]=1;return function(){for(var d=Object.keys(this),l=d.length-1;l>-1;--l)if(h[d[l]]===1&&this[d[l]]!==void 0&&this[d[l]]!==null)return d[l]}},i.oneOfSetter=function(a){return function(h){for(var p=0;p<a.length;++p)a[p]!==h&&delete this[a[p]]}},i.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},i._configure=function(){var a=i.Buffer;a?(i._Buffer_from=a.from!==Uint8Array.from&&a.from||function(h,p){return new a(h,p)},i._Buffer_allocUnsafe=a.allocUnsafe||function(h){return new a(h)}):i._Buffer_from=i._Buffer_allocUnsafe=null}},1173:(f,t,r)=>{f.exports=n;var i,s=r(9693),c=s.LongBits,a=s.base64,h=s.utf8;function p(b,_,x){this.fn=b,this.len=_,this.next=void 0,this.val=x}function d(){}function l(b){this.head=b.head,this.tail=b.tail,this.len=b.len,this.next=b.states}function n(){this.len=0,this.head=new p(d,0,0),this.tail=this.head,this.states=null}var e=function(){return s.Buffer?function(){return(n.create=function(){return new i})()}:function(){return new n}};function o(b,_,x){_[x]=255&b}function u(b,_){this.len=b,this.next=void 0,this.val=_}function g(b,_,x){for(;b.hi;)_[x++]=127&b.lo|128,b.lo=(b.lo>>>7|b.hi<<25)>>>0,b.hi>>>=7;for(;b.lo>127;)_[x++]=127&b.lo|128,b.lo=b.lo>>>7;_[x++]=b.lo}function m(b,_,x){_[x]=255&b,_[x+1]=b>>>8&255,_[x+2]=b>>>16&255,_[x+3]=b>>>24}n.create=e(),n.alloc=function(b){return new s.Array(b)},s.Array!==Array&&(n.alloc=s.pool(n.alloc,s.Array.prototype.subarray)),n.prototype._push=function(b,_,x){return this.tail=this.tail.next=new p(b,_,x),this.len+=_,this},u.prototype=Object.create(p.prototype),u.prototype.fn=function(b,_,x){for(;b>127;)_[x++]=127&b|128,b>>>=7;_[x]=b},n.prototype.uint32=function(b){return this.len+=(this.tail=this.tail.next=new u((b>>>=0)<128?1:b<16384?2:b<2097152?3:b<268435456?4:5,b)).len,this},n.prototype.int32=function(b){return b<0?this._push(g,10,c.fromNumber(b)):this.uint32(b)},n.prototype.sint32=function(b){return this.uint32((b<<1^b>>31)>>>0)},n.prototype.uint64=function(b){var _=c.from(b);return this._push(g,_.length(),_)},n.prototype.int64=n.prototype.uint64,n.prototype.sint64=function(b){var _=c.from(b).zzEncode();return this._push(g,_.length(),_)},n.prototype.bool=function(b){return this._push(o,1,b?1:0)},n.prototype.fixed32=function(b){return this._push(m,4,b>>>0)},n.prototype.sfixed32=n.prototype.fixed32,n.prototype.fixed64=function(b){var _=c.from(b);return this._push(m,4,_.lo)._push(m,4,_.hi)},n.prototype.sfixed64=n.prototype.fixed64,n.prototype.float=function(b){return this._push(s.float.writeFloatLE,4,b)},n.prototype.double=function(b){return this._push(s.float.writeDoubleLE,8,b)};var y=s.Array.prototype.set?function(b,_,x){_.set(b,x)}:function(b,_,x){for(var w=0;w<b.length;++w)_[x+w]=b[w]};n.prototype.bytes=function(b){var _=b.length>>>0;if(!_)return this._push(o,1,0);if(s.isString(b)){var x=n.alloc(_=a.length(b));a.decode(b,x,0),b=x}return this.uint32(_)._push(y,_,b)},n.prototype.string=function(b){var _=h.length(b);return _?this.uint32(_)._push(h.write,_,b):this._push(o,1,0)},n.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new p(d,0,0),this.len=0,this},n.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new p(d,0,0),this.len=0),this},n.prototype.ldelim=function(){var b=this.head,_=this.tail,x=this.len;return this.reset().uint32(x),x&&(this.tail.next=b.next,this.tail=_,this.len+=x),this},n.prototype.finish=function(){for(var b=this.head.next,_=this.constructor.alloc(this.len),x=0;b;)b.fn(b.val,_,x),x+=b.len,b=b.next;return _},n._configure=function(b){i=b,n.create=e(),i._configure()}},3155:(f,t,r)=>{f.exports=c;var i=r(1173);(c.prototype=Object.create(i.prototype)).constructor=c;var s=r(9693);function c(){i.call(this)}function a(h,p,d){h.length<40?s.utf8.write(h,p,d):p.utf8Write?p.utf8Write(h,d):p.write(h,d)}c._configure=function(){c.alloc=s._Buffer_allocUnsafe,c.writeBytesBuffer=s.Buffer&&s.Buffer.prototype instanceof Uint8Array&&s.Buffer.prototype.set.name==="set"?function(h,p,d){p.set(h,d)}:function(h,p,d){if(h.copy)h.copy(p,d,0,h.length);else for(var l=0;l<h.length;)p[d++]=h[l++]}},c.prototype.bytes=function(h){s.isString(h)&&(h=s._Buffer_from(h,"base64"));var p=h.length>>>0;return this.uint32(p),p&&this._push(c.writeBytesBuffer,p,h),this},c.prototype.string=function(h){var p=s.Buffer.byteLength(h);return this.uint32(p),p&&this._push(a,p,h),this},c._configure()},7714:(f,t,r)=>{t.R=void 0;const i=r(6919),s=r(7448);t.R=new class{async init(){}async createSessionHandler(c,a){const h=new i.Session(a);return await h.loadModel(c),new s.OnnxjsSessionHandler(h)}}},4200:(f,t,r)=>{t.c8=t.rX=void 0;const i=r(1670),s=r(5381),c=r(2157),a=r(2306);t.rX=()=>{if((typeof i.env.wasm.initTimeout!="number"||i.env.wasm.initTimeout<0)&&(i.env.wasm.initTimeout=0),typeof i.env.wasm.simd!="boolean"&&(i.env.wasm.simd=!0),typeof i.env.wasm.proxy!="boolean"&&(i.env.wasm.proxy=!1),typeof i.env.wasm.numThreads!="number"||!Number.isInteger(i.env.wasm.numThreads)||i.env.wasm.numThreads<=0){const h=typeof navigator>"u"?(0,s.cpus)().length:navigator.hardwareConcurrency;i.env.wasm.numThreads=Math.min(4,Math.ceil((h||1)/2))}},t.c8=new class{async init(){(0,t.rX)(),await(0,c.initWasm)()}async createSessionHandler(h,p){const d=new a.OnnxruntimeWebAssemblySessionHandler;return await d.loadModel(h,p),Promise.resolve(d)}}},6018:function(f,t,r){var i=this&&this.__createBinding||(Object.create?function(a,h,p,d){d===void 0&&(d=p);var l=Object.getOwnPropertyDescriptor(h,p);l&&!("get"in l?!h.__esModule:l.writable||l.configurable)||(l={enumerable:!0,get:function(){return h[p]}}),Object.defineProperty(a,d,l)}:function(a,h,p,d){d===void 0&&(d=p),a[d]=h[p]}),s=this&&this.__exportStar||function(a,h){for(var p in a)p==="default"||Object.prototype.hasOwnProperty.call(h,p)||i(h,a,p)};Object.defineProperty(t,"__esModule",{value:!0}),s(r(1670),t);const c=r(1670);{const a=r(7714).R;(0,c.registerBackend)("webgl",a,-10)}{const a=r(4200).c8;(0,c.registerBackend)("cpu",a,10),(0,c.registerBackend)("wasm",a,10),(0,c.registerBackend)("xnnpack",a,9)}},246:(f,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createAttributeWithCacheKey=void 0;class r{constructor(s){Object.assign(this,s)}get cacheKey(){return this._cacheKey||(this._cacheKey=Object.getOwnPropertyNames(this).sort().map(s=>`${this[s]}`).join(";")),this._cacheKey}}t.createAttributeWithCacheKey=i=>new r(i)},7778:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Attribute=void 0;const i=r(1446),s=r(9395),c=r(9162),a=r(2517);var h=s.onnxruntime.experimental.fbs;class p{constructor(l){if(this._attributes=new Map,l!=null){for(const n of l)n instanceof i.onnx.AttributeProto?this._attributes.set(n.name,[p.getValue(n),p.getType(n)]):n instanceof h.Attribute&&this._attributes.set(n.name(),[p.getValue(n),p.getType(n)]);if(this._attributes.size<l.length)throw new Error("duplicated attribute names")}}set(l,n,e){this._attributes.set(l,[e,n])}delete(l){this._attributes.delete(l)}getFloat(l,n){return this.get(l,"float",n)}getInt(l,n){return this.get(l,"int",n)}getString(l,n){return this.get(l,"string",n)}getTensor(l,n){return this.get(l,"tensor",n)}getFloats(l,n){return this.get(l,"floats",n)}getInts(l,n){return this.get(l,"ints",n)}getStrings(l,n){return this.get(l,"strings",n)}getTensors(l,n){return this.get(l,"tensors",n)}get(l,n,e){const o=this._attributes.get(l);if(o===void 0){if(e!==void 0)return e;throw new Error(`required attribute not found: ${l}`)}if(o[1]!==n)throw new Error(`type mismatch: expected ${n} but got ${o[1]}`);return o[0]}static getType(l){const n=l instanceof i.onnx.AttributeProto?l.type:l.type();switch(n){case i.onnx.AttributeProto.AttributeType.FLOAT:return"float";case i.onnx.AttributeProto.AttributeType.INT:return"int";case i.onnx.AttributeProto.AttributeType.STRING:return"string";case i.onnx.AttributeProto.AttributeType.TENSOR:return"tensor";case i.onnx.AttributeProto.AttributeType.FLOATS:return"floats";case i.onnx.AttributeProto.AttributeType.INTS:return"ints";case i.onnx.AttributeProto.AttributeType.STRINGS:return"strings";case i.onnx.AttributeProto.AttributeType.TENSORS:return"tensors";default:throw new Error(`attribute type is not supported yet: ${i.onnx.AttributeProto.AttributeType[n]}`)}}static getValue(l){const n=l instanceof i.onnx.AttributeProto?l.type:l.type();if(n===i.onnx.AttributeProto.AttributeType.GRAPH||n===i.onnx.AttributeProto.AttributeType.GRAPHS)throw new Error("graph attribute is not supported yet");const e=this.getValueNoCheck(l);if(n===i.onnx.AttributeProto.AttributeType.INT&&a.LongUtil.isLong(e))return a.LongUtil.longToNumber(e);if(n===i.onnx.AttributeProto.AttributeType.INTS){const o=e,u=new Array(o.length);for(let g=0;g<o.length;g++){const m=o[g];u[g]=a.LongUtil.longToNumber(m)}return u}if(n===i.onnx.AttributeProto.AttributeType.TENSOR)return l instanceof i.onnx.AttributeProto?c.Tensor.fromProto(e):c.Tensor.fromOrtTensor(e);if(n===i.onnx.AttributeProto.AttributeType.TENSORS){if(l instanceof i.onnx.AttributeProto)return e.map(o=>c.Tensor.fromProto(o));if(l instanceof h.Attribute)return e.map(o=>c.Tensor.fromOrtTensor(o))}if(n===i.onnx.AttributeProto.AttributeType.STRING&&l instanceof i.onnx.AttributeProto){const o=e;return(0,a.decodeUtf8String)(o)}return n===i.onnx.AttributeProto.AttributeType.STRINGS&&l instanceof i.onnx.AttributeProto?e.map(a.decodeUtf8String):e}static getValueNoCheck(l){return l instanceof i.onnx.AttributeProto?this.getValueNoCheckFromOnnxFormat(l):this.getValueNoCheckFromOrtFormat(l)}static getValueNoCheckFromOnnxFormat(l){switch(l.type){case i.onnx.AttributeProto.AttributeType.FLOAT:return l.f;case i.onnx.AttributeProto.AttributeType.INT:return l.i;case i.onnx.AttributeProto.AttributeType.STRING:return l.s;case i.onnx.AttributeProto.AttributeType.TENSOR:return l.t;case i.onnx.AttributeProto.AttributeType.GRAPH:return l.g;case i.onnx.AttributeProto.AttributeType.FLOATS:return l.floats;case i.onnx.AttributeProto.AttributeType.INTS:return l.ints;case i.onnx.AttributeProto.AttributeType.STRINGS:return l.strings;case i.onnx.AttributeProto.AttributeType.TENSORS:return l.tensors;case i.onnx.AttributeProto.AttributeType.GRAPHS:return l.graphs;default:throw new Error(`unsupported attribute type: ${i.onnx.AttributeProto.AttributeType[l.type]}`)}}static getValueNoCheckFromOrtFormat(l){switch(l.type()){case h.AttributeType.FLOAT:return l.f();case h.AttributeType.INT:return l.i();case h.AttributeType.STRING:return l.s();case h.AttributeType.TENSOR:return l.t();case h.AttributeType.GRAPH:return l.g();case h.AttributeType.FLOATS:return l.floatsArray();case h.AttributeType.INTS:{const n=[];for(let e=0;e<l.intsLength();e++)n.push(l.ints(e));return n}case h.AttributeType.STRINGS:{const n=[];for(let e=0;e<l.stringsLength();e++)n.push(l.strings(e));return n}case h.AttributeType.TENSORS:{const n=[];for(let e=0;e<l.tensorsLength();e++)n.push(l.tensors(e));return n}default:throw new Error(`unsupported attribute type: ${h.AttributeType[l.type()]}`)}}}t.Attribute=p},7091:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resolveBackend=t.backend=void 0;const i=r(5038),s=new Map;async function c(a){const h=t.backend;if(h[a]!==void 0&&function(p){const d=p;return"initialize"in d&&typeof d.initialize=="function"&&"createSessionHandler"in d&&typeof d.createSessionHandler=="function"&&"dispose"in d&&typeof d.dispose=="function"}(h[a])){const p=h[a];let d=p.initialize();if(typeof d=="object"&&"then"in d&&(d=await d),d)return s.set(a,p),p}}t.backend={webgl:new i.WebGLBackend},t.resolveBackend=async function a(h){if(!h)return a(["webgl"]);{const p=typeof h=="string"?[h]:h;for(const d of p){const l=s.get(d);if(l)return l;const n=await c(d);if(n)return n}}throw new Error("no available backend to use")}},5038:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLBackend=void 0;const i=r(1670),s=r(6231),c=r(6416),a=r(7305);t.WebGLBackend=class{get contextId(){return i.env.webgl.contextId}set contextId(h){i.env.webgl.contextId=h}get matmulMaxBatchSize(){return i.env.webgl.matmulMaxBatchSize}set matmulMaxBatchSize(h){i.env.webgl.matmulMaxBatchSize=h}get textureCacheMode(){return i.env.webgl.textureCacheMode}set textureCacheMode(h){i.env.webgl.textureCacheMode=h}get pack(){return i.env.webgl.pack}set pack(h){i.env.webgl.pack=h}get async(){return i.env.webgl.async}set async(h){i.env.webgl.async=h}initialize(){try{return this.glContext=(0,a.createWebGLContext)(this.contextId),typeof this.matmulMaxBatchSize!="number"&&(this.matmulMaxBatchSize=16),typeof this.textureCacheMode!="string"&&(this.textureCacheMode="full"),typeof this.pack!="boolean"&&(this.pack=!1),typeof this.async!="boolean"&&(this.async=!1),s.Logger.setWithEnv(i.env),s.Logger.verbose("WebGLBackend",`Created WebGLContext: ${typeof this.glContext} with matmulMaxBatchSize: ${this.matmulMaxBatchSize}; textureCacheMode: ${this.textureCacheMode}; pack: ${this.pack}; async: ${this.async}.`),!0}catch(h){return s.Logger.warning("WebGLBackend",`Unable to initialize WebGLBackend. ${h}`),!1}}createSessionHandler(h){return new c.WebGLSessionHandler(this,h)}dispose(){this.glContext.dispose()}}},5107:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoordsGlslLib=void 0;const i=r(2517),s=r(8520),c=r(5060),a=r(7859),h=r(9390);class p extends s.GlslLib{constructor(l){super(l)}getFunctions(){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.offsetToCoords()),this.coordsToOffset()),this.toVec()),this.valueFrom()),this.getCommonUtilFuncs()),this.getInputsSamplingSnippets()),this.getOutputSamplingSnippet())}getCustomTypes(){return{}}offsetToCoords(){return{offsetToCoords:new s.GlslLibRoutine(`
      vec2 offsetToCoords(int offset, int width, int height) {
        int t = offset / width;
        int s = offset - t*width;
        vec2 coords = (vec2(s,t) + vec2(0.5,0.5)) / vec2(width, height);
        return coords;
      }
      `)}}coordsToOffset(){return{coordsToOffset:new s.GlslLibRoutine(`
      int coordsToOffset(vec2 coords, int width, int height) {
        float s = coords.s * float(width);
        float t = coords.t * float(height);
        int offset = int(t) * width + int(s);
        return offset;
      }
      `)}}getOutputSamplingSnippet(){const l=this.context.outputTextureLayout;return l.isPacked?this.getPackedOutputSamplingSnippet(l):this.getUnpackedOutputSamplingSnippet(l)}getPackedOutputSamplingSnippet(l){const n=l.unpackedShape,e=[l.width,l.height],o={},u="getOutputCoords";switch(n.length){case 0:o[u]=this.getOutputScalarCoords();break;case 1:o[u]=this.getOutputPacked1DCoords(n,e);break;case 2:o[u]=this.getOutputPacked2DCoords(n,e);break;case 3:o[u]=this.getOutputPacked3DCoords(n,e);break;default:o[u]=this.getOutputPackedNDCoords(n,e)}const g=`
      void setOutput(vec4 val) {
        ${(0,c.getGlsl)(this.context.glContext.version).output} = val;
      }
    `;return o.floatTextureSetRGBA=new s.GlslLibRoutine(g),o}getUnpackedOutputSamplingSnippet(l){const n=l.unpackedShape,e=[l.width,l.height],o={},u="getOutputCoords";switch(n.length){case 0:o[u]=this.getOutputScalarCoords();break;case 1:o[u]=this.getOutputUnpacked1DCoords(n,e);break;case 2:o[u]=this.getOutputUnpacked2DCoords(n,e);break;case 3:o[u]=this.getOutputUnpacked3DCoords(n,e);break;case 4:o[u]=this.getOutputUnpacked4DCoords(n,e);break;case 5:o[u]=this.getOutputUnpacked5DCoords(n,e);break;case 6:o[u]=this.getOutputUnpacked6DCoords(n,e);break;default:throw new Error(`Unsupported output dimensionality: ${n.length}`)}const g=`
        void setOutput(float val) {
          ${(0,c.getGlsl)(this.context.glContext.version).output} = vec4(val, 0, 0, 0);
        }
    `;return o.floatTextureSetR=new s.GlslLibRoutine(g),o}getOutputScalarCoords(){return new s.GlslLibRoutine(`
      int getOutputCoords() {
        return 0;
      }
    `)}getOutputPacked1DCoords(l,n){const e=n;let o="";return e[0]===1?(o=`
          int getOutputCoords() {
            return 2 * int(TexCoords.y * ${e[1]}.0);
          }
        `,new s.GlslLibRoutine(o)):e[1]===1?(o=`
          int getOutputCoords() {
            return 2 * int(TexCoords.x * ${e[0]}.0);
          }
        `,new s.GlslLibRoutine(o)):(o=`
        int getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                 vec2(${e[0]}, ${e[1]}));
          return 2 * (resTexRC.y * ${e[0]} + resTexRC.x);
        }
      `,new s.GlslLibRoutine(o))}getOutputPacked2DCoords(l,n){let e="";if(i.ArrayUtil.arraysEqual(l,n))return e=`
        ivec2 getOutputCoords() {
          return 2 * ivec2(TexCoords.xy * vec2(${n[0]}, ${n[1]}));
        }
      `,new s.GlslLibRoutine(e);const o=n,u=Math.ceil(l[1]/2);return e=`
        ivec2 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${o[0]}, ${o[1]}));

          int index = resTexRC.y * ${o[0]} + resTexRC.x;

          // reverse r and c order for packed texture
          int r = imod(index, ${u}) * 2;
          int c = 2 * (index / ${u});

          return ivec2(r, c);
        }
      `,new s.GlslLibRoutine(e)}getOutputPacked3DCoords(l,n){const e=[n[0],n[1]],o=Math.ceil(l[2]/2),u=o*Math.ceil(l[1]/2),g=`
        ivec3 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${e[0]}, ${e[1]}));
          int index = resTexRC.y * ${e[0]} + resTexRC.x;

          int b = index / ${u};
          index -= b * ${u};

          // reverse r and c order for packed texture
          int r = imod(index, ${o}) * 2;
          int c = 2 * (index / ${o});

          return ivec3(b, r, c);
        }
      `;return new s.GlslLibRoutine(g)}getOutputPackedNDCoords(l,n){const e=[n[0],n[1]],o=Math.ceil(l[l.length-1]/2),u=o*Math.ceil(l[l.length-2]/2);let g=u,m="",y="b, r, c";for(let _=2;_<l.length-1;_++)g*=l[l.length-_-1],m=`
      int b${_} = index / ${g};
      index -= b${_} * ${g};
    `+m,y=`b${_}, `+y;const b=`
      ivec${l.length} getOutputCoords() {
        ivec2 resTexRC = ivec2(TexCoords.xy *
                              vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.y * ${e[0]} + resTexRC.x;

        ${m}

        int b = index / ${u};
        index -= b * ${u};

        // reverse r and c order for packed texture
        int r = imod(index, ${o}) * 2;
        int c = 2 * (index / ${o});

        return ivec${l.length}(${y});
      }
    `;return new s.GlslLibRoutine(b)}getOutputUnpacked1DCoords(l,n){const e=`
        int getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${n[0]}, ${n[1]}));
          return resTexRC.y * ${n[0]} + resTexRC.x;
        }
      `;return new s.GlslLibRoutine(e)}getOutputUnpacked2DCoords(l,n){const e=`
        ivec2 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${n[0]}, ${n[1]}));
          int index = resTexRC.y * ${n[0]} + resTexRC.x;
          int r = index / ${l[1]};
          int c = index - r * ${l[1]};
          return ivec2(r, c);
        }
      `;return new s.GlslLibRoutine(e)}getOutputUnpacked3DCoords(l,n){let e="";const o=l.length;let u=null;o<2&&(u=[]),u=new Array(o-1),u[o-2]=l[o-1];for(let y=o-3;y>=0;--y)u[y]=u[y+1]*l[y+1];const g=["r","c","d"],m=u.map((y,b)=>`int ${g[b]} = index / ${y}; ${b===u.length-1?`int ${g[b+1]} = index - ${g[b]} * ${y}`:`index -= ${g[b]} * ${y}`};`).join("");return e=`
        ivec3 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${n[0]}, ${n[1]}));
          int index = resTexRC.y * ${n[0]} + resTexRC.x;
          ${m}
          return ivec3(r, c, d);
        }
      `,new s.GlslLibRoutine(e)}getOutputUnpacked4DCoords(l,n){let e="";const o=l.length;let u=null;o<2&&(u=[]),u=new Array(o-1),u[o-2]=l[o-1];for(let y=o-3;y>=0;--y)u[y]=u[y+1]*l[y+1];const g=["r","c","d","d2"],m=u.map((y,b)=>`int ${g[b]} = index / ${y}; ${b===u.length-1?`int ${g[b+1]} = index - ${g[b]} * ${y}`:`index -= ${g[b]} * ${y}`};`).join("");return e=`
      ivec4 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${n[0]}, ${n[1]}));
          int index = resTexRC.y * ${n[0]} + resTexRC.x;
          ${m}
          return ivec4(r, c, d, d2);
        }
      `,new s.GlslLibRoutine(e)}getOutputUnpacked5DCoords(l,n){let e="";const o=l.length;let u=null;o<2&&(u=[]),u=new Array(o-1),u[o-2]=l[o-1];for(let y=o-3;y>=0;--y)u[y]=u[y+1]*l[y+1];const g=["r","c","d","d2","d3"],m=u.map((y,b)=>`int ${g[b]} = index / ${y}; ${b===u.length-1?`int ${g[b+1]} = index - ${g[b]} * ${y}`:`index -= ${g[b]} * ${y}`};`).join("");return e=`
      ivec5 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${n[0]}, ${n[1]}));
          int index = resTexRC.y * ${n[0]} + resTexRC.x;
          ${m}
          return ivec5(r, c, d, d2, d3);
        }
      `,new s.GlslLibRoutine(e)}getOutputUnpacked6DCoords(l,n){let e="";const o=l.length;let u=null;o<2&&(u=[]),u=new Array(o-1),u[o-2]=l[o-1];for(let y=o-3;y>=0;--y)u[y]=u[y+1]*l[y+1];const g=["r","c","d","d2","d3","d4"],m=u.map((y,b)=>`int ${g[b]} = index / ${y}; ${b===u.length-1?`int ${g[b+1]} = index - ${g[b]} * ${y}`:`index -= ${g[b]} * ${y}`};`).join("");return e=`
     ivec6 getOutputCoords() {
         ivec2 resTexRC = ivec2(TexCoords.xy *
                               vec2(${n[0]}, ${n[1]}));
         int index = resTexRC.y * ${n[0]} + resTexRC.x;
         ${m}
         return ivec6(r, c, d, d2, d3, d4);
       }
     `,new s.GlslLibRoutine(e)}getCommonUtilFuncs(){const l={};let n="uvFromFlat";l[n]=new s.GlslLibRoutine(`
    vec2 uvFromFlat(int texNumR, int texNumC, int index) {
      int texC = index / texNumR;
      int texR = index - texC * texNumR;
      // TODO: swap texR, texC order in following function so row is corresponding to u and column is corresponding to
      //       v.
      return (vec2(texR, texC) + halfCR) / vec2(texNumR, texNumC);
    }
    `),n="packedUVfrom1D",l[n]=new s.GlslLibRoutine(`
      vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
        int texelIndex = index / 2;
        int texR = texelIndex / texNumC;
        int texC = texelIndex - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),n="packedUVfrom2D",l[n]=new s.GlslLibRoutine(`
      vec2 packedUVfrom2D(int texNumR, int texNumC, int texelsInLogicalRow, int row, int col) {
        int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
        int texR = texelIndex / texNumC;
        int texC = texelIndex - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),n="packedUVfrom3D",l[n]=new s.GlslLibRoutine(`
      vec2 packedUVfrom3D(int texNumR, int texNumC,
          int texelsInBatch, int texelsInLogicalRow, int b,
          int row, int col) {
        int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
        int texR = index / texNumC;
        int texC = index - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),n="sampleTexture";const e=(0,c.getGlsl)(this.context.glContext.version);return l[n]=new s.GlslLibRoutine(`
        float sampleTexture(sampler2D textureSampler, vec2 uv) {
            return ${e.texture2D}(textureSampler, uv).r;
        }`),l}getInputsSamplingSnippets(){const l={},n=this.context.outputTextureLayout;return this.context.programInfo.inputNames.forEach((e,o)=>{const u=this.context.inputTextureLayouts[o],g=(0,h.generateShaderFuncNameFromInputSamplerName)(e);u.isPacked?l[g]=this.getPackedSamplerFromInput(g,e,u):l[g]=this.getUnpackedSamplerFromInput(g,e,u);const m=(0,h.generateShaderFuncNameFromInputSamplerNameAtOutCoords)(e);u.unpackedShape.length<=n.unpackedShape.length&&(u.isPacked?l[m]=this.getPackedSamplerAtOutputCoords(m,u,n,e):l[m]=this.getUnpackedSamplerAtOutputCoords(m,u,n,e))}),l}getPackedSamplerAtOutputCoords(l,n,e,o){const u=n.unpackedShape,g=e.unpackedShape,m=o,y=(0,h.generateShaderFuncNameFromInputSamplerName)(m),b=u.length,_=g.length,x=i.BroadcastUtil.getBroadcastDims(u,g),w=(0,h.getCoordsDataType)(_),T=_-b;let S;const I=(0,h.getGlChannels)();S=b===0?"":_<2&&x.length>=1?"coords = 0;":x.map(D=>`coords.${I[D+T]} = 0;`).join(`
`);let v="";v=_<2&&b>0?"coords":u.map((D,R)=>`coords.${I[R+T]}`).join(", ");let A="return outputValue;";const L=i.ShapeUtil.size(u)===1,N=i.ShapeUtil.size(g)===1;if(b!==1||L||N){if(L&&!N)A=_===1?`
          return vec4(outputValue.x, outputValue.x, 0., 0.);
        `:`
          return vec4(outputValue.x);
        `;else if(x.length){const D=b-2,R=b-1;x.indexOf(D)>-1&&x.indexOf(R)>-1?A="return vec4(outputValue.x);":x.indexOf(D)>-1?A="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":x.indexOf(R)>-1&&(A="return vec4(outputValue.xx, outputValue.zz);")}}else A=`
        return vec4(outputValue.xy, outputValue.xy);
      `;const $=`
      vec4 ${l}() {
        ${w} coords = getOutputCoords();
        
        int lastDim = coords.${I[_-1]};
        coords.${I[_-1]} = coords.${I[_-2]};
        coords.${I[_-2]} = lastDim;
      
        ${S}
        vec4 outputValue = ${y}(${v});
        ${A}
      }
    `;return new s.GlslLibRoutine($,["coordinates.getOutputCoords"])}getUnpackedSamplerAtOutputCoords(l,n,e,o){const u=[e.width,e.height],g=[n.width,n.height],m=n.unpackedShape.length,y=e.unpackedShape.length,b=n.unpackedShape,_=e.unpackedShape,x=(0,h.generateShaderFuncNameFromInputSamplerName)(o);if(m===y&&i.ArrayUtil.arraysEqual(g,u)){const N=`
          float ${l}() {
            return sampleTexture(${o}, TexCoords);
          }
        `;return new s.GlslLibRoutine(N,["coordinates.sampleTexture"])}const w=(0,h.getCoordsDataType)(y),T=i.BroadcastUtil.getBroadcastDims(b,_),S=y-m;let I;const v=(0,h.getGlChannels)();I=m===0?"":y<2&&T.length>=1?"coords = 0;":T.map(N=>`coords.${v[N+S]} = 0;`).join(`
`);let A="";A=y<2&&m>0?"coords":n.unpackedShape.map((N,$)=>`coords.${v[$+S]}`).join(", ");const L=`
        float ${l}() {
          ${w} coords = getOutputCoords();
          ${I}
          return ${x}(${A});
        }
      `;return new s.GlslLibRoutine(L,["coordinates.getOutputCoords"])}getPackedSamplerFromInput(l,n,e){switch(e.unpackedShape.length){case 0:return this.getPackedSamplerScalar(l,n);case 1:return this.getPackedSampler1D(l,n,e);case 2:return this.getPackedSampler2D(l,n,e);case 3:return this.getPackedSampler3D(l,n,e);default:return this.getPackedSamplerND(l,n,e)}}getUnpackedSamplerFromInput(l,n,e){const o=e.unpackedShape;switch(o.length){case 0:return this.getUnpackedSamplerScalar(l,n,e);case 1:return this.getUnpackedSampler1D(l,n,e);case 2:return this.getUnpackedSampler2D(l,n,e);case 3:return this.getUnpackedSampler3D(l,n,e);case 4:return this.getUnpackedSampler4D(l,n,e);case 5:return this.getUnpackedSampler5D(l,n,e);case 6:return this.getUnpackedSampler6D(l,n,e);default:throw new Error(`Unsupported dimension ${o.length}-D`)}}getPackedSamplerScalar(l,n){const e=`
          vec4 ${l}() {
            return ${(0,c.getGlsl)(this.context.glContext.version).texture2D}(${n}, halfCR);
          }
        `;return new s.GlslLibRoutine(e)}getPackedSampler1D(l,n,e){const o=[e.width,e.height],u=[o[1],o[0]],g=(0,c.getGlsl)(this.context.glContext.version),m=`vec4 ${l}(int index) {
      vec2 uv = packedUVfrom1D(
      ${u[0]}, ${u[1]}, index);
      return ${g.texture2D}(${n}, uv);
    }`;return new s.GlslLibRoutine(m,["coordinates.packedUVfrom1D"])}getPackedSampler2D(l,n,e){const o=e.unpackedShape,u=[e.width,e.height],g=(0,c.getGlsl)(this.context.glContext.version),m=u[0],y=u[1];if(u!=null&&i.ArrayUtil.arraysEqual(o,u)){const w=`vec4 ${l}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${y}.0, ${m}.0);
        return ${g.texture2D}(${n}, uv);
      }`;return new s.GlslLibRoutine(w)}const b=u,_=Math.ceil(o[1]/2),x=`vec4 ${l}(int row, int col) {
      vec2 uv = packedUVfrom2D(${b[1]}, ${b[0]}, ${_}, row, col);
      return ${g.texture2D}(${n}, uv);
    }`;return new s.GlslLibRoutine(x,["coordinates.packedUVfrom2D"])}getPackedSampler3D(l,n,e){const o=e.unpackedShape,u=[e.width,e.height],g=[u[0],u[1]],m=(0,c.getGlsl)(this.context.glContext.version);if(o[0]===1){const w=o.slice(1),T=[1,2],S=(0,h.squeezeInputShape)(o,w),I=["b","row","col"],v=JSON.parse(JSON.stringify(e));v.unpackedShape=S;const A=this.getPackedSamplerFromInput(l,n,v),L=`${A.routineBody}
      vec4 ${l}(int b, int row, int col) {
        return ${l}(${(0,h.getSqueezedParams)(I,T)});
      } `;return new s.GlslLibRoutine(L,A.dependencies)}const y=g[0],b=g[1],_=Math.ceil(o[2]/2),x=`vec4 ${l}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${b}, ${y}, ${_*Math.ceil(o[1]/2)}, ${_}, b, row, col);
      return ${m.texture2D}(${n}, uv);}`;return new s.GlslLibRoutine(x,["coordinates.packedUVfrom3D"])}getPackedSamplerND(l,n,e){const o=e.unpackedShape,u=o.length,g=[e.width,e.height],m=(0,c.getGlsl)(this.context.glContext.version),y=[g[0],g[1]],b=y[1],_=y[0],x=Math.ceil(o[u-1]/2);let w=x*Math.ceil(o[u-2]/2),T="int b, int row, int col",S=`b * ${w} + (row / 2) * ${x} + (col / 2)`;for(let v=2;v<u-1;v++)T=`int b${v}, `+T,w*=o[u-v-1],S=`b${v} * ${w} + `+S;const I=`vec4 ${l}(${T}) {
      int index = ${S};
      int texR = index / ${_};
      int texC = index - texR * ${_};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${_}, ${b});
      return ${m.texture2D}(${n}, uv);
    }`;return new s.GlslLibRoutine(I)}getUnpackedSamplerScalar(l,n,e){const[o,u]=[e.width,e.height];if(o===1&&u===1){const m=`
          float ${l}() {
            return sampleTexture(${n}, halfCR);
          }
        `;return new s.GlslLibRoutine(m,["coordinates.sampleTexture"])}const g=`
        float ${l}() {
          int offset_${n} = coordsToOffset(TexCoords, ${o}, ${u});
          vec2 uv = uvFromFlat(${o}, ${u}, offset_${n});
          return sampleTexture(${n}, uv);
        }
      `;return new s.GlslLibRoutine(g,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler1D(l,n,e){const o=e.width,u=e.height;if(u===1&&o===1){const m=`
        float ${l}(int index) {
          return sampleTexture(${n}, halfCR);
        }
      `;return new s.GlslLibRoutine(m,["coordinates.sampleTexture"])}if(u===1){const m=`
          float ${l}(int index) {
            vec2 uv = vec2((float(index) + 0.5) / ${o}.0, 0.5);
            return sampleTexture(${n}, uv);
          }
        `;return new s.GlslLibRoutine(m,["coordinates.sampleTexture"])}if(o===1){const m=`
          float ${l}(int index) {
            vec2 uv = vec2(0.5, (float(index) + 0.5) / ${u}.0);
            return sampleTexture(${n}, uv);
          }
        `;return new s.GlslLibRoutine(m,["coordinates.sampleTexture"])}const g=`
        float ${l}(int index) {
          vec2 uv = uvFromFlat(${o}, ${u}, index);
          return sampleTexture(${n}, uv);
        }
      `;return new s.GlslLibRoutine(g,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler2D(l,n,e){const o=e.unpackedShape,u=[e.height,e.width];if(u!=null&&i.ArrayUtil.arraysEqual(o,u)){const w=`
          float ${l}(int row, int col) {
            vec2 uv = (vec2(row, col) + halfCR) / vec2(${u[1]}.0, ${u[0]}.0);
            return sampleTexture(${n}, uv);
          }
        `;return new s.GlslLibRoutine(w,["coordinates.sampleTexture"])}const{newShape:g,keptDims:m}=(0,a.squeezeShape)(o),y=g;if(y.length<o.length){const w=(0,h.squeezeInputShape)(o,y),T=JSON.parse(JSON.stringify(e));T.unpackedShape=w;const S=["col","row"],I=`
          ${this.getUnpackedSamplerFromInput(l,n,T).routineBody}
          float ${l}(int row, int col) {
            return ${l}(${(0,h.getSqueezedParams)(S,m)});
          }
        `;return new s.GlslLibRoutine(I,["coordinates.sampleTexture"])}const b=u[1],_=u[0];if(_===1){const w=`
          float ${l}(int row, int col) {
            int offset_${n} = coordsToOffset(TexCoords, ${b}, ${_});
            float index = dot(vec3(row, col, offset_${n}), vec3(${o[1]}, 1, 1));
            vec2 uv = vec2(0.5, (index + 0.5) / ${b}.0);
            return sampleTexture(${n}, uv);
          }
        `;return new s.GlslLibRoutine(w,["coordinates.sampleTexture","coordinates.coordsToOffset"])}if(b===1){const w=`
          float ${l}(int row, int col) {
            int offset_${n} = coordsToOffset(TexCoords, ${b}, ${_});
            float index = dot(vec3(row, col, offset_${n}), vec3(${o[1]}, 1, 1));
            vec2 uv = vec2((index + 0.5) / ${_}.0, 0.5);
            return sampleTexture(${n}, uv);
          }
        `;return new s.GlslLibRoutine(w,["coordinates.sampleTexture","coordinates.coordsToOffset"])}const x=`
        float ${l}(int row, int col) {
          int index = col * ${o[1]} + row;
          vec2 uv = uvFromFlat(${b}, ${_}, index);
          return sampleTexture(${n}, uv);
        }
      `;return new s.GlslLibRoutine(x,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler3D(l,n,e){const o=e.unpackedShape,u=o[1]*o[2],g=o[2],{newShape:m,keptDims:y}=(0,a.squeezeShape)(o),b=m;if(b.length<o.length){const x=(0,h.squeezeInputShape)(o,b),w=["batch","col","row"],T=JSON.parse(JSON.stringify(e));T.unpackedShape=x;const S=this.getUnpackedSamplerFromInput(l,n,T),I=y.reverse(),v=`
          ${S.routineBody}
          float ${l}(int batch, int row, int col) {
            return ${l}(${(0,h.getSqueezedParams)(w,I)});
          }
        `;return new s.GlslLibRoutine(v,S.dependencies)}const _=`
          float ${l}(int depth, int row, int col) {
            // Explicitly use integer operations as dot() only works on floats.
            int index = depth * ${u} + col * ${g} + row;
            vec2 uv = uvFromFlat(${e.width}, ${e.height}, index);
            return sampleTexture(${n}, uv);
          }
      `;return new s.GlslLibRoutine(_,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler4D(l,n,e){const o=e.unpackedShape,u=o[3],g=o[2]*u,m=`
        float ${l}(int row, int col, int depth, int depth2) {
          int index = row * ${o[1]*g} + col * ${g} +
              depth2 * ${u} + depth;
          vec2 uv = uvFromFlat(${e.width}, ${e.height}, index);
          return sampleTexture(${n}, uv);
        }
      `;return new s.GlslLibRoutine(m,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler5D(l,n,e){const o=e.unpackedShape,u=o[4],g=o[3]*u,m=o[2]*g,y=o[1]*m,{newShape:b,keptDims:_}=(0,a.squeezeShape)(o);if(b.length<o.length){const w=(0,h.squeezeInputShape)(o,b),T=["row","col","depth","depth2","depth3"],S=JSON.parse(JSON.stringify(e));S.unpackedShape=w;const I=`
          ${this.getUnpackedSamplerFromInput(l,n,S).routineBody}
          float ${l}(int row, int col, int depth, int depth2, int depth3) {
            return ${l}(${(0,h.getSqueezedParams)(T,_)});
          }
        `;return new s.GlslLibRoutine(I,["coordinates.sampleTexture","coordinates.uvFromFlat"])}const x=`
        float ${l}(int row, int col, int depth, int depth2, int depth3) {
          int index = row * ${y} + col * ${m} + depth * ${g} +
          depth3 * ${u} + depth2;
          vec2 uv = uvFromFlat(${e.width}, ${e.height}, index);
          return sampleTexture(${n}, uv);
        }
      `;return new s.GlslLibRoutine(x,["coordinates.sampleTexture","coordinates.uvFromFlat"])}getUnpackedSampler6D(l,n,e){const o=e.unpackedShape,u=o[5],g=o[4]*u,m=o[3]*g,y=o[2]*m,b=o[1]*y,{newShape:_,keptDims:x}=(0,a.squeezeShape)(o);if(_.length<o.length){const T=(0,h.squeezeInputShape)(o,_),S=["row","col","depth","depth2","depth3","depth4"],I=JSON.parse(JSON.stringify(e));I.unpackedShape=T;const v=`
            ${this.getUnpackedSamplerFromInput(l,n,I).routineBody}
            float ${l}(int row, int col, int depth,
              int depth2, int depth3, int depth4) {
              return ${l}(${(0,h.getSqueezedParams)(S,x)});
            }
          `;return new s.GlslLibRoutine(v,["coordinates.sampleTexture","coordinates.uvFromFlat"])}const w=`
          float ${l}(int row, int col, int depth,
            int depth2, int depth3, int depth4) {
            int index = row * ${b} + col * ${y} + depth * ${m} +
            depth2 * ${g} + depth3 * ${u} + depth4;
            vec2 uv = uvFromFlat(${e.width}, ${e.height}, index);
            return sampleTexture(${n}, uv);
          }
        `;return new s.GlslLibRoutine(w,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}toVec(){const l=this.context.outputTextureLayout,n=l.shape.length,e=l.strides,o=l.width,u=l.height,g=[];for(let y=0;y<n-1;++y)g.push(`
        c[${y}] = offset / ${e[y]};`),g.push(`
        offset -= c[${y}] * ${e[y]};`);g.push(`
        c[${n-1}] = offset;`);const m=`
      void toVec(vec2 texCoords, out int c[${n}]) {
        int offset = coordsToOffset(texCoords, ${o}, ${u});
        ${g.join("")}
      }
      void toVec(int offset, out int c[${n}]) {
        ${g.join("")}
      }
    `;return{toVec:new s.GlslLibRoutine(m,["coordinates.coordsToOffset"])}}valueFrom(){const l={};return this.context.programInfo.inputNames.forEach((n,e)=>{const o=this.context.inputTextureLayouts[e],u=(o.unpackedShape.length>0?o.unpackedShape:o.shape).length;let g=`_${n}`;l[g]=new s.GlslLibRoutine(this.getValueFromSingle(n,u,o.width,o.height,!1),[`shapeUtils.indicesToOffset${g}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"]),g+="_T",l[g]=new s.GlslLibRoutine(this.getValueFromSingle(n,u,o.width,o.height,!0),[`shapeUtils.indicesToOffset${g}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"])}),l}getValueFromSingle(l,n,e,o,u){let g=`_${l}`;return u&&(g+="_T"),`
        float ${g}(int m[${n}]) {
          int offset = indicesToOffset${g}(m);
          vec2 coords = offsetToCoords(offset, ${e}, ${o});
          float value = getColorAsFloat(${(0,c.getGlsl)(this.context.glContext.version).texture2D}(${l}, coords));
          return value;
        }
        `}getPackedValueFrom(l,n,e,o,u){let g=`_${l}_Pack`;return u&&(g+="_T"),`
        vec4 ${g}(int m[${n}]) {
          int offset = indicesToOffset_${l}(m);
          vec2 coords = offsetToCoords(offset, ${e}, ${o});
          return ${(0,c.getGlsl)(this.context.glContext.version).texture2D}(${l}, coords);
        }
        `}}t.CoordsGlslLib=p},8520:(f,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.TopologicalSortGlslRoutines=t.GlslLibRoutineNode=t.GlslLibRoutine=t.GlslLib=t.GlslContext=t.FunctionType=void 0,(r=t.FunctionType||(t.FunctionType={}))[r.ValueBased=0]="ValueBased",r[r.Positional=1]="Positional",t.GlslContext=class{constructor(i,s,c,a){this.glContext=i,this.programInfo=s,this.inputTextureLayouts=c,this.outputTextureLayout=a}},t.GlslLib=class{constructor(i){this.context=i}},t.GlslLibRoutine=class{constructor(i,s){this.routineBody=i,this.dependencies=s}},t.GlslLibRoutineNode=class{constructor(i,s,c){this.name=i,this.dependencies=c||[],s&&(this.routineBody=s)}addDependency(i){i&&this.dependencies.push(i)}},t.TopologicalSortGlslRoutines=class{static returnOrderedNodes(i){if(!i||i.length===0)return[];if(i.length===1)return i;const s=new Set,c=new Set,a=new Array;return this.createOrderedNodes(i,s,c,a),a}static createOrderedNodes(i,s,c,a){for(let h=0;h<i.length;++h)this.dfsTraverse(i[h],s,c,a)}static dfsTraverse(i,s,c,a){if(!i||c.has(i.name))return;if(s.has(i.name))throw new Error("Cyclic dependency detected. Can't topologically sort routines needed for shader.");s.add(i.name);const h=i.dependencies;if(h&&h.length>0)for(let p=0;p<h.length;++p)this.dfsTraverse(h[p],s,c,a);a.push(i),c.add(i.name),s.delete(i.name)}}},7341:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EncodingGlslLib=void 0;const i=r(8520);class s extends i.GlslLib{constructor(a){super(a)}getFunctions(){return Object.assign(Object.assign({},this.encodeFloat32()),this.decodeFloat32())}getCustomTypes(){return{}}encodeFloat32(){return{encode:new i.GlslLibRoutine(`highp vec4 encode(highp float f) {
        return vec4(f, 0.0, 0.0, 0.0);
      }
        `)}}decodeFloat32(){return{decode:new i.GlslLibRoutine(`highp float decode(highp vec4 rgba) {
        return rgba.r;
      }
        `)}}encodeUint8(){const a=s.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{encode:new i.GlslLibRoutine(`
      highp vec4 encode(highp float f) {
        highp float F = abs(f);
        highp float Sign = step(0.0,-f);
        highp float Exponent = floor(log2(F));
        highp float Mantissa = (exp2(- Exponent) * F);
        Exponent = floor(log2(F) + 127.0) + floor(log2(Mantissa));
        highp vec4 rgba;
        rgba[0] = 128.0 * Sign  + floor(Exponent*exp2(-1.0));
        rgba[1] = 128.0 * mod(Exponent,2.0) + mod(floor(Mantissa*128.0),128.0);
        rgba[2] = floor(mod(floor(Mantissa*exp2(23.0 -8.0)),exp2(8.0)));
        rgba[3] = floor(exp2(23.0)*mod(Mantissa,exp2(-15.0)));
        ${a}
        rgba = rgba / 255.0; // values need to be normalized to [0,1]
        return rgba;
    }
        `)}}decodeUint8(){const a=s.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{decode:new i.GlslLibRoutine(`
        highp float decode(highp vec4 rgba) {
          rgba = rgba * 255.0; // values need to be de-normalized from [0,1] to [0,255]
          ${a}
          highp float Sign = 1.0 - step(128.0,rgba[0])*2.0;
          highp float Exponent = 2.0 * mod(rgba[0],128.0) + step(128.0,rgba[1]) - 127.0;
          highp float Mantissa = mod(rgba[1],128.0)*65536.0 + rgba[2]*256.0 +rgba[3] + float(0x800000);
          highp float Result =  Sign * exp2(Exponent) * (Mantissa * exp2(-23.0 ));
          return Result;
      }
        `)}}static isLittleEndian(){const a=new ArrayBuffer(4),h=new Uint32Array(a),p=new Uint8Array(a);if(h[0]=3735928559,p[0]===239)return!0;if(p[0]===222)return!1;throw new Error("unknown endianness")}}t.EncodingGlslLib=s},9894:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FragColorGlslLib=void 0;const i=r(8520),s=r(5060);class c extends i.GlslLib{constructor(h){super(h)}getFunctions(){return Object.assign(Object.assign({},this.setFragColor()),this.getColorAsFloat())}getCustomTypes(){return{}}setFragColor(){const h=(0,s.getGlsl)(this.context.glContext.version);return{setFragColor:new i.GlslLibRoutine(`
        void setFragColor(float value) {
            ${h.output} = encode(value);
        }
        `,["encoding.encode"])}}getColorAsFloat(){return{getColorAsFloat:new i.GlslLibRoutine(`
        float getColorAsFloat(vec4 color) {
            return decode(color);
        }
        `,["encoding.decode"])}}}t.FragColorGlslLib=c},2848:(f,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.replaceInlines=void 0;const r=/@inline[\s\n\r]+(\w+)[\s\n\r]+([0-9a-zA-Z_]+)\s*\(([^)]*)\)\s*{(([^}]|[\n\r])*)}/gm;t.replaceInlines=function(i){const s={};let c;for(;(c=r.exec(i))!==null;){const a=c[3].split(",").map(h=>{const p=h.trim().split(" ");return p&&p.length===2?{type:p[0],name:p[1]}:null}).filter(h=>h!==null);s[c[2]]={params:a,body:c[4]}}for(const a in s){const h="(\\w+)?\\s+([_0-9a-zA-Z]+)\\s+=\\s+__FUNC__\\((.*)\\)\\s*;".replace("__FUNC__",a),p=new RegExp(h,"gm");for(;(c=p.exec(i))!==null;){const d=c[1],l=c[2],n=c[3].split(","),e=d?`${d} ${l};`:"";let o=s[a].body,u="";s[a].params.forEach((m,y)=>{m&&(u+=`${m.type} ${m.name} = ${n[y]};
`)}),o=`${u}
 ${o}`,o=o.replace("return",`${l} = `);const g=`
      ${e}
      {
        ${o}
      }
      `;i=i.replace(c[0],g)}}return i.replace(r,"")}},8879:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GlslPreprocessor=void 0;const i=r(8520),s=r(2848),c=r(5483),a=r(5060);t.GlslPreprocessor=class{constructor(h,p,d,l){this.libs={},this.glslLibRoutineDependencyGraph={},this.context=new i.GlslContext(h,p,d,l),Object.keys(c.glslRegistry).forEach(e=>{const o=new c.glslRegistry[e](this.context);this.libs[e]=o});const n=this.glslLibRoutineDependencyGraph;for(const e in this.libs){const o=this.libs[e].getFunctions();for(const u in o){const g=e+"."+u;let m;n[g]?(m=n[g],m.routineBody=o[u].routineBody):(m=new i.GlslLibRoutineNode(g,o[u].routineBody),n[g]=m);const y=o[u].dependencies;if(y)for(let b=0;b<y.length;++b)if(n[y[b]])m.addDependency(n[y[b]]);else{const _=new i.GlslLibRoutineNode(y[b]);n[y[b]]=_,m.addDependency(_)}}}}preprocess(){const h=this.context.programInfo;let p=h.shaderSource;return this.context.programInfo.hasMain||(p=`${p}
      ${(0,a.getDefaultFragShaderMain)(this.context.glContext.version,this.context.outputTextureLayout.shape.length)}`),p=(0,s.replaceInlines)(p),`${(0,a.getFragShaderPreamble)(this.context.glContext.version)}
    ${this.getUniforms(h.inputNames,h.variables)}
    ${this.getImports(p)}
    ${p}`}getImports(h){const p=this.selectGlslLibRoutinesToBeIncluded(h);if(p.length===0)return"";let d="";for(let l=0;l<p.length;++l){if(!p[l].routineBody)throw new Error(`Missing body for the Glsl Library routine: ${p[l].name}`);d+=p[l].routineBody+`
`}return d}selectGlslLibRoutinesToBeIncluded(h){const p=[];return Object.keys(this.glslLibRoutineDependencyGraph).forEach(d=>{const l=d.split(".")[1];h.indexOf(l)!==-1&&p.push(this.glslLibRoutineDependencyGraph[d])}),i.TopologicalSortGlslRoutines.returnOrderedNodes(p)}getUniforms(h,p){const d=[];if(h)for(const l of h)d.push(`uniform sampler2D ${l};`);if(p)for(const l of p)d.push(`uniform ${l.type} ${l.name}${l.arrayLength?`[${l.arrayLength}]`:""};`);return d.join(`
`)}}},5483:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.glslRegistry=void 0;const i=r(5107),s=r(7341),c=r(9894),a=r(2655),h=r(3891);t.glslRegistry={encoding:s.EncodingGlslLib,fragcolor:c.FragColorGlslLib,vec:h.VecGlslLib,shapeUtils:a.ShapeUtilsGlslLib,coordinates:i.CoordsGlslLib}},2655:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ShapeUtilsGlslLib=void 0;const i=r(8520);class s extends i.GlslLib{constructor(a){super(a)}getFunctions(){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.bcastIndex()),this.bcastMatmulIndex()),this.offsetToIndices()),this.indicesToOffset()),this.incrementIndices())}getCustomTypes(){return{}}bcastIndex(){const a=this.context.outputTextureLayout.shape.length,h={};return this.context.programInfo.inputNames.forEach((p,d)=>{const l=this.context.inputTextureLayouts[d].unpackedShape;if(l.length<=a){const n=l.length,e=a-n,o=`bcastIndices_${p}`;let u="";for(let m=0;m<n;++m)u+=`
          realIndices[${m}] = int( mod(float(bcastedIndices[${e+m}]), ${l[m]}.0) );
          `;const g=`
        void ${o} (int bcastedIndices[${a}], out int realIndices[${n}]) {
          ${u}
        }
        `;h[o]=new i.GlslLibRoutine(g)}}),h}bcastMatmulIndex(){const a=this.context.outputTextureLayout.shape.length,h={};return this.context.programInfo.inputNames.forEach((p,d)=>{const l=this.context.inputTextureLayouts[d].shape;if(!(l.length<2||l.length>a)){const n=l.length,e=a-n,o=`bcastMatmulIndices_${p}`;let u="";for(let m=0;m<n-2;++m)u+=`
          realIndices[${m}] = int( mod(float(bcastedIndices[${e+m}]), ${l[m]}.0) );
          `;const g=`
        void ${o}(int bcastedIndices[${a}], out int realIndices[${n}]) {
          ${u}
          realIndices[${n-1}] = bcastedIndices[${a-1}];
          realIndices[${n-2}] = bcastedIndices[${a-2}];
        }
        `;h[o]=new i.GlslLibRoutine(g)}}),h}indicesToOffset(){const a={};return this.context.programInfo.inputNames.forEach((h,p)=>{const d=this.context.inputTextureLayouts[p].shape,l=this.context.inputTextureLayouts[p].strides,n=d.length;let e=`indicesToOffset_${h}`;a[e]=new i.GlslLibRoutine(s.indexToOffsetSingle(e,n,l)),e=`indicesToOffset_${h}_T`,a[e]=new i.GlslLibRoutine(s.indexToOffsetSingle(e,n,l.slice().reverse()))}),a}static indexToOffsetSingle(a,h,p){let d="";for(let l=h-1;l>=0;--l)d+=`
        offset += indices[${l}] * ${p[l]};
        `;return`
      int ${a}(int indices[${h}]) {
        int offset = 0;
        ${d}
        return offset;
      }
      `}offsetToIndices(){const a={};return this.context.programInfo.inputNames.forEach((h,p)=>{const d=this.context.inputTextureLayouts[p].shape,l=this.context.inputTextureLayouts[p].strides,n=d.length;let e=`offsetToIndices_${h}`;a[e]=new i.GlslLibRoutine(s.offsetToIndicesSingle(e,n,l)),e=`offsetToIndices_${h}_T`,a[e]=new i.GlslLibRoutine(s.offsetToIndicesSingle(e,n,l.slice().reverse()))}),a}static offsetToIndicesSingle(a,h,p){const d=[];for(let l=0;l<h-1;++l)d.push(`
      indices[${l}] = offset / ${p[l]};`),d.push(`
        offset -= indices[${l}] * ${p[l]};`);return d.push(`
      indices[${h-1}] = offset;`),`
      void ${a}(int offset, out int indices[${h}]) {
        ${d.join("")}
      }
      `}incrementIndices(){const a={};return this.context.programInfo.inputNames.forEach((h,p)=>{const d=this.context.inputTextureLayouts[p].shape,l=d.length,n=`incrementIndices_${h}`;let e="";for(let u=0;u<l;++u)e+=`
        shape[${u}] = ${d[u]};`;const o=`
        void ${n}(int axis, out int indices[${l}]) {
          int shape[${l}];
          ${e};
          for(int i = ${l} -1 ; i >= 0; --i) {
            if(i > axis) continue;
            indices[i] += 1;
            if(indices[i] < shape[i]) {
              break;
            }
            indices[i] = 0;
          }
        }
        `;a[n]=new i.GlslLibRoutine(o)}),a}}t.ShapeUtilsGlslLib=s},5060:(f,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultFragShaderMain=t.getFragShaderPreamble=t.getVertexShaderSource=t.getGlsl=void 0;const r={version:"",attribute:"attribute",varyingVertex:"varying",varyingFrag:"varying",texture2D:"texture2D",output:"gl_FragColor",outputDeclaration:""},i={version:"#version 300 es",attribute:"in",varyingVertex:"out",varyingFrag:"in",texture2D:"texture",output:"outputColor",outputDeclaration:"out vec4 outputColor;"};function s(c){return c===1?r:i}t.getGlsl=s,t.getVertexShaderSource=function(c){const a=s(c);return`${a.version}
      precision highp float;
      ${a.attribute} vec3 position;
      ${a.attribute} vec2 textureCoord;

      ${a.varyingVertex} vec2 TexCoords;

      void main()
      {
          gl_Position = vec4(position, 1.0);
          TexCoords = textureCoord;
      }`},t.getFragShaderPreamble=function(c){const a=s(c);return`${a.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${a.varyingFrag} vec2 TexCoords;
    ${a.outputDeclaration}
    const vec2 halfCR = vec2(0.5, 0.5);

    // Custom vector types to handle higher dimenalities.
    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    `},t.getDefaultFragShaderMain=function(c,a){return`
  void main() {
    int indices[${a}];
    toVec(TexCoords, indices);
    vec4 result = vec4(process(indices));
    ${s(c).output} = result;
  }
  `}},3891:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VecGlslLib=void 0;const i=r(8520);class s extends i.GlslLib{constructor(a){super(a)}getCustomTypes(){return{}}getFunctions(){return Object.assign(Object.assign(Object.assign(Object.assign({},this.binaryVecFunctions()),this.copyVec()),this.setVecItem()),this.getVecItem())}binaryVecFunctions(){const a=this.context.outputTextureLayout.shape.length,h={add:"+=",sub:"-=",mul:"*=",div:"/="},p={};for(const d in h){const l=`${d}Vec`;let n="";for(let o=0;o<a;++o)n+=`
          dest[${o}] ${h[d]} src[${o}];
          `;const e=`
        void ${l}(int src[${a}], out int dest[${a}]) {
          ${n}
        }
        `;p[l]=new i.GlslLibRoutine(e)}return p}copyVec(){const a=this.context.outputTextureLayout.shape.length;let h="";for(let d=0;d<a;++d)h+=`
        dest[${d}] = src[${d}];
        `;const p=`
      void copyVec(int src[${a}], out int dest[${a}]) {
        ${h}
      }
      `;return{copyVec:new i.GlslLibRoutine(p)}}setVecItem(){const a=this.context.outputTextureLayout.shape.length;let h=`
        if(index < 0)
            index =${a} + index;
        if (index == 0)
            m[0] = value;
        `;for(let d=1;d<a-1;++d)h+=`
        else if (index == ${d})
            m[${d}] = value;
            `;h+=`
        else
            m[${a-1}] = value;
        `;const p=`
      void setVecItem(out int m[${a}], int index, int value) {
        ${h}
      }
        `;return{setVecItem:new i.GlslLibRoutine(p)}}getVecItem(){const a=this.context.outputTextureLayout.shape.length;let h=`
        if(index < 0)
            index = ${a} + index;
        if (index == 0)
            return m[0];
      `;for(let d=1;d<a-1;++d)h+=`
        else if (index == ${d})
            return m[${d}];
      `;h+=`
        else
            return m[${a-1}];
        `;const p=`
      int getVecItem(int m[${a}], int index) {
        ${h}
      }
    `;return{getVecItem:new i.GlslLibRoutine(p)}}}t.VecGlslLib=s},8316:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLInferenceHandler=void 0;const i=r(6231),s=r(9162),c=r(2517),a=r(2403),h=r(7019),p=r(8710),d=r(5611),l=r(4057),n=r(2039);t.WebGLInferenceHandler=class{constructor(e){this.session=e,this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map}calculateTextureWidthAndHeight(e,o){return(0,l.calculateTextureWidthAndHeight)(this.session.layoutStrategy,e,o)}executeProgram(e,o){if(o.length<e.inputNames.length)throw new Error(`Input size mustn't be less than ${e.inputNames.length}.`);if(e.inputNames.length!==e.inputTypes.length)throw new Error("input names size does not match input types");const u=[];for(let x=0;x<e.inputNames.length;++x)u[x]=this.getOrCreateTextureData(o[x],e.inputTypes[x]);const g=((x,w)=>{const T=w.map(I=>`${I.unpackedShape.join(",")};${I.width}x${I.height}`).join("_");let S=x.name;return x.cacheHint&&(S+="["+x.cacheHint+"]"),S+=":"+T,S})(e,u);let m=this.session.programManager.getArtifact(g);const y=m?m.programInfo:typeof e.get=="function"?e.get():e,b=(0,l.createTextureLayoutFromTextureType)(this.session.layoutStrategy,y.output.dims,y.output.textureType),_=this.createTextureData(b,y.output.type);return m||(m=this.session.programManager.build(y,u,_),this.session.programManager.setArtifact(g,m)),this.runProgram(m,u,_),_}run(e,o){return this.executeProgram(e,o).tensor}runProgram(e,o,u){for(let g=0;g<o.length;++g)if(!!o[g].isPacked!=(e.programInfo.inputTypes[g]===n.TextureType.packed))throw new Error(`input[${g}] property packed inconsistent`);if(!!u.isPacked!=(e.programInfo.output.textureType===n.TextureType.packed))throw new Error("output property packed inconsistent");this.session.programManager.run(e,o,u)}getOrCreateTextureData(e,o){let u=this.getTextureData(e.dataId,o===n.TextureType.packed);if(!u&&(u=this.getTextureData(e.dataId,o!==n.TextureType.packed),u))return o===n.TextureType.packed?this.pack(u):this.unpack(u);if(!u){const g=(0,l.createTextureLayoutFromTextureType)(this.session.layoutStrategy,e.dims,o);if(o===n.TextureType.packedLastDimension){const b=e.dims;if(b.length===4){const _=[b[0],Math.ceil(b[1]*b[2]*b[3]/4)],x=(0,l.createTextureLayoutFromTextureType)(this.session.layoutStrategy,_,o);let w=e.numberData;if(b[1]*b[2]*b[3]%4!=0){const T=b[0],S=b[1]*b[2]*b[3],I=Math.ceil(S*1/4)*4;w=new Float32Array(T*I);for(let v=0;v<T;++v){const A=v*S,L=v*I+v%1*S;w.set(e.numberData.subarray(A,A+S),L)}}return this.createTextureData(x,e.type,w,e,1)}}if(o===n.TextureType.packed){const m=(0,l.createTextureLayoutFromShape)(this.session.layoutStrategy,e.dims,1,[],{reverseWH:!0}),y=this.createTextureData(m,e.type,e.numberData,e,1);u=this.pack(y)}else u=this.createTextureData(g,e.type,e.numberData,e,1)}return u}createTextureDataFromLayoutBindTensor(e,o,u,g){return this.createTextureData(e,o,u,g,1)}createTextureData(e,o,u,g,m){i.Logger.verbose("InferenceHandler",`Creating TextureData: layout:[${JSON.stringify(e)}]`);const y=this.session.textureManager.createTextureFromLayout(o,e,u,m);return this.createTextureDataFromTexture(e,o,y,g)}reshapeUnpacked(e,o){const u=this.getOrCreateTextureData(e,n.TextureType.unpacked),g={channels:u.channels,height:u.height,width:u.width,shape:o.length!==0?o:[1],strides:c.ShapeUtil.computeStrides(o),unpackedShape:o};return this.createTextureDataFromTexture(g,e.type,u.texture).tensor}reshapePacked(e,o){const u=this.getOrCreateTextureData(e,n.TextureType.packed);if((0,h.isReshapeCheap)(e.dims,o)){const _={channels:u.channels,height:u.height,width:u.width,shape:o.length!==0?o:[1],strides:c.ShapeUtil.computeStrides(o),unpackedShape:o,isPacked:!0};return this.createTextureDataFromTexture(_,e.type,u.texture).tensor}const g=(0,h.processDims3D)(e.dims),m=(0,h.processDims3D)(o),y=this.reshapePacked(e,g),b=this.run((0,h.createPackedReshape3DProgramInfoLoader)(this,y,m),[y]);return this.reshapePacked(b,o)}cast(e,o){const u=this.getOrCreateTextureData(e,n.TextureType.unpacked);return this.createTextureDataFromTexture(u,o,u.texture).tensor}createTextureDataFromTexture(e,o,u,g,m){const y=Object.assign(Object.assign({},e),{tensor:g||new s.Tensor(e.unpackedShape,o,b=>this.readTexture(y),async b=>this.readTextureAsync(y),void 0,m),texture:u});return this.setTextureData(y.tensor.dataId,y,e.isPacked),y}getTextureData(e,o=!1){return this.session.isInitializer(e)?this.session.getTextureData(e,o):o?this.packedTextureDataCache.get(e):this.unpackedTextureDataCache.get(e)}setTextureData(e,o,u=!1){this.session.isInitializer(e)?this.session.setTextureData(e,o,u):(u?this.packedTextureDataCache:this.unpackedTextureDataCache).set(e,o)}isTextureLayoutCached(e,o=!1){return!!this.getTextureData(e.dataId,o)}dispose(){this.session.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach(e=>this.session.textureManager.releaseTexture(e)),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach(e=>this.session.textureManager.releaseTexture(e)),this.unpackedTextureDataCache=new Map}readTexture(e){return e.isPacked?this.readTexture(this.unpack(e)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTexture(e,e.tensor.type,e.channels):this.session.textureManager.readUint8TextureAsFloat((0,p.encodeAsUint8)(this,e))}async readTextureAsync(e){return e.isPacked?this.readTextureAsync(this.unpack(e)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTextureAsync(e,e.tensor.type,e.channels):this.session.textureManager.readUint8TextureAsFloat((0,p.encodeAsUint8)(this,e))}pack(e){return this.executeProgram((0,a.createPackProgramInfoLoader)(this,e.tensor),[e.tensor])}unpack(e){return this.executeProgram((0,d.createUnpackProgramInfoLoader)(this,e.tensor),[e.tensor])}}},1640:function(f,t,r){var i=this&&this.__createBinding||(Object.create?function(W,Z,J,nt){nt===void 0&&(nt=J);var wt=Object.getOwnPropertyDescriptor(Z,J);wt&&!("get"in wt?!Z.__esModule:wt.writable||wt.configurable)||(wt={enumerable:!0,get:function(){return Z[J]}}),Object.defineProperty(W,nt,wt)}:function(W,Z,J,nt){nt===void 0&&(nt=J),W[nt]=Z[J]}),s=this&&this.__setModuleDefault||(Object.create?function(W,Z){Object.defineProperty(W,"default",{enumerable:!0,value:Z})}:function(W,Z){W.default=Z}),c=this&&this.__importStar||function(W){if(W&&W.__esModule)return W;var Z={};if(W!=null)for(var J in W)J!=="default"&&Object.prototype.hasOwnProperty.call(W,J)&&i(Z,W,J);return s(Z,W),Z};Object.defineProperty(t,"__esModule",{value:!0}),t.WEBGL_OP_RESOLVE_RULES=void 0;const a=r(2898),h=c(r(7839)),p=r(4196),d=r(2069),l=r(8138),n=r(9663),e=r(5193),o=r(7992),u=r(1253),g=r(4776),m=r(6572),y=r(3346),b=r(5623),_=r(2870),x=r(2143),w=r(4939),T=r(718),S=r(2268),I=r(8117),v=r(2278),A=r(5524),L=r(5975),N=r(3933),$=r(6558),D=r(5723),R=r(3738),O=c(r(4909)),F=r(8428),z=r(9793);t.WEBGL_OP_RESOLVE_RULES=[["Abs","","6+",O.abs],["Acos","","7+",O.acos],["Add","","7+",h.add],["And","","7+",h.and],["Asin","","7+",O.asin],["Atan","","7+",O.atan],["AveragePool","","7+",x.averagePool,x.parseAveragePoolAttributes],["BatchNormalization","","7+",a.batchNormalization,a.parseBatchNormalizationAttributes],["Cast","","6+",p.cast,p.parseCastAttributes],["Ceil","","6+",O.ceil],["Clip","","6-10",O.clip,O.parseClipAttributes],["Clip","","11+",O.clipV11],["Concat","","4+",d.concat,d.parseConcatAttributes],["Conv","","1+",l.conv,l.parseConvAttributes],["ConvTranspose","","1+",n.convTranspose,n.parseConvTransposeAttributes],["Cos","","7+",O.cos],["Div","","7+",h.div],["Dropout","","7+",O.identity],["DepthToSpace","","1+",e.depthToSpace,e.parseDepthToSpaceAttributes],["Equal","","7+",h.equal],["Elu","","6+",O.elu,O.parseEluAttributes],["Exp","","6+",O.exp],["Flatten","","1+",o.flatten,o.parseFlattenAttributes],["Floor","","6+",O.floor],["FusedConv","com.microsoft","1+",l.conv,l.parseConvAttributes],["Gather","","1+",u.gather,u.parseGatherAttributes],["Gemm","","7-10",g.gemm,g.parseGemmAttributesV7],["Gemm","","11+",g.gemm,g.parseGemmAttributesV11],["GlobalAveragePool","","1+",x.globalAveragePool,x.parseGlobalAveragePoolAttributes],["GlobalMaxPool","","1+",x.globalMaxPool],["Greater","","7+",h.greater],["Identity","","1+",O.identity],["ImageScaler","","1+",m.imageScaler,m.parseImageScalerAttributes],["InstanceNormalization","","6+",y.instanceNormalization,y.parseInstanceNormalizationAttributes],["LeakyRelu","","6+",O.leakyRelu,O.parseLeakyReluAttributes],["Less","","7+",h.less],["Log","","6+",O.log],["MatMul","","1+",b.matMul,b.parseMatMulAttributes],["MaxPool","","1+",x.maxPool,x.parseMaxPoolAttributes],["Mul","","7+",h.mul],["Neg","","6+",O.neg],["Not","","1+",O.not],["Or","","7+",h.or],["Pad","","2-10",_.padV2,_.parsePadAttributesV2],["Pad","","11+",_.padV11,_.parsePadAttributesV11],["Pow","","7+",h.pow],["PRelu","","7+",h.pRelu],["ReduceLogSum","","1+",w.reduceLogSum,w.parseReduceAttributes],["ReduceMax","","1+",w.reduceMax,w.parseReduceAttributes],["ReduceMean","","1+",w.reduceMean,w.parseReduceAttributes],["ReduceMin","","1+",w.reduceMin,w.parseReduceAttributes],["ReduceProd","","1+",w.reduceProd,w.parseReduceAttributes],["ReduceSum","","1-12",w.reduceSum,w.parseReduceAttributes],["ReduceSumSquare","","1+",w.reduceLogSumSquare,w.parseReduceAttributes],["Relu","","6+",O.relu],["Reshape","","5+",T.reshape],["Resize","","10",S.resize,S.parseResizeAttributesV10],["Resize","","11+",S.resize,S.parseResizeAttributesV11],["Shape","","1+",I.shape],["Sigmoid","","6+",O.sigmoid],["Sin","","7+",O.sin],["Slice","","10+",v.sliceV10],["Slice","","1-9",v.slice,v.parseSliceAttributes],["Softmax","","1-12",A.softmax,A.parseSoftmaxAttributes],["Softmax","","13+",A.softmaxV13,A.parseSoftmaxAttributesV13],["Split","","2-12",L.split,L.parseSplitAttributes],["Sqrt","","6+",O.sqrt],["Squeeze","","1-12",N.squeeze,N.parseSqueezeAttributes],["Squeeze","","13+",N.squeezeV13],["Sub","","7+",h.sub],["Sum","","6+",$.sum],["Tan","","7+",O.tan],["Tanh","","6+",O.tanh],["Tile","","6+",D.tile],["Transpose","","1+",R.transpose,R.parseTransposeAttributes],["Upsample","","7-8",z.upsample,z.parseUpsampleAttributesV7],["Upsample","","9",z.upsample,z.parseUpsampleAttributesV9],["Unsqueeze","","1-12",F.unsqueeze,F.parseUnsqueezeAttributes],["Unsqueeze","","13+",F.unsqueezeV13],["Xor","","7+",h.xor]]},2898:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseBatchNormalizationAttributes=t.batchNormalization=void 0;const i=r(246),s=r(5060),c=r(2039),a={name:"BatchNormalization",inputNames:["A","Scale","B","Mean","Variance"],inputTypes:[c.TextureType.unpacked,c.TextureType.unpacked,c.TextureType.unpacked,c.TextureType.unpacked,c.TextureType.unpacked]};t.batchNormalization=(d,l,n)=>(p(l),[d.run(Object.assign(Object.assign({},a),{cacheHint:n.cacheKey,get:()=>h(d,l,n)}),l)]),t.parseBatchNormalizationAttributes=d=>{const l=d.attributes.getFloat("epsilon",1e-5),n=d.attributes.getFloat("momentum",.9),e=d.attributes.getInt("spatial",1);return(0,i.createAttributeWithCacheKey)({epsilon:l,momentum:n,spatial:e})};const h=(d,l,n)=>{const e=(0,s.getGlsl)(d.session.backend.glContext.version),o=l[0].dims.length,[u,g]=d.calculateTextureWidthAndHeight(l[1].dims,c.TextureType.unpacked),m=`
  float process(int[${o}] indices) {
    vec2 position = offsetToCoords(indices[1], ${u}, ${g});
    float scale = getColorAsFloat(${e.texture2D}(Scale, position));
    float mean = getColorAsFloat(${e.texture2D}(Mean, position));
    float variance = getColorAsFloat(${e.texture2D}(Variance, position));
    float b = getColorAsFloat(${e.texture2D}(B, position));

    return scale * ( (_A(indices) - mean) / sqrt(variance + float(${n.epsilon})) ) + b;
  }`;return Object.assign(Object.assign({},a),{output:{dims:l[0].dims,type:l[0].type,textureType:c.TextureType.unpacked},shaderSource:m})},p=d=>{if(!d||d.length!==5)throw new Error("BatchNormalization requires 5 inputs.");const l=d[0],n=d[1],e=d[2],o=d[3],u=d[4];if(l.dims.length<3||n.dims.length!==1||e.dims.length!==1||o.dims.length!==1||u.dims.length!==1)throw new Error("invalid input shape.");if(n.dims[0]!==l.dims[1]||e.dims[0]!==l.dims[1]||o.dims[0]!==l.dims[1]||u.dims[0]!==l.dims[1])throw new Error("invalid input shape.");if(l.type!=="float32"&&l.type!=="float64"||n.type!=="float32"&&n.type!=="float64"||e.type!=="float32"&&e.type!=="float64"||o.type!=="float32"&&o.type!=="float64"||u.type!=="float32"&&u.type!=="float64")throw new Error("invalid input tensor types.")}},7839:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.xor=t.sub=t.pRelu=t.pow=t.or=t.mul=t.less=t.greater=t.equal=t.div=t.and=t.add=t.glslPRelu=t.glslPow=t.glslXor=t.glslOr=t.glslAnd=t.glslLess=t.glslGreater=t.glslEqual=t.glslSub=t.glslMul=t.glslDiv=t.glslAdd=void 0;const i=r(2517),s=r(8520),c=r(5060),a=r(2039);function h(){const w="add_";return{body:`
  float ${w}(float a, float b) {
    return a + b;
  }
  vec4 ${w}(vec4 v1, vec4 v2) {
    return v1 + v2;
  }
  `,name:w,type:s.FunctionType.ValueBased}}function p(){const w="div_";return{body:`
  float ${w}(float a, float b) {
    return a / b;
  }
  vec4 ${w}(vec4 v1, vec4 v2) {
    return v1 / v2;
  }
  `,name:w,type:s.FunctionType.ValueBased}}function d(){const w="mul_";return{body:`
  float ${w}(float a, float b) {
    return a * b;
  }
  vec4 ${w}(vec4 v1, vec4 v2) {
    return v1 * v2;
  }
  `,name:w,type:s.FunctionType.ValueBased}}function l(){const w="sub_";return{body:`
  float ${w}(float a, float b) {
    return a - b;
  }
  vec4 ${w}(vec4 v1, vec4 v2) {
    return v1 - v2;
  }
  `,name:w,type:s.FunctionType.ValueBased}}function n(){const w="equal_";return{body:`
  float ${w}(float a, float b) {
    return float(a == b);
  }
  vec4 ${w}(vec4 v1, vec4 v2) {
    return vec4(equal(v1, v2));
  }
  `,name:w,type:s.FunctionType.ValueBased}}function e(){const w="greater_";return{body:`
  float ${w}(float a, float b) {
    return float(a > b);
  }
  vec4 ${w}(vec4 v1, vec4 v2) {
    return vec4( v1.r > v2.r ,
      v1.g > v2.g,
      v1.b > v2.b,
      v1.a > v2.a );
  }
  `,name:w,type:s.FunctionType.ValueBased}}function o(){const w="less_";return{body:`
  float ${w}(float a, float b) {
    return float(a < b);
  }
  vec4 ${w}(vec4 v1, vec4 v2) {
    return vec4( v1.r < v2.r ,
                v1.g < v2.g,
                v1.b < v2.b,
                v1.a < v2.a );
  }
  `,name:w,type:s.FunctionType.ValueBased}}function u(){const w="and_";return{body:`
  float ${w}(float a, float b) {
    return float( bool(a) && bool(b) );
  }
  vec4 ${w}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r && b2.r ,
                b1.g && b2.g,
                b1.b && b2.b,
                b1.a && b2.a );
  }
  `,name:w,type:s.FunctionType.ValueBased}}function g(){const w="or_";return{body:`
  float ${w}(float a, float b) {
    return float( bool(a) || bool(b) );
  }
  vec4 ${w}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r || b2.r ,
                b1.g || b2.g,
                b1.b || b2.b,
                b1.a || b2.a );
  }
  `,name:w,type:s.FunctionType.ValueBased}}function m(){const w="xor_";return{body:`
  float ${w}(float a, float b) {
    return float( bool(a) ^^ bool(b) );
  }
  vec4 ${w}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r ^^ b2.r ,
                b1.g ^^ b2.g,
                b1.b ^^ b2.b,
                b1.a ^^ b2.a );
  }
  `,name:w,type:s.FunctionType.ValueBased}}function y(){return function(w){const T=`${w}_`;return{body:`
  float ${T}(float a, float b) {
    return ${w}(a, b);
  }
  vec4 ${T}(vec4 v1, vec4 v2) {
    return ${w}(v1, v2);
  }
  `,name:T,type:s.FunctionType.ValueBased}}("pow")}function b(){const w="prelu_";return{body:`
  float ${w}(float a, float b) {
    return a < 0.0 ? a * b: a;
  }
  vec4 ${w}(vec4 v1, vec4 v2) {
    return vec4(
      v1.r < 0.0 ? v1.r * v2.r: v1.r,
      v1.g < 0.0 ? v1.g * v2.g: v1.g,
      v1.b < 0.0 ? v1.b * v2.b: v1.b,
      v1.a < 0.0 ? v1.a * v2.a: v1.a
      );
  }
  `,name:w,type:s.FunctionType.ValueBased}}t.glslAdd=h,t.glslDiv=p,t.glslMul=d,t.glslSub=l,t.glslEqual=n,t.glslGreater=e,t.glslLess=o,t.glslAnd=u,t.glslOr=g,t.glslXor=m,t.glslPow=y,t.glslPRelu=b;const _=(w,T,S,I=T[0].type,v)=>{const A=w.session.pack?a.TextureType.packed:a.TextureType.unpacked;return{name:S.name,inputNames:["A","B"],inputTypes:[A,A],cacheHint:v,get:()=>x(w,T,S,I)}},x=(w,T,S,I=T[0].type)=>{const v=w.session.pack?a.TextureType.packed:a.TextureType.unpacked,A=!i.ShapeUtil.areEqual(T[0].dims,T[1].dims);let L=T[0].dims;const N=w.session.pack;if(A){const R=i.BroadcastUtil.calcShape(T[0].dims,T[1].dims,!1);if(!R)throw new Error("Can't perform binary op on the given tensors");L=R;const O=L.length,F=T[0].dims.length!==0?T[0].dims.length:1,z=T[1].dims.length!==0?T[1].dims.length:1,W=T[0].dims.length!==0?"bcastIndices_A(indices, aindices);":"aindices[0] = 0;",Z=T[1].dims.length!==0?"bcastIndices_B(indices, bindices);":"bindices[0] = 0;",J=(0,c.getGlsl)(w.session.backend.glContext.version),nt=N?`
      ${S.body}
      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();
        vec4 result = ${S.name}(a, b);
        ${J.output} = result;
      }`:`
      ${S.body}
      float process(int indices[${O}]) {
        int aindices[${F}];
        int bindices[${z}];
        ${W}
        ${Z}
        return ${S.name}(_A(aindices), _B(bindices));
      }`;return{name:S.name,inputNames:["A","B"],inputTypes:[v,v],output:{dims:L,type:I,textureType:v},shaderSource:nt,hasMain:N}}const $=(0,c.getGlsl)(w.session.backend.glContext.version),D=`
    ${S.body}
    void main() {
      vec4 v1 = ${$.texture2D}(A, TexCoords);
      vec4 v2 = ${$.texture2D}(B, TexCoords);
      vec4 result = ${S.name}(v1, v2);
      ${$.output} = result;
    }
    `;return{name:S.name,inputNames:["A","B"],inputTypes:[v,v],output:{dims:T[0].dims,type:I,textureType:v},shaderSource:D,hasMain:!0}};t.add=(w,T)=>[w.run(_(w,T,h()),T)],t.and=(w,T)=>[w.run(_(w,T,u(),"bool"),T)],t.div=(w,T)=>[w.run(_(w,T,p()),T)],t.equal=(w,T)=>[w.run(_(w,T,n(),"bool"),T)],t.greater=(w,T)=>[w.run(_(w,T,e(),"bool"),T)],t.less=(w,T)=>[w.run(_(w,T,o(),"bool"),T)],t.mul=(w,T)=>[w.run(_(w,T,d()),T)],t.or=(w,T)=>[w.run(_(w,T,g(),"bool"),T)],t.pow=(w,T)=>[w.run(_(w,T,y()),T)],t.pRelu=(w,T)=>[w.run(_(w,T,b()),T)],t.sub=(w,T)=>[w.run(_(w,T,l()),T)],t.xor=(w,T)=>[w.run(_(w,T,m(),"bool"),T)]},4196:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseCastAttributes=t.cast=void 0;const i=r(2517);t.cast=(c,a,h)=>(s(a),[c.cast(a[0],h)]),t.parseCastAttributes=c=>i.ProtoUtil.tensorDataTypeFromProto(c.attributes.getInt("to"));const s=c=>{if(!c||c.length!==1)throw new Error("Cast requires 1 input.");if(c[0].type==="string")throw new Error("Invalid input type.")}},1163:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createPackedConcatProgramInfoLoader=void 0;const i=r(5060),s=r(2039),c=r(9390),a=r(2827);t.createPackedConcatProgramInfoLoader=(p,d,l)=>{const n=(e=d.length,o=l.cacheKey,{name:"Concat (packed)",inputNames:Array.from({length:e},(u,g)=>`X${g}`),inputTypes:Array(e).fill(s.TextureType.packed),cacheHint:o});var e,o;return Object.assign(Object.assign({},n),{get:()=>((u,g,m,y)=>{const b=m[0].dims.slice();if(y>=b.length||y<-1*b.length)throw new Error("axis specified for concat doesn't match input dimensionality");y<0&&(y=b.length+y);const _=b.slice(0);for(let W=1;W<m.length;W++){const Z=m[W].dims.slice();for(let J=0;J<b.length;J++)if(J===y)_[y]+=Z[J];else if(b[J]!==Z[J])throw new Error("non concat dimensions must match")}const x=_.length,w=(0,a.getChannels)("coords",x),T=(0,c.getCoordsDataType)(x),S=(0,a.unpackFromChannel)(),I=m.map(W=>W.dims),v=(0,c.getGlChannels)(x),A=new Array(I.length-1);A[0]=I[0][y];for(let W=1;W<A.length;W++)A[W]=A[W-1]+I[W][y];const L=v[y],N=v.slice(-2),$=v.join();let D=`if (${L} < ${A[0]}) {
        return getChannel(
            getX0(${$}), vec2(${N.join()}));
        }`;for(let W=1;W<A.length;W++){const Z=A[W-1];D+=`
            if (${L} < ${A[W]}  && ${L} >= ${A[W-1]}) {
              return getChannel(
                getX${W}(${h(v,L,Z)}),
                vec2(${h(N,L,Z)}));
            }`}const R=A.length,O=A[A.length-1];D+=`
            return getChannel(
              getX${R}(${h(v,L,O)}),
              vec2(${h(N,L,O)}));`;const F=(0,i.getGlsl)(u.session.backend.glContext.version),z=`
          ${S}
          float getValue(${v.map(W=>"int "+W)}) {
            ${D}
          }

          void main() {
            ${T} coords = getOutputCoords();
            int lastDim = coords.${v[x-1]};
            coords.${v[x-1]} = coords.${v[x-2]};
            coords.${v[x-2]} = lastDim;

            vec4 result = vec4(getValue(${w}), 0., 0., 0.);

            ${w[x-1]} = ${w[x-1]} + 1;
            if (${w[x-1]} < ${_[x-1]}) {
              result.g = getValue(${w});
            }

            ${w[x-2]} = ${w[x-2]} + 1;
            if (${w[x-2]} < ${_[x-2]}) {
              result.a = getValue(${w});
            }

            ${w[x-1]} = ${w[x-1]} - 1;
            if (${w[x-2]} < ${_[x-2]} &&
                ${w[x-1]} < ${_[x-1]}) {
              result.b = getValue(${w});
            }
            ${F.output} = result;
          }
        `;return Object.assign(Object.assign({},g),{output:{dims:_,type:m[0].type,textureType:s.TextureType.packed},shaderSource:z,hasMain:!0})})(p,n,d,l.axis)})};const h=(p,d,l)=>{const n=p.indexOf(d);return p.map((e,o)=>o===n?`${e} - ${l}`:e).join()}},2069:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseConcatAttributes=t.concat=void 0;const i=r(246),s=r(2039),c=r(1163);t.concat=(e,o,u)=>(n(o),e.session.pack&&o[0].dims.length>1?[e.run((0,c.createPackedConcatProgramInfoLoader)(e,o,u),o)]:[e.run(a(e,o,u),o)]);const a=(e,o,u)=>{const g=(m=o.length,y=u.cacheKey,{name:"Concat",inputNames:Array.from({length:m},(b,_)=>`X${_}`),inputTypes:Array(m).fill(s.TextureType.unpacked),cacheHint:y});var m,y;return Object.assign(Object.assign({},g),{get:()=>((b,_,x,w)=>{const T=x[0].dims.slice();if(w>=T.length||w<-1*T.length)throw new Error("axis specified for concat doesn't match input dimensionality");w<0&&(w=T.length+w);const S=T.slice(0);for(let $=1;$<x.length;$++){const D=x[$].dims.slice();for(let R=0;R<T.length;R++)if(R===w)S[w]+=D[R];else if(T[R]!==D[R])throw new Error("non concat dimensions must match")}const I=S.length,v=new Array(x.length);let A=0;for(let $=0;$<v.length;++$)A+=x[$].dims[w],v[$]=A;let L="";L=x.length<5?h(v):p(v);const N=`
        ${d(x.length,I)}
        ${l(v)}
        ${L}
        float process(int indices[${I}]) {
          int textureIndex = getTextureWhereDataResides (indices[${w}]);

          if(textureIndex != 0) {
            indices[${w}] = indices[${w}] - int(getSizeInConcatAxisValueFromIndex(textureIndex-int(1)));
          }

          return fetchDataFromCorrectTexture(textureIndex, indices);
        }`;return Object.assign(Object.assign({},_),{output:{dims:S,type:x[0].type,textureType:s.TextureType.unpacked},shaderSource:N})})(0,g,o,u.axis)})},h=e=>`int getTextureWhereDataResides(int index) {
      ${e.map((o,u)=>`if(index<${o}) {return ${u};}
`).join("")}
    }`,p=e=>h(e),d=(e,o)=>{const u=[`float fetchDataFromCorrectTexture(int textureIndex, int indices[${o}]) {`];for(let g=0;g<e;++g)g===0?u.push(`	if (textureIndex == ${g}) { return _X${g}(indices); }`):g===e-1?u.push(`	else { return _X${g}(indices); }`):u.push(`	else if (textureIndex == ${g}) { return _X${g}(indices); }`);return u.push("	}"),u.join(`
`)},l=e=>{const o=["int getSizeInConcatAxisValueFromIndex(int index) {"];for(let u=0;u<e.length;++u)u===0?o.push(`	if (index == ${u}) { return ${e[u]}; }`):u===e.length-1?o.push(`	else { return ${e[u]}; }`):o.push(`	else if (index == ${u}) { return ${e[u]}; }`);return o.push("	}"),o.join(`
`)};t.parseConcatAttributes=e=>(0,i.createAttributeWithCacheKey)({axis:e.attributes.getInt("axis")});const n=e=>{if(!e||e.length<1)throw new Error("too few inputs");const o=e[0].type,u=e[0].dims.length;if(o==="string")throw new Error("string tensor is not supported yet");for(const g of e){if(g.type!==o)throw new Error("input tensors should be one type");if(g.dims.length!==u)throw new Error("input tensors should have the same shape")}}},4770:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createUnpackedGroupedConvProgramInfoLoader=void 0;const i=r(6231),s=r(5060),c=r(2039),a=r(8138),h=r(2823);t.createUnpackedGroupedConvProgramInfoLoader=(p,d,l)=>{const n=(e=d.length>2,o=l.cacheKey,{name:"GroupedConv",inputNames:e?["X","W","Bias"]:["X","W"],inputTypes:e?[c.TextureType.unpacked,c.TextureType.unpacked,c.TextureType.unpacked]:[c.TextureType.unpacked,c.TextureType.unpacked],cacheHint:o});var e,o;return Object.assign(Object.assign({},n),{get:()=>((u,g,m,y)=>{const b=g.length>2?"value += getBias(output_channel);":"",_=g[0].dims.slice(),x=g[1].dims.slice(),w=x[0]/y.group;i.Logger.verbose("GroupedConv",`autpPad:${y.autoPad}, dilations:${y.dilations}, group:${y.group}, kernelShape:${y.kernelShape}, pads:${y.pads}, strides:${y.strides}`);const T=(0,a.calculateOutputShape)(_,x,y.dilations,y.pads,y.strides),S=(0,s.getGlsl)(u.session.backend.glContext.version),{activationFunction:I,applyActivation:v}=(0,h.getActivationSnippet)(y),A=`
  const ivec2 strides = ivec2(${y.strides[0]}, ${y.strides[1]});
  const ivec2 pads = ivec2(${y.pads[0]}, ${y.pads[1]});
  ${I}
  void main() {
    ivec4 coords = getOutputCoords();
    int batch = coords.x;
    int output_channel = coords.y;
    ivec2 xRCCorner = coords.zw * strides - pads;
    int group_id = output_channel / ${w};

    float value = 0.0;
    for (int wInChannel = 0; wInChannel < ${x[1]}; wInChannel++) {
      int input_channel = group_id * ${x[1]} + wInChannel;
      for (int wHeight = 0; wHeight < ${x[2]}; wHeight++) {
        int xHeight = xRCCorner.x + wHeight * ${y.dilations[0]};

        if (xHeight < 0 || xHeight >= ${_[2]}) {
          continue;
        }

        for (int wWidth = 0; wWidth < ${x[3]}; wWidth++) {
          int xWidth = xRCCorner.y + wWidth * ${y.dilations[1]};
          if (xWidth < 0 || xWidth >= ${_[3]}) {
            continue;
          }

          float xVal = getX(batch, input_channel, xWidth, xHeight);
          float wVal = getW(output_channel, wInChannel, wWidth, wHeight);
          value += xVal*wVal;
        }
      }
    }
    ${b}
    ${v}
    ${S.output} = vec4(value, .0, .0, .0);
  }
`;return Object.assign(Object.assign({},m),{output:{dims:T,type:g[0].type,textureType:c.TextureType.unpacked},shaderSource:A,hasMain:!0})})(p,d,n,l)})}},1386:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.conv2DPacked=t.conv2DPackedPointwise=void 0;const i=r(8138),s=r(8555),c=r(708);t.conv2DPackedPointwise=(a,h,p)=>{const d=h[0].dims,l=h[1].dims,n=(0,i.calculateOutputShape)(d,l,p.dilations,p.pads,p.strides),e=a.reshapePacked(h[0],[d[1],d[2]*d[3]]),o=a.reshapePacked(h[1],[l[0],l[1]]),u=h.length>2?[o,e,h[2]]:[o,e],g=a.run((0,c.createPackedMatmulProgramInfoLoader)(a,u,p),u);return a.reshapePacked(g,n)},t.conv2DPacked=(a,h,p)=>{const d=h[0].dims,l=h[1].dims,n=(0,i.calculateOutputShape)(d,l,p.dilations,p.pads,p.strides),e=a.run((0,s.createPackedIm2ColProgramInfoLoader)(a,h[0],h[1],n,p),[h[0]]),o=a.reshapePacked(h[1],[l[0],l[1]*l[2]*l[3]]),u=h.length===3?[o,e,h[2]]:[o,e],g=a.run((0,c.createPackedMatmulProgramInfoLoader)(a,u,p),u);return a.reshapePacked(g,n)}},9663:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseConvTransposeAttributes=t.convTranspose=void 0;const i=r(246),s=r(5060),c=r(2039),a=r(2823),h=(o,u,g,m,y,b)=>(o-1)*u+g+(m-1)*y+1-b,p=(o,u,g,m,y)=>{const b=Math.floor(o/2);u==="SAME_UPPER"?(g[m]=b,g[y]=o-b):u==="SAME_LOWER"&&(g[m]=o-b,g[y]=b)};t.convTranspose=(o,u,g)=>(e(u,g),d(o,u,g));const d=(o,u,g)=>{const m=n(g,u);return[l(o,u,m)]},l=(o,u,g)=>o.run(((m,y,b)=>{const _=(x=y.length>2,w=b.cacheKey,{name:"ConvTranspose",inputNames:x?["X","W","B"]:["X","W"],inputTypes:x?[c.TextureType.unpacked,c.TextureType.unpacked,c.TextureType.unpacked]:[c.TextureType.unpacked,c.TextureType.unpacked],cacheHint:w});var x,w;return Object.assign(Object.assign({},_),{get:()=>((T,S,I,v)=>{const A=S.length>2?"getB(output_channel)":"0.0",L=S[0].dims,N=S[1].dims,$=N[1],D=N[0]/v.group,R=[S[0].dims[0],S[1].dims[1]*v.group,...v.outputShape],O=(0,s.getGlsl)(T.session.backend.glContext.version),{activationFunction:F,applyActivation:z}=(0,a.getActivationSnippet)(v),W=`
  const ivec2 strides = ivec2(${v.strides[0]}, ${v.strides[1]});
  const ivec2 pads = ivec2(${v.pads[0]}, ${v.pads[1]});
  ${F}
  void main() {
    ivec4 coords = getOutputCoords();
    int batch = coords.x;
    int output_channel = coords.y;

    ivec2 loc = coords.zw + pads;

    int group_id = output_channel / ${$};
    int wOutChannel = output_channel - group_id * ${$};

    float value = ${A};
    for (int inChannelOffset = 0; inChannelOffset < ${D}; inChannelOffset++) {
      int input_channel = group_id * ${D} + inChannelOffset;
      for (int wWOff = 0; wWOff < ${N[2]}; wWOff++) {
        for (int wHOff = 0; wHOff < ${N[3]}; wHOff++) {
          ivec2 wOff = ivec2(wWOff * ${v.dilations[0]}, wHOff * ${v.dilations[1]});
          ivec2 wLoc = loc - wOff;
          ivec2 wLocIn = wLoc / strides;
          if (
            wLocIn * strides == wLoc &&
            wLocIn.x >= 0 && wLocIn.x < ${L[2]} &&
            wLocIn.y >= 0 && wLocIn.y < ${L[3]}
          ) {
            float xVal = getX(batch, input_channel, wLocIn.y, wLocIn.x);
            float wVal = getW(input_channel, wOutChannel, wHOff, wWOff);
            value += xVal * wVal;
          }
        }
      }
    }
    ${z}
    ${O.output} = vec4(value, .0, .0, .0);
  }
`;return Object.assign(Object.assign({},I),{output:{dims:R,type:S[0].type,textureType:c.TextureType.unpacked},shaderSource:W,hasMain:!0})})(m,y,_,b)})})(o,u,g),u),n=(o,u)=>{const g=o.kernelShape.slice();if(o.kernelShape.length===0)for(let _=2;_<u[1].dims.length;++_)g.push(u[1].dims[_]);const m=o.pads.slice(),y=o.outputShape.slice();((_,x,w,T,S,I,v,A)=>{const L=_.length-2,N=A.length===0;for(let $=0;$<L;++$){const D=N?_[$+2]*I[$]:A[$],R=h(_[$+2],I[$],S[$],x[$],w[$],D);p(R,T,S,$,$+L),N&&A.push(I[$]*(_[$+2]-1)+v[$]+(x[$]-1)*w[$]+1-S[$]-S[$+L])}})(u[0].dims,g,o.dilations,o.autoPad,m,o.strides,o.outputPadding,y);const b=Object.assign({},o);return Object.assign(b,{kernelShape:g,pads:m,outputShape:y,cacheKey:o.cacheKey}),b};t.parseConvTransposeAttributes=o=>{const u=o.attributes,g=(0,a.parseInternalActivationAttributes)(u),m=u.getString("auto_pad","NOTSET"),y=u.getInts("dilations",[1,1]),b=u.getInt("group",1),_=u.getInts("kernel_shape",[]),x=u.getInts("output_padding",[0,0]),w=u.getInts("output_shape",[]),T=u.getInts("pads",[0,0,0,0]),S=u.getInts("strides",[1,1]);return(0,i.createAttributeWithCacheKey)(Object.assign({autoPad:m,dilations:y,group:b,kernelShape:_,outputPadding:x,outputShape:w,pads:T,strides:S},g))};const e=(o,u)=>{if(!o||o.length!==2&&o.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(o[0].dims.length!==4||o[1].dims.length!==4)throw new Error("currently only support 2-dimensional conv");if(o[0].dims[1]!==o[1].dims[0])throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");const g=o[1].dims[1]*u.group;if(o.length===3&&(o[2].dims.length!==1||o[2].dims[0]!==g))throw new Error("invalid bias");const m=o[0].dims.length-2;if(u.dilations.length!==m)throw new Error(`dilations should be ${m}D`);if(u.strides.length!==m)throw new Error(`strides should be ${m}D`);if(u.pads.length!==2*m)throw new Error(`pads should be ${2*m}D`);if(u.outputPadding.length!==m)throw new Error(`output_padding should be ${m}D`);if(u.kernelShape.length!==0&&u.kernelShape.length!==o[1].dims.length-2)throw new Error("invalid kernel shape");if(u.outputShape.length!==0&&u.outputShape.length!==o[0].dims.length-2)throw new Error("invalid output shape");if(o[0].type!=="float32"||o[1].type!=="float32")throw new Error("ConvTranspose input(X,W) should be float tensor");if(o.length===3&&o[2].type!=="float32")throw new Error("ConvTranspose input(bias) should be float tensor")}},8138:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseConvAttributes=t.conv=t.calculateOutputShape=void 0;const i=r(246),s=r(2517),c=r(4770),a=r(1386),h=r(9828),p=r(2823),d=r(3248),l=r(5623);t.calculateOutputShape=(m,y,b,_,x)=>{const w=m[0],T=m.slice(2),S=T.length,I=y[0],v=y.slice(2).map((L,N)=>L+(L-1)*(b[N]-1)),A=T.map((L,N)=>L+_[N]+_[N+S]).map((L,N)=>Math.floor((L-v[N]+x[N])/x[N]));return[w,I].concat(...A)},t.conv=(m,y,b)=>(g(y,b),n(m,y,b));const n=(m,y,b)=>{const _=u(b,y),x=m.session.pack,w=_.kernelShape[0]===1&&_.kernelShape[1]===1;return _.group>1?[m.run((0,c.createUnpackedGroupedConvProgramInfoLoader)(m,y,_),y)]:w&&x?[e(m,y,_)]:x&&y[0].dims.length===4&&y[0].dims[0]===1&&!w?[(0,a.conv2DPacked)(m,y,_)]:[o(m,y,_)]},e=(m,y,b)=>{const _=y[0].dims,x=y[1].dims,w=(0,t.calculateOutputShape)(_,x,b.dilations,b.pads,b.strides),T=m.reshapeUnpacked(y[0],[_[1],_[2]*_[3]]),S=m.reshapeUnpacked(y[1],[x[0],x[1]]),I=y.length>2?[S,T,y[2]]:[S,T],v=m.run((0,l.createMatmulProgramInfoLoader)(I,b),I);return m.reshapeUnpacked(v,w)},o=(m,y,b)=>{const _=y[0].dims,x=y[1].dims,w=(0,t.calculateOutputShape)(_,x,b.dilations,b.pads,b.strides),T=m.run((0,d.createIm2ColProgramInfoLoader)(m,y[0],y[1],w,b),[y[0]]),S=y.length===3?[T,y[1],y[2]]:[T,y[1]];return m.run((0,h.createDotProductProgramInfoLoader)(m,y,w,b),S)},u=(m,y)=>{const b=m.kernelShape.slice();if(m.kernelShape.length===0)for(let w=2;w<y[1].dims.length;++w)b.push(y[1].dims[w]);const _=m.pads.slice();s.PoolConvUtil.adjustPadsBasedOnAutoPad(y[0].dims,m.strides,m.dilations,b,_,m.autoPad);const x=Object.assign({},m);return Object.assign(x,{kernelShape:b,pads:_,cacheKey:m.cacheKey}),x};t.parseConvAttributes=m=>{const y=m.attributes,b=(0,p.parseInternalActivationAttributes)(y),_=y.getString("auto_pad","NOTSET"),x=y.getInts("dilations",[1,1]),w=y.getInt("group",1),T=y.getInts("kernel_shape",[]),S=y.getInts("pads",[0,0,0,0]),I=y.getInts("strides",[1,1]);return(0,i.createAttributeWithCacheKey)(Object.assign({autoPad:_,dilations:x,group:w,kernelShape:T,pads:S,strides:I},b))};const g=(m,y)=>{if(!m||m.length!==2&&m.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(m[0].dims.length!==4||m[1].dims.length!==4)throw new Error("currently only support 2-dimensional conv");if(m[0].dims[1]!==m[1].dims[1]*y.group)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(m.length===3&&(m[2].dims.length!==1||m[1].dims[0]!==m[2].dims[0]))throw new Error("invalid bias");const b=m[0].dims.length-2;if(y.dilations.length!==b)throw new Error(`dilations should be ${b}D`);if(y.strides.length!==b)throw new Error(`strides should be ${b}D`);if(y.pads.length!==2*b)throw new Error(`pads should be ${2*b}D`);if(y.kernelShape.length!==0&&y.kernelShape.length!==m[1].dims.length-2)throw new Error("invalid kernel shape");if(m[0].type!=="float32"||m[1].type!=="float32")throw new Error("Conv input(X,W) should be float tensor");if(m.length===3&&m[2].type!=="float32")throw new Error("Conv input(bias) should be float tensor")}},5193:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseDepthToSpaceAttributes=t.depthToSpace=void 0;const i=r(3738);t.depthToSpace=(c,a,h)=>{s(a);const p=h.blocksize,d=p*p,l=h.mode==="DCR"?[0,3,4,1,5,2]:[0,1,4,2,5,3],n=h.mode==="DCR"?[a[0].dims[0],p,p,a[0].dims[1]/d,a[0].dims[2],a[0].dims[3]]:[a[0].dims[0],a[0].dims[1]/d,p,p,a[0].dims[2],a[0].dims[3]],e=c.reshapeUnpacked(a[0],n),o={perm:l,cacheKey:`${l}`},[u]=(0,i.transpose)(c,[e],o),g=[a[0].dims[0],a[0].dims[1]/d,a[0].dims[2]*p,a[0].dims[3]*p];return[c.reshapeUnpacked(u,g)]},t.parseDepthToSpaceAttributes=c=>{const a=c.attributes.getInt("blocksize");if(a<1)throw new Error(`blocksize must be >= 1, but got : ${a} for DepthToSpace`);const h=c.attributes.getString("mode","DCR");if(h!=="DCR"&&h!=="CRD")throw new Error(`unrecognized mode: ${h} for DepthToSpace`);return{mode:h,blocksize:a}};const s=c=>{if(c.length!==1)throw new Error(`DepthToSpace expect 1 inputs, but got ${c.length}`);if(c[0].type==="string"||c[0].dims.length!==4)throw new TypeError("DepthToSpace input should be a 4-D numeric tensor")}},9828:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createDotProductProgramInfoLoader=void 0;const i=r(2517),s=r(5060),c=r(2039),a=r(2823),h=r(3248);t.createDotProductProgramInfoLoader=(p,d,l,n)=>{const e=((o,u)=>({name:"ConvDotProduct",inputNames:o?["Im2Col","K","B"]:["Im2Col","K"],inputTypes:o?[c.TextureType.unpacked,c.TextureType.packedLastDimension,c.TextureType.unpacked]:[c.TextureType.unpacked,c.TextureType.packedLastDimension],cacheKey:u.activationCacheKey}))(d.length>2,n);return Object.assign(Object.assign({},e),{get:()=>((o,u,g,m,y)=>{const b=g[0].dims,_=g[1].dims,x=[_[0],Math.ceil(b[1]*_[2]*_[3]/4)],w=(0,h.calculateIm2ColDims)(b,_,m),[T,S]=o.calculateTextureWidthAndHeight(x,c.TextureType.packedLastDimension),I=i.ShapeUtil.computeStrides(w),[v,A]=o.calculateTextureWidthAndHeight(w,c.TextureType.packedLastDimension),L=m.length,N=g.length<3?"0.0":"_B(b)",$=Math.ceil(b[1]*_[2]*_[3]/4),{activationFunction:D,applyActivation:R}=(0,a.getActivationSnippet)(y),O=(0,s.getGlsl)(o.session.backend.glContext.version),F=`
${D}
float process(int indices[${L}]) {
  int b[1];
  b[0] = indices[1];
  int im2col[4];
  im2col[0] = indices[0];
  im2col[1] = indices[2];
  im2col[2] = indices[3];
  int im2colOffset = im2col[0] * ${I[0]} + im2col[1] * ${I[1]} + im2col[2] * ${I[2]};
  int kernelOffset = indices[1] * ${x[1]};
  float value = ${N};
  for (int i = 0; i < ${$}; ++i) {
    vec2 im2colCoords = offsetToCoords(im2colOffset, ${v}, ${A});
    vec2 kernelCoords = offsetToCoords(kernelOffset, ${T}, ${S});
    value += dot(${O.texture2D}(Im2Col, im2colCoords), ${O.texture2D}(K, kernelCoords));
    ++im2colOffset;
    ++kernelOffset;
  }
  ${R}
  return value;
}`;return Object.assign(Object.assign({},u),{output:{dims:m,type:g[0].type,textureType:c.TextureType.unpacked},shaderSource:F})})(p,e,d,l,n)})}},7992:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseFlattenAttributes=t.flatten=void 0;const i=r(2517);t.flatten=(c,a,h)=>{s(a,h);const p=i.ShapeUtil.flattenShape(a[0].dims,h);return[c.reshapeUnpacked(a[0],p)]},t.parseFlattenAttributes=c=>c.attributes.getInt("axis",1);const s=(c,a)=>{if(!c||c.length!==1)throw new Error("Flatten requires 1 input.");const h=c[0].dims.length;if(h===0)throw new Error("scalar tensor is not supported.");if(a<-h||a>h)throw new Error("Invalid axis");if(c[0].type==="string")throw new Error("string tensor is not supported.")}},2823:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseInternalActivationAttributes=t.getActivationSnippet=void 0;const i=r(2517),s=r(4909);t.getActivationSnippet=function(c){let a;switch(c.activation){case"Relu":a=(0,s.glslRelu)();break;case"Sigmoid":a=(0,s.glslSigmoid)();break;case"Clip":a=(0,s.glslClip)(c.clipMin,c.clipMax);break;default:return{activationFunction:"",applyActivation:""}}const h=a.name;return{activationFunction:a.body,applyActivation:`value = ${h}_(value);`}},t.parseInternalActivationAttributes=c=>{const a=c.getString("activation","");if(a==="Clip"){const[h,p]=c.getFloats("activation_params",[i.MIN_CLIP,i.MAX_CLIP]);return{activation:a,clipMax:p,clipMin:h,activationCacheKey:`${a}:${h},${p}`}}return{activation:a,activationCacheKey:a}}},1253:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseGatherAttributes=t.gather=void 0;const i=r(246),s=r(782),c=r(2517),a=r(2039);t.gather=(l,n,e)=>(d(n,e.axis),[l.run(p(l,n,e),n)]),t.parseGatherAttributes=l=>(0,i.createAttributeWithCacheKey)({axis:l.attributes.getInt("axis",0)});const h={name:"Gather",inputNames:["A","B"],inputTypes:[a.TextureType.unpacked,a.TextureType.unpacked]},p=(l,n,e)=>{const o=Object.assign(Object.assign({},h),{cacheHint:e.cacheKey});return Object.assign(Object.assign({},o),{get:()=>((u,g,m,y)=>{const b=m[0].dims.slice(),_=m[1].dims.slice(),x=new Array(b.length+_.length-1);y=c.ShapeUtil.normalizeAxis(y,b.length);const w=[];for(let S=0;S<x.length;S++)S<y?(x[S]=b[S],w.push(`inputIdx[${S}] = outputIdx[${S}];`)):S<y+_.length?(x[S]=_[S-y],w.push(`indexDataIdx[${S-y}] = outputIdx[${S}];`)):(x[S]=b[S-_.length+1],w.push(`inputIdx[${S-_.length+1}] = outputIdx[${S}];`));const T=`
      float process(int outputIdx[${x.length||1}]) {
        int inputIdx[${b.length}];
        int indexDataIdx[${_.length||1}];
        indexDataIdx[0] = 0;
        ${w.join(`
        `)}
        int idx = int(_B(indexDataIdx));
        inputIdx[${y}] = idx < 0 ? idx + ${b[y]} : idx;
        return _A(inputIdx);
      }`;return Object.assign(Object.assign({},g),{output:{dims:x,type:m[0].type,textureType:a.TextureType.unpacked},shaderSource:T})})(0,o,n,e.axis)})},d=(l,n)=>{if(!l||l.length!==2)throw new Error("Gather requires 2 inputs.");const e=l[0].dims.length;if(e<1)throw new Error("Invalid input shape.");if(n<-e||n>e-1)throw new Error("Invalid axis.");if(s.NUMBER_TYPES.indexOf(l[0].type)===-1)throw new Error("Invaid input type.");if(l[1].type!=="int32"&&l[1].type!=="int16")throw new Error("Invaid input type.")}},4776:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseGemmAttributesV11=t.parseGemmAttributesV7=t.gemm=void 0;const i=r(246),s=r(2517),c=r(2039);t.gemm=(l,n,e)=>(d(n,e),[l.run(h(n,e),n)]);const a=(l,n)=>{const e=l.attributes.getInt("transA",0)!==0,o=l.attributes.getInt("transB",0)!==0,u=l.attributes.getFloat("alpha",1),g=l.attributes.getFloat("beta",1);return(0,i.createAttributeWithCacheKey)({transA:e,transB:o,alpha:u,beta:g,isOptionalC:n})};t.parseGemmAttributesV7=l=>a(l,!1),t.parseGemmAttributesV11=l=>a(l,!0);const h=(l,n)=>{const e={name:"Gemm",inputNames:l.length===3?["A","B","C"]:["A","B"],inputTypes:l.length===3?[c.TextureType.unpacked,c.TextureType.unpacked,c.TextureType.unpacked]:[c.TextureType.unpacked,c.TextureType.unpacked],key:n.cacheKey};return Object.assign(Object.assign({},e),{get:()=>p(e,l,n)})},p=(l,n,e)=>{const o=n[0].dims.slice(),u=n[1].dims.slice(),[g,m]=s.GemmUtil.getShapeOfGemmResult(o,e.transA,u,e.transB,n.length===3?n[2].dims:void 0),y=[g,m];if(!y)throw new Error("Can't use gemm on the given tensors");let b=o[o.length-1],_="";e.transA&&(b=o[0]),e.transA&&e.transB?_="value += _A_T(a) * _B_T(b);":e.transA&&!e.transB?_="value += _A_T(a) * _B(b);":!e.transA&&e.transB?_="value += _A(a) * _B_T(b);":e.transA||e.transB||(_="value += _A(a) * _B(b);");const x=y.length,w=`
      float process(int indices[${x}]) {
          int a[${x}];
          int b[${x}];
          ${n.length===3?`int c[${n[2].dims.length}];`:""}

          copyVec(indices, a);
          copyVec(indices, b);
          ${n.length===3?"bcastIndices_C(indices, c);":""}

          float value = 0.0;
          for (int k=0; k<${b}; ++k) {
              a[${x-1}] = k;
              b[${x-2}] = k;
              ${_}
          }

          value = value * alpha;
          ${n.length===3?"value += beta * _C(c);":""}
          return value;
      }`;return Object.assign(Object.assign({},l),{output:{dims:y,type:n[0].type,textureType:c.TextureType.unpacked},variables:[{name:"alpha",type:"float",data:e.alpha},{name:"beta",type:"float",data:e.beta}],shaderSource:w})},d=(l,n)=>{if(!l)throw new Error("Input is missing");if(n.isOptionalC&&(l.length<2||l.length>3))throw new Error("Invaid input shape.");if(!n.isOptionalC&&l.length!==3)throw new Error("Gemm requires 3 inputs");if(l.length===3&&l[2].dims.length!==1&&l[2].dims.length!==2)throw new Error("Invalid input shape of C");if(l[0].type!=="float32"&&l[0].type!=="float64"||l[1].type!=="float32"&&l[1].type!=="float64"||l.length===3&&l[2].type!=="float32"&&l[2].type!=="float64")throw new Error("Invalid input type.");if(l[0].type!==l[1].type||l.length===3&&l[0].type!==l[2].type)throw new Error("Input types are mismatched")}},8555:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createPackedIm2ColProgramInfoLoader=void 0;const i=r(5060),s=r(2039),c=r(2827);t.createPackedIm2ColProgramInfoLoader=(a,h,p,d,l)=>{const n=(e=l.cacheKey,{name:"Im2Col (packed)",inputNames:["A"],inputTypes:[s.TextureType.packed],cacheHint:e});var e;return Object.assign(Object.assign({},n),{get:()=>((o,u,g,m,y,b)=>{const _=g.dims,x=m.dims,w=y.length,T=[x[1]*x[2]*x[3],y[2]*y[3]],S=x[2]*x[3],I=(0,c.unpackFromChannel)(),v=(0,i.getGlsl)(o.session.backend.glContext.version);let A="";for(let N=0;N<=1;N++)for(let $=0;$<=1;$++)A+=`
            blockIndex = rc.x + ${$};
            pos = rc.y + ${N};

            if(blockIndex < ${T[1]} && pos < ${T[0]}) {
              offsetY = int(blockIndex / (${y[w-1]})) * ${b.strides[0]} -
                ${b.pads[0]};
              d0 = offsetY + ${b.dilations[0]} * (imod(pos, ${S}) / ${x[2]});

              if(d0 < ${_[2]} && d0 >= 0) {
                offsetX = imod(blockIndex, ${y[w-1]}) * ${b.strides[1]} -
                  ${b.pads[1]};
                d1 = offsetX + ${b.dilations[1]} * imod(imod(pos, ${S}), ${x[2]});

                if(d1 < ${_[3]} && d1 >= 0) {

                  ch = int(float(pos)/ ${S}.);
                    innerDims = vec2(d0, d1);
                    result[${2*N+$}] = getChannel(
                      getA(0, ch, int(innerDims.x),
                      int(innerDims.y)), innerDims);
                }
              }
            }

          `;const L=`
      ${I}

      void main() {
        ivec2 rc = getOutputCoords();
          vec4 result = vec4(0.0);
          int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
          vec2 innerDims;
          ${A}
          ${v.output} = result;
      }
            `;return Object.assign(Object.assign({},u),{output:{dims:T,type:g.type,textureType:s.TextureType.packed},shaderSource:L,hasMain:!0})})(a,n,h,p,d,l)})}},3248:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.calculateIm2ColDims=t.createIm2ColProgramInfoLoader=void 0;const i=r(2039);t.createIm2ColProgramInfoLoader=(s,c,a,h,p)=>{const d=(l=p.cacheKey,{name:"Im2Col",inputNames:["X"],inputTypes:[i.TextureType.unpacked],cacheHint:l});var l;return Object.assign(Object.assign({},d),{get:()=>((n,e,o,u,g,m)=>{const y=o.dims,b=u.dims,_=g.length,x=(0,t.calculateIm2ColDims)(y,b,g,4),w=`
        const int XC = ${y[1]};
        const int XH = ${y[2]};
        const int XW = ${y[3]};
        const int KH = ${m.kernelShape[0]};
        const int KW = ${m.kernelShape[1]};
        const int dilationH = ${m.dilations[0]};
        const int dilationW = ${m.dilations[1]};
        const int strideH = ${m.strides[0]};
        const int strideW = ${m.strides[1]};
        const int padH = ${m.pads[0]};
        const int padW = ${m.pads[1]};
        const int KHKW = KH*KW;
        const int XCKHKW = XC * KHKW;
        const int outputChannels = 4;
        vec4 process(int indices[${_}]) {
          int b  = indices[0]; // batch size
          int oh = indices[1] * strideH - padH; //output height
          int ow = indices[2] * strideW - padW; //output width
          int p = indices[3] * outputChannels; //patch
          vec4 value = vec4(0.0);
          for(int i=0; i < outputChannels; ++i) {
            if(p < XCKHKW) {
              int patchC = p / KHKW;
              int patchH = (p - patchC*KHKW) / KW;
              int patchW = (p - patchC*KHKW) - patchH * KW;
              int xh2 = oh + patchH * dilationH;
              int xw2 = ow + patchW * dilationW;
              int x[${y.length}];
              x[0] = b;
              x[1] = patchC;
              x[2] = xh2;
              x[3] = xw2;
              if(xh2 >= 0 &&
                  xh2 < XH &&
                  xw2 >= 0 &&
                  xw2 < XW) {
                value[i] = _X(x);
              }
            }
            ++p;
          }
          return value;
        }
        `;return Object.assign(Object.assign({},e),{output:{dims:x,type:o.type,textureType:i.TextureType.packedLastDimension},shaderSource:w})})(0,d,c,a,h,p)})},t.calculateIm2ColDims=(s,c,a,h=4)=>[a[0],a[2],a[3],Math.ceil(s[1]*c[2]*c[3]/h)]},6572:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseImageScalerAttributes=t.imageScaler=void 0;const i=r(246),s=r(2039);t.imageScaler=(d,l,n)=>(p(l),[d.run(a(d,l,n),l)]),t.parseImageScalerAttributes=d=>{const l=d.attributes.getFloat("scale"),n=d.attributes.getFloats("bias");return(0,i.createAttributeWithCacheKey)({scale:l,bias:n})};const c={name:"ImageScaler",inputNames:["X"],inputTypes:[s.TextureType.unpacked]},a=(d,l,n)=>{const e=Object.assign(Object.assign({},c),{cacheHint:n.cacheKey});return Object.assign(Object.assign({},e),{get:()=>((o,u,g,m)=>{const y=g[0].dims.slice(),b=y.length,_=`
      ${h(m.bias.length)}
      float process(int indices[${b}]) {
        return _X(indices) * scale + getBias(bias, indices[1]);
      }`;return Object.assign(Object.assign({},u),{output:{dims:y,type:g[0].type,textureType:s.TextureType.unpacked},variables:[{name:"bias",type:"float",arrayLength:m.bias.length,data:m.bias},{name:"scale",type:"float",data:m.scale}],shaderSource:_})})(0,e,l,n)})},h=d=>{const l=[`float getBias(float bias[${d}], int channel) {`];for(let n=0;n<d;++n)n===0?l.push(`	if (channel == ${n}) { return bias[${n}]; }`):n===d-1?l.push(`	else { return bias[${n}]; }`):l.push(`	else if (channel == ${n}) { return bias[${n}]; }`);return l.push("	}"),l.join(`
`)},p=d=>{if(!d||d.length!==1)throw new Error("ImageScaler requires 1 input.");if(d[0].dims.length!==4)throw new Error("Invalid input shape.");if(d[0].type!=="float32"&&d[0].type!=="float64")throw new Error("Invalid input type.")}},3346:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseInstanceNormalizationAttributes=t.instanceNormalization=void 0;const i=r(5060),s=r(2039);t.instanceNormalization=(l,n,e)=>{d(n);const o=l.run(a(n[0]),n);return[l.run(p(l,n[0],e,o.dims),[n[0],o,n[1],n[2]])]},t.parseInstanceNormalizationAttributes=l=>l.attributes.getFloat("epsilon",1e-5);const c={name:"InstanceNormalization_MeanAndVariance",inputNames:["X"],inputTypes:[s.TextureType.unpacked]},a=l=>Object.assign(Object.assign({},c),{get:()=>((n,e)=>{const o=e.dims.slice(),u=o[1],g=o[2]*o[3],m=[o[0],u],y=`
      vec4 process(int[2] indices) {
        vec4 v = vec4(0.0);
        int a[4];
        a[0] = indices[0];
        a[1] = indices[1];
        float temp = 0.0;
        for(int a2=0; a2<${o[2]}; a2++) {
          a[2] = a2;
          for(int a3=0; a3<${o[3]}; a3++) {
            a[3] = a3;
            float x = _X(a);
            temp += x;
          }
        }
        float mean = temp / float(${g});
        temp = 0.0;
        for(int a2=0; a2<${o[2]}; a2++) {
          a[2] = a2;
          for(int a3=0; a3<${o[3]}; a3++) {
            a[3] = a3;
            float x = _X(a);
            temp += (x - mean) * (x - mean);
          }
        }
        v.r = mean;
        v.g = temp / float(${g});

        return v;
      }`;return Object.assign(Object.assign({},n),{output:{dims:m,type:e.type,textureType:s.TextureType.packedLastDimension},shaderSource:y})})(c,l)}),h={name:"InstanceNormalization_ComputeOutput",inputNames:["X","MeanAndVariance","Scale","B"],inputTypes:[s.TextureType.unpacked,s.TextureType.packedLastDimension,s.TextureType.unpacked,s.TextureType.unpacked]},p=(l,n,e,o)=>{const u=Object.assign(Object.assign({},h),{cacheHint:`${e}`});return Object.assign(Object.assign({},u),{get:()=>((g,m,y,b,_)=>{const x=(0,i.getGlsl)(g.session.backend.glContext.version),[w,T]=g.calculateTextureWidthAndHeight(_,s.TextureType.packedLastDimension),[S,I]=[w/4,T],v=`
      vec4 get_MeanAndVariance(int[2] mv) {
        int offset = indicesToOffset_MeanAndVariance(mv);
        vec2 coords = offsetToCoords(offset, ${S}, ${I});
        return ${x.texture2D}(MeanAndVariance, coords);
      }

      float process(int[4] indices) {
        int mv[2];
        mv[0] = indices[0];
        mv[1] = indices[1];
        vec4 mean_and_variance = get_MeanAndVariance(mv);
        float mean = mean_and_variance.r;
        float variance = mean_and_variance.g;

        int sb[1];
        sb[0] = indices[1];
        float scale = _Scale(sb);
        float b = _B(sb);

        return scale * (_X(indices) - mean) / sqrt(variance + epsilon) + b;
      }`;return Object.assign(Object.assign({},m),{output:{dims:y.dims,type:y.type,textureType:s.TextureType.unpacked},variables:[{name:"epsilon",type:"float",data:b}],shaderSource:v})})(l,u,n,e,o)})},d=l=>{if(!l||l.length!==3)throw new Error("InstanceNormalization requires 3 inputs.");const n=l[0],e=l[1],o=l[2];if(n.dims.length<3||e.dims.length!==1||o.dims.length!==1)throw new Error("Invalid input shape.");if(e.dims[0]!==n.dims[1]||o.dims[0]!==n.dims[1])throw new Error("Input shapes are mismatched.");if(n.type!=="float32"&&n.type!=="float64"||e.type!=="float32"&&e.type!=="float64"||o.type!=="float32"&&o.type!=="float64")throw new Error("Invalid input type.");if(l[0].dims.length!==4)throw new Error("Only support 4-D input shape.")}},708:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createPackedMatmulProgramInfoLoader=void 0;const i=r(2517),s=r(5060),c=r(2039),a=r(9390),h=r(2823),p=r(5623);t.createPackedMatmulProgramInfoLoader=(d,l,n)=>{const e=(o=l.length>2,u=n.activationCacheKey,{name:"MatMul (packed)",inputNames:o?["A","B","Bias"]:["A","B"],inputTypes:o?[c.TextureType.packed,c.TextureType.packed,c.TextureType.packed]:[c.TextureType.packed,c.TextureType.packed],cacheHint:u});var o,u;return Object.assign(Object.assign({},e),{get:()=>((g,m,y,b)=>{const _=y.length>2,x=_?"value += getBiasForMatmul();":"",w=y[0].dims,T=y[1].dims,S=i.BroadcastUtil.calcShape(w,T,!0),I=!i.ShapeUtil.areEqual(y[0].dims,y[1].dims);if(!S)throw new Error("Can't use matmul on the given tensors");const v=w[w.length-1],A=Math.ceil(v/2),L=w.length,N=T.length,$=(0,s.getGlsl)(g.session.backend.glContext.version),D=(0,a.getCoordsDataType)(S.length),R=S.length,O=(0,a.getGlChannels)(),{activationFunction:F,applyActivation:z}=(0,h.getActivationSnippet)(b),W=_?`${(0,p.getBiasForMatmul)(D,O,y[2].dims,S,!0)}`:"",Z=I?`${function(K,st,Tt,xt){let $t=[],Qt=[];const Ot=Tt[0].dims,Ft=Tt[1].dims,Mt=Ot.length,St=Ft.length,vt=xt.length,jt=vt-Mt,Gt=vt-St;$t=Ot.map((It,Ht)=>`coords.${st[Ht+jt]}`),$t[Mt-1]="i*2",$t.join(", "),Qt=Ft.map((It,Ht)=>`coords.${st[Ht+Gt]}`),Qt[St-2]="i*2",Qt.join(", ");const zt=i.BroadcastUtil.getBroadcastDims(Ot,xt),Xt=i.BroadcastUtil.getBroadcastDims(Ft,xt),Kt=zt.map(It=>`coords.${st[It+jt]} = 0;`).join(`
`),Wt=Xt.map(It=>`coords.${st[It+Gt]} = 0;`).join(`
`),Yt=`int lastDim = coords.${st[vt-1]};
  coords.${st[vt-1]} = coords.${st[vt-2]};
  coords.${st[vt-2]} = lastDim;`;return`
vec4 getAAtOutCoordsMatmul(int i) {
  ${K} coords = getOutputCoords();
  ${Yt}
  ${Kt}
  vec4 outputValue = getA(${$t});
  return outputValue;
}

vec4 getBAtOutCoordsMatmul(int i) {
  ${K} coords = getOutputCoords();
  ${Yt}
  ${Wt}
  vec4 outputValue = getB(${Qt});
  return outputValue;
}`}(D,O,y,S)}`:"",J=I?"getAAtOutCoordsMatmul(i)":`getA(${function(K,st){let Tt="";for(let xt=0;xt<st-2;xt++)Tt+=`rc.${K[xt]}, `;return Tt+=`rc.${K[st-2]}, i*2`,Tt}(O,L)})`,nt=I?"getBAtOutCoordsMatmul(i)":`getB(${function(K,st){let Tt="";for(let xt=0;xt<st-2;xt++)Tt+=`rc.${K[xt]}, `;return Tt+=`i*2, rc.${K[st-1]}`,Tt}(O,N)})`,wt=`
            ${Z}
            ${W}
            ${F}
            void main() {
              ${I?"":`${D} rc =
          getOutputCoords(); int lastDim = rc.${O[R-1]}; rc.${O[R-1]} =
          rc.${O[R-2]}; rc.${O[R-2]} = lastDim;
      `}

              vec4 value = vec4(0);
              for (int i = 0; i < ${A}; i++) {
                vec4 a = ${J};
                vec4 b = ${nt};

                value += (a.rrbb * b.rgrg);
                value += (a.ggaa * b.baba);
              }
              ${x}
              ${z}
              ${$.output} = value;
            }`;return Object.assign(Object.assign({},m),{output:{dims:S,type:y[0].type,textureType:c.TextureType.packed},shaderSource:wt,hasMain:!0})})(d,e,l,n)})}},5623:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBiasForMatmul=t.createMatmulProgramInfoLoader=t.parseMatMulAttributes=t.matMul=void 0;const i=r(2517),s=r(2039),c=r(9390),a=r(2823),h=r(708);function p(n,e){const o=(u=n.length>2,g=e.activationCacheKey,{name:"MatMul",inputNames:u?["A","B","Bias"]:["A","B"],inputTypes:u?[s.TextureType.unpacked,s.TextureType.unpacked,s.TextureType.unpacked]:[s.TextureType.unpacked,s.TextureType.unpacked],cacheHint:g});var u,g;return Object.assign(Object.assign({},o),{get:()=>function(m,y,b){const _=y[0].dims,x=y[1].dims,w=i.BroadcastUtil.calcShape(_,x,!0);if(!w)throw new Error("Can't use matmul on the given tensors");const T=(0,c.getCoordsDataType)(w.length),S=(0,c.getGlChannels)(),{activationFunction:I,applyActivation:v}=(0,a.getActivationSnippet)(b),A=y.length>2,L=A?"value += getBiasForMatmul();":"",N=A?`${l(T,S,y[2].dims,w,!1)}`:"",$=w.length,D=_.length,R=x.length,O=`
    ${I}
    ${N}
    float process(int indices[${$}]) {
        int a[${D}];
        int b[${R}];
        bcastMatmulIndices_A(indices, a);
        bcastMatmulIndices_B(indices, b);

        float value;
        for (int k=0; k<${_[_.length-1]}; ++k) {
            a[${D-1}] = k;
            b[${R-2}] = k;
            value += _A(a) * _B(b);
        }
        ${L}
        ${v}
        return value;
    }`;return Object.assign(Object.assign({},m),{output:{dims:w,type:y[0].type,textureType:s.TextureType.unpacked},shaderSource:O})}(o,n,e)})}t.matMul=(n,e,o)=>(d(e),n.session.pack?[n.run((0,h.createPackedMatmulProgramInfoLoader)(n,e,o),e)]:[n.run(p(e,o),e)]),t.parseMatMulAttributes=n=>(0,a.parseInternalActivationAttributes)(n.attributes),t.createMatmulProgramInfoLoader=p;const d=n=>{if(!n||n.length!==2)throw new Error("MatMul requires 2 inputs.");if(n[0].dims[n[0].dims.length-1]!==n[1].dims[n[1].dims.length-2])throw new Error("shared dimension does not match.");if(n[0].type!=="float32"&&n[0].type!=="float64"||n[1].type!=="float32"&&n[1].type!=="float64")throw new Error("inputs should be float type");if(n[0].type!==n[1].type)throw new Error("inputs types should match")};function l(n,e,o,u,g){let m="";const y=o.length,b=u.length,_=b-y;m=b<2&&y>0?"coords":o.map((T,S)=>`coords.${e[S+_]}`).join(", ");const x=i.BroadcastUtil.getBroadcastDims(o,u).map(T=>`coords.${e[T+_]} = 0;`).join(`
`);let w="vec4(outputValue.xx, outputValue.yy)";return i.ShapeUtil.size(o)===1&&(w="vec4(outputValue.x)"),g?`
vec4 getBiasForMatmul() {
  ${n} coords = getOutputCoords();
  ${x}
  vec4 outputValue = getBias(${m});
  return ${w};
}`:`
float getBiasForMatmul() {
  ${n} coords = getOutputCoords();
  ${x}
  return getBias(coords.x);
}`}t.getBiasForMatmul=l},2403:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createPackProgramInfoLoader=void 0;const i=r(5060),s=r(2039),c=r(9390),a=r(2827),h={name:"pack",inputNames:["A"],inputTypes:[s.TextureType.unpackedReversed]};t.createPackProgramInfoLoader=(p,d)=>Object.assign(Object.assign({},h),{get:()=>((l,n)=>{const e=(0,i.getGlsl)(l.session.backend.glContext.version),o=n.dims,u=o.length,g=n.dims.length,m=(0,c.getCoordsDataType)(g),y=(0,a.getChannels)("rc",g),b=(_=g,x=y,w=o[o.length-2],T=o[o.length-1],_===0||_===1?"":`
    int r = ${x[_-2]};
    int c = ${x[_-1]};
    int rp1 = ${x[_-2]} + 1;
    int cp1 = ${x[_-1]} + 1;
    bool rEdge = rp1 >= ${T};
    bool cEdge = cp1 >= ${w};
    `);var _,x,w,T;let S;S=u===0?[1,1]:u===1?[o[0],1]:[o[g-1],o[g-2]];const I=function(L,N,$){if(L===0)return"false";if(L===1)return`rc > ${N[0]}`;let D="";for(let R=L-2;R<L;R++)D+=`${$[R]} >= ${N[R-L+2]}`,R<L-1&&(D+="||");return D}(g,S,y),v=function(L,N){const $=L.length;if($===0)return"getA(), 0, 0, 0";if($===1)return`getA(rc),
            rc + 1 >= ${L[0]} ? 0. : getA(rc + 1),
            0, 0`;let D="";if($>2)for(let R=0;R<$-2;++R)D+=`${N[R]},`;return`getA(${D}r, c),
          rEdge ? 0. : getA(${D}rp1, c),
          cEdge ? 0. : getA(${D}r, cp1),
          rEdge || cEdge ? 0. : getA(${D}rp1, cp1)`}(o,y),A=`
        void main() {
          ${m} rc = getOutputCoords();

          if(${I}) {
            ${e.output} = vec4(0);
          } else {
            ${b}

            ${e.output} = vec4(${v});
          }
        }
      `;return Object.assign(Object.assign({},h),{hasMain:!0,output:{dims:n.dims,type:n.type,textureType:s.TextureType.packed},shaderSource:A})})(p,d)})},2827:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unpackFromChannel=t.getChannels=t.getVecChannels=void 0;const i=r(9390);function s(c,a){return(0,i.getGlChannels)(a).map(h=>`${c}.${h}`)}t.getVecChannels=s,t.getChannels=function(c,a){return a===1?[c]:s(c,a)},t.unpackFromChannel=function(){return`
    float getChannel(vec4 frag, int dim) {
      int modCoord = imod(dim, 2);
      return modCoord == 0 ? frag.r : frag.g;
    }

    float getChannel(vec4 frag, vec2 innerDims) {
      vec2 modCoord = mod(innerDims, 2.);
      return modCoord.x == 0. ?
        (modCoord.y == 0. ? frag.r : frag.g) :
        (modCoord.y == 0. ? frag.b : frag.a);
    }
  `}},2870:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parsePadAttributesV11=t.padV11=t.parsePadAttributesV2=t.padV2=void 0;const i=r(246),s=r(2517),c=r(5060),a=r(2039),h={name:"Pad",inputNames:["A"],inputTypes:[a.TextureType.unpacked]};t.padV2=(m,y,b)=>(l(y),[m.run(Object.assign(Object.assign({},h),{cacheHint:b.cacheKey,get:()=>d(m,y[0],b)}),y)]),t.parsePadAttributesV2=m=>{const y=m.attributes.getString("mode","constant"),b=m.attributes.getFloat("value",0),_=m.attributes.getInts("pads");return(0,i.createAttributeWithCacheKey)({mode:y,value:b,pads:_})},t.padV11=(m,y,b)=>{n(y);const _=p(m,y,b);return(0,t.padV2)(m,[y[0]],_)},t.parsePadAttributesV11=m=>m.attributes.getString("mode","constant");const p=(m,y,b)=>{if(!m.session.isInitializer(y[1].dataId)||y.length>=3&&!m.session.isInitializer(y[2].dataId))throw new Error("dynamic pad attributes are not allowed");const _=Array.from(y[1].integerData),x=y.length>=3?y[2].floatData[0]:0;return(0,i.createAttributeWithCacheKey)({mode:b,pads:_,value:x})},d=(m,y,b)=>{const _=s.ShapeUtil.padShape(y.dims.slice(),b.pads),x=_.length,w=`
      ${e(m,y,b)}
      float process(int[${x}] indices) {
          return padA(indices);
      }`;return{name:"Pad",inputNames:["A"],inputTypes:[a.TextureType.unpacked],output:{dims:_,type:y.type,textureType:a.TextureType.unpacked},shaderSource:w}},l=m=>{if(!m||m.length!==1)throw new Error("Pad requires 1 input");if(m[0].type!=="float32"&&m[0].type!=="float64")throw new Error("Invalid input type.")},n=m=>{if(!m||m.length!==2&&m.length!==3)throw new Error("Pad requires 2 or 3 inputs");if(m[1].type!=="int32")throw new Error("Invalid input type.");if(m.length>=3&&m[2].type==="string")throw new Error("Invalid input type.")},e=(m,y,b)=>{const _=(0,c.getGlsl)(m.session.backend.glContext.version),[x,w]=m.calculateTextureWidthAndHeight(y.dims,a.TextureType.unpacked),T=s.ShapeUtil.computeStrides(y.dims);switch(b.mode){case"constant":return o(_,y.dims,T,x,w,b.pads,b.value);case"reflect":return u(_,y.dims,T,x,w,b.pads);case"edge":return g(_,y.dims,T,x,w,b.pads);default:throw new Error("Invalid mode")}},o=(m,y,b,_,x,w,T)=>{const S=y.length;let I="";for(let v=S-1;v>=0;--v)I+=`
        k = m[${v}] - ${w[v]};
        if (k < 0)  return constant;
        if (k >= ${y[v]}) return constant;
        offset += k * ${b[v]};
        `;return`
      float padA(int m[${S}]) {
        const float constant = float(${T});
        int offset = 0;
        int k = 0;
        ${I}
        vec2 coords = offsetToCoords(offset, ${_}, ${x});
        float value = getColorAsFloat(${m.texture2D}(A, coords));
        return value;
      }
      `},u=(m,y,b,_,x,w)=>{const T=y.length;let S="";for(let I=T-1;I>=0;--I)S+=`
        k = m[${I}] - ${w[I]};
        if (k < 0) { k = -k; }
        {
          const int _2n_1 = ${2*(y[I]-1)};
          k = int( mod( float(k), float(_2n_1) ) ) ;
          if(k >= ${y[I]}) { k = _2n_1 - k; }
        }
        offset += k * ${b[I]};
        `;return`
      float padA(int m[${T}]) {
        int offset = 0;
        int k = 0;
        ${S}
        vec2 coords = offsetToCoords(offset, ${_}, ${x});
        float value = getColorAsFloat(${m.texture2D}(A, coords));
        return value;
      }
      `},g=(m,y,b,_,x,w)=>{const T=y.length;let S="";for(let I=T-1;I>=0;--I)S+=`
        k = m[${I}] - ${w[I]};
        if (k < 0)  k = 0;
        if (k >= ${y[I]}) k = ${y[I]-1};
        offset += k * ${b[I]};
      `;return`
      float padA(int m[${T}]) {
        int offset = 0;
        int k = 0;
        ${S}
        vec2 coords = offsetToCoords(offset, ${_}, ${x});
        float value = getColorAsFloat(${m.texture2D}(A, coords));
        return value;
      }
      `}},2143:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.globalMaxPool=t.parseMaxPoolAttributes=t.maxPool=t.parseGlobalAveragePoolAttributes=t.globalAveragePool=t.parseAveragePoolAttributes=t.averagePool=void 0;const i=r(246),s=r(2517),c=r(2039);t.averagePool=(g,m,y)=>{n(m);const b={name:"AveragePool",inputNames:["X"],inputTypes:[c.TextureType.unpacked],cacheHint:y.cacheKey};return[g.run(Object.assign(Object.assign({},b),{get:()=>a(m,b,!1,y)}),m)]},t.parseAveragePoolAttributes=g=>{const m=g.attributes.getString("auto_pad","NOTSET"),y=g.attributes.getInt("ceil_mode",0),b=g.attributes.getInt("count_include_pad",0)!==0,_=g.attributes.getInts("kernel_shape"),x=g.attributes.getInts("strides",[]),w=g.attributes.getInts("pads",[]);if(y!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");return(0,i.createAttributeWithCacheKey)({autoPad:m,ceilMode:y,countIncludePad:b,kernelShape:_,strides:x,pads:w})};const a=(g,m,y,b)=>{const[_,x]=p(g,b,y),w=s.ShapeUtil.size(_.kernelShape);let T="";_.countIncludePad?T+=`value /= float(${w});`:T+=`value /= float(${w} - pad);`;const S=`
        ${e(g[0].dims,_,"value += _X(x);",T,"0.0")}
      `;return Object.assign(Object.assign({},m),{output:{dims:x,type:g[0].type,textureType:c.TextureType.unpacked},shaderSource:S})};t.globalAveragePool=(g,m,y)=>{n(m);const b={name:"GlobalAveragePool",inputNames:["X"],inputTypes:[c.TextureType.unpacked],cacheHint:`${y.countIncludePad}`};return[g.run(Object.assign(Object.assign({},b),{get:()=>a(m,b,!0,y)}),m)]},t.parseGlobalAveragePoolAttributes=g=>{const m=g.attributes.getInt("count_include_pad",0)!==0;return(0,i.createAttributeWithCacheKey)({autoPad:"",ceilMode:0,countIncludePad:m,kernelShape:[],strides:[],pads:[]})},t.maxPool=(g,m,y)=>{n(m);const b={name:"MaxPool",inputNames:["X"],inputTypes:[c.TextureType.unpacked],cacheHint:y.cacheKey};return[g.run(Object.assign(Object.assign({},b),{get:()=>h(m,b,!1,y)}),m)]},t.parseMaxPoolAttributes=g=>{const m=g.attributes.getString("auto_pad","NOTSET"),y=g.attributes.getInt("ceil_mode",0),b=g.attributes.getInts("kernel_shape"),_=g.attributes.getInts("strides",[]),x=g.attributes.getInts("pads",[]),w=g.attributes.getInt("storage_order",0),T=g.attributes.getInts("dilations",[]);if(w!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(y!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");return(0,i.createAttributeWithCacheKey)({autoPad:m,ceilMode:y,countIncludePad:!1,kernelShape:b,strides:_,pads:x,storageOrder:w,dilations:T})};const h=(g,m,y,b)=>{const[_,x]=p(g,b,y),w=`
      ${e(g[0].dims,_,`
      value = max(_X(x), value);
    `,"","-1e5")}
    `;return Object.assign(Object.assign({},m),{output:{dims:x,type:g[0].type,textureType:c.TextureType.unpacked},shaderSource:w})},p=(g,m,y)=>{const b=g[0].dims.slice(),_=Object.hasOwnProperty.call(m,"dilations"),x=m.kernelShape.slice(),w=m.strides.slice(),T=_?m.dilations.slice():[],S=m.pads.slice();s.PoolConvUtil.adjustPoolAttributes(y,b,x,w,T,S);const I=s.PoolConvUtil.computePoolOutputShape(y,b,w,T,x,S,m.autoPad),v=Object.assign({},m);return _?Object.assign(v,{kernelShape:x,strides:w,pads:S,dilations:T,cacheKey:m.cacheKey}):Object.assign(v,{kernelShape:x,strides:w,pads:S,cacheKey:m.cacheKey}),[v,I]},d={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[],cacheKey:""},l={name:"GlobalMaxPool",inputNames:["X"],inputTypes:[c.TextureType.unpacked]};t.globalMaxPool=(g,m)=>(n(m),[g.run(Object.assign(Object.assign({},l),{get:()=>h(m,l,!0,d)}),m)]);const n=g=>{if(!g||g.length!==1)throw new Error("Pool ops requires 1 input.");if(g[0].type!=="float32"&&g[0].type!=="float64")throw new Error("Invalid input type.")},e=(g,m,y,b,_)=>{const x=g.length;if(m.kernelShape.length<=2){const w=m.kernelShape[m.kernelShape.length-1],T=m.strides[m.strides.length-1],S=m.pads[m.pads.length/2-1],I=m.pads[m.pads.length-1],v=g[x-1];let A="",L="",N="";if(A=S+I!==0?`
          for (int i = 0; i < ${w}; i++) {
            x[${x} - 1] = indices[${x} - 1] * ${T} - ${S} + i;
            if (x[${x} - 1] < 0 || x[${x} - 1] >= ${v}) {
              pad++;
              continue;
            }
            ${y}
          }`:`
          for (int i = 0; i < ${w}; i++) {
            x[${x} - 1] = indices[${x} - 1] * ${T} - ${S} + i;
            ${y}
          }`,m.kernelShape.length===2){const $=m.kernelShape[m.kernelShape.length-2],D=m.strides[m.strides.length-2],R=m.pads[m.pads.length/2-2],O=m.pads[m.pads.length-2],F=g[x-2];L=R+O!==0?`
            for (int j = 0; j < ${$}; j++) {
              x[${x} - 2] = indices[${x} - 2] * ${D} - ${R} + j;
              if (x[${x} - 2] < 0 || x[${x} - 2] >= ${F}) {
                pad+= ${w};
                continue;
              }
          `:`
            for (int j = 0; j < ${$}; j++) {
              x[${x} - 2] = indices[${x} - 2] * ${D} - ${R} + j;
            `,N=`
          }
        `}return`
        float process(int indices[${x}]) {
          int x[${x}];
          copyVec(indices, x);

          float value = ${_};
          int pad = 0;
          ${L}
          ${A}
          ${N}
          ${b}
          return value;
        }
      `}{const w=s.ShapeUtil.size(m.kernelShape),T=s.ShapeUtil.computeStrides(m.kernelShape),S=T.length,I=m.pads.length,v=u(S),A=o(g,"inputDims"),L=o(m.pads,"pads"),N=o(T,"kernelStrides"),$=o(m.strides,"strides");let D="";return D=m.pads.reduce((R,O)=>R+O)?`
            if (x[j] >= inputDims[j] || x[j] < 0) {
              pad++;
              isPad = true;
              break;
            }
          }
          if (!isPad) {
            ${y}
          }`:`
          }
          ${y}
        `,`
        ${v}
        float process(int indices[${x}]) {
          int x[${x}];
          copyVec(indices, x);
          int offset[${S}];
          int pads[${I}];
          int inputDims[${x}];
          int kernelStrides[${S}];
          int strides[${S}];
          ${L}
          ${A}
          ${$}
          ${N}

          float value = ${_};
          int pad = 0;
          bool isPad = false;
          for (int i = 0; i < ${w}; i++) {
            offsetToIndices(i, kernelStrides, offset);
            isPad = false;
            for (int j = ${x} - ${S}; j < ${x}; j++) {
              x[j] = indices[j] * strides[j - ${x} + ${S}]
                + offset[j - ${x} + ${S}] - pads[j - 2];
              ${D}
          }
          ${b}

          return value;
        }
      `}},o=(g,m)=>{let y="";for(let b=0;b<g.length;b++)y+=`
      ${m}[${b}] = ${g[b]};
    `;return y},u=g=>`
  void offsetToIndices(int offset, int[${g}] strides, out int[${g}] indices) {
    if (${g} == 0) {
      return;
    }
    for (int i = 0; i < ${g} - 1; ++i) {
      indices[i] = offset / strides[i];
      offset -= indices[i] * strides[i];
    }
    indices[${g} - 1] = offset;
  }`},4939:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reduceLogSumSquare=t.reduceLogSum=t.reduceProd=t.reduceMin=t.reduceMax=t.reduceMean=t.reduceSum=t.parseReduceAttributes=void 0;const i=r(246),s=r(782),c=r(2517),a=r(2039),h=(l,n,e,o,u)=>{d(n);const g={name:o,inputNames:["A"],inputTypes:[a.TextureType.unpacked]};return[l.run(Object.assign(Object.assign({},g),{cacheHint:e.cacheKey,get:()=>p(l,n,e,o,u,g)}),n)]};t.parseReduceAttributes=l=>{const n=l.attributes.getInts("axes",[]),e=l.attributes.getInt("keepdims",1)===1;return(0,i.createAttributeWithCacheKey)({axes:n,keepDims:e})};const p=(l,n,e,o,u,g)=>{const m=[],y=n[0].dims.length||1,b=[],_=c.ShapeUtil.normalizeAxes(e.axes,n[0].dims.length),x=u(n,_);let w=x[1];for(let S=0;S<n[0].dims.length;S++)_.indexOf(S)>=0||_.length===0?(e.keepDims&&m.push(1),w=`
          for(int j${S} = 0; j${S} < ${n[0].dims[S]}; j${S}++) {
            inputIdx[${S}] = j${S};
            ${w}
          }`):(b.push(`inputIdx[${S}] = outputIdx[${m.length}];`),m.push(n[0].dims[S]));const T=`
      float process(int outputIdx[${m.length||1}]) {
        float value;                 // final result
        int inputIdx[${y}];      // addressing input data
        ${b.join(`
`)}
        ${x[0]}       // init ops for reduce max/min
        ${w}
        ${x[2]}       // final computation for reduce mean
        return value;
      }`;return Object.assign(Object.assign({},g),{output:{dims:m,type:n[0].type,textureType:a.TextureType.unpacked},shaderSource:T})},d=l=>{if(!l||l.length!==1)throw new Error("Reduce op requires 1 input.");if(s.NUMBER_TYPES.indexOf(l[0].type)===-1)throw new Error("Invalid input type.")};t.reduceSum=(l,n,e)=>h(l,n,e,"ReduceSum",()=>["value = 0.0;","value += _A(inputIdx);",""]),t.reduceMean=(l,n,e)=>h(l,n,e,"ReduceMean",(o,u)=>{let g=1;for(let m=0;m<o[0].dims.length;m++)(u.indexOf(m)>=0||u.length===0)&&(g*=o[0].dims[m]);return["value = 0.0;","value += _A(inputIdx);",`value /= ${g}.;`]}),t.reduceMax=(l,n,e)=>h(l,n,e,"ReduceMax",(o,u)=>{const g=[];for(let m=0;m<o[0].dims.length;m++)(u.indexOf(m)>=0||u.length===0)&&g.push(`inputIdx[${m}] = 0;`);return[`${g.join(`
`)}
value = _A(inputIdx);`,"value = max(value, _A(inputIdx));",""]}),t.reduceMin=(l,n,e)=>h(l,n,e,"ReduceMin",(o,u)=>{const g=[];for(let m=0;m<o[0].dims.length;m++)(u.indexOf(m)>=0||u.length===0)&&g.push(`inputIdx[${m}] = 0;`);return[`${g.join(`
`)}
value = _A(inputIdx);`,"value = min(value, _A(inputIdx));",""]}),t.reduceProd=(l,n,e)=>h(l,n,e,"ReduceProd",()=>["value = 1.0;","value *= _A(inputIdx);",""]),t.reduceLogSum=(l,n,e)=>h(l,n,e,"ReduceLogSum",()=>["value = 0.0;","value += _A(inputIdx);","value = log(value);"]),t.reduceLogSumSquare=(l,n,e)=>h(l,n,e,"ReduceLogSumSquare",()=>["float t; value = 0.0;","t = _A(inputIdx); value += t * t;",""])},7019:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isReshapeCheap=t.processDims3D=t.createPackedReshape3DProgramInfoLoader=void 0;const i=r(2517),s=r(5060),c=r(2039),a=r(2827);t.createPackedReshape3DProgramInfoLoader=(h,p,d)=>{const l=(n=>({name:"Reshape (packed)",inputTypes:[c.TextureType.packed],inputNames:["A"],cacheHint:`${n}`}))(d);return Object.assign(Object.assign({},l),{get:()=>((n,e,o,u)=>{const g=e.dims,m=u;let y="";for(let x=0;x<4;x++){let w="";switch(x){case 0:w="outputCoords = rc;";break;case 1:w="outputCoords = ivec3(rc.x, rc.y+1, rc.z);";break;case 2:w="outputCoords = ivec3(rc.x, rc.y, rc.z+1);";break;case 3:w="outputCoords = ivec3(rc.x, rc.y+1, rc.z+1);";break;default:throw new Error}y+=`
        ${w}
        ${x>0?"if(outputCoords.y < rows && outputCoords.z < cols){":""}
          int flattenedIndex = getFlattenedIndex(outputCoords);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flattenedIndex);
          vec2 innerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${x}] = getChannel(getA(inputRC.x, inputRC.y, inputRC.z), innerDims);

        ${x>0?"}":""}
      `}const b=(0,s.getGlsl)(n.session.backend.glContext.version),_=`
      ${function(x){const w=i.ShapeUtil.computeStrides(x),T=["b","r","c"],S="index";return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${w.map((I,v)=>`int ${T[v]} = ${S} / ${I}; ${v===w.length-1?`int ${T[v+1]} = ${S} - ${T[v]} * ${I}`:`index -= ${T[v]} * ${I}`};`).join("")}
      return ivec3(b, r, c);
    }
  `}(g)}
      ${function(x){const w=i.ShapeUtil.computeStrides(x);return`
  int getFlattenedIndex(ivec3 coords) {
    // reverse y, z order
    return coords.x * ${w[0]} + coords.z * ${w[1]} + coords.y;
  }
`}(m)}
      ${(0,a.unpackFromChannel)()}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.0);

        ivec3 outputCoords;
        int rows = ${m[2]};
        int cols = ${m[1]};

        ${y}
        ${b.output} = result;
      }
    `;return Object.assign(Object.assign({},o),{output:{dims:m,type:e.type,textureType:c.TextureType.packed},shaderSource:_,hasMain:!0})})(h,p,l,d)})},t.processDims3D=function(h){if(h.length===0)return[1,1,1];let p=1;for(let d=0;d<h.length-2;++d)p*=h[d];return[p,h.length>1?h[h.length-2]:1,h[h.length-1]]},t.isReshapeCheap=function(h,p){let d=!1;return d=h.length===0||p.length===0||(h.length<2||p.length<2?h[h.length-1]===p[p.length-1]:h[h.length-1]===p[p.length-1]&&h[h.length-2]===p[p.length-2]),d}},718:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reshape=void 0;const i=r(2517);t.reshape=(s,c)=>{const a=i.ShapeUtil.calculateReshapedDims(c[0].dims,c[1].integerData);return s.session.pack?[s.reshapePacked(c[0],a)]:[s.reshapeUnpacked(c[0],a)]}},2268:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseResizeAttributesV11=t.parseResizeAttributesV10=t.resize=void 0;const i=r(5060),s=r(2039),c=r(9390),a=r(2827),h=r(9793),p={name:"Resize",inputNames:["A"],inputTypes:[s.TextureType.packed]};t.resize=(o,u,g)=>((0,h.validateInputs)(u,g),[o.run(Object.assign(Object.assign({},p),{cacheHint:g.cacheKey,get:()=>d(o,u,g)}),u)]),t.parseResizeAttributesV10=o=>(0,h.parseUpsampleAttributes)(o,10),t.parseResizeAttributesV11=o=>(0,h.parseUpsampleAttributes)(o,11);const d=(o,u,g)=>{const m=(0,i.getGlsl)(o.session.backend.glContext.version),[y,b]=l(u,g);if(y.every(D=>D===1)&&g.coordinateTransformMode!=="tf_crop_and_resize")return Object.assign(Object.assign({},p),{output:{dims:b,type:u[0].type,textureType:s.TextureType.packed},hasMain:!0,shaderSource:`void main() {
                    vec4 v = ${m.texture2D}(X, TexCoords);
                    ${m.output} = v;
                }`});const _=b.length;if(_<2)throw new Error(`output dimension should be at least 2, but got ${_}`);const x=b[_-2],w=b[_-1],T=u[0].dims;if(_!==T.length)throw new Error(`output dimension should match input ${T.length}, but got ${_}`);const S=T[_-2],I=T[_-1],v=y[_-2],A=y[_-1];let L="";if(g.mode!=="linear")throw new Error(`resize (packed) does not support mode: '${g.mode}'`);switch(g.coordinateTransformMode){case"asymmetric":L=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        return vec4(coords) / scaleWHWH;
                    }
                `;break;case"half_pixel":L=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        return (vec4(coords) + 0.5) / scaleWHWH - 0.5;
                    }
                `;break;case"pytorch_half_pixel":L=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        vec4 fcoords = vec4(coords);
                        return vec4(
                            ${w}.0 > 1.0 ? (fcoords.x + 0.5) / scaleWHWH.x - 0.5 : 0.0,
                            ${x}.0 > 1.0 ? (fcoords.y + 0.5) / scaleWHWH.y - 0.5 : 0.0,
                            ${w}.0 > 1.0 ? (fcoords.z + 0.5) / scaleWHWH.z - 0.5 : 0.0,
                            ${x}.0 > 1.0 ? (fcoords.w + 0.5) / scaleWHWH.w - 0.5 : 0.0
                          );
                    }
                `;break;case"align_corners":L=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        vec4 resized = vec4(${w}.0 - 1.0, ${x}.0 - 1.0, ${w}.0 - 1.0,
                            ${x}.0 - 1.0);
                        vec4 original = vec4(${I}.0 - 1.0, ${S}.0 - 1.0, ${I}.0 - 1.0,
                            ${S}.0 - 1.0);
                        vec4 new_scale = original / resized;
                        return vec4(coords) * new_scale;
                    }
                `;break;default:throw new Error(`resize (packed) does not support coordinateTransformMode:                                 '${g.coordinateTransformMode}'`)}const N=(0,c.getCoordsDataType)(_),$=`
            const vec2 inputWH = vec2(${S}.0, ${I}.0);
            const vec4 scaleWHWH = vec4(float(${v}), float(${A}), float(${v}), float(${A}));
            ${(0,a.unpackFromChannel)()}
            ${L}
            float getAValue(int x10, int r, int c, int d) {
                return getChannel(getA(x10, r, c, d), vec2(c, d));
            }
            void main() {
                ${N} rc = getOutputCoords();

                int batch = rc[0];
                int depth = rc[1];

                // retrieve the 4 coordinates that is used in the 4 packed output values.
                ivec4 coords = ivec4(rc.wz, rc.w + 1, rc.z + 1);

                // calculate the source index in fraction
                vec4 sourceFrac = getSourceFracIndex(coords);

                // get the lower and upper bound of the 4 values that will be packed into one texel.
                ivec4 x00 = ivec4(max(sourceFrac.xy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xy)));
                ivec4 x01 = ivec4(max(sourceFrac.xw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xw)));
                ivec4 x10 = ivec4(max(sourceFrac.zy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zy)));
                ivec4 x11 = ivec4(max(sourceFrac.zw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zw)));

                bool hasNextRow = rc.w < ${x-1};
                bool hasNextCol = rc.z < ${w-1};

                // pack x00, x01, x10, x11's top-left corner into one vec4 structure
                vec4 topLeft = vec4(
                    getAValue(batch, depth, x00.x, x00.y),
                    hasNextCol ? getAValue(batch, depth, x01.x, x01.y) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.x, x10.y) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.y) : 0.0);

                // pack x00, x01, x10, x11's top-right corner into one vec4 structure
                vec4 topRight = vec4(
                    getAValue(batch, depth, x00.x, x00.w),
                    hasNextCol ? getAValue(batch, depth, x01.x, x01.w) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.x, x10.w) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.w) : 0.0);

                // pack x00, x01, x10, x11's bottom-left corner into one vec4 structure
                vec4 bottomLeft = vec4(
                    getAValue(batch, depth, x00.z, x00.y),
                    hasNextCol ? getAValue(batch, depth, x01.z, x01.y) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.z, x10.y) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.y) : 0.0);

                // pack x00, x01, x10, x11's bottom-right corner into one vec4 structure
                vec4 bottomRight = vec4(
                    getAValue(batch, depth, x00.z, x00.w),
                    hasNextCol ? getAValue(batch, depth, x01.z, x01.w) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.z, x10.w) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.w) : 0.0);

                // calculate the interpolation fraction on u and v direction
                vec4 frac = vec4(sourceFrac) - floor(sourceFrac);
                vec4 clampFrac = clamp(frac, vec4(0.0), vec4(1.0));

                vec4 top = mix(topLeft, topRight, clampFrac.ywyw);
                vec4 bottom = mix(bottomLeft, bottomRight, clampFrac.ywyw);
                vec4 newValue = mix(top, bottom, clampFrac.xxzz);

                ${m.output} = vec4(newValue);
            }
        `;return Object.assign(Object.assign({},p),{output:{dims:b,type:u[0].type,textureType:s.TextureType.packed},hasMain:!0,shaderSource:$})},l=(o,u)=>{const g=o[0].dims;let m,y=u.scales;if(y.length===0){const _=o[u.scalesInputIdx];if(_&&_.size!==0){if(o[u.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");y=n(_,u.mode,u.isResize)}else{const x=o[u.sizesInputIdx];if(!x||x.size===0)throw new Error("Either scales or sizes MUST be provided as input.");m=Array.from(x.integerData),y=e(m,g,u.mode,u.isResize)}}else if(o[u.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");const b=m||g.map((_,x)=>Math.floor(_*y[x]));return[y,b]},n=(o,u,g)=>{const m=Array.from(o.floatData);return(0,h.scalesValidation)(m,u,g),m},e=(o,u,g,m)=>{const y=u.length,b=new Array(y);for(let _=0,x=y;_<x;_++)if(u[_]===0){if(o[_]!==0)throw new Error("Input dim is zero but required output dim is non-zero.");b[_]=1}else b[_]=o[_]/u[_];return(0,h.scalesValidation)(b,g,m),b}},8117:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.shape=void 0;const i=r(9162);t.shape=(c,a)=>(s(a),[new i.Tensor([a[0].dims.length],"int32",void 0,void 0,new Int32Array(a[0].dims))]);const s=c=>{if(!c||c.length!==1)throw new Error("Shape requires 1 input.")}},2278:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sliceV10=t.parseSliceAttributes=t.slice=void 0;const i=r(246),s=r(782),c=r(2517),a=r(2039),h={name:"Slice",inputNames:["A"],inputTypes:[a.TextureType.unpacked]};t.slice=(e,o,u)=>(d(o),[e.run(Object.assign(Object.assign({},h),{cacheHint:u.cacheKey,get:()=>p(e,o[0],u)}),o)]),t.parseSliceAttributes=e=>{const o=e.attributes.getInts("starts"),u=e.attributes.getInts("ends"),g=e.attributes.getInts("axes",[]);return(0,i.createAttributeWithCacheKey)({starts:o,ends:u,axes:g})};const p=(e,o,u)=>{const g=u.axes.length===0?o.dims.slice(0).map((T,S)=>S):u.axes,m=c.ShapeUtil.normalizeAxes(g,o.dims.length),y=u.starts.map((T,S)=>T>o.dims[m[S]]-1?o.dims[m[S]]:c.ShapeUtil.normalizeAxis(T,o.dims[m[S]])),b=u.ends.map((T,S)=>T>o.dims[m[S]]-1?o.dims[m[S]]:c.ShapeUtil.normalizeAxis(T,o.dims[m[S]])),_=o.dims.slice(),x=[];for(let T=0;T<m.length;T++)_[m[T]]=b[T]-y[T],y[T]>0&&x.push(`outputIdx[${m[T]}] += ${y[T]};`);const w=`
      float process(int outputIdx[${_.length}]) {
        ${x.join(`
      `)}
        return _A(outputIdx);
      }`;return Object.assign(Object.assign({},h),{output:{dims:_,type:o.type,textureType:a.TextureType.unpacked},shaderSource:w})},d=e=>{if(!e||e.length!==1)throw new Error("Slice requires 1 input.");if(s.NUMBER_TYPES.indexOf(e[0].type)===-1)throw new Error("Invalid input type.")};t.sliceV10=(e,o)=>{n(o);const u=l(e,o);return[e.run(Object.assign(Object.assign({},h),{cacheHint:u.cacheKey,get:()=>p(e,o[0],u)}),[o[0]])]};const l=(e,o)=>{if(!e.session.isInitializer(o[1].dataId)||!e.session.isInitializer(o[2].dataId)||o.length>=4&&!e.session.isInitializer(o[3].dataId)||o.length>=5&&!e.session.isInitializer(o[4].dataId))throw new Error("dynamic slice attributes are not allowed");if(o.length>=5&&o[4].integerData.some(y=>y!==1))throw new Error("currently non-1 steps is not supported for Slice");const u=Array.from(o[1].integerData),g=Array.from(o[2].integerData),m=o.length>=4?Array.from(o[3].integerData):[];return{starts:u,ends:g,axes:m,cacheKey:`${m};${u};${g}`}},n=e=>{if(!e||e.length<3||e.length>5)throw new Error("Invalid input number.");if(e[1].type!=="int32"||e[1].dims.length!==1)throw new Error("Invalid input type.");if(e[2].type!=="int32"||e[2].dims.length!==1)throw new Error("Invalid input type.");if(e.length>=4&&(e[3].type!=="int32"||e[3].dims.length!==1))throw new Error("Invalid input type.");if(e.length>=5&&(e[4].type!=="int32"||e[4].dims.length!==1))throw new Error("Invalid input type.")}},5524:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.softmaxV13=t.parseSoftmaxAttributesV13=t.parseSoftmaxAttributes=t.softmax=void 0;const i=r(246),s=r(2517),c=r(5060),a=r(2039),h=r(3738),p={name:"SoftmaxComputeMax",inputNames:["A"],inputTypes:[a.TextureType.unpacked]},d={name:"SoftmaxComputeScale",inputNames:["A","Max"],inputTypes:[a.TextureType.unpacked,a.TextureType.unpacked]},l={name:"SoftMax",inputNames:["A","Max","Norm"],inputTypes:[a.TextureType.unpacked,a.TextureType.unpacked,a.TextureType.unpacked]};t.softmax=(m,y,b)=>{g(y);const _=y[0].dims.slice(),x=s.ShapeUtil.normalizeAxis(b.axis,_.length),w=s.ShapeUtil.sizeToDimension(_,x),T=s.ShapeUtil.sizeFromDimension(_,x);return n(m,y,b,w,T)},t.parseSoftmaxAttributes=m=>(0,i.createAttributeWithCacheKey)({axis:m.attributes.getInt("axis",1)}),t.parseSoftmaxAttributesV13=m=>(0,i.createAttributeWithCacheKey)({axis:m.attributes.getInt("axis",-1)}),t.softmaxV13=(m,y,b)=>{g(y);const _=y[0].dims.slice(),x=s.ShapeUtil.normalizeAxis(b.axis,_.length),w=_.length,T=x!==w-1,S=[];let I,v=[],A=[];T&&(v=Array.from({length:w}).map((D,R)=>R),v[x]=w-1,v[w-1]=x,v.map(D=>S.push(_[D])),I=(0,i.createAttributeWithCacheKey)({perm:v}),A=(0,h.transpose)(m,y,I));const L=T?s.ShapeUtil.sizeToDimension(S,w-1):s.ShapeUtil.sizeToDimension(_,w-1),N=T?s.ShapeUtil.sizeFromDimension(S,w-1):s.ShapeUtil.sizeFromDimension(_,w-1),$=n(m,T?A:y,b,L,N);return T?(0,h.transpose)(m,$,I):$};const n=(m,y,b,_,x)=>{const w=e(m,y[0],_,x,[_]),T=m.run(Object.assign(Object.assign({},p),{cacheHint:b.cacheKey,get:()=>w}),y),S=o(m,y[0],_,x,w.output.dims,[_]),I=m.run(Object.assign(Object.assign({},d),{cacheHint:b.cacheKey,get:()=>S}),[y[0],T]),v=u(m,y[0],_,x,w.output.dims,S.output.dims);return[m.run(Object.assign(Object.assign({},l),{cacheHint:b.cacheKey,get:()=>v}),[y[0],T,I])]},e=(m,y,b,_,x)=>{const[w,T]=m.calculateTextureWidthAndHeight(y.dims,a.TextureType.unpacked),S=x.length;if(b<1||_<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(x.length!==1)throw new Error("Dimensionality of the output should be 1");if(x[0]!==b)throw new Error("Shape of the output should be equal to logical row count");const I=(0,c.getGlsl)(m.session.backend.glContext.version),v=`
      float process(int[${S}] indices) {
        int logical_row_start_offset = indices[0] * ${_};

        float max = getColorAsFloat(${I.texture2D}(A, offsetToCoords(logical_row_start_offset, ${w},
        ${T} )));
        for(int i=1; i<${_}; ++i)
        {
          float current = getColorAsFloat(${I.texture2D}(A, offsetToCoords(logical_row_start_offset + i,
            ${w}, ${T})));
          if(current > max)
          max = current;
        }

        return max;
      }`;return Object.assign(Object.assign({},p),{output:{dims:x,type:y.type,textureType:a.TextureType.unpacked},shaderSource:v})},o=(m,y,b,_,x,w)=>{const[T,S]=m.calculateTextureWidthAndHeight(y.dims,a.TextureType.unpacked),I=w.length;if(b<1||_<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(w.length!==1)throw new Error("Dimensionality of the output should be 1");if(w[0]!==b)throw new Error("Shape of the output should be equal to logical row count");if(x.length!==1)throw new Error("Dimensionality of the intermediate results should be 1");if(x[0]!==b)throw new Error("Shape of the intermediate results should be equal to logical row count");const v=`
      float process(int[${I}] indices) {
        int logical_row_start_offset = indices[0] * ${_};

        float norm_factor = 0.0;
        float max = _Max(indices);
        for(int i=0; i<${_}; ++i)
        {
          norm_factor += exp(getColorAsFloat(${(0,c.getGlsl)(m.session.backend.glContext.version).texture2D}(A, offsetToCoords(logical_row_start_offset + i,
            ${T}, ${S}))) - max);
        }

        return norm_factor;
      }`;return Object.assign(Object.assign({},d),{output:{dims:w,type:y.type,textureType:a.TextureType.unpacked},shaderSource:v})},u=(m,y,b,_,x,w)=>{const[T,S]=m.calculateTextureWidthAndHeight(y.dims,a.TextureType.unpacked),I=y.dims.length;if(b<1||_<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(x.length!==1||w.length!==1)throw new Error("Dimensionality of the intermediate results should be 1");if(x[0]!==b||w[0]!==b)throw new Error("Shape of the intermediate results should be equal to logical row count");const v=`
      float process(int[${I}] indices) {

      // get offset of current logical tensor index from the 2-D texture coordinates (TexCoords)
      int offset = coordsToOffset(TexCoords, ${T}, ${S});

      //determine the logical row for this index
      int logical_row_index[1];
      logical_row_index[0] = offset / ${_};

      float norm_factor = _Norm(logical_row_index);

      // avoid possible division by 0
      // if norm_facor is 0, all elements are zero
      // if so, return 0
      if(norm_factor == 0.0)
        return 0.0;

      return exp(_A(indices) - _Max(logical_row_index)) / norm_factor;
    }`;return Object.assign(Object.assign({},l),{output:{dims:y.dims,type:y.type,textureType:a.TextureType.unpacked},shaderSource:v})},g=m=>{if(!m||m.length!==1)throw new Error("Softmax requires 1 input.");if(m[0].type!=="float32"&&m[0].type!=="float64")throw new Error("Invalid input type")}},5975:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseSplitAttributes=t.split=void 0;const i=r(246),s=r(2517),c=r(2039),a={name:"Split",inputNames:["A"],inputTypes:[c.TextureType.unpacked]};t.split=(l,n,e)=>{d(n);const o=s.ShapeUtil.normalizeAxis(e.axis,n[0].dims.length),u=h(l,n,o,e),g=[];for(let m=0;m<u;++m)g.push(l.run(Object.assign(Object.assign({},a),{cacheHint:`${e.cacheKey};${m}`,get:()=>p(l,n[0],e,o,m)}),n));return g},t.parseSplitAttributes=l=>{const n=l.attributes.getInt("axis",0),e=l.attributes.getInts("split",[]),o=l.outputs.length;return(0,i.createAttributeWithCacheKey)({axis:n,split:e,numOutputs:o})};const h=(l,n,e,o)=>{const[,u]=s.SplitUtil.splitShape(n[0].dims,e,o.split,o.numOutputs);return u.length},p=(l,n,e,o,u)=>{const[g,m]=s.SplitUtil.splitShape(n.dims,o,e.split,e.numOutputs),y=m[u],b=g[u],_=`
      float process(int indices[${b.length}]) {
        indices[${o}] += ${y};
        return _A(indices);
      }
    `;return Object.assign(Object.assign({},a),{cacheHint:`${e.cacheKey}:${u}`,output:{dims:b,type:n.type,textureType:c.TextureType.unpacked},shaderSource:_})},d=l=>{if(!l||l.length!==1)throw new Error("Split requires one input.");if(l[0].type!=="int8"&&l[0].type!=="uint8"&&l[0].type!=="int16"&&l[0].type!=="uint16"&&l[0].type!=="int32"&&l[0].type!=="uint32"&&l[0].type!=="float32"&&l[0].type!=="float64"&&l[0].type!=="bool")throw new Error("Invalid input type.")}},3933:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseSqueezeAttributes=t.squeezeV13=t.squeeze=void 0;const i=r(2517);t.squeeze=(a,h,p)=>{s(h);const d=i.ShapeUtil.squeezeShape(h[0].dims,p);return[a.reshapeUnpacked(h[0],d)]},t.squeezeV13=(a,h)=>(c(h),(0,t.squeeze)(a,[h[0]],Array.from(h[1].integerData))),t.parseSqueezeAttributes=a=>a.attributes.getInts("axes");const s=a=>{if(!a||a.length!==1)throw new Error("Squeeze requires 1 input.");if(a[0].type==="string")throw new Error("invalid input tensor types.")},c=a=>{if(!a||a.length!==2)throw new Error("Squeeze requires 2 inputs.");if(a[1].type!=="int32")throw new Error("Invalid input type.")}},6558:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sum=void 0;const i=r(5060),s=r(2039);t.sum=(h,p)=>{a(p);const d={name:"Sum",inputNames:p.map((l,n)=>`X${n}`),inputTypes:new Array(p.length).fill(s.TextureType.unpacked)};return[h.run(Object.assign(Object.assign({},d),{get:()=>c(h,p,d)}),p)]};const c=(h,p,d)=>{const l=(0,i.getGlsl)(h.session.backend.glContext.version),n=p[0].dims.slice(),e=`
      void main() {
        vec4 result = ${p.map((o,u)=>`${l.texture2D}(X${u},TexCoords)`).join(" + ")};
        ${l.output} = result;
      }
    `;return Object.assign(Object.assign({},d),{output:{dims:n,type:p[0].type,textureType:s.TextureType.unpacked},hasMain:!0,shaderSource:e})},a=h=>{if(!h||h.length===0)throw new Error("Sum requires inputs.");const p=h[0].dims.length;for(let d=1;d<h.length;d++){if(p!==h[d].dims.length)throw new Error("Input shapes are mismatched.");for(let l=0;l<p;l++)if(h[0].dims[l]!==h[d].dims[l])throw new Error("Input shapes are not matched.")}if(h[0].type!=="float32"&&h[0].type!=="float64")throw new Error("Invalid input type.");for(let d=1;d<h.length;d++)if(h[0].type!==h[d].type)throw new Error("Input types are not matched.")}},5723:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tile=void 0;const i=r(782),s=r(2039);t.tile=(h,p)=>{a(p);const d={name:"Tile",inputNames:["A"],inputTypes:[s.TextureType.unpacked]};return[h.run(Object.assign(Object.assign({},d),{get:()=>c(h,p,d)}),p)]};const c=(h,p,d)=>{const l=p[0].dims.slice(),n=new Array(l.length),e=[];for(let g=0;g<l.length;g++)n[g]=l[g]*p[1].numberData[g],e.push(`inputIdx[${g}] = int(mod(float(outputIdx[${g}]), ${l[g]}.));`);const o=n.length,u=`
      float process(int outputIdx[${o}]) {
        int inputIdx[${o}];
        ${e.join(`
`)}
        return _A(inputIdx);
      }
    `;return Object.assign(Object.assign({},d),{output:{dims:n,type:p[0].type,textureType:s.TextureType.unpacked},shaderSource:u})},a=h=>{if(!h||h.length!==2)throw new Error("Tile requires 2 input.");if(h[1].dims.length!==1)throw new Error("The second input shape must 1 dimension.");if(h[1].dims[0]!==h[0].dims.length)throw new Error("Invalid input shape.");if(i.NUMBER_TYPES.indexOf(h[0].type)===-1)throw new Error("Invalid input type.");if(h[1].type!=="int32"&&h[1].type!=="int16")throw new Error("Invalid repeat type.")}},3738:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseTransposeAttributes=t.transpose=void 0;const i=r(246),s=r(2517),c=r(2039),a={name:"Transpose",inputNames:["A"],inputTypes:[c.TextureType.unpacked]};t.transpose=(e,o,u)=>(n(o),[e.run(Object.assign(Object.assign({},a),{cacheHint:u.cacheKey,get:()=>h(e,o[0],u.perm)}),o)]),t.parseTransposeAttributes=e=>(0,i.createAttributeWithCacheKey)({perm:e.attributes.getInts("perm",[])});const h=(e,o,u)=>{const g=o.dims;u=p(g,u);const m=d(g,u),y=g.length,b=`
      ${l("perm",u,y)}
      float process(int indices[${y}]) {
        int a[${y}];
        perm(a, indices);
        return _A(a);
      }`;return Object.assign(Object.assign({},a),{output:{dims:m,type:o.type,textureType:c.TextureType.unpacked},shaderSource:b})},p=(e,o)=>(o&&o.length!==e.length&&(o=[...e.keys()].reverse()),o),d=(e,o)=>(o=p(e,o),s.ShapeUtil.sortBasedOnPerm(e,o)),l=(e,o,u)=>{const g=[];g.push(`void ${e}(out int a[${u}], int src[${u}]) {`);for(let m=0;m<u;++m)g.push(`	a[${o[m]}]=src[${m}];`);return g.push("	}"),g.join(`
`)},n=e=>{if(!e||e.length!==1)throw new Error("Transpose requires 1 input.");if(e[0].type!=="float32"&&e[0].type!=="float64")throw new Error("input should be float tensor")}},8710:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.encodeAsUint8=void 0;const i=r(5060),s=r(2039);t.encodeAsUint8=(c,a)=>{const h=a.shape,p=(0,i.getGlsl)(c.session.backend.glContext.version),d=`
    const float FLOAT_MAX = 1.70141184e38;
    const float FLOAT_MIN = 1.17549435e-38;

    bool isNaN(float val) {
      return (val < 1.0 || 0.0 < val || val == 0.0) ? false : true;
    }

    highp vec4 encodeAsUint8(highp float v) {
      if (isNaN(v)) {
        return vec4(255, 255, 255, 255);
      }

      highp float av = abs(v);

      if(av < FLOAT_MIN) {
        return vec4(0.0, 0.0, 0.0, 0.0);
      } else if(v > FLOAT_MAX) {
        return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
      } else if(v < -FLOAT_MAX) {
        return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
      }

      highp vec4 c = vec4(0,0,0,0);

      highp float e = floor(log2(av));
      highp float m = exp2(fract(log2(av))) - 1.0;

      c[2] = floor(128.0 * m);
      m -= c[2] / 128.0;
      c[1] = floor(32768.0 * m);
      m -= c[1] / 32768.0;
      c[0] = floor(8388608.0 * m);

      highp float ebias = e + 127.0;
      c[3] = floor(ebias / 2.0);
      ebias -= c[3] * 2.0;
      c[2] += floor(ebias) * 128.0;

      c[3] += 128.0 * step(0.0, -v);

      return c / 255.0;
    }

    void main() {
      float value = ${p.texture2D}(X,TexCoords).r;
      ${p.output} = encodeAsUint8(value);
    }`,l={name:"Uint8Encode",inputTypes:[s.TextureType.unpacked],inputNames:["X"],output:{dims:h,type:a.tensor.type,textureType:s.TextureType.downloadUint8AsFloat},shaderSource:d,hasMain:!0};return c.executeProgram(l,[a.tensor])}},4909:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tanh=t.tan=t.sqrt=t.sin=t.sigmoid=t.relu=t.not=t.neg=t.log=t.parseLeakyReluAttributes=t.leakyRelu=t.identity=t.floor=t.exp=t.parseEluAttributes=t.elu=t.cos=t.ceil=t.clipV11=t.parseClipAttributes=t.clip=t.atan=t.asin=t.acos=t.abs=t.glslTanh=t.glslTan=t.glslSqrt=t.glslSigmoid=t.glslRelu=t.glslSin=t.glslNot=t.glslNeg=t.glslLog=t.glslLeakyRelu=t.glslIdentity=t.glslClip=t.glslFloor=t.glslExp=t.glslElu=t.glslCos=t.glslCeil=t.glslAtan=t.glslAsin=t.glslAcos=t.glslAbs=void 0;const i=r(246),s=r(2517),c=r(8520),a=r(5060),h=r(2039);function p(){return $("abs")}function d(){return $("acos")}function l(){return $("asin")}function n(){return $("atan")}function e(){return $("ceil")}function o(){return $("cos")}function u(O){const F="elu";return{body:`
  const float alpha = float(${O});

  float ${F}_(float a) {
    return a >= 0.0 ? a: (exp(a) - 1.0) * alpha;
  }
  vec4 ${F}_(vec4 v) {
    return vec4(${F}_(v.x), ${F}_(v.y), ${F}_(v.z), ${F}_(v.w));
  }
  `,name:F,type:c.FunctionType.ValueBased}}function g(){return $("exp")}function m(){return $("floor")}function y(O,F){const z="clip";return{body:`
  const float min = float(${O});
  const float max = float(${F});

  float ${z}_(float a) {
    return clamp(a, min, max);
  }
  vec4 ${z}_(vec4 v) {
    return clamp(v, min, max);
  }
  `,name:z,type:c.FunctionType.ValueBased}}function b(){const O="indentity";return{body:`
  float ${O}_(float a) {
    return a;
  }
  vec4 ${O}_(vec4 v) {
    return v;
  }
  `,name:O,type:c.FunctionType.ValueBased}}function _(O){const F="leakyRelu";return{body:`
  const float alpha = float(${O});

  float ${F}_(float a) {
    return a < 0.0 ? a * alpha : a;
  }
  vec4 ${F}_(vec4 v) {
    return vec4(${F}_(v.x), ${F}_(v.y), ${F}_(v.z), ${F}_(v.w));
  }
  `,name:F,type:c.FunctionType.ValueBased}}function x(){return $("log")}function w(){const O="neg";return{body:`
  float ${O}_(float a) {
    return -a;
  }
  vec4 ${O}_(vec4 v) {
    return -v;
  }
  `,name:O,type:c.FunctionType.ValueBased}}function T(){const O="not";return{body:`
  float ${O}_(float a) {
    return float( ! bool(a) );
  }
  bool ${O}_(bool a) {
    return !a;
  }
  vec4 ${O}_(vec4 v) {
    return vec4(!bool(v.x), !bool(v.y), !bool(v.z), !bool(v.w));
  }
  bvec4 ${O}_(bvec4 v) {
    return bvec4(!v.x, !v.y, !v.z, !v.w);
  }
  `,name:O,type:c.FunctionType.ValueBased}}function S(){return $("sin")}function I(){const O="relu";return{body:`
  float ${O}_(float a) {
    return max( a, 0.0 );
  }
  vec4 ${O}_(vec4 v) {
    return max( v, 0.0 );
  }
  `,name:O,type:c.FunctionType.ValueBased}}function v(){const O="sigmoid";return{body:`
  float ${O}_(float a) {
    return 1.0 / (1.0 + exp(-a));
  }
  vec4 ${O}_(vec4 v) {
    return 1.0 / (1.0 + exp(-v));
  }
  `,name:O,type:c.FunctionType.ValueBased}}function A(){return $("sqrt")}function L(){return $("tan")}function N(){const O="tanh";return{body:`
  float ${O}_(float a) {
    a = clamp(a, -10., 10.);
    a = exp(2.*a);
    return (a - 1.) / (a + 1.);
  }
  vec4 ${O}_(vec4 v) {
    v = clamp(v, -10., 10.);
    v = exp(2.*v);
    return (v - 1.) / (v + 1.);
  }
  `,name:O,type:c.FunctionType.ValueBased}}function $(O){return{body:`
  float ${O}_(float a) {
    return ${O}(a);
  }
  vec4 ${O}_(vec4 v) {
    return ${O}(v);
  }
  `,name:O,type:c.FunctionType.ValueBased}}t.glslAbs=p,t.glslAcos=d,t.glslAsin=l,t.glslAtan=n,t.glslCeil=e,t.glslCos=o,t.glslElu=u,t.glslExp=g,t.glslFloor=m,t.glslClip=y,t.glslIdentity=b,t.glslLeakyRelu=_,t.glslLog=x,t.glslNeg=w,t.glslNot=T,t.glslSin=S,t.glslRelu=I,t.glslSigmoid=v,t.glslSqrt=A,t.glslTan=L,t.glslTanh=N;const D=(O,F,z,W)=>{const Z=O.session.pack?h.TextureType.packed:h.TextureType.unpacked,J={name:z.name,inputTypes:[Z],inputNames:["A"],cacheHint:W};return Object.assign(Object.assign({},J),{get:()=>((nt,wt,K,st)=>{const Tt=nt.session.pack?h.TextureType.packed:h.TextureType.unpacked,xt=(0,a.getGlsl)(nt.session.backend.glContext.version);return Object.assign(Object.assign({},wt),{output:{dims:K.dims,type:K.type,textureType:Tt},shaderSource:`
     ${st.body}
     void main() {
       vec4 v = ${xt.texture2D}(A, TexCoords);
       v = ${st.name}_(v);
       ${xt.output} = v;
     }
     `,hasMain:!0})})(O,J,F,z)})};t.abs=(O,F)=>[O.run(D(O,F[0],p()),F)],t.acos=(O,F)=>[O.run(D(O,F[0],d()),F)],t.asin=(O,F)=>[O.run(D(O,F[0],l()),F)],t.atan=(O,F)=>[O.run(D(O,F[0],n()),F)],t.clip=(O,F,z)=>[O.run(D(O,F[0],y(z.min,z.max),z.cacheKey),F)],t.parseClipAttributes=O=>(0,i.createAttributeWithCacheKey)({min:O.attributes.getFloat("min",s.MIN_CLIP),max:O.attributes.getFloat("max",s.MAX_CLIP)}),t.clipV11=(O,F)=>{const z=R(O,F);return(0,t.clip)(O,[F[0]],z)};const R=(O,F)=>{if(F.length>=3&&(!O.session.isInitializer(F[1].dataId)||!O.session.isInitializer(F[2].dataId)))throw new Error("dynamic clip attributes are not allowed");const z=F.length>=3?F[1].numberData[0]:s.MIN_CLIP,W=F.length>=3?F[2].numberData[0]:s.MAX_CLIP;return(0,i.createAttributeWithCacheKey)({min:z,max:W})};t.ceil=(O,F)=>[O.run(D(O,F[0],e()),F)],t.cos=(O,F)=>[O.run(D(O,F[0],o()),F)],t.elu=(O,F,z)=>[O.run(D(O,F[0],u(z.alpha),z.cacheKey),F)],t.parseEluAttributes=O=>(0,i.createAttributeWithCacheKey)({alpha:O.attributes.getFloat("alpha",1)}),t.exp=(O,F)=>[O.run(D(O,F[0],g()),F)],t.floor=(O,F)=>[O.run(D(O,F[0],m()),F)],t.identity=(O,F)=>[O.run(D(O,F[0],b()),F)],t.leakyRelu=(O,F,z)=>[O.run(D(O,F[0],_(z.alpha),z.cacheKey),F)],t.parseLeakyReluAttributes=O=>(0,i.createAttributeWithCacheKey)({alpha:O.attributes.getFloat("alpha",.01)}),t.log=(O,F)=>[O.run(D(O,F[0],x()),F)],t.neg=(O,F)=>[O.run(D(O,F[0],w()),F)],t.not=(O,F)=>[O.run(D(O,F[0],T()),F)],t.relu=(O,F)=>[O.run(D(O,F[0],I()),F)],t.sigmoid=(O,F)=>[O.run(D(O,F[0],v()),F)],t.sin=(O,F)=>[O.run(D(O,F[0],S()),F)],t.sqrt=(O,F)=>[O.run(D(O,F[0],A()),F)],t.tan=(O,F)=>[O.run(D(O,F[0],L()),F)],t.tanh=(O,F)=>[O.run(D(O,F[0],N()),F)]},5611:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createUnpackProgramInfoLoader=t.createUnpackProgramInfo=void 0;const i=r(5060),s=r(2039),c=r(9390),a=r(2827),h={name:"unpack",inputNames:["A"],inputTypes:[s.TextureType.packed]};t.createUnpackProgramInfo=(p,d)=>{const l=d.dims.length,n=(0,a.getChannels)("rc",l),e=n.slice(-2),o=(0,c.getCoordsDataType)(l),u=(0,a.unpackFromChannel)(),g=d.dims.length===0?"":function(b,_){if(b===1)return"rc";let x="";for(let w=0;w<b;w++)x+=_[w],w<b-1&&(x+=",");return x}(l,n),m=l<=1?"rc":`vec2(${e.join(",")})`,y=`
    ${u}
    void main() {
      ${o} rc = getOutputCoords();

       // Sample the texture with the coords to get the rgba channel value.
       vec4 packedInput = getA(${g});

       ${(0,i.getGlsl)(p.session.backend.glContext.version).output} = vec4(getChannel(packedInput, ${m}), 0, 0, 0);
     }
   `;return Object.assign(Object.assign({},h),{hasMain:!0,output:{dims:d.dims,type:d.type,textureType:s.TextureType.unpacked},shaderSource:y})},t.createUnpackProgramInfoLoader=(p,d)=>Object.assign(Object.assign({},h),{get:()=>(0,t.createUnpackProgramInfo)(p,d)})},8428:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseUnsqueezeAttributes=t.unsqueezeV13=t.unsqueeze=void 0;const i=r(2517);t.unsqueeze=(a,h,p)=>{s(h);const d=i.ShapeUtil.unsqueezeShape(h[0].dims,p);return[a.reshapeUnpacked(h[0],d)]},t.unsqueezeV13=(a,h)=>(c(h),(0,t.unsqueeze)(a,[h[0]],Array.from(h[1].integerData))),t.parseUnsqueezeAttributes=a=>a.attributes.getInts("axes");const s=a=>{if(!a||a.length!==1)throw new Error("Unsqueeze requires 1 input.");if(a[0].type==="string")throw new Error("invalid input tensor types.")},c=a=>{if(!a||a.length!==2)throw new Error("Unsqueeze requires 2 inputs.");if(a[1].type!=="int32")throw new Error("Invalid input type.")}},9793:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.scalesValidation=t.validateInputs=t.parseUpsampleAttributes=t.parseUpsampleAttributesV9=t.parseUpsampleAttributesV7=t.upsample=void 0;const i=r(246),s=r(5060),c=r(2039),a={name:"Upsample",inputNames:["X"],inputTypes:[c.TextureType.unpacked]};t.upsample=(p,d,l)=>((0,t.validateInputs)(d,l),[p.run(Object.assign(Object.assign({},a),{cacheHint:l.cacheKey,get:()=>h(p,d,l)}),d)]),t.parseUpsampleAttributesV7=p=>(0,t.parseUpsampleAttributes)(p,7),t.parseUpsampleAttributesV9=p=>(0,t.parseUpsampleAttributes)(p,9),t.parseUpsampleAttributes=(p,d)=>{const l=d>=10,n=p.attributes.getString("mode","nearest");if(n!=="nearest"&&n!=="linear"&&(d<11||n!=="cubic"))throw new Error(`unrecognized mode: ${n}`);let e=[];d<9&&(e=p.attributes.getFloats("scales"),(0,t.scalesValidation)(e,n,l));const o=p.attributes.getFloat("extrapolation_value",0),u=d>10?p.attributes.getString("coordinate_transformation_mode","half_pixel"):"asymmetric";if(["asymmetric","pytorch_half_pixel","tf_half_pixel_for_nn","align_corners","tf_crop_and_resize","half_pixel"].indexOf(u)===-1)throw new Error(`coordinate_transform_mode '${u}' is not supported`);const g=u==="tf_crop_and_resize",m=g,y=n==="nearest"&&d>=11?p.attributes.getString("nearest_mode","round_prefer_floor"):"";if(["round_prefer_floor","round_prefer_ceil","floor","ceil",""].indexOf(y)===-1)throw new Error(`nearest_mode '${y}' is not supported`);const b=p.attributes.getFloat("cubic_coeff_a",-.75),_=p.attributes.getInt("exclude_outside",0)!==0;if(_&&n!=="cubic")throw new Error("exclude_outside can be set to 1 only when mode is CUBIC.");const x=d<11||n==="nearest"&&u==="asymmetric"&&y==="floor";let w=0,T=0,S=0;return d>10?p.inputs.length>2?(w=1,T=2,S=3):(T=1,S=2):d===9&&(T=1),(0,i.createAttributeWithCacheKey)({opset:d,isResize:l,mode:n,scales:e,extrapolationValue:o,coordinateTransformMode:u,useExtrapolation:m,needRoiInput:g,nearestMode:y,cubicCoefficientA:b,excludeOutside:_,useNearest2xOptimization:x,roiInputIdx:w,scalesInputIdx:T,sizesInputIdx:S})};const h=(p,d,l)=>{const n=(0,s.getGlsl)(p.session.backend.glContext.version),[e,o]=p.calculateTextureWidthAndHeight(d[0].dims,c.TextureType.unpacked),u=d[0].dims.map((S,I)=>Math.floor(S*l.scales[I])),[g,m]=p.calculateTextureWidthAndHeight(u,c.TextureType.unpacked),y=u.length,b=new Array(y),_=new Array(y);let x=`
      int output_pitches[${y}];
      int input_pitches[${y}];
      `;for(let S=y-1;S>=0;S--)b[S]=S===y-1?1:b[S+1]*u[S+1],_[S]=S===y-1?1:_[S+1]*d[0].dims[S+1],x+=`
        output_pitches[${S}] = ${b[S]};
        input_pitches[${S}] = ${_[S]};
        `;const w=`
      float getInputFloat(int index) {
        vec2 coords = offsetToCoords(index, ${e}, ${o});
        float value = getColorAsFloat(${n.texture2D}(X, coords));
        return value;
      }
      `,T=l.mode==="nearest"?`
    ${w}
    float process(int indices[${y}]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${g}, ${m});

      ${x}

      int d, m;
      for (int dim = 0; dim < ${y}; ++dim) {
        d = output_index / output_pitches[dim];
        m = output_index - d * output_pitches[dim];
        output_index = m;

        if (scales[dim] != 1 && d > 0) {
          int d2 = d / scales[dim];
          m = d - d2 * scales[dim];
          d = d2;
        }
        input_index += input_pitches[dim] * d;
      }

      return getInputFloat(input_index);
    }`:y===4?`
    ${w}
    float process(int indices[4]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${g}, ${m});

      ${x}

      int m;
      int index_of_dim0, index_of_dim1, index_of_dim2, index_of_dim3;
      index_of_dim0 = output_index / output_pitches[0];
      m = output_index - index_of_dim0 * output_pitches[0];
      index_of_dim1 = m / output_pitches[1];
      m = m - index_of_dim1 * output_pitches[1];
      index_of_dim2 = m / output_pitches[2];
      m = m - index_of_dim2 * output_pitches[2];
      index_of_dim3 = m;

      int index_of_input_dim2, index_of_input_dim3, x_offset, y_offset;
      index_of_input_dim2 = index_of_dim2 / scales[2];
      y_offset = index_of_dim2 - index_of_input_dim2 * scales[2];
      index_of_input_dim3 = index_of_dim3 / scales[3];
      x_offset = index_of_dim3 - index_of_input_dim3 * scales[3];

      input_index = index_of_dim0 * input_pitches[0] +
            index_of_dim1 * input_pitches[1] +
            index_of_input_dim2 * input_pitches[2] +
            index_of_input_dim3;

      float x00 = getInputFloat(input_index);
      float x10, x01, x11;

      bool end_of_dim2 = false;
      if (index_of_input_dim2 == (${d[0].dims[2]} - 1)) {
        // It's the end in dimension 2
        x01 = x00;
        end_of_dim2 = true;
      } else {
        x01 = getInputFloat(input_index + input_pitches[2]);
      }

      if (index_of_input_dim3 == (input_pitches[2] - 1)) {
        // It's the end in dimension 3
        x10 = x00;
        x11 = x01;
      }
      else {
        x10 = getInputFloat(input_index + 1);
        x11 = end_of_dim2 ? x10 : getInputFloat(input_index + input_pitches[2] + 1);
      }

      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[2]);
      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[2]);
      return y0 + float(x_offset) * (y1 - y0) / float(scales[3]);
    }`:`
    ${w}
    float process(int indices[2]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${g}, ${m});

      ${x}

      int m;
      int index_of_dim0, index_of_dim1;
      index_of_dim0 = output_index / output_pitches[0];
      m = output_index - index_of_dim0 * output_pitches[0];
      index_of_dim1 = m;

      int index_of_input_dim0, index_of_input_dim1, x_offset, y_offset;
      index_of_input_dim0 = index_of_dim0 / scales[0];
      y_offset = index_of_dim0 - index_of_input_dim0 * scales[0];
      index_of_input_dim1 = index_of_dim1 / scales[1];
      x_offset = index_of_dim1 - index_of_input_dim1 * scales[1];

      input_index = index_of_input_dim0 * input_pitches[0] + index_of_input_dim1;

      float x00 = getInputFloat(input_index);
      float x10, x01, x11;

      bool end_of_dim0 = false;
      if (index_of_input_dim0 == (${d[0].dims[0]} - 1)) {
        // It's the end in dimension 0
        x01 = x00;
        end_of_dim0 = true;
      } else {
        x01 = getInputFloat(input_index + input_pitches[0]);
      }

      if (index_of_input_dim1 == (input_pitches[0] - 1)) {
        // It's the end in dimension 1
        x10 = x00;
        x11 = x01;
      }
      else {
        x10 = getInputFloat(input_index + 1);
        x11 = end_of_dim0 ? x10 : getInputFloat(input_index + input_pitches[0] + 1);
      }

      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[0]);
      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[0]);
      return y0 + float(x_offset) * (y1 - y0) / float(scales[1]);
    }`;return Object.assign(Object.assign({},a),{output:{dims:u,type:d[0].type,textureType:c.TextureType.unpacked},shaderSource:T,variables:[{name:"scales",type:"int",arrayLength:l.scales.length,data:l.scales.map(S=>Math.ceil(S))}]})};t.validateInputs=(p,d)=>{if(!p||d.opset<9&&p.length!==1||d.opset>=9&&d.opset<11&&p.length!==2||d.opset>=11&&p.length<2)throw new Error("invalid inputs.");if(d.scales.length>0&&p[0].dims.length!==d.scales.length)throw new Error("Invalid input shape.");if(p[0].type==="string")throw new Error("Invalid input tensor types.")},t.scalesValidation=(p,d,l)=>{if(l){for(const n of p)if(n<=0)throw new Error("Scale value should be greater than 0.")}else for(const n of p)if(n<1)throw new Error("Scale value should be greater than or equal to 1.");if(!(d!=="linear"&&d!=="cubic"||p.length===2||p.length===4&&p[0]===1&&p[1]===1))throw new Error(`'Linear' mode and 'Cubic' mode only support 2-D inputs ('Bilinear', 'Bicubic')         or 4-D inputs with the corresponding outermost 2 scale values being 1         in the ${l?"Resize":"Upsample"} opeartor.`)}},1958:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProgramManager=void 0;const i=r(1670),s=r(6231),c=r(8879),a=r(5060);t.ProgramManager=class{constructor(h,p,d){this.profiler=h,this.glContext=p,this.textureLayoutStrategy=d,this.repo=new Map,this.attributesBound=!1}getArtifact(h){return this.repo.get(h)}setArtifact(h,p){this.repo.set(h,p)}run(h,p,d){var l;this.profiler.event("op",`ProgramManager.run ${(l=h.programInfo.name)!==null&&l!==void 0?l:"unknown kernel"}`,()=>{var n;const e=this.glContext.gl,o=h.program;e.useProgram(o);try{this.bindOutput(d),this.attributesBound||this.bindAttributes(h.attribLocations),this.bindUniforms(h.uniformLocations,(n=h.programInfo.variables)!==null&&n!==void 0?n:[],p)}catch(u){throw s.Logger.error("ProgramManager",h.programInfo.shaderSource),u}this.profiler.event("backend","GlContext.draw()",()=>{this.glContext.draw()})},this.glContext)}dispose(){this.vertexShader&&this.glContext.deleteShader(this.vertexShader),this.repo.forEach(h=>this.glContext.deleteProgram(h.program))}build(h,p,d){return this.profiler.event("backend","ProgramManager.build",()=>{const l=new c.GlslPreprocessor(this.glContext,h,p,d),n=l.preprocess(),e=this.compile(n);return{programInfo:h,program:e,uniformLocations:this.getUniformLocations(e,l.context.programInfo.inputNames,l.context.programInfo.variables),attribLocations:this.getAttribLocations(e)}})}compile(h){if(!this.vertexShader){s.Logger.verbose("ProrgramManager","Compiling and caching Vertex shader for the first time");const l=(0,a.getVertexShaderSource)(this.glContext.version);this.vertexShader=this.glContext.compileShader(l,this.glContext.gl.VERTEX_SHADER)}i.env.debug&&s.Logger.verbose("ProrgramManager",`FragShader:
${h}
`);const p=this.glContext.compileShader(h,this.glContext.gl.FRAGMENT_SHADER),d=this.glContext.createProgram(this.vertexShader,p);return this.glContext.deleteShader(p),d}bindOutput(h){const p=h.width,d=h.height;s.Logger.verbose("ProrgramManager",`Binding output texture to Framebuffer: w/h=${p}/${d}, shape=${h.shape}, type=${h.tensor.type}`),this.glContext.attachFramebuffer(h.texture,p,d)}bindAttributes(h){const p=h.position,d=h.textureCoord;this.glContext.setVertexAttributes(p,d),this.attributesBound=!0}bindUniforms(h,p,d){var l;const n=this.glContext.gl;let e=0;for(const{name:o,type:u,location:g,arrayLength:m}of h){const y=(l=p.find(b=>b.name===o))===null||l===void 0?void 0:l.data;if(u!=="sampler2D"&&!y)throw new Error(`variable '${o}' does not have data defined in program info`);switch(u){case"sampler2D":this.bindTexture(d[e],g,e),e++;break;case"float":m?n.uniform1fv(g,y):n.uniform1f(g,y);break;case"int":m?n.uniform1iv(g,y):n.uniform1i(g,y);break;default:throw new Error(`Uniform not implemented: ${u}`)}}}bindTexture(h,p,d){this.glContext.bindTextureToUniform(h.texture,d,p)}getAttribLocations(h){return{position:this.getAttribLocation(h,"position"),textureCoord:this.getAttribLocation(h,"textureCoord")}}getUniformLocations(h,p,d){const l=[];if(p)for(const n of p)l.push({name:n,type:"sampler2D",location:this.getUniformLocation(h,n)});if(d)for(const n of d)l.push(Object.assign(Object.assign({},n),{location:this.getUniformLocation(h,n.name)}));return l}getUniformLocation(h,p){const d=this.glContext.gl.getUniformLocation(h,p);if(d===null)throw new Error(`Uniform ${p} not found.`);return d}getAttribLocation(h,p){return this.glContext.gl.getAttribLocation(h,p)}}},6416:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLSessionHandler=void 0;const i=r(6231),s=r(1047),c=r(8316),a=r(1640),h=r(1958),p=r(7859),d=r(5702);t.WebGLSessionHandler=class{constructor(l,n){this.backend=l,this.context=n,this.layoutStrategy=new p.PreferLogicalStrategy(l.glContext.maxTextureSize),this.programManager=new h.ProgramManager(this.context.profiler,l.glContext,this.layoutStrategy),this.textureManager=new d.TextureManager(l.glContext,this.layoutStrategy,this.context.profiler,{reuseTextures:l.textureCacheMode==="full"}),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map,this.pack=l.pack,this.pack2unpackMap=new Map,this.unpack2packMap=new Map}createInferenceHandler(){return new c.WebGLInferenceHandler(this)}onGraphInitialized(l){const n=l.getValues().filter(e=>e.from===-1&&e.tensor).map(e=>e.tensor.dataId);this.initializers=new Set(n)}isInitializer(l){return!!this.initializers&&this.initializers.has(l)}addInitializer(l){this.initializers.add(l)}getTextureData(l,n){return n?this.packedTextureDataCache.get(l):this.unpackedTextureDataCache.get(l)}setTextureData(l,n,e=!1){i.Logger.verbose("WebGLSessionHandler","Storing Texture data in cache"),e?this.packedTextureDataCache.set(l,n):this.unpackedTextureDataCache.set(l,n)}dispose(){this.programManager.dispose(),this.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach(l=>this.textureManager.releaseTexture(l,!0)),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach(l=>this.textureManager.releaseTexture(l,!0)),this.unpackedTextureDataCache=new Map}resolve(l,n,e){const o=(0,s.resolveOperator)(l,n,a.WEBGL_OP_RESOLVE_RULES);return{impl:o.opImpl,context:o.opInit?o.opInit(l,e):l}}}},7769:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Uint8DataEncoder=t.RGBAFloatDataEncoder=t.RedFloat32DataEncoder=void 0;const i=r(6231);t.RedFloat32DataEncoder=class{constructor(s,c=1){if(c===1)this.internalFormat=s.R32F,this.format=s.RED,this.textureType=s.FLOAT,this.channelSize=c;else{if(c!==4)throw new Error(`Invalid number of channels: ${c}`);this.internalFormat=s.RGBA32F,this.format=s.RGBA,this.textureType=s.FLOAT,this.channelSize=c}}encode(s,c){let a,h;return s.constructor!==Float32Array&&(i.Logger.warning("Encoder","data was not of type Float32; creating new Float32Array"),h=new Float32Array(s)),c*this.channelSize>s.length?(i.Logger.warning("Encoder","Source data too small. Allocating larger array"),h=s,a=this.allocate(c*this.channelSize),h.forEach((p,d)=>a[d]=p)):(h=s,a=h),a}allocate(s){return new Float32Array(4*s)}decode(s,c){return this.channelSize===1?s.filter((a,h)=>h%4==0).subarray(0,c):s.subarray(0,c)}},t.RGBAFloatDataEncoder=class{constructor(s,c=1,a){if(c!==1&&c!==4)throw new Error(`Invalid number of channels: ${c}`);this.internalFormat=s.RGBA,this.format=s.RGBA,this.channelSize=c,this.textureType=a||s.FLOAT}encode(s,c){let a=s;return this.channelSize===1&&(i.Logger.verbose("Encoder","Exploding into a larger array"),a=this.allocate(c),s.forEach((h,p)=>a[4*p]=h)),a}allocate(s){return new Float32Array(4*s)}decode(s,c){return this.channelSize===1?s.filter((a,h)=>h%4==0).subarray(0,c):s.subarray(0,c)}},t.Uint8DataEncoder=class{constructor(s,c=1){if(this.channelSize=4,c===1)this.internalFormat=s.ALPHA,this.format=s.ALPHA,this.textureType=s.UNSIGNED_BYTE,this.channelSize=c;else{if(c!==4)throw new Error(`Invalid number of channels: ${c}`);this.internalFormat=s.RGBA,this.format=s.RGBA,this.textureType=s.UNSIGNED_BYTE,this.channelSize=c}}encode(s,c){return new Uint8Array(s.buffer,s.byteOffset,s.byteLength)}allocate(s){return new Uint8Array(s*this.channelSize)}decode(s,c){if(s instanceof Uint8Array)return s.subarray(0,c);throw new Error(`Invalid array type: ${s.constructor}`)}}},7859:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBatchDim=t.sizeToSquarishShape=t.getRowsCols=t.sizeFromShape=t.isInt=t.parseAxisParam=t.squeezeShape=t.PreferLogicalStrategy=t.AlwaysKeepOriginalSizeStrategy=void 0;const i=r(6231),s=r(2517);function c(l,n){const e=[],o=[],u=n!=null&&Array.isArray(n)&&n.length===0,g=n==null||u?null:a(n,l).sort();let m=0;for(let y=0;y<l.length;++y){if(g!=null){if(g[m]===y&&l[y]!==1)throw new Error(`Can't squeeze axis ${y} since its dim '${l[y]}' is not 1`);(g[m]==null||g[m]>y)&&l[y]===1&&(e.push(l[y]),o.push(y)),g[m]<=y&&m++}l[y]!==1&&(e.push(l[y]),o.push(y))}return{newShape:e,keptDims:o}}function a(l,n){const e=n.length;return l=l==null?n.map((o,u)=>u):[].concat(l),(0,s.assert)(l.every(o=>o>=-e&&o<e),()=>`All values in axis param must be in range [-${e}, ${e}) but got axis ${l}`),(0,s.assert)(l.every(h),()=>`All values in axis param must be integers but got axis ${l}`),l.map(o=>o<0?e+o:o)}function h(l){return l%1==0}function p(l){if(l.length===0)return 1;let n=l[0];for(let e=1;e<l.length;e++)n*=l[e];return n}function d(l){const n=Math.ceil(Math.sqrt(l));return[n,Math.ceil(l/n)]}t.AlwaysKeepOriginalSizeStrategy=class{constructor(l){this.maxTextureSize=l}computeTextureWH(l,n){if(l.length===0)return[1,1];const e=this.maxTextureSize;if(n&&n.breakAxis!==void 0){const g=n.breakAxis>=l.length?1:l.slice(n.breakAxis).reduce((y,b)=>y*b),m=n.breakAxis<=0?1:l.slice(0,n.breakAxis).reduce((y,b)=>y*b);if(!(g>e||m>e))return[g,m];i.Logger.verbose("TextureLayout",`Given width/height preferences were unattainable: shape:${l}, breakAxis:${n.breakAxis}`)}const o=l.reduce((g,m)=>g*m);let u=Math.floor(Math.sqrt(o));for(;u<e&&u<o&&o%u!=0;u++);if(u>=e||o%u!=0)throw new Error(`The given dimensions are outside this GPU's boundaries: ${l}`);return[u,o/u]}},t.PreferLogicalStrategy=class{constructor(l){this.maxTextureSize=l}computeTextureWH(l,n){const e=this.computeTexture(l,n);return n&&n.isPacked&&(e[0]/=2,e[1]/=2),n&&n.reverseWH?[e[1],e[0]]:e}computeTexture(l,n){const e=n&&n.isPacked;if(l.length===0)return e?[2,2]:[1,1];let o=this.maxTextureSize;if(n&&n.breakAxis!==void 0){const m=n.breakAxis>=l.length?1:l.slice(n.breakAxis).reduce((b,_)=>b*_),y=n.breakAxis<=0?1:l.slice(0,n.breakAxis).reduce((b,_)=>b*_);if(!(m>o||y>o))return[m,y];i.Logger.verbose("TextureLayout",`Given width/height preferences were unattainable: shape:${l}, breakAxis:${n.breakAxis}`)}let u=l.slice(0);e&&(o*=2,u=u.map((m,y)=>y>=u.length-2?u[y]%2==0?u[y]:u[y]+1:u[y]),u.length===1&&(u=[2,u[0]])),u.length!==2&&(u=c(u).newShape);const g=p(u);return u.length<=1&&g<=o?[1,g]:u.length===2&&u[0]<=o&&u[1]<=o?u:u.length===3&&u[0]*u[1]<=o&&u[2]<=o?[u[0]*u[1],u[2]]:u.length===3&&u[0]<=o&&u[1]*u[2]<=o?[u[0],u[1]*u[2]]:u.length===4&&u[0]*u[1]*u[2]<=o&&u[3]<=o?[u[0]*u[1]*u[2],u[3]]:u.length===4&&u[0]<=o&&u[1]*u[2]*u[3]<=o?[u[0],u[1]*u[2]*u[3]]:e?d(g/4).map(m=>2*m):d(g)}},t.squeezeShape=c,t.parseAxisParam=a,t.isInt=h,t.sizeFromShape=p,t.getRowsCols=function(l){if(l.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[l.length>1?l[l.length-2]:1,l[l.length-1]]},t.sizeToSquarishShape=d,t.getBatchDim=function(l,n=2){return p(l.slice(0,l.length-n))}},4057:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTextureLayoutFromShape=t.calculateTextureWidthAndHeight=t.createTextureLayoutFromTextureType=void 0;const i=r(2517),s=r(2039);t.createTextureLayoutFromTextureType=(c,a,h)=>{const p=h===s.TextureType.unpacked||h===s.TextureType.unpackedReversed?1:4,d=h===s.TextureType.packed,l=h===s.TextureType.unpackedReversed||h===s.TextureType.packed,n=h===s.TextureType.packedLastDimension?a.length-1:void 0,e=h===s.TextureType.packedLastDimension?a.map((o,u)=>u===a.length-1?4*o:o):void 0;return(0,t.createTextureLayoutFromShape)(c,a,p,e,{isPacked:d,reverseWH:l,breakAxis:n})},t.calculateTextureWidthAndHeight=(c,a,h)=>{const p=(0,t.createTextureLayoutFromTextureType)(c,a,h);return[p.width,p.height]},t.createTextureLayoutFromShape=(c,a,h=1,p,d)=>{const l=!(!d||!d.isPacked),[n,e]=c.computeTextureWH(l&&p||a,d),o=a.length;let u=a.slice(0);if(o===0&&(u=[1]),h===1)p=a;else if(l){if(h!==4)throw new Error("a packed texture must be 4-channel");p=a,o>0&&(u[o-1]=Math.ceil(u[o-1]/2)),o>1&&(u[o-2]=Math.ceil(u[o-2]/2))}else if(!p)throw new Error("Unpacked shape is needed when using channels > 1");return{width:n,height:e,channels:h,isPacked:l,shape:u,strides:i.ShapeUtil.computeStrides(u),unpackedShape:p,reversedWH:d&&d.reverseWH}}},5702:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextureManager=void 0;const i=r(6231);t.TextureManager=class{constructor(s,c,a,h){this.glContext=s,this.layoutStrategy=c,this.profiler=a,this.config=h,this.pendingRead=new Map,h.reuseTextures&&(this.inUseTextures=new Map,this.idleTextures=new Map,this.textureLookup=new Map)}createTextureFromLayout(s,c,a,h){const p=this.toEncoderType(s),d=this.glContext.getEncoder(p,c.channels||1,h);if(c.isPacked&&h===1)throw new Error("not implemented");const l=c.width,n=c.height;let e,o;if(this.config.reuseTextures){e=`${l}x${n}_${d.format}_${d.internalFormat}_${d.textureType}`,o=this.inUseTextures.get(e),o||(o=[],this.inUseTextures.set(e,o));const g=this.idleTextures.get(e);if(g&&g.length>0){const m=g.pop();return o.push(m),h===1&&this.glContext.updateTexture(m,l,n,d,this.toTextureData(s,a)),m}}i.Logger.verbose("TextureManager",`Creating new texture of size ${c.width}x${c.height}`);const u=this.glContext.allocateTexture(l,n,d,this.toTextureData(s,a));return this.config.reuseTextures&&(o.push(u),this.textureLookup.set(u,e)),u}readTexture(s,c,a){return a||(a=1),this.profiler.event("backend","TextureManager.readTexture",()=>{const h=s.shape.reduce((d,l)=>d*l)*a,p=this.glContext.readTexture(s.texture,s.width,s.height,h,this.toEncoderType(c),a);return this.toTensorData(c,p)})}async readTextureAsync(s,c,a){const h=s.tensor.dataId;if(a||(a=1),this.pendingRead.has(h)){const p=this.pendingRead.get(h);return new Promise(d=>p==null?void 0:p.push(d))}return this.profiler.event("backend","TextureManager.readTextureAsync",async()=>{this.pendingRead.set(h,[]);const p=s.shape.reduce((e,o)=>e*o)*a;await this.glContext.createAndWaitForFence();const d=this.glContext.readTexture(s.texture,s.width,s.height,p,this.toEncoderType(c),a),l=this.toTensorData(c,d),n=this.pendingRead.get(h);return this.pendingRead.delete(h),n==null||n.forEach(e=>e(l)),l})}readUint8TextureAsFloat(s){return this.profiler.event("backend","TextureManager.readUint8TextureAsFloat",()=>{const c=s.shape.reduce((h,p)=>h*p),a=this.glContext.readTexture(s.texture,s.width,s.height,4*c,"byte",4);return new Float32Array(a.buffer,a.byteOffset,c)})}releaseTexture(s,c){let a;if(this.config.reuseTextures&&(a=this.textureLookup.get(s.texture),a)){c&&this.textureLookup.delete(a);const h=this.inUseTextures.get(a);if(h){const p=h.indexOf(s.texture);if(p!==-1){h.splice(p,1);let d=this.idleTextures.get(a);d||(d=[],this.idleTextures.set(a,d)),d.push(s.texture)}}}a&&!c||(i.Logger.verbose("TextureManager",`Deleting texture of size ${s.width}x${s.height}`),this.glContext.deleteTexture(s.texture))}toTensorData(s,c){switch(s){case"int16":return c instanceof Int16Array?c:Int16Array.from(c);case"int32":return c instanceof Int32Array?c:Int32Array.from(c);case"int8":return c instanceof Int8Array?c:Int8Array.from(c);case"uint16":return c instanceof Uint16Array?c:Uint16Array.from(c);case"uint32":return c instanceof Uint32Array?c:Uint32Array.from(c);case"uint8":case"bool":return c instanceof Uint8Array?c:Uint8Array.from(c);case"float32":return c instanceof Float32Array?c:Float32Array.from(c);case"float64":return c instanceof Float64Array?c:Float64Array.from(c);default:throw new Error(`TensorData type ${s} is not supported`)}}toTextureData(s,c){if(c)return c instanceof Float32Array?c:new Float32Array(c)}toEncoderType(s){return"float"}clearActiveTextures(){this.glContext.clearActiveTextures()}}},2039:(f,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.TextureType=void 0,(r=t.TextureType||(t.TextureType={}))[r.unpacked=0]="unpacked",r[r.unpackedReversed=1]="unpackedReversed",r[r.packed=2]="packed",r[r.downloadUint8AsFloat=3]="downloadUint8AsFloat",r[r.packedLastDimension=4]="packedLastDimension"},9390:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getGlChannels=t.getCoordsDataType=t.getSqueezedParams=t.squeezeInputShape=t.generateShaderFuncNameFromInputSamplerNameAtOutCoords=t.generateShaderFuncNameFromInputSamplerName=t.repeatedTry=t.getPackedShape=void 0;const i=r(2517);t.getPackedShape=function(s){const c=s.length;return s.slice(0,c-1).concat(s[c-1]/4)},t.repeatedTry=async function(s,c=h=>0,a){return new Promise((h,p)=>{let d=0;const l=()=>{if(s())return void h();d++;const n=c(d);a!=null&&d>=a?p():setTimeout(l,n)};l()})},t.generateShaderFuncNameFromInputSamplerName=function(s){return(0,i.assert)(s!==void 0&&s.length!==0,()=>"empty string found for sampler name"),"get"+s.charAt(0).toUpperCase()+s.slice(1)},t.generateShaderFuncNameFromInputSamplerNameAtOutCoords=function(s){return(0,i.assert)(s!==void 0&&s.length!==0,()=>"empty string found for sampler name"),"get"+s.charAt(0).toUpperCase()+s.slice(1)+"AtOutCoords"},t.squeezeInputShape=function(s,c){let a=JSON.parse(JSON.stringify(s));return a=c,a},t.getSqueezedParams=function(s,c){return c.map(a=>s[a]).join(", ")},t.getCoordsDataType=function(s){if(s<=1)return"int";if(s===2)return"ivec2";if(s===3)return"ivec3";if(s===4)return"ivec4";if(s===5)return"ivec5";if(s===6)return"ivec6";throw Error(`GPU for rank ${s} is not yet supported`)},t.getGlChannels=function(s=6){return["x","y","z","w","u","v"].slice(0,s)}},7305:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createNewWebGLContext=t.createWebGLContext=void 0;const i=r(6231),s=r(1713),c={};function a(h){const p=function(){if(typeof document>"u"){if(typeof OffscreenCanvas>"u")throw new TypeError("failed to create canvas: OffscreenCanvas is not supported");return new OffscreenCanvas(1,1)}const n=document.createElement("canvas");return n.width=1,n.height=1,n}();let d;const l={alpha:!1,depth:!1,antialias:!1,stencil:!1,preserveDrawingBuffer:!1,premultipliedAlpha:!1,failIfMajorPerformanceCaveat:!1};if((!h||h==="webgl2")&&(d=p.getContext("webgl2",l),d))try{return new s.WebGLContext(d,2)}catch(n){i.Logger.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl2'. Error: ${n}`)}if((!h||h==="webgl")&&(d=p.getContext("webgl",l)||p.getContext("experimental-webgl",l),d))try{return new s.WebGLContext(d,1)}catch(n){i.Logger.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl' or 'experimental-webgl'. Error: ${n}`)}throw new Error("WebGL is not supported")}t.createWebGLContext=function h(p){let d;p&&p!=="webgl2"||!("webgl2"in c)?p&&p!=="webgl"||!("webgl"in c)||(d=c.webgl):d=c.webgl2,d=d||a(p),p=p||d.version===1?"webgl":"webgl2";const l=d.gl;return c[p]=d,l.isContextLost()?(delete c[p],h(p)):(l.disable(l.DEPTH_TEST),l.disable(l.STENCIL_TEST),l.disable(l.BLEND),l.disable(l.DITHER),l.disable(l.POLYGON_OFFSET_FILL),l.disable(l.SAMPLE_COVERAGE),l.enable(l.SCISSOR_TEST),l.enable(l.CULL_FACE),l.cullFace(l.BACK),d)},t.createNewWebGLContext=a},1713:function(f,t,r){var i=this&&this.__createBinding||(Object.create?function(l,n,e,o){o===void 0&&(o=e);var u=Object.getOwnPropertyDescriptor(n,e);u&&!("get"in u?!n.__esModule:u.writable||u.configurable)||(u={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(l,o,u)}:function(l,n,e,o){o===void 0&&(o=e),l[o]=n[e]}),s=this&&this.__setModuleDefault||(Object.create?function(l,n){Object.defineProperty(l,"default",{enumerable:!0,value:n})}:function(l,n){l.default=n}),c=this&&this.__importStar||function(l){if(l&&l.__esModule)return l;var n={};if(l!=null)for(var e in l)e!=="default"&&Object.prototype.hasOwnProperty.call(l,e)&&i(n,l,e);return s(n,l),n};Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLContext=t.linearSearchLastTrue=void 0;const a=r(1670),h=c(r(7769)),p=r(9390);function d(l){let n=0;for(;n<l.length&&l[n]();++n);return n-1}t.linearSearchLastTrue=d,t.WebGLContext=class{constructor(l,n){this.frameBufferBound=!1,this.itemsToPoll=[],this.gl=l,this.version=n,this.getExtensions(),this.vertexbuffer=this.createVertexbuffer(),this.framebuffer=this.createFramebuffer(),this.queryVitalParameters()}allocateTexture(l,n,e,o){const u=this.gl,g=u.createTexture();u.bindTexture(u.TEXTURE_2D,g),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.NEAREST),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.NEAREST),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE);const m=o?e.encode(o,l*n):null;return u.texImage2D(u.TEXTURE_2D,0,e.internalFormat,l,n,0,e.format,e.textureType,m),this.checkError(),g}updateTexture(l,n,e,o,u){const g=this.gl;g.bindTexture(g.TEXTURE_2D,l);const m=o.encode(u,n*e);g.texSubImage2D(g.TEXTURE_2D,0,0,0,n,e,o.format,o.textureType,m),this.checkError()}attachFramebuffer(l,n,e){const o=this.gl;o.bindTexture(o.TEXTURE_2D,l),o.bindFramebuffer(o.FRAMEBUFFER,this.framebuffer),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,l,0),this.checkError(),o.viewport(0,0,n,e),o.scissor(0,0,n,e)}readTexture(l,n,e,o,u,g){const m=this.gl;g||(g=1),this.frameBufferBound||this.attachFramebuffer(l,n,e);const y=this.getEncoder(u,g),b=y.allocate(n*e);return m.bindTexture(m.TEXTURE_2D,l),m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,l,0),m.readPixels(0,0,n,e,m.RGBA,y.textureType,b),this.checkError(),y.decode(b,o)}isFramebufferReady(){return!0}getActiveTexture(){const l=this.gl;return"TEXTURE"+(l.getParameter(this.gl.ACTIVE_TEXTURE)-l.TEXTURE0)}getTextureBinding(){return this.gl.getParameter(this.gl.TEXTURE_BINDING_2D)}getFramebufferBinding(){return this.gl.getParameter(this.gl.FRAMEBUFFER_BINDING)}setVertexAttributes(l,n){const e=this.gl;e.vertexAttribPointer(l,3,e.FLOAT,!1,20,0),e.enableVertexAttribArray(l),n!==-1&&(e.vertexAttribPointer(n,2,e.FLOAT,!1,20,12),e.enableVertexAttribArray(n)),this.checkError()}createProgram(l,n){const e=this.gl,o=e.createProgram();return e.attachShader(o,l),e.attachShader(o,n),e.linkProgram(o),o}compileShader(l,n){const e=this.gl,o=e.createShader(n);if(!o)throw new Error(`createShader() returned null with type ${n}`);if(e.shaderSource(o,l),e.compileShader(o),e.getShaderParameter(o,e.COMPILE_STATUS)===!1)throw new Error(`Failed to compile shader: ${e.getShaderInfoLog(o)}
Shader source:
${l}`);return o}deleteShader(l){this.gl.deleteShader(l)}bindTextureToUniform(l,n,e){const o=this.gl;o.activeTexture(o.TEXTURE0+n),this.checkError(),o.bindTexture(o.TEXTURE_2D,l),this.checkError(),o.uniform1i(e,n),this.checkError()}draw(){this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.checkError()}checkError(){if(a.env.debug){const l=this.gl,n=l.getError();let e="";switch(n){case l.NO_ERROR:return;case l.INVALID_ENUM:e="INVALID_ENUM";break;case l.INVALID_VALUE:e="INVALID_VALUE";break;case l.INVALID_OPERATION:e="INVALID_OPERATION";break;case l.INVALID_FRAMEBUFFER_OPERATION:e="INVALID_FRAMEBUFFER_OPERATION";break;case l.OUT_OF_MEMORY:e="OUT_OF_MEMORY";break;case l.CONTEXT_LOST_WEBGL:e="CONTEXT_LOST_WEBGL";break;default:e=`Unknown WebGL Error: ${n.toString(16)}`}throw new Error(e)}}deleteTexture(l){this.gl.deleteTexture(l)}deleteProgram(l){this.gl.deleteProgram(l)}getEncoder(l,n,e=0){if(this.version===2)return new h.RedFloat32DataEncoder(this.gl,n);switch(l){case"float":return e===1||this.isRenderFloat32Supported?new h.RGBAFloatDataEncoder(this.gl,n):new h.RGBAFloatDataEncoder(this.gl,n,this.textureHalfFloatExtension.HALF_FLOAT_OES);case"int":throw new Error("not implemented");case"byte":return new h.Uint8DataEncoder(this.gl,n);default:throw new Error(`Invalid dataType: ${l}`)}}clearActiveTextures(){const l=this.gl;for(let n=0;n<this.maxTextureImageUnits;++n)l.activeTexture(l.TEXTURE0+n),l.bindTexture(l.TEXTURE_2D,null)}dispose(){if(this.disposed)return;const l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,null),l.deleteFramebuffer(this.framebuffer),l.bindBuffer(l.ARRAY_BUFFER,null),l.deleteBuffer(this.vertexbuffer),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,null),l.finish(),this.disposed=!0}createDefaultGeometry(){return new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0])}createVertexbuffer(){const l=this.gl,n=l.createBuffer();if(!n)throw new Error("createBuffer() returned null");const e=this.createDefaultGeometry();return l.bindBuffer(l.ARRAY_BUFFER,n),l.bufferData(l.ARRAY_BUFFER,e,l.STATIC_DRAW),this.checkError(),n}createFramebuffer(){const l=this.gl.createFramebuffer();if(!l)throw new Error("createFramebuffer returned null");return l}queryVitalParameters(){const l=this.gl;if(this.isFloatTextureAttachableToFrameBuffer=this.checkFloatTextureAttachableToFrameBuffer(),this.isRenderFloat32Supported=this.checkRenderFloat32(),this.isFloat32DownloadSupported=this.checkFloat32Download(),this.version===1&&!this.textureHalfFloatExtension&&!this.isRenderFloat32Supported)throw new Error("both float32 and float16 TextureType are not supported");this.isBlendSupported=!this.isRenderFloat32Supported||this.checkFloat32Blend(),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE),this.maxTextureImageUnits=l.getParameter(l.MAX_TEXTURE_IMAGE_UNITS),this.version}getExtensions(){this.version===2?(this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float"),this.disjointTimerQueryWebgl2Extension=this.gl.getExtension("EXT_disjoint_timer_query_webgl2")):(this.textureFloatExtension=this.gl.getExtension("OES_texture_float"),this.textureHalfFloatExtension=this.gl.getExtension("OES_texture_half_float"))}checkFloatTextureAttachableToFrameBuffer(){const l=this.gl,n=l.createTexture();l.bindTexture(l.TEXTURE_2D,n);const e=this.version===2?l.RGBA32F:l.RGBA;l.texImage2D(l.TEXTURE_2D,0,e,1,1,0,l.RGBA,l.FLOAT,null);const o=l.createFramebuffer();l.bindFramebuffer(l.FRAMEBUFFER,o),l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,n,0);const u=l.checkFramebufferStatus(l.FRAMEBUFFER)===l.FRAMEBUFFER_COMPLETE;return l.bindTexture(l.TEXTURE_2D,null),l.bindFramebuffer(l.FRAMEBUFFER,null),l.deleteTexture(n),l.deleteFramebuffer(o),u}checkRenderFloat32(){if(this.version===2){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension)return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Download(){if(this.version===2){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension||!this.gl.getExtension("WEBGL_color_buffer_float"))return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Blend(){const l=this.gl;let n,e,o,u,g;try{n=l.createTexture(),e=l.createFramebuffer(),l.bindTexture(l.TEXTURE_2D,n);const m=this.version===2?l.RGBA32F:l.RGBA;return l.texImage2D(l.TEXTURE_2D,0,m,1,1,0,l.RGBA,l.FLOAT,null),l.bindFramebuffer(l.FRAMEBUFFER,e),l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,n,0),l.enable(l.BLEND),o=l.createShader(l.VERTEX_SHADER),!!o&&(l.shaderSource(o,"void main(){}"),l.compileShader(o),u=l.createShader(l.FRAGMENT_SHADER),!!u&&(l.shaderSource(u,"precision highp float;void main(){gl_FragColor=vec4(0.5);}"),l.compileShader(u),g=l.createProgram(),!!g&&(l.attachShader(g,o),l.attachShader(g,u),l.linkProgram(g),l.useProgram(g),l.drawArrays(l.POINTS,0,1),l.getError()===l.NO_ERROR)))}finally{l.disable(l.BLEND),g&&l.deleteProgram(g),o&&l.deleteShader(o),u&&l.deleteShader(u),e&&(l.bindFramebuffer(l.FRAMEBUFFER,null),l.deleteFramebuffer(e)),n&&(l.bindTexture(l.TEXTURE_2D,null),l.deleteTexture(n))}}beginTimer(){if(this.version===2&&this.disjointTimerQueryWebgl2Extension){const l=this.gl,n=this.disjointTimerQueryWebgl2Extension,e=l.createQuery();return l.beginQuery(n.TIME_ELAPSED_EXT,e),e}throw new Error("WebGL1 profiling currently not supported.")}endTimer(){if(this.version!==2||!this.disjointTimerQueryWebgl2Extension)throw new Error("WebGL1 profiling currently not supported");{const l=this.gl,n=this.disjointTimerQueryWebgl2Extension;l.endQuery(n.TIME_ELAPSED_EXT)}}isTimerResultAvailable(l){let n=!1,e=!1;if(this.version!==2||!this.disjointTimerQueryWebgl2Extension)throw new Error("WebGL1 profiling currently not supported");{const o=this.gl,u=this.disjointTimerQueryWebgl2Extension;n=o.getQueryParameter(l,o.QUERY_RESULT_AVAILABLE),e=o.getParameter(u.GPU_DISJOINT_EXT)}return n&&!e}getTimerResult(l){let n=0;if(this.version!==2)throw new Error("WebGL1 profiling currently not supported");{const e=this.gl;n=e.getQueryParameter(l,e.QUERY_RESULT),e.deleteQuery(l)}return n/1e6}async waitForQueryAndGetTime(l){return await(0,p.repeatedTry)(()=>this.isTimerResultAvailable(l)),this.getTimerResult(l)}async createAndWaitForFence(){const l=this.createFence(this.gl);return this.pollFence(l)}createFence(l){let n;const e=l,o=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return l.flush(),n=o===null?()=>!0:()=>{const u=e.clientWaitSync(o,0,0);return u===e.ALREADY_SIGNALED||u===e.CONDITION_SATISFIED},{query:o,isFencePassed:n}}async pollFence(l){return new Promise(n=>{this.addItemToPoll(()=>l.isFencePassed(),()=>n())})}pollItems(){const l=d(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=l;++n){const{resolveFn:e}=this.itemsToPoll[n];e()}this.itemsToPoll=this.itemsToPoll.slice(l+1)}async addItemToPoll(l,n){this.itemsToPoll.push({isDoneFn:l,resolveFn:n}),this.itemsToPoll.length>1||await(0,p.repeatedTry)(()=>(this.pollItems(),this.itemsToPoll.length===0))}}},1036:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExecutionPlan=void 0;const i=r(6231);class s{constructor(a,h){this.op=a,this.node=h}}t.ExecutionPlan=class{constructor(c,a,h){this.graph=c,this.profiler=h,this.initialize(a)}initialize(c){this.profiler.event("session","ExecutionPlan.initialize",()=>{const a=this.graph.getNodes();if(a.length!==c.length)throw new Error("The size of nodes and OPs do not match.");this._ops=c.map((h,p)=>new s(h,a[p])),this.reset(),this._starter=[],this._ops.forEach((h,p)=>{let d=!0;for(const l of h.node.inputs)if(!this._values[l]&&this.graph.getInputIndices().indexOf(l)===-1){d=!1;break}d&&this._starter.push(p)})})}reset(){this._values=this.graph.getValues().map(c=>c.tensor)}async execute(c,a){return this.profiler.event("session","ExecutionPlan.execute",async()=>{this.reset();const h=c.createInferenceHandler(),p=this.graph.getInputIndices();if(a.length!==p.length)throw new Error(`number of input tensors don't match the number of inputs to the model: actual: ${a.length} expected: ${p.length}`);a.forEach((u,g)=>{const m=p[g];this._values[m]=u});const d=this._starter.slice(0),l=this.graph.getValues(),n=this.graph.getNodes();let e=0;for(;e<d.length;){const u=d[e++],g=this._ops[u],m=g.node.inputs.map(x=>this._values[x]);if(m.indexOf(void 0)!==-1)throw new Error(`unresolved input detected: op: ${g.node}`);const y=m;i.Logger.verbose("ExecPlan",`Runing op:${g.node.name} (${y.map((x,w)=>`'${g.node.inputs[w]}': ${x.type}[${x.dims.join(",")}]`).join(", ")})`);const b=await this.profiler.event("node",g.node.name,async()=>g.op.impl(h,y,g.op.context));if(b.length!==g.node.outputs.length)throw new Error("the size of output does not match model definition.");b.forEach((x,w)=>{const T=g.node.outputs[w];if(this._values[T])throw new Error(`output [${T}] already has value: op:${g.node.name}`);this._values[T]=x});const _=new Set;b.forEach((x,w)=>{const T=g.node.outputs[w];for(const S of l[T].to){const I=n[S];let v=!0;for(const A of I.inputs)if(!this._values[A]){v=!1;break}v&&_.add(S)}}),d.push(..._)}const o=[];for(let u=0;u<this.graph.getOutputIndices().length;u++){const g=this.graph.getOutputIndices()[u],m=this._values[g];if(m===void 0)throw new Error(`required output [${g}] does not have value`);g===0?await m.getData():m.data,o.push(m)}return i.Logger.verbose("ExecPlan","disposing of inferenceHandler"),h.dispose(),o})}}},7070:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Graph=void 0;const i=r(1446),s=r(7778),c=r(9395),a=r(9162),h=r(2517);var p=c.onnxruntime.experimental.fbs;t.Graph={from:(e,o)=>new n(e,o)};class d{constructor(o){this._from=void 0,this._to=[],this.tensor=void 0,this.type=void 0,o&&(this.type=h.ProtoUtil.tensorValueTypeFromProto(o.type.tensorType))}get from(){return this._from}get to(){return this._to}}class l{constructor(o,u){o instanceof i.onnx.NodeProto?(this.name=o.name,this.opType=o.opType,this.attributes=new s.Attribute(o.attribute)):o instanceof p.Node&&(this.name=u??o.name(),this.opType=o.opType(),this.attributes=new s.Attribute(h.ProtoUtil.tensorAttributesFromORTFormat(o))),this.inputs=[],this.outputs=[],this.executeNode=!0}}class n{constructor(o,u){if(!o)throw new TypeError("graph is empty");this.buildGraph(o),this.transformGraph(u),this.checkIsAcyclic()}getInputIndices(){return this._allInputIndices}getInputNames(){return this._allInputNames}getOutputIndices(){return this._allOutputIndices}getOutputNames(){return this._allOutputNames}getValues(){return this._allData}getNodes(){return this._nodes}buildGraph(o){if(o instanceof i.onnx.GraphProto)this.buildGraphFromOnnxFormat(o);else{if(!(o instanceof p.Graph))throw new TypeError("Graph type is not supported.");this.buildGraphFromOrtFormat(o)}}buildGraphFromOnnxFormat(o){const u=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];const g=new Map;if(!o.input)throw new Error("missing information in graph: input");const m=[];for(const y of o.input){if(u.has(y.name))throw new Error(`duplicated input name: ${y.name}`);const b=this._allData.push(new d(y))-1;u.set(y.name,b),m.push(y.name)}if(!o.initializer)throw new Error("missing information in graph: initializer");for(const y of o.initializer){let b=u.get(y.name);if(b===void 0){const _=new d;_.type={shape:{dims:h.ProtoUtil.tensorDimsFromProto(y.dims)},tensorType:h.ProtoUtil.tensorDataTypeFromProto(y.dataType)},b=this._allData.push(_)-1,u.set(y.name,b)}this._allData[b]._from=-1,this._allData[b].tensor=a.Tensor.fromProto(y)}for(let y=0;y<this._allData.length;y++)this._allData[y].tensor||(this._allInputIndices.push(y),this._allInputNames.push(m[y]));if(!o.output)throw new Error("missing information in graph: output");for(const y of o.output){if(u.has(y.name))throw new Error(`duplicated output name: ${y.name}`);const b=this._allData.push(new d(y))-1;u.set(y.name,b),this._allOutputIndices.push(b),this._allOutputNames.push(y.name)}if(!o.node)throw new Error("missing information in graph: node");for(const y of o.node){if(!y.name)for(let _=0;;_++){const x=`unnamed_${y.opType}_${_}`;if(!g.has(x)){y.name=x;break}}if(g.has(y.name))throw new Error(`duplicated node name: ${y.name}`);const b=this._nodes.push(new l(y))-1;g.set(y.name,b)}for(let y=0;y<this._nodes.length;y++){const b=this._nodes[y],_=o.node[y];if(!_.output)throw new Error(`missing output for node: ${_.name}`);for(const x of _.output){let w=u.get(x);if(w===void 0&&(w=this._allData.push(new d)-1,u.set(x,w)),b.outputs.push(w),this._allData[w]._from!==void 0)throw new Error(`multiple nodes output to one data value: ${w}`);if(this._allData[w]._from=y,_.opType==="Constant"){if(!_.attribute||_.attribute.length!==1||!_.attribute[0].t)throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(!_.output||_.output.length!==1)throw new Error("missing output or incorrect number of outputs for this Constant operator");b.outputs.pop(),b.executeNode=!1,this._allData[w]._from=-1,this._allData[w].tensor=a.Tensor.fromProto(_.attribute[0].t)}}}for(let y=0;y<this._nodes.length;y++){const b=this._nodes[y],_=o.node[y];if(!_.input)throw new Error(`missing input for node: ${_.name}`);for(const x of _.input){const w=u.get(x);if(w===void 0){if(x===""&&_.input.length===3&&_.opType==="Resize")continue;throw new Error(`unrecognized input '${x}' for node: ${_.name}`)}b.inputs.push(w),this._allData[w]._to.push(y)}}return!0}buildGraphFromOrtFormat(o){var u,g,m;const y=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];const b=new Map,_=[];for(let x=0;x<o.inputsLength();x++){const w=o.inputs(x);if(y.has(w))throw new Error(`duplicated input name: ${w}`);for(let T=0;T<o.nodeArgsLength();T++)if(((u=o.nodeArgs(T))===null||u===void 0?void 0:u.name())===w){const S=new d;if(((m=(g=o.nodeArgs(T))===null||g===void 0?void 0:g.type())===null||m===void 0?void 0:m.valueType())!==p.TypeInfoValue.tensor_type)throw new Error("Unexpected value type for the nodeArg.");const I=o.nodeArgs(T).type().value(new p.TensorTypeAndShape),v=h.ProtoUtil.tensorDataTypeFromProto(I.elemType()),A=I.shape(),L=[];for(let $=0;$<A.dimLength();$++)L.push(h.LongUtil.longToNumber(A.dim($).value().dimValue()));S.type={shape:{dims:L},tensorType:v};const N=this._allData.push(S)-1;y.set(w,N),_.push(w)}}for(let x=0;x<o.initializersLength();x++){const w=o.initializers(x);let T=y.get(w.name());if(T===void 0){const S=new d,I=h.ProtoUtil.tensorDimsFromORTFormat(w),v=h.ProtoUtil.tensorDataTypeFromProto(w.dataType());S.type={shape:{dims:I},tensorType:v},T=this._allData.push(S)-1,y.set(w.name(),T)}this._allData[T]._from=-1,this._allData[T].tensor=a.Tensor.fromOrtTensor(w)}for(let x=0;x<this._allData.length;x++)this._allData[x].tensor||(this._allInputIndices.push(x),this._allInputNames.push(_[x]));for(let x=0;x<o.outputsLength();x++){const w=o.outputs(x);if(y.has(w))throw new Error(`duplicated output name: ${w}`);const T=this._allData.push(new d)-1;y.set(w,T),this._allOutputIndices.push(T),this._allOutputNames.push(w)}if(!o.nodes)throw new Error("missing information in graph: node");for(let x=0;x<o.nodesLength();x++){const w=o.nodes(x);let T=w.name();if(!T)for(let I=0;T=`unnamed_${w.opType()}_${I}`,b.has(T);I++);if(b.has(T))throw new Error(`duplicated node name: ${T}`);const S=this._nodes.push(new l(w,T))-1;b.set(T,S)}for(let x=0;x<this._nodes.length;x++){const w=this._nodes[x],T=o.nodes(x);if(T==null)throw new Error(`No node exists at index ${x}`);if((T==null?void 0:T.outputsLength())===0)throw new Error(`missing output for node: ${T.name}`);for(let S=0;S<(T==null?void 0:T.outputsLength());S++){const I=T==null?void 0:T.outputs(S);let v=y.get(I);if(v===void 0&&(v=this._allData.push(new d)-1,y.set(I,v)),w.outputs.push(v),this._allData[v]._from!==void 0)throw new Error(`multiple nodes output to one data value: ${v}`);if(this._allData[v]._from=x,T.opType()==="Constant"){if(T.attributesLength()!==1||!T.attributes(0).t())throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(T.outputsLength()!==1)throw new Error("missing output or incorrect number of outputs for this Constant operator");w.outputs.pop(),w.executeNode=!1,this._allData[v]._from=-1,this._allData[v].tensor=a.Tensor.fromOrtTensor(T.attributes(0).t())}}}for(let x=0;x<this._nodes.length;x++){const w=this._nodes[x],T=o.nodes(x);if(T.inputsLength()===0)throw new Error(`missing input for node: ${T.name}`);for(let S=0;S<T.inputsLength();S++){const I=T.inputs(S),v=y.get(I);if(v===void 0)throw new Error(`unrecognized input '${I}' for node: ${T.name()}`);w.inputs.push(v),this._allData[v]._to.push(x)}}}checkIsAcyclic(){const o=new Set;this._allInputIndices.forEach(m=>{this._allData[m]._to.forEach(y=>{o.add(y)})});const u=Array.from(o),g=new Array(this._nodes.length).fill("white");for(;u.length>0;){const m=u.pop();g[m]==="gray"?g[m]="black":(u.push(m),g[m]="gray",this._nodes[m].outputs.forEach(y=>{const b=this._allData[y];if(b.tensor!==void 0)throw new Error("node outputs should not be initialized");if(b._from!==m)throw new Error("from property of the Value object doesn't match index of Node being processed");b._to.forEach(_=>{if(g[_]==="gray")throw new Error("model graph is cyclic");g[_]==="white"&&u.push(_)})}))}}transformGraph(o){this.removeAllIdentityNodes(),this.removeAllDropoutNodes(),this.fuseConvActivationNodes(),o&&o.transformGraph(this),this.finalizeGraph()}finalizeGraph(){let o=0;for(let u=0;u<this._nodes.length;u++)this._nodes[u].executeNode?o>0&&(this._nodes[u].inputs.forEach(g=>{const m=this._allData[g]._to.indexOf(u+o);m!==-1&&(this._allData[g]._to[m]=u)}),this._nodes[u].outputs.forEach(g=>{this._allData[g]._from&&this._allData[g]._from===u+o&&(this._allData[g]._from=u)})):(o++,this._nodes[u].outputs.forEach(g=>{this._allData[g]._from=-2}),this._nodes.splice(u,1),u--);o=0;for(let u=0;u<this._allData.length;u++)if(this._allData[u].from!==-2||this._allOutputIndices.indexOf(u+o)!==-1){if(o>0){let g=-1;this._allData[u].from!==void 0&&this._allData[u].from!==-1?(g=this._nodes[this._allData[u].from].outputs.indexOf(u+o),g!==-1&&(this._nodes[this._allData[u].from].outputs[g]=u)):(g=this._allInputIndices.indexOf(u+o),g!==-1&&(this._allInputIndices[g]=u)),this._allData[u].to.forEach(m=>{g=this._nodes[m].inputs.indexOf(u+o),g!==-1&&(this._nodes[m].inputs[g]=u)}),this._allData[u].to.length===0&&(g=this._allOutputIndices.indexOf(u+o),g!==-1&&(this._allOutputIndices[g]=u))}}else o++,this._allData.splice(u,1),u--}deleteNode(o){const u=this._nodes[o];if(u.outputs.length>1){for(let x=1;x<u.outputs.length;x++)if(this._allData[u.outputs[x]].to.length>0)throw new Error("Node deletion with more than one output connected to other nodes is not supported. ")}u.executeNode=!1;const g=u.inputs[0],m=u.outputs[0],y=this._allData[m].to,b=this._allData[g].to.indexOf(o);if(b===-1)throw new Error("The Value object doesn't have the current Node in it's 'to' property ");this._allData[g].to.splice(b,1),this._allData[m]._to=[];const _=this._allOutputIndices.indexOf(m);if(_!==-1&&(this._allOutputIndices[_]=g),y&&y.length>0)for(const x of y){const w=this._nodes[x].inputs.indexOf(m);if(w===-1)throw new Error("The Node object doesn't have the output Value in it's 'inputs' property ");this._nodes[x].inputs[w]=g,this._allData[g].to.push(x)}}removeAllDropoutNodes(){let o=0;for(const u of this._nodes){if(u.opType==="Dropout"){if(u.inputs.length!==1)throw new Error("Dropout nodes should only contain one input. ");if(u.outputs.length!==1&&u.outputs.length!==2)throw new Error("Dropout nodes should contain either 1 or 2 output(s)");if(u.outputs.length===2&&this._allData[u.outputs[1]]._to.length!==0)throw new Error("Dropout nodes's second output should not be referenced by other nodes");this.deleteNode(o)}o++}}removeAllIdentityNodes(){let o=0;for(const u of this._nodes)u.opType==="Identity"&&this.deleteNode(o),o++}isActivation(o){switch(o.opType){case"Relu":case"Sigmoid":case"Clip":return!0;default:return!1}}fuseConvActivationNodes(){for(const o of this._nodes)if(o.opType==="Conv"){const u=this._allData[o.outputs[0]]._to;if(u.length===1&&this.isActivation(this._nodes[u[0]])){const g=this._nodes[u[0]];if(g.opType==="Clip")if(g.inputs.length===1)try{o.attributes.set("activation_params","floats",[g.attributes.getFloat("min"),g.attributes.getFloat("max")])}catch{o.attributes.set("activation_params","floats",[h.MIN_CLIP,h.MAX_CLIP])}else{if(!(g.inputs.length>=3&&this._allData[g.inputs[1]].tensor!==void 0&&this._allData[g.inputs[2]].tensor!==void 0))continue;o.attributes.set("activation_params","floats",[this._allData[g.inputs[1]].tensor.floatData[0],this._allData[g.inputs[2]].tensor.floatData[0]])}o.attributes.set("activation","string",g.opType),this.deleteNode(u[0])}}}}},6231:(f,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.Profiler=t.Logger=void 0;const r={verbose:1e3,info:2e3,warning:4e3,error:5e3,fatal:6e3},i={none:new class{log(l,n,e){}},console:new class{log(l,n,e){console.log(`${this.color(l)} ${e?"\x1B[35m"+e+"\x1B[0m ":""}${n}`)}color(l){switch(l){case"verbose":return"\x1B[34;40mv\x1B[0m";case"info":return"\x1B[32mi\x1B[0m";case"warning":return"\x1B[30;43mw\x1B[0m";case"error":return"\x1B[31;40me\x1B[0m";case"fatal":return"\x1B[101mf\x1B[0m";default:throw new Error(`unsupported severity: ${l}`)}}}},s={provider:"console",minimalSeverity:"warning",logDateTime:!0,logSourceLocation:!1};let c={"":s};function a(l,n,e,o){if(n===void 0)return u=l,{verbose:a.verbose.bind(null,u),info:a.info.bind(null,u),warning:a.warning.bind(null,u),error:a.error.bind(null,u),fatal:a.fatal.bind(null,u)};if(e===void 0)h(l,n);else if(typeof e=="number"&&o===void 0)h(l,n);else if(typeof e=="string"&&o===void 0)h(l,e,0,n);else{if(typeof e!="string"||typeof o!="number")throw new TypeError("input is valid");h(l,e,0,n)}var u}function h(l,n,e,o){const u=c[o||""]||c[""];r[l]<r[u.minimalSeverity]||(u.logDateTime&&(n=`${new Date().toISOString()}|${n}`),u.logSourceLocation,i[u.provider].log(l,n,o))}(function(l){function n(o){c={},e("",o||{})}function e(o,u){if(o==="*")n(u);else{const g=c[o]||s;c[o]={provider:u.provider||g.provider,minimalSeverity:u.minimalSeverity||g.minimalSeverity,logDateTime:u.logDateTime===void 0?g.logDateTime:u.logDateTime,logSourceLocation:u.logSourceLocation===void 0?g.logSourceLocation:u.logSourceLocation}}}l.verbose=function(o,u){l("verbose",o,u)},l.info=function(o,u){l("info",o,u)},l.warning=function(o,u){l("warning",o,u)},l.error=function(o,u){l("error",o,u)},l.fatal=function(o,u){l("fatal",o,u)},l.reset=n,l.set=e,l.setWithEnv=function(o){const u={};o.logLevel&&(u.minimalSeverity=o.logLevel),e("",u)}})(a||(a={})),t.Logger=a;class p{constructor(n,e,o,u,g,m){this.category=n,this.name=e,this.startTime=o,this.endCallback=u,this.timer=g,this.ctx=m}end(){return this.endCallback(this)}async checkTimer(){if(this.ctx===void 0||this.timer===void 0)throw new Error("No webgl timer found");return this.ctx.endTimer(),this.ctx.waitForQueryAndGetTime(this.timer)}}class d{constructor(n,e,o,u){this.category=n,this.name=e,this.startTime=o,this.endTime=u}}t.Profiler=class{static create(l){return l===void 0?new this:new this(l.maxNumberEvents,l.flushBatchSize,l.flushIntervalInMilliseconds)}constructor(l,n,e){this._started=!1,this._flushPointer=0,this._started=!1,this._maxNumberEvents=l===void 0?1e4:l,this._flushBatchSize=n===void 0?10:n,this._flushIntervalInMilliseconds=e===void 0?5e3:e}start(){this._started=!0,this._timingEvents=[],this._flushTime=(0,t.now)(),this._flushPointer=0}stop(){for(this._started=!1;this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer])}event(l,n,e,o){const u=this._started?this.begin(l,n,o):void 0;let g=!1;const m=e();if(m&&typeof m.then=="function")return g=!0,new Promise((y,b)=>{m.then(async _=>{u&&await u.end(),y(_)},async _=>{u&&await u.end(),b(_)})});if(!g&&u){const y=u.end();if(y&&typeof y.then=="function")return new Promise((b,_)=>{y.then(()=>{b(m)},x=>{_(x)})})}return m}begin(l,n,e){if(!this._started)throw new Error("profiler is not started yet");if(e===void 0){const o=(0,t.now)();return this.flush(o),new p(l,n,o,u=>this.endSync(u))}{const o=e.beginTimer();return new p(l,n,0,async u=>this.end(u),o,e)}}async end(l){const n=await l.checkTimer();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new d(l.category,l.name,l.startTime,n)),this.flush(n))}endSync(l){const n=(0,t.now)();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new d(l.category,l.name,l.startTime,n)),this.flush(n))}logOneEvent(l){t.Logger.verbose(`Profiler.${l.category}`,`${(l.endTime-l.startTime).toFixed(2)}ms on event '${l.name}' at ${l.endTime.toFixed(2)}`)}flush(l){if(this._timingEvents.length-this._flushPointer>=this._flushBatchSize||l-this._flushTime>=this._flushIntervalInMilliseconds){for(const n=this._flushPointer;this._flushPointer<n+this._flushBatchSize&&this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer]);this._flushTime=(0,t.now)()}}get started(){return this._started}},t.now=typeof performance<"u"&&performance.now?()=>performance.now():Date.now},2644:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Model=void 0;const i=r(5686),s=r(1446),c=r(7070),a=r(9395),h=r(2517);var p=a.onnxruntime.experimental.fbs;t.Model=class{constructor(){}load(d,l,n){if(!n)try{return void this.loadFromOnnxFormat(d,l)}catch(e){if(n!==void 0)throw e}this.loadFromOrtFormat(d,l)}loadFromOnnxFormat(d,l){const n=s.onnx.ModelProto.decode(d);if(h.LongUtil.longToNumber(n.irVersion)<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=n.opsetImport.map(e=>({domain:e.domain,version:h.LongUtil.longToNumber(e.version)})),this._graph=c.Graph.from(n.graph,l)}loadFromOrtFormat(d,l){const n=new i.flatbuffers.ByteBuffer(d),e=p.InferenceSession.getRootAsInferenceSession(n).model();if(h.LongUtil.longToNumber(e.irVersion())<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=[];for(let o=0;o<e.opsetImportLength();o++){const u=e.opsetImport(o);this._opsets.push({domain:u==null?void 0:u.domain(),version:h.LongUtil.longToNumber(u.version())})}this._graph=c.Graph.from(e.graph(),l)}get graph(){return this._graph}get opsets(){return this._opsets}}},782:(f,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FLOAT_TYPES=t.INT_TYPES=t.NUMBER_TYPES=void 0,t.NUMBER_TYPES=["float32","float64","int32","int16","int8","uint16","uint32","uint8"],t.INT_TYPES=["int32","int16","int8","uint16","uint32","uint8"],t.FLOAT_TYPES=["float32","float64"]},1047:(f,t)=>{function r(i,s){if(s.endsWith("+")){const c=Number.parseInt(s.substring(0,s.length-1),10);return!isNaN(c)&&c<=i}if(s.split("-").length===2){const c=s.split("-"),a=Number.parseInt(c[0],10),h=Number.parseInt(c[1],10);return!isNaN(a)&&!isNaN(h)&&a<=i&&i<=h}return Number.parseInt(s,10)===i}Object.defineProperty(t,"__esModule",{value:!0}),t.resolveOperator=void 0,t.resolveOperator=function(i,s,c){for(const a of c){const h=a[0],p=a[1],d=a[2],l=a[3],n=a[4];if(i.opType===h){for(const e of s)if((e.domain===p||e.domain==="ai.onnx"&&p==="")&&r(e.version,d))return{opImpl:l,opInit:n}}}throw new TypeError(`cannot resolve operator '${i.opType}' with opsets: ${s.map(a=>`${a.domain||"ai.onnx"} v${a.version}`).join(", ")}`)}},9395:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.onnxruntime=void 0;const i=r(5686);var s,c;s=t.onnxruntime||(t.onnxruntime={}),function(a){(function(h){h[h.UNDEFINED=0]="UNDEFINED",h[h.FLOAT=1]="FLOAT",h[h.INT=2]="INT",h[h.STRING=3]="STRING",h[h.TENSOR=4]="TENSOR",h[h.GRAPH=5]="GRAPH",h[h.FLOATS=6]="FLOATS",h[h.INTS=7]="INTS",h[h.STRINGS=8]="STRINGS",h[h.TENSORS=9]="TENSORS",h[h.GRAPHS=10]="GRAPHS",h[h.SPARSE_TENSOR=11]="SPARSE_TENSOR",h[h.SPARSE_TENSORS=12]="SPARSE_TENSORS"})(a.AttributeType||(a.AttributeType={}))}((c=s.experimental||(s.experimental={})).fbs||(c.fbs={})),function(a){(function(h){(function(p){(function(d){d[d.UNKNOWN=0]="UNKNOWN",d[d.VALUE=1]="VALUE",d[d.PARAM=2]="PARAM"})(p.DimensionValueType||(p.DimensionValueType={}))})(h.fbs||(h.fbs={}))})(a.experimental||(a.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(a){(function(h){(function(p){(function(d){d[d.UNDEFINED=0]="UNDEFINED",d[d.FLOAT=1]="FLOAT",d[d.UINT8=2]="UINT8",d[d.INT8=3]="INT8",d[d.UINT16=4]="UINT16",d[d.INT16=5]="INT16",d[d.INT32=6]="INT32",d[d.INT64=7]="INT64",d[d.STRING=8]="STRING",d[d.BOOL=9]="BOOL",d[d.FLOAT16=10]="FLOAT16",d[d.DOUBLE=11]="DOUBLE",d[d.UINT32=12]="UINT32",d[d.UINT64=13]="UINT64",d[d.COMPLEX64=14]="COMPLEX64",d[d.COMPLEX128=15]="COMPLEX128",d[d.BFLOAT16=16]="BFLOAT16"})(p.TensorDataType||(p.TensorDataType={}))})(h.fbs||(h.fbs={}))})(a.experimental||(a.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(a){(function(h){(function(p){(function(d){d[d.Primitive=0]="Primitive",d[d.Fused=1]="Fused"})(p.NodeType||(p.NodeType={}))})(h.fbs||(h.fbs={}))})(a.experimental||(a.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(a){(function(h){(function(p){(function(d){d[d.NONE=0]="NONE",d[d.tensor_type=1]="tensor_type",d[d.sequence_type=2]="sequence_type",d[d.map_type=3]="map_type"})(p.TypeInfoValue||(p.TypeInfoValue={}))})(h.fbs||(h.fbs={}))})(a.experimental||(a.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(a){(function(h){(function(p){class d{constructor(){this.bb=null,this.bb_pos=0}__init(n,e){return this.bb_pos=n,this.bb=e,this}static getRootAsShape(n,e){return(e||new d).__init(n.readInt32(n.position())+n.position(),n)}static getSizePrefixedRootAsShape(n,e){return n.setPosition(n.position()+i.flatbuffers.SIZE_PREFIX_LENGTH),(e||new d).__init(n.readInt32(n.position())+n.position(),n)}dim(n,e){let o=this.bb.__offset(this.bb_pos,4);return o?(e||new a.experimental.fbs.Dimension).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+o)+4*n),this.bb):null}dimLength(){let n=this.bb.__offset(this.bb_pos,4);return n?this.bb.__vector_len(this.bb_pos+n):0}static startShape(n){n.startObject(1)}static addDim(n,e){n.addFieldOffset(0,e,0)}static createDimVector(n,e){n.startVector(4,e.length,4);for(let o=e.length-1;o>=0;o--)n.addOffset(e[o]);return n.endVector()}static startDimVector(n,e){n.startVector(4,e,4)}static endShape(n){return n.endObject()}static createShape(n,e){return d.startShape(n),d.addDim(n,e),d.endShape(n)}}p.Shape=d})(h.fbs||(h.fbs={}))})(a.experimental||(a.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(a){(function(h){(function(p){class d{constructor(){this.bb=null,this.bb_pos=0}__init(n,e){return this.bb_pos=n,this.bb=e,this}static getRootAsDimension(n,e){return(e||new d).__init(n.readInt32(n.position())+n.position(),n)}static getSizePrefixedRootAsDimension(n,e){return n.setPosition(n.position()+i.flatbuffers.SIZE_PREFIX_LENGTH),(e||new d).__init(n.readInt32(n.position())+n.position(),n)}value(n){let e=this.bb.__offset(this.bb_pos,4);return e?(n||new a.experimental.fbs.DimensionValue).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}denotation(n){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,n):null}static startDimension(n){n.startObject(2)}static addValue(n,e){n.addFieldOffset(0,e,0)}static addDenotation(n,e){n.addFieldOffset(1,e,0)}static endDimension(n){return n.endObject()}static createDimension(n,e,o){return d.startDimension(n),d.addValue(n,e),d.addDenotation(n,o),d.endDimension(n)}}p.Dimension=d})(h.fbs||(h.fbs={}))})(a.experimental||(a.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(a){(function(h){(function(p){class d{constructor(){this.bb=null,this.bb_pos=0}__init(n,e){return this.bb_pos=n,this.bb=e,this}static getRootAsDimensionValue(n,e){return(e||new d).__init(n.readInt32(n.position())+n.position(),n)}static getSizePrefixedRootAsDimensionValue(n,e){return n.setPosition(n.position()+i.flatbuffers.SIZE_PREFIX_LENGTH),(e||new d).__init(n.readInt32(n.position())+n.position(),n)}dimType(){let n=this.bb.__offset(this.bb_pos,4);return n?this.bb.readInt8(this.bb_pos+n):a.experimental.fbs.DimensionValueType.UNKNOWN}dimValue(){let n=this.bb.__offset(this.bb_pos,6);return n?this.bb.readInt64(this.bb_pos+n):this.bb.createLong(0,0)}dimParam(n){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__string(this.bb_pos+e,n):null}static startDimensionValue(n){n.startObject(3)}static addDimType(n,e){n.addFieldInt8(0,e,a.experimental.fbs.DimensionValueType.UNKNOWN)}static addDimValue(n,e){n.addFieldInt64(1,e,n.createLong(0,0))}static addDimParam(n,e){n.addFieldOffset(2,e,0)}static endDimensionValue(n){return n.endObject()}static createDimensionValue(n,e,o,u){return d.startDimensionValue(n),d.addDimType(n,e),d.addDimValue(n,o),d.addDimParam(n,u),d.endDimensionValue(n)}}p.DimensionValue=d})(h.fbs||(h.fbs={}))})(a.experimental||(a.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(a){(function(h){(function(p){class d{constructor(){this.bb=null,this.bb_pos=0}__init(n,e){return this.bb_pos=n,this.bb=e,this}static getRootAsTensorTypeAndShape(n,e){return(e||new d).__init(n.readInt32(n.position())+n.position(),n)}static getSizePrefixedRootAsTensorTypeAndShape(n,e){return n.setPosition(n.position()+i.flatbuffers.SIZE_PREFIX_LENGTH),(e||new d).__init(n.readInt32(n.position())+n.position(),n)}elemType(){let n=this.bb.__offset(this.bb_pos,4);return n?this.bb.readInt32(this.bb_pos+n):a.experimental.fbs.TensorDataType.UNDEFINED}shape(n){let e=this.bb.__offset(this.bb_pos,6);return e?(n||new a.experimental.fbs.Shape).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startTensorTypeAndShape(n){n.startObject(2)}static addElemType(n,e){n.addFieldInt32(0,e,a.experimental.fbs.TensorDataType.UNDEFINED)}static addShape(n,e){n.addFieldOffset(1,e,0)}static endTensorTypeAndShape(n){return n.endObject()}static createTensorTypeAndShape(n,e,o){return d.startTensorTypeAndShape(n),d.addElemType(n,e),d.addShape(n,o),d.endTensorTypeAndShape(n)}}p.TensorTypeAndShape=d})(h.fbs||(h.fbs={}))})(a.experimental||(a.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(a){(function(h){(function(p){class d{constructor(){this.bb=null,this.bb_pos=0}__init(n,e){return this.bb_pos=n,this.bb=e,this}static getRootAsMapType(n,e){return(e||new d).__init(n.readInt32(n.position())+n.position(),n)}static getSizePrefixedRootAsMapType(n,e){return n.setPosition(n.position()+i.flatbuffers.SIZE_PREFIX_LENGTH),(e||new d).__init(n.readInt32(n.position())+n.position(),n)}keyType(){let n=this.bb.__offset(this.bb_pos,4);return n?this.bb.readInt32(this.bb_pos+n):a.experimental.fbs.TensorDataType.UNDEFINED}valueType(n){let e=this.bb.__offset(this.bb_pos,6);return e?(n||new a.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startMapType(n){n.startObject(2)}static addKeyType(n,e){n.addFieldInt32(0,e,a.experimental.fbs.TensorDataType.UNDEFINED)}static addValueType(n,e){n.addFieldOffset(1,e,0)}static endMapType(n){return n.endObject()}static createMapType(n,e,o){return d.startMapType(n),d.addKeyType(n,e),d.addValueType(n,o),d.endMapType(n)}}p.MapType=d})(h.fbs||(h.fbs={}))})(a.experimental||(a.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(a){(function(h){(function(p){class d{constructor(){this.bb=null,this.bb_pos=0}__init(n,e){return this.bb_pos=n,this.bb=e,this}static getRootAsSequenceType(n,e){return(e||new d).__init(n.readInt32(n.position())+n.position(),n)}static getSizePrefixedRootAsSequenceType(n,e){return n.setPosition(n.position()+i.flatbuffers.SIZE_PREFIX_LENGTH),(e||new d).__init(n.readInt32(n.position())+n.position(),n)}elemType(n){let e=this.bb.__offset(this.bb_pos,4);return e?(n||new a.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startSequenceType(n){n.startObject(1)}static addElemType(n,e){n.addFieldOffset(0,e,0)}static endSequenceType(n){return n.endObject()}static createSequenceType(n,e){return d.startSequenceType(n),d.addElemType(n,e),d.endSequenceType(n)}}p.SequenceType=d})(h.fbs||(h.fbs={}))})(a.experimental||(a.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(a){(function(h){(h.fbs||(h.fbs={})).EdgeEnd=class{constructor(){this.bb=null,this.bb_pos=0}__init(p,d){return this.bb_pos=p,this.bb=d,this}nodeIndex(){return this.bb.readUint32(this.bb_pos)}srcArgIndex(){return this.bb.readInt32(this.bb_pos+4)}dstArgIndex(){return this.bb.readInt32(this.bb_pos+8)}static createEdgeEnd(p,d,l,n){return p.prep(4,12),p.writeInt32(n),p.writeInt32(l),p.writeInt32(d),p.offset()}}})(a.experimental||(a.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(a){(function(h){(function(p){class d{constructor(){this.bb=null,this.bb_pos=0}__init(n,e){return this.bb_pos=n,this.bb=e,this}static getRootAsNodeEdge(n,e){return(e||new d).__init(n.readInt32(n.position())+n.position(),n)}static getSizePrefixedRootAsNodeEdge(n,e){return n.setPosition(n.position()+i.flatbuffers.SIZE_PREFIX_LENGTH),(e||new d).__init(n.readInt32(n.position())+n.position(),n)}nodeIndex(){let n=this.bb.__offset(this.bb_pos,4);return n?this.bb.readUint32(this.bb_pos+n):0}inputEdges(n,e){let o=this.bb.__offset(this.bb_pos,6);return o?(e||new a.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+o)+12*n,this.bb):null}inputEdgesLength(){let n=this.bb.__offset(this.bb_pos,6);return n?this.bb.__vector_len(this.bb_pos+n):0}outputEdges(n,e){let o=this.bb.__offset(this.bb_pos,8);return o?(e||new a.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+o)+12*n,this.bb):null}outputEdgesLength(){let n=this.bb.__offset(this.bb_pos,8);return n?this.bb.__vector_len(this.bb_pos+n):0}static startNodeEdge(n){n.startObject(3)}static addNodeIndex(n,e){n.addFieldInt32(0,e,0)}static addInputEdges(n,e){n.addFieldOffset(1,e,0)}static startInputEdgesVector(n,e){n.startVector(12,e,4)}static addOutputEdges(n,e){n.addFieldOffset(2,e,0)}static startOutputEdgesVector(n,e){n.startVector(12,e,4)}static endNodeEdge(n){return n.endObject()}static createNodeEdge(n,e,o,u){return d.startNodeEdge(n),d.addNodeIndex(n,e),d.addInputEdges(n,o),d.addOutputEdges(n,u),d.endNodeEdge(n)}}p.NodeEdge=d})(h.fbs||(h.fbs={}))})(a.experimental||(a.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(a){(function(h){(function(p){class d{constructor(){this.bb=null,this.bb_pos=0}__init(n,e){return this.bb_pos=n,this.bb=e,this}static getRootAsNode(n,e){return(e||new d).__init(n.readInt32(n.position())+n.position(),n)}static getSizePrefixedRootAsNode(n,e){return n.setPosition(n.position()+i.flatbuffers.SIZE_PREFIX_LENGTH),(e||new d).__init(n.readInt32(n.position())+n.position(),n)}name(n){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,n):null}docString(n){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,n):null}domain(n){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__string(this.bb_pos+e,n):null}sinceVersion(){let n=this.bb.__offset(this.bb_pos,10);return n?this.bb.readInt32(this.bb_pos+n):0}index(){let n=this.bb.__offset(this.bb_pos,12);return n?this.bb.readUint32(this.bb_pos+n):0}opType(n){let e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__string(this.bb_pos+e,n):null}type(){let n=this.bb.__offset(this.bb_pos,16);return n?this.bb.readInt32(this.bb_pos+n):a.experimental.fbs.NodeType.Primitive}executionProviderType(n){let e=this.bb.__offset(this.bb_pos,18);return e?this.bb.__string(this.bb_pos+e,n):null}inputs(n,e){let o=this.bb.__offset(this.bb_pos,20);return o?this.bb.__string(this.bb.__vector(this.bb_pos+o)+4*n,e):null}inputsLength(){let n=this.bb.__offset(this.bb_pos,20);return n?this.bb.__vector_len(this.bb_pos+n):0}outputs(n,e){let o=this.bb.__offset(this.bb_pos,22);return o?this.bb.__string(this.bb.__vector(this.bb_pos+o)+4*n,e):null}outputsLength(){let n=this.bb.__offset(this.bb_pos,22);return n?this.bb.__vector_len(this.bb_pos+n):0}attributes(n,e){let o=this.bb.__offset(this.bb_pos,24);return o?(e||new a.experimental.fbs.Attribute).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+o)+4*n),this.bb):null}attributesLength(){let n=this.bb.__offset(this.bb_pos,24);return n?this.bb.__vector_len(this.bb_pos+n):0}inputArgCounts(n){let e=this.bb.__offset(this.bb_pos,26);return e?this.bb.readInt32(this.bb.__vector(this.bb_pos+e)+4*n):0}inputArgCountsLength(){let n=this.bb.__offset(this.bb_pos,26);return n?this.bb.__vector_len(this.bb_pos+n):0}inputArgCountsArray(){let n=this.bb.__offset(this.bb_pos,26);return n?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+n),this.bb.__vector_len(this.bb_pos+n)):null}implicitInputs(n,e){let o=this.bb.__offset(this.bb_pos,28);return o?this.bb.__string(this.bb.__vector(this.bb_pos+o)+4*n,e):null}implicitInputsLength(){let n=this.bb.__offset(this.bb_pos,28);return n?this.bb.__vector_len(this.bb_pos+n):0}static startNode(n){n.startObject(13)}static addName(n,e){n.addFieldOffset(0,e,0)}static addDocString(n,e){n.addFieldOffset(1,e,0)}static addDomain(n,e){n.addFieldOffset(2,e,0)}static addSinceVersion(n,e){n.addFieldInt32(3,e,0)}static addIndex(n,e){n.addFieldInt32(4,e,0)}static addOpType(n,e){n.addFieldOffset(5,e,0)}static addType(n,e){n.addFieldInt32(6,e,a.experimental.fbs.NodeType.Primitive)}static addExecutionProviderType(n,e){n.addFieldOffset(7,e,0)}static addInputs(n,e){n.addFieldOffset(8,e,0)}static createInputsVector(n,e){n.startVector(4,e.length,4);for(let o=e.length-1;o>=0;o--)n.addOffset(e[o]);return n.endVector()}static startInputsVector(n,e){n.startVector(4,e,4)}static addOutputs(n,e){n.addFieldOffset(9,e,0)}static createOutputsVector(n,e){n.startVector(4,e.length,4);for(let o=e.length-1;o>=0;o--)n.addOffset(e[o]);return n.endVector()}static startOutputsVector(n,e){n.startVector(4,e,4)}static addAttributes(n,e){n.addFieldOffset(10,e,0)}static createAttributesVector(n,e){n.startVector(4,e.length,4);for(let o=e.length-1;o>=0;o--)n.addOffset(e[o]);return n.endVector()}static startAttributesVector(n,e){n.startVector(4,e,4)}static addInputArgCounts(n,e){n.addFieldOffset(11,e,0)}static createInputArgCountsVector(n,e){n.startVector(4,e.length,4);for(let o=e.length-1;o>=0;o--)n.addInt32(e[o]);return n.endVector()}static startInputArgCountsVector(n,e){n.startVector(4,e,4)}static addImplicitInputs(n,e){n.addFieldOffset(12,e,0)}static createImplicitInputsVector(n,e){n.startVector(4,e.length,4);for(let o=e.length-1;o>=0;o--)n.addOffset(e[o]);return n.endVector()}static startImplicitInputsVector(n,e){n.startVector(4,e,4)}static endNode(n){return n.endObject()}static createNode(n,e,o,u,g,m,y,b,_,x,w,T,S,I){return d.startNode(n),d.addName(n,e),d.addDocString(n,o),d.addDomain(n,u),d.addSinceVersion(n,g),d.addIndex(n,m),d.addOpType(n,y),d.addType(n,b),d.addExecutionProviderType(n,_),d.addInputs(n,x),d.addOutputs(n,w),d.addAttributes(n,T),d.addInputArgCounts(n,S),d.addImplicitInputs(n,I),d.endNode(n)}}p.Node=d})(h.fbs||(h.fbs={}))})(a.experimental||(a.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(a){(function(h){(function(p){class d{constructor(){this.bb=null,this.bb_pos=0}__init(n,e){return this.bb_pos=n,this.bb=e,this}static getRootAsValueInfo(n,e){return(e||new d).__init(n.readInt32(n.position())+n.position(),n)}static getSizePrefixedRootAsValueInfo(n,e){return n.setPosition(n.position()+i.flatbuffers.SIZE_PREFIX_LENGTH),(e||new d).__init(n.readInt32(n.position())+n.position(),n)}name(n){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,n):null}docString(n){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,n):null}type(n){let e=this.bb.__offset(this.bb_pos,8);return e?(n||new a.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startValueInfo(n){n.startObject(3)}static addName(n,e){n.addFieldOffset(0,e,0)}static addDocString(n,e){n.addFieldOffset(1,e,0)}static addType(n,e){n.addFieldOffset(2,e,0)}static endValueInfo(n){return n.endObject()}static createValueInfo(n,e,o,u){return d.startValueInfo(n),d.addName(n,e),d.addDocString(n,o),d.addType(n,u),d.endValueInfo(n)}}p.ValueInfo=d})(h.fbs||(h.fbs={}))})(a.experimental||(a.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(a){(function(h){(function(p){class d{constructor(){this.bb=null,this.bb_pos=0}__init(n,e){return this.bb_pos=n,this.bb=e,this}static getRootAsTypeInfo(n,e){return(e||new d).__init(n.readInt32(n.position())+n.position(),n)}static getSizePrefixedRootAsTypeInfo(n,e){return n.setPosition(n.position()+i.flatbuffers.SIZE_PREFIX_LENGTH),(e||new d).__init(n.readInt32(n.position())+n.position(),n)}denotation(n){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,n):null}valueType(){let n=this.bb.__offset(this.bb_pos,6);return n?this.bb.readUint8(this.bb_pos+n):a.experimental.fbs.TypeInfoValue.NONE}value(n){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__union(n,this.bb_pos+e):null}static startTypeInfo(n){n.startObject(3)}static addDenotation(n,e){n.addFieldOffset(0,e,0)}static addValueType(n,e){n.addFieldInt8(1,e,a.experimental.fbs.TypeInfoValue.NONE)}static addValue(n,e){n.addFieldOffset(2,e,0)}static endTypeInfo(n){return n.endObject()}static createTypeInfo(n,e,o,u){return d.startTypeInfo(n),d.addDenotation(n,e),d.addValueType(n,o),d.addValue(n,u),d.endTypeInfo(n)}}p.TypeInfo=d})(h.fbs||(h.fbs={}))})(a.experimental||(a.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(a){(function(h){(function(p){class d{constructor(){this.bb=null,this.bb_pos=0}__init(n,e){return this.bb_pos=n,this.bb=e,this}static getRootAsOperatorSetId(n,e){return(e||new d).__init(n.readInt32(n.position())+n.position(),n)}static getSizePrefixedRootAsOperatorSetId(n,e){return n.setPosition(n.position()+i.flatbuffers.SIZE_PREFIX_LENGTH),(e||new d).__init(n.readInt32(n.position())+n.position(),n)}domain(n){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,n):null}version(){let n=this.bb.__offset(this.bb_pos,6);return n?this.bb.readInt64(this.bb_pos+n):this.bb.createLong(0,0)}static startOperatorSetId(n){n.startObject(2)}static addDomain(n,e){n.addFieldOffset(0,e,0)}static addVersion(n,e){n.addFieldInt64(1,e,n.createLong(0,0))}static endOperatorSetId(n){return n.endObject()}static createOperatorSetId(n,e,o){return d.startOperatorSetId(n),d.addDomain(n,e),d.addVersion(n,o),d.endOperatorSetId(n)}}p.OperatorSetId=d})(h.fbs||(h.fbs={}))})(a.experimental||(a.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(a){(function(h){(function(p){class d{constructor(){this.bb=null,this.bb_pos=0}__init(n,e){return this.bb_pos=n,this.bb=e,this}static getRootAsTensor(n,e){return(e||new d).__init(n.readInt32(n.position())+n.position(),n)}static getSizePrefixedRootAsTensor(n,e){return n.setPosition(n.position()+i.flatbuffers.SIZE_PREFIX_LENGTH),(e||new d).__init(n.readInt32(n.position())+n.position(),n)}name(n){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,n):null}docString(n){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,n):null}dims(n){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readInt64(this.bb.__vector(this.bb_pos+e)+8*n):this.bb.createLong(0,0)}dimsLength(){let n=this.bb.__offset(this.bb_pos,8);return n?this.bb.__vector_len(this.bb_pos+n):0}dataType(){let n=this.bb.__offset(this.bb_pos,10);return n?this.bb.readInt32(this.bb_pos+n):a.experimental.fbs.TensorDataType.UNDEFINED}rawData(n){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+n):0}rawDataLength(){let n=this.bb.__offset(this.bb_pos,12);return n?this.bb.__vector_len(this.bb_pos+n):0}rawDataArray(){let n=this.bb.__offset(this.bb_pos,12);return n?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+n),this.bb.__vector_len(this.bb_pos+n)):null}stringData(n,e){let o=this.bb.__offset(this.bb_pos,14);return o?this.bb.__string(this.bb.__vector(this.bb_pos+o)+4*n,e):null}stringDataLength(){let n=this.bb.__offset(this.bb_pos,14);return n?this.bb.__vector_len(this.bb_pos+n):0}static startTensor(n){n.startObject(6)}static addName(n,e){n.addFieldOffset(0,e,0)}static addDocString(n,e){n.addFieldOffset(1,e,0)}static addDims(n,e){n.addFieldOffset(2,e,0)}static createDimsVector(n,e){n.startVector(8,e.length,8);for(let o=e.length-1;o>=0;o--)n.addInt64(e[o]);return n.endVector()}static startDimsVector(n,e){n.startVector(8,e,8)}static addDataType(n,e){n.addFieldInt32(3,e,a.experimental.fbs.TensorDataType.UNDEFINED)}static addRawData(n,e){n.addFieldOffset(4,e,0)}static createRawDataVector(n,e){n.startVector(1,e.length,1);for(let o=e.length-1;o>=0;o--)n.addInt8(e[o]);return n.endVector()}static startRawDataVector(n,e){n.startVector(1,e,1)}static addStringData(n,e){n.addFieldOffset(5,e,0)}static createStringDataVector(n,e){n.startVector(4,e.length,4);for(let o=e.length-1;o>=0;o--)n.addOffset(e[o]);return n.endVector()}static startStringDataVector(n,e){n.startVector(4,e,4)}static endTensor(n){return n.endObject()}static createTensor(n,e,o,u,g,m,y){return d.startTensor(n),d.addName(n,e),d.addDocString(n,o),d.addDims(n,u),d.addDataType(n,g),d.addRawData(n,m),d.addStringData(n,y),d.endTensor(n)}}p.Tensor=d})(h.fbs||(h.fbs={}))})(a.experimental||(a.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(a){(function(h){(function(p){class d{constructor(){this.bb=null,this.bb_pos=0}__init(n,e){return this.bb_pos=n,this.bb=e,this}static getRootAsSparseTensor(n,e){return(e||new d).__init(n.readInt32(n.position())+n.position(),n)}static getSizePrefixedRootAsSparseTensor(n,e){return n.setPosition(n.position()+i.flatbuffers.SIZE_PREFIX_LENGTH),(e||new d).__init(n.readInt32(n.position())+n.position(),n)}values(n){let e=this.bb.__offset(this.bb_pos,4);return e?(n||new a.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}indices(n){let e=this.bb.__offset(this.bb_pos,6);return e?(n||new a.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}dims(n){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readInt64(this.bb.__vector(this.bb_pos+e)+8*n):this.bb.createLong(0,0)}dimsLength(){let n=this.bb.__offset(this.bb_pos,8);return n?this.bb.__vector_len(this.bb_pos+n):0}static startSparseTensor(n){n.startObject(3)}static addValues(n,e){n.addFieldOffset(0,e,0)}static addIndices(n,e){n.addFieldOffset(1,e,0)}static addDims(n,e){n.addFieldOffset(2,e,0)}static createDimsVector(n,e){n.startVector(8,e.length,8);for(let o=e.length-1;o>=0;o--)n.addInt64(e[o]);return n.endVector()}static startDimsVector(n,e){n.startVector(8,e,8)}static endSparseTensor(n){return n.endObject()}static createSparseTensor(n,e,o,u){return d.startSparseTensor(n),d.addValues(n,e),d.addIndices(n,o),d.addDims(n,u),d.endSparseTensor(n)}}p.SparseTensor=d})(h.fbs||(h.fbs={}))})(a.experimental||(a.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(a){(function(h){(function(p){class d{constructor(){this.bb=null,this.bb_pos=0}__init(n,e){return this.bb_pos=n,this.bb=e,this}static getRootAsAttribute(n,e){return(e||new d).__init(n.readInt32(n.position())+n.position(),n)}static getSizePrefixedRootAsAttribute(n,e){return n.setPosition(n.position()+i.flatbuffers.SIZE_PREFIX_LENGTH),(e||new d).__init(n.readInt32(n.position())+n.position(),n)}name(n){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,n):null}docString(n){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,n):null}type(){let n=this.bb.__offset(this.bb_pos,8);return n?this.bb.readInt32(this.bb_pos+n):a.experimental.fbs.AttributeType.UNDEFINED}f(){let n=this.bb.__offset(this.bb_pos,10);return n?this.bb.readFloat32(this.bb_pos+n):0}i(){let n=this.bb.__offset(this.bb_pos,12);return n?this.bb.readInt64(this.bb_pos+n):this.bb.createLong(0,0)}s(n){let e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__string(this.bb_pos+e,n):null}t(n){let e=this.bb.__offset(this.bb_pos,16);return e?(n||new a.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}g(n){let e=this.bb.__offset(this.bb_pos,18);return e?(n||new a.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}floats(n){let e=this.bb.__offset(this.bb_pos,20);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+4*n):0}floatsLength(){let n=this.bb.__offset(this.bb_pos,20);return n?this.bb.__vector_len(this.bb_pos+n):0}floatsArray(){let n=this.bb.__offset(this.bb_pos,20);return n?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+n),this.bb.__vector_len(this.bb_pos+n)):null}ints(n){let e=this.bb.__offset(this.bb_pos,22);return e?this.bb.readInt64(this.bb.__vector(this.bb_pos+e)+8*n):this.bb.createLong(0,0)}intsLength(){let n=this.bb.__offset(this.bb_pos,22);return n?this.bb.__vector_len(this.bb_pos+n):0}strings(n,e){let o=this.bb.__offset(this.bb_pos,24);return o?this.bb.__string(this.bb.__vector(this.bb_pos+o)+4*n,e):null}stringsLength(){let n=this.bb.__offset(this.bb_pos,24);return n?this.bb.__vector_len(this.bb_pos+n):0}tensors(n,e){let o=this.bb.__offset(this.bb_pos,26);return o?(e||new a.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+o)+4*n),this.bb):null}tensorsLength(){let n=this.bb.__offset(this.bb_pos,26);return n?this.bb.__vector_len(this.bb_pos+n):0}graphs(n,e){let o=this.bb.__offset(this.bb_pos,28);return o?(e||new a.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+o)+4*n),this.bb):null}graphsLength(){let n=this.bb.__offset(this.bb_pos,28);return n?this.bb.__vector_len(this.bb_pos+n):0}static startAttribute(n){n.startObject(13)}static addName(n,e){n.addFieldOffset(0,e,0)}static addDocString(n,e){n.addFieldOffset(1,e,0)}static addType(n,e){n.addFieldInt32(2,e,a.experimental.fbs.AttributeType.UNDEFINED)}static addF(n,e){n.addFieldFloat32(3,e,0)}static addI(n,e){n.addFieldInt64(4,e,n.createLong(0,0))}static addS(n,e){n.addFieldOffset(5,e,0)}static addT(n,e){n.addFieldOffset(6,e,0)}static addG(n,e){n.addFieldOffset(7,e,0)}static addFloats(n,e){n.addFieldOffset(8,e,0)}static createFloatsVector(n,e){n.startVector(4,e.length,4);for(let o=e.length-1;o>=0;o--)n.addFloat32(e[o]);return n.endVector()}static startFloatsVector(n,e){n.startVector(4,e,4)}static addInts(n,e){n.addFieldOffset(9,e,0)}static createIntsVector(n,e){n.startVector(8,e.length,8);for(let o=e.length-1;o>=0;o--)n.addInt64(e[o]);return n.endVector()}static startIntsVector(n,e){n.startVector(8,e,8)}static addStrings(n,e){n.addFieldOffset(10,e,0)}static createStringsVector(n,e){n.startVector(4,e.length,4);for(let o=e.length-1;o>=0;o--)n.addOffset(e[o]);return n.endVector()}static startStringsVector(n,e){n.startVector(4,e,4)}static addTensors(n,e){n.addFieldOffset(11,e,0)}static createTensorsVector(n,e){n.startVector(4,e.length,4);for(let o=e.length-1;o>=0;o--)n.addOffset(e[o]);return n.endVector()}static startTensorsVector(n,e){n.startVector(4,e,4)}static addGraphs(n,e){n.addFieldOffset(12,e,0)}static createGraphsVector(n,e){n.startVector(4,e.length,4);for(let o=e.length-1;o>=0;o--)n.addOffset(e[o]);return n.endVector()}static startGraphsVector(n,e){n.startVector(4,e,4)}static endAttribute(n){return n.endObject()}static createAttribute(n,e,o,u,g,m,y,b,_,x,w,T,S,I){return d.startAttribute(n),d.addName(n,e),d.addDocString(n,o),d.addType(n,u),d.addF(n,g),d.addI(n,m),d.addS(n,y),d.addT(n,b),d.addG(n,_),d.addFloats(n,x),d.addInts(n,w),d.addStrings(n,T),d.addTensors(n,S),d.addGraphs(n,I),d.endAttribute(n)}}p.Attribute=d})(h.fbs||(h.fbs={}))})(a.experimental||(a.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(a){(function(h){(function(p){class d{constructor(){this.bb=null,this.bb_pos=0}__init(n,e){return this.bb_pos=n,this.bb=e,this}static getRootAsGraph(n,e){return(e||new d).__init(n.readInt32(n.position())+n.position(),n)}static getSizePrefixedRootAsGraph(n,e){return n.setPosition(n.position()+i.flatbuffers.SIZE_PREFIX_LENGTH),(e||new d).__init(n.readInt32(n.position())+n.position(),n)}initializers(n,e){let o=this.bb.__offset(this.bb_pos,4);return o?(e||new a.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+o)+4*n),this.bb):null}initializersLength(){let n=this.bb.__offset(this.bb_pos,4);return n?this.bb.__vector_len(this.bb_pos+n):0}nodeArgs(n,e){let o=this.bb.__offset(this.bb_pos,6);return o?(e||new a.experimental.fbs.ValueInfo).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+o)+4*n),this.bb):null}nodeArgsLength(){let n=this.bb.__offset(this.bb_pos,6);return n?this.bb.__vector_len(this.bb_pos+n):0}nodes(n,e){let o=this.bb.__offset(this.bb_pos,8);return o?(e||new a.experimental.fbs.Node).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+o)+4*n),this.bb):null}nodesLength(){let n=this.bb.__offset(this.bb_pos,8);return n?this.bb.__vector_len(this.bb_pos+n):0}maxNodeIndex(){let n=this.bb.__offset(this.bb_pos,10);return n?this.bb.readUint32(this.bb_pos+n):0}nodeEdges(n,e){let o=this.bb.__offset(this.bb_pos,12);return o?(e||new a.experimental.fbs.NodeEdge).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+o)+4*n),this.bb):null}nodeEdgesLength(){let n=this.bb.__offset(this.bb_pos,12);return n?this.bb.__vector_len(this.bb_pos+n):0}inputs(n,e){let o=this.bb.__offset(this.bb_pos,14);return o?this.bb.__string(this.bb.__vector(this.bb_pos+o)+4*n,e):null}inputsLength(){let n=this.bb.__offset(this.bb_pos,14);return n?this.bb.__vector_len(this.bb_pos+n):0}outputs(n,e){let o=this.bb.__offset(this.bb_pos,16);return o?this.bb.__string(this.bb.__vector(this.bb_pos+o)+4*n,e):null}outputsLength(){let n=this.bb.__offset(this.bb_pos,16);return n?this.bb.__vector_len(this.bb_pos+n):0}sparseInitializers(n,e){let o=this.bb.__offset(this.bb_pos,18);return o?(e||new a.experimental.fbs.SparseTensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+o)+4*n),this.bb):null}sparseInitializersLength(){let n=this.bb.__offset(this.bb_pos,18);return n?this.bb.__vector_len(this.bb_pos+n):0}static startGraph(n){n.startObject(8)}static addInitializers(n,e){n.addFieldOffset(0,e,0)}static createInitializersVector(n,e){n.startVector(4,e.length,4);for(let o=e.length-1;o>=0;o--)n.addOffset(e[o]);return n.endVector()}static startInitializersVector(n,e){n.startVector(4,e,4)}static addNodeArgs(n,e){n.addFieldOffset(1,e,0)}static createNodeArgsVector(n,e){n.startVector(4,e.length,4);for(let o=e.length-1;o>=0;o--)n.addOffset(e[o]);return n.endVector()}static startNodeArgsVector(n,e){n.startVector(4,e,4)}static addNodes(n,e){n.addFieldOffset(2,e,0)}static createNodesVector(n,e){n.startVector(4,e.length,4);for(let o=e.length-1;o>=0;o--)n.addOffset(e[o]);return n.endVector()}static startNodesVector(n,e){n.startVector(4,e,4)}static addMaxNodeIndex(n,e){n.addFieldInt32(3,e,0)}static addNodeEdges(n,e){n.addFieldOffset(4,e,0)}static createNodeEdgesVector(n,e){n.startVector(4,e.length,4);for(let o=e.length-1;o>=0;o--)n.addOffset(e[o]);return n.endVector()}static startNodeEdgesVector(n,e){n.startVector(4,e,4)}static addInputs(n,e){n.addFieldOffset(5,e,0)}static createInputsVector(n,e){n.startVector(4,e.length,4);for(let o=e.length-1;o>=0;o--)n.addOffset(e[o]);return n.endVector()}static startInputsVector(n,e){n.startVector(4,e,4)}static addOutputs(n,e){n.addFieldOffset(6,e,0)}static createOutputsVector(n,e){n.startVector(4,e.length,4);for(let o=e.length-1;o>=0;o--)n.addOffset(e[o]);return n.endVector()}static startOutputsVector(n,e){n.startVector(4,e,4)}static addSparseInitializers(n,e){n.addFieldOffset(7,e,0)}static createSparseInitializersVector(n,e){n.startVector(4,e.length,4);for(let o=e.length-1;o>=0;o--)n.addOffset(e[o]);return n.endVector()}static startSparseInitializersVector(n,e){n.startVector(4,e,4)}static endGraph(n){return n.endObject()}static createGraph(n,e,o,u,g,m,y,b,_){return d.startGraph(n),d.addInitializers(n,e),d.addNodeArgs(n,o),d.addNodes(n,u),d.addMaxNodeIndex(n,g),d.addNodeEdges(n,m),d.addInputs(n,y),d.addOutputs(n,b),d.addSparseInitializers(n,_),d.endGraph(n)}}p.Graph=d})(h.fbs||(h.fbs={}))})(a.experimental||(a.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(a){(function(h){(function(p){class d{constructor(){this.bb=null,this.bb_pos=0}__init(n,e){return this.bb_pos=n,this.bb=e,this}static getRootAsModel(n,e){return(e||new d).__init(n.readInt32(n.position())+n.position(),n)}static getSizePrefixedRootAsModel(n,e){return n.setPosition(n.position()+i.flatbuffers.SIZE_PREFIX_LENGTH),(e||new d).__init(n.readInt32(n.position())+n.position(),n)}irVersion(){let n=this.bb.__offset(this.bb_pos,4);return n?this.bb.readInt64(this.bb_pos+n):this.bb.createLong(0,0)}opsetImport(n,e){let o=this.bb.__offset(this.bb_pos,6);return o?(e||new a.experimental.fbs.OperatorSetId).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+o)+4*n),this.bb):null}opsetImportLength(){let n=this.bb.__offset(this.bb_pos,6);return n?this.bb.__vector_len(this.bb_pos+n):0}producerName(n){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__string(this.bb_pos+e,n):null}producerVersion(n){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__string(this.bb_pos+e,n):null}domain(n){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__string(this.bb_pos+e,n):null}modelVersion(){let n=this.bb.__offset(this.bb_pos,14);return n?this.bb.readInt64(this.bb_pos+n):this.bb.createLong(0,0)}docString(n){let e=this.bb.__offset(this.bb_pos,16);return e?this.bb.__string(this.bb_pos+e,n):null}graph(n){let e=this.bb.__offset(this.bb_pos,18);return e?(n||new a.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}graphDocString(n){let e=this.bb.__offset(this.bb_pos,20);return e?this.bb.__string(this.bb_pos+e,n):null}static startModel(n){n.startObject(9)}static addIrVersion(n,e){n.addFieldInt64(0,e,n.createLong(0,0))}static addOpsetImport(n,e){n.addFieldOffset(1,e,0)}static createOpsetImportVector(n,e){n.startVector(4,e.length,4);for(let o=e.length-1;o>=0;o--)n.addOffset(e[o]);return n.endVector()}static startOpsetImportVector(n,e){n.startVector(4,e,4)}static addProducerName(n,e){n.addFieldOffset(2,e,0)}static addProducerVersion(n,e){n.addFieldOffset(3,e,0)}static addDomain(n,e){n.addFieldOffset(4,e,0)}static addModelVersion(n,e){n.addFieldInt64(5,e,n.createLong(0,0))}static addDocString(n,e){n.addFieldOffset(6,e,0)}static addGraph(n,e){n.addFieldOffset(7,e,0)}static addGraphDocString(n,e){n.addFieldOffset(8,e,0)}static endModel(n){return n.endObject()}static createModel(n,e,o,u,g,m,y,b,_,x){return d.startModel(n),d.addIrVersion(n,e),d.addOpsetImport(n,o),d.addProducerName(n,u),d.addProducerVersion(n,g),d.addDomain(n,m),d.addModelVersion(n,y),d.addDocString(n,b),d.addGraph(n,_),d.addGraphDocString(n,x),d.endModel(n)}}p.Model=d})(h.fbs||(h.fbs={}))})(a.experimental||(a.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(a){(function(h){(function(p){class d{constructor(){this.bb=null,this.bb_pos=0}__init(n,e){return this.bb_pos=n,this.bb=e,this}static getRootAsKernelCreateInfos(n,e){return(e||new d).__init(n.readInt32(n.position())+n.position(),n)}static getSizePrefixedRootAsKernelCreateInfos(n,e){return n.setPosition(n.position()+i.flatbuffers.SIZE_PREFIX_LENGTH),(e||new d).__init(n.readInt32(n.position())+n.position(),n)}nodeIndices(n){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+4*n):0}nodeIndicesLength(){let n=this.bb.__offset(this.bb_pos,4);return n?this.bb.__vector_len(this.bb_pos+n):0}nodeIndicesArray(){let n=this.bb.__offset(this.bb_pos,4);return n?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+n),this.bb.__vector_len(this.bb_pos+n)):null}kernelDefHashes(n){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint64(this.bb.__vector(this.bb_pos+e)+8*n):this.bb.createLong(0,0)}kernelDefHashesLength(){let n=this.bb.__offset(this.bb_pos,6);return n?this.bb.__vector_len(this.bb_pos+n):0}static startKernelCreateInfos(n){n.startObject(2)}static addNodeIndices(n,e){n.addFieldOffset(0,e,0)}static createNodeIndicesVector(n,e){n.startVector(4,e.length,4);for(let o=e.length-1;o>=0;o--)n.addInt32(e[o]);return n.endVector()}static startNodeIndicesVector(n,e){n.startVector(4,e,4)}static addKernelDefHashes(n,e){n.addFieldOffset(1,e,0)}static createKernelDefHashesVector(n,e){n.startVector(8,e.length,8);for(let o=e.length-1;o>=0;o--)n.addInt64(e[o]);return n.endVector()}static startKernelDefHashesVector(n,e){n.startVector(8,e,8)}static endKernelCreateInfos(n){return n.endObject()}static createKernelCreateInfos(n,e,o){return d.startKernelCreateInfos(n),d.addNodeIndices(n,e),d.addKernelDefHashes(n,o),d.endKernelCreateInfos(n)}}p.KernelCreateInfos=d})(h.fbs||(h.fbs={}))})(a.experimental||(a.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(a){(function(h){(function(p){class d{constructor(){this.bb=null,this.bb_pos=0}__init(n,e){return this.bb_pos=n,this.bb=e,this}static getRootAsSubGraphSessionState(n,e){return(e||new d).__init(n.readInt32(n.position())+n.position(),n)}static getSizePrefixedRootAsSubGraphSessionState(n,e){return n.setPosition(n.position()+i.flatbuffers.SIZE_PREFIX_LENGTH),(e||new d).__init(n.readInt32(n.position())+n.position(),n)}graphId(n){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,n):null}sessionState(n){let e=this.bb.__offset(this.bb_pos,6);return e?(n||new a.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startSubGraphSessionState(n){n.startObject(2)}static addGraphId(n,e){n.addFieldOffset(0,e,0)}static addSessionState(n,e){n.addFieldOffset(1,e,0)}static endSubGraphSessionState(n){let e=n.endObject();return n.requiredField(e,4),e}static createSubGraphSessionState(n,e,o){return d.startSubGraphSessionState(n),d.addGraphId(n,e),d.addSessionState(n,o),d.endSubGraphSessionState(n)}}p.SubGraphSessionState=d})(h.fbs||(h.fbs={}))})(a.experimental||(a.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(a){(function(h){(function(p){class d{constructor(){this.bb=null,this.bb_pos=0}__init(n,e){return this.bb_pos=n,this.bb=e,this}static getRootAsSessionState(n,e){return(e||new d).__init(n.readInt32(n.position())+n.position(),n)}static getSizePrefixedRootAsSessionState(n,e){return n.setPosition(n.position()+i.flatbuffers.SIZE_PREFIX_LENGTH),(e||new d).__init(n.readInt32(n.position())+n.position(),n)}kernels(n){let e=this.bb.__offset(this.bb_pos,4);return e?(n||new a.experimental.fbs.KernelCreateInfos).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}subGraphSessionStates(n,e){let o=this.bb.__offset(this.bb_pos,6);return o?(e||new a.experimental.fbs.SubGraphSessionState).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+o)+4*n),this.bb):null}subGraphSessionStatesLength(){let n=this.bb.__offset(this.bb_pos,6);return n?this.bb.__vector_len(this.bb_pos+n):0}static startSessionState(n){n.startObject(2)}static addKernels(n,e){n.addFieldOffset(0,e,0)}static addSubGraphSessionStates(n,e){n.addFieldOffset(1,e,0)}static createSubGraphSessionStatesVector(n,e){n.startVector(4,e.length,4);for(let o=e.length-1;o>=0;o--)n.addOffset(e[o]);return n.endVector()}static startSubGraphSessionStatesVector(n,e){n.startVector(4,e,4)}static endSessionState(n){return n.endObject()}static createSessionState(n,e,o){return d.startSessionState(n),d.addKernels(n,e),d.addSubGraphSessionStates(n,o),d.endSessionState(n)}}p.SessionState=d})(h.fbs||(h.fbs={}))})(a.experimental||(a.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(a){(function(h){(function(p){class d{constructor(){this.bb=null,this.bb_pos=0}__init(n,e){return this.bb_pos=n,this.bb=e,this}static getRootAsInferenceSession(n,e){return(e||new d).__init(n.readInt32(n.position())+n.position(),n)}static getSizePrefixedRootAsInferenceSession(n,e){return n.setPosition(n.position()+i.flatbuffers.SIZE_PREFIX_LENGTH),(e||new d).__init(n.readInt32(n.position())+n.position(),n)}static bufferHasIdentifier(n){return n.__has_identifier("ORTM")}ortVersion(n){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,n):null}model(n){let e=this.bb.__offset(this.bb_pos,6);return e?(n||new a.experimental.fbs.Model).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}sessionState(n){let e=this.bb.__offset(this.bb_pos,8);return e?(n||new a.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startInferenceSession(n){n.startObject(3)}static addOrtVersion(n,e){n.addFieldOffset(0,e,0)}static addModel(n,e){n.addFieldOffset(1,e,0)}static addSessionState(n,e){n.addFieldOffset(2,e,0)}static endInferenceSession(n){return n.endObject()}static finishInferenceSessionBuffer(n,e){n.finish(e,"ORTM")}static finishSizePrefixedInferenceSessionBuffer(n,e){n.finish(e,"ORTM",!0)}static createInferenceSession(n,e,o,u){return d.startInferenceSession(n),d.addOrtVersion(n,e),d.addModel(n,o),d.addSessionState(n,u),d.endInferenceSession(n)}}p.InferenceSession=d})(h.fbs||(h.fbs={}))})(a.experimental||(a.experimental={}))}(t.onnxruntime||(t.onnxruntime={}))},7448:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OnnxjsSessionHandler=void 0;const i=r(1670),s=r(9162);t.OnnxjsSessionHandler=class{constructor(c){this.session=c,this.inputNames=this.session.inputNames,this.outputNames=this.session.outputNames}async dispose(){}async run(c,a,h){const p=new Map;for(const n in c)if(Object.hasOwnProperty.call(c,n)){const e=c[n];p.set(n,new s.Tensor(e.dims,e.type,void 0,void 0,e.data))}const d=await this.session.run(p),l={};return d.forEach((n,e)=>{l[e]=new i.Tensor(n.type,n.data,n.dims)}),l}startProfiling(){this.session.startProfiling()}endProfiling(){this.session.endProfiling()}}},6919:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Session=void 0;const i=r(7067),s=r(1296),c=r(7091),a=r(1036),h=r(6231),p=r(2644);t.Session=class{constructor(d={}){this._initialized=!1,this.backendHint=d.backendHint,this.profiler=h.Profiler.create(d.profiler),this.context={profiler:this.profiler,graphInputTypes:[],graphInputDims:[]}}get inputNames(){return this._model.graph.getInputNames()}get outputNames(){return this._model.graph.getOutputNames()}startProfiling(){this.profiler.start()}endProfiling(){this.profiler.stop()}async loadModel(d,l,n){await this.profiler.event("session","Session.loadModel",async()=>{const e=await(0,c.resolveBackend)(this.backendHint);if(this.sessionHandler=e.createSessionHandler(this.context),this._model=new p.Model,typeof d=="string"){const o=d.endsWith(".ort");if(typeof fetch>"u"){const u=await(0,s.promisify)(i.readFile)(d);this.initialize(u,o)}else{const u=await fetch(d),g=await u.arrayBuffer();this.initialize(new Uint8Array(g),o)}}else if(ArrayBuffer.isView(d))this.initialize(d);else{const o=new Uint8Array(d,l||0,n||d.byteLength);this.initialize(o)}})}initialize(d,l){if(this._initialized)throw new Error("already initialized");this.profiler.event("session","Session.initialize",()=>{const n=this.sessionHandler.transformGraph?this.sessionHandler:void 0;this._model.load(d,n,l),this.sessionHandler.onGraphInitialized&&this.sessionHandler.onGraphInitialized(this._model.graph),this.initializeOps(this._model.graph),this._executionPlan=new a.ExecutionPlan(this._model.graph,this._ops,this.profiler)}),this._initialized=!0}async run(d){if(!this._initialized)throw new Error("session not initialized yet");return this.profiler.event("session","Session.run",async()=>{const l=this.normalizeAndValidateInputs(d),n=await this._executionPlan.execute(this.sessionHandler,l);return this.createOutput(n)})}normalizeAndValidateInputs(d){const l=this._model.graph.getInputNames();if(Array.isArray(d)){if(d.length!==l.length)throw new Error(`incorrect input array length: expected ${l.length} but got ${d.length}`)}else{if(d.size!==l.length)throw new Error(`incorrect input map size: expected ${l.length} but got ${d.size}`);const n=new Array(d.size);let e=0;for(let o=0;o<l.length;++o){const u=d.get(l[o]);if(!u)throw new Error(`missing input tensor for: '${name}'`);n[e++]=u}d=n}if(this.context.graphInputTypes&&this.context.graphInputTypes.length!==0&&this.context.graphInputDims&&this.context.graphInputDims.length!==0)this.validateInputTensorDims(this.context.graphInputDims,d,!1);else{const n=this._model.graph.getInputIndices(),e=this._model.graph.getValues(),o=new Array(n.length);for(let u=0;u<n.length;++u){const g=e[n[u]];o[u]=g.type.shape.dims,this.context.graphInputTypes.push(g.type.tensorType),this.context.graphInputDims.push(d[u].dims)}this.validateInputTensorDims(o,d,!0)}return this.validateInputTensorTypes(this.context.graphInputTypes,d),d}validateInputTensorTypes(d,l){for(let n=0;n<l.length;n++){const e=d[n],o=l[n].type;if(e!==o)throw new Error(`input tensor[${n}] check failed: expected type '${e}' but got ${o}`)}}validateInputTensorDims(d,l,n){for(let e=0;e<l.length;e++){const o=d[e],u=l[e].dims;if(!this.compareTensorDims(o,u,n))throw new Error(`input tensor[${e}] check failed: expected shape '[${o.join(",")}]' but got [${u.join(",")}]`)}}compareTensorDims(d,l,n){if(d.length!==l.length)return!1;for(let e=0;e<d.length;++e)if(d[e]!==l[e]&&(!n||d[e]!==0))return!1;return!0}createOutput(d){const l=this._model.graph.getOutputNames();if(d.length!==l.length)throw new Error("expected number of outputs do not match number of generated outputs");const n=new Map;for(let e=0;e<l.length;++e)n.set(l[e],d[e]);return n}initializeOps(d){const l=d.getNodes();this._ops=new Array(l.length);for(let n=0;n<l.length;n++)this._ops[n]=this.sessionHandler.resolve(l[n],this._model.opsets,d)}}},9162:function(f,t,r){var i=this&&this.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(t,"__esModule",{value:!0}),t.Tensor=void 0;const s=r(3442),c=i(r(3720)),a=r(1446),h=r(9395),p=r(2517);var d=h.onnxruntime.experimental.fbs;class l{get data(){if(this.cache===void 0){const m=this.dataProvider(this.dataId);if(m.length!==this.size)throw new Error("Length of data provided by the Data Provider is inconsistent with the dims of this Tensor.");this.cache=m}return this.cache}get stringData(){if(this.type!=="string")throw new TypeError("data type is not string");return this.data}get integerData(){switch(this.type){case"uint8":case"int8":case"uint16":case"int16":case"int32":case"uint32":case"bool":return this.data;default:throw new TypeError("data type is not integer (uint8, int8, uint16, int16, int32, uint32, bool)")}}get floatData(){switch(this.type){case"float32":case"float64":return this.data;default:throw new TypeError("data type is not float (float32, float64)")}}get numberData(){if(this.type!=="string")return this.data;throw new TypeError("type cannot be non-number (string)")}get(m){return this.data[p.ShapeUtil.indicesToOffset(m,this.strides)]}set(m,y){this.data[p.ShapeUtil.indicesToOffset(m,this.strides)]=y}async getData(){return this.cache===void 0&&(this.cache=await this.asyncDataProvider(this.dataId)),this.cache}get strides(){return this._strides||(this._strides=p.ShapeUtil.computeStrides(this.dims)),this._strides}constructor(m,y,b,_,x,w=s.Guid.create()){this.dims=m,this.type=y,this.dataProvider=b,this.asyncDataProvider=_,this.cache=x,this.dataId=w,this.size=p.ShapeUtil.validateDimsAndCalcSize(m);const T=this.size,S=b===void 0&&_===void 0&&x===void 0;if(x!==void 0&&x.length!==T)throw new RangeError("Input dims doesn't match data length.");if(y==="string"){if(!(x===void 0||Array.isArray(x)&&x.every(I=>typeof I=="string")))throw new TypeError("cache should be a string array");S&&(this.cache=new Array(T))}else{if(x!==void 0){const I=e(y);if(!(x instanceof I))throw new TypeError(`cache should be type ${I.name}`)}if(S){const I=new ArrayBuffer(T*function(v){switch(v){case"bool":case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;case"float64":return 8;default:throw new Error(`cannot calculate sizeof() on type ${v}`)}}(y));this.cache=function(v,A){return new(e(A))(v)}(I,y)}}}static fromProto(m){if(!m)throw new Error("cannot construct Value from an empty tensor");const y=p.ProtoUtil.tensorDataTypeFromProto(m.dataType),b=p.ProtoUtil.tensorDimsFromProto(m.dims),_=new l(b,y);if(y==="string")m.stringData.forEach((x,w)=>{_.data[w]=(0,p.decodeUtf8String)(x)});else if(m.rawData&&typeof m.rawData.byteLength=="number"&&m.rawData.byteLength>0){const x=_.data,w=new DataView(m.rawData.buffer,m.rawData.byteOffset,m.rawData.byteLength),T=n(m.dataType),S=m.rawData.byteLength/T;if(m.rawData.byteLength%T!=0)throw new Error("invalid buffer length");if(x.length!==S)throw new Error("buffer length mismatch");for(let I=0;I<S;I++){const v=u(w,m.dataType,I*T);x[I]=v}}else{let x;switch(m.dataType){case a.onnx.TensorProto.DataType.FLOAT:x=m.floatData;break;case a.onnx.TensorProto.DataType.INT32:case a.onnx.TensorProto.DataType.INT16:case a.onnx.TensorProto.DataType.UINT16:case a.onnx.TensorProto.DataType.INT8:case a.onnx.TensorProto.DataType.UINT8:case a.onnx.TensorProto.DataType.BOOL:x=m.int32Data;break;case a.onnx.TensorProto.DataType.INT64:x=m.int64Data;break;case a.onnx.TensorProto.DataType.DOUBLE:x=m.doubleData;break;case a.onnx.TensorProto.DataType.UINT32:case a.onnx.TensorProto.DataType.UINT64:x=m.uint64Data;break;default:throw new Error("unspecific error")}if(x==null)throw new Error("failed to populate data from a tensorproto value");const w=_.data;if(w.length!==x.length)throw new Error("array length mismatch");for(let T=0;T<x.length;T++){const S=x[T];c.default.isLong(S)?w[T]=o(S,m.dataType):w[T]=S}}return _}static fromData(m,y,b){return new l(y,b,void 0,void 0,m)}static fromOrtTensor(m){if(!m)throw new Error("cannot construct Value from an empty tensor");const y=p.ProtoUtil.tensorDimsFromORTFormat(m),b=p.ProtoUtil.tensorDataTypeFromProto(m.dataType()),_=new l(y,b);if(b==="string")for(let x=0;x<m.stringDataLength();x++)_.data[x]=m.stringData(x);else if(m.rawDataArray()&&typeof m.rawDataLength()=="number"&&m.rawDataLength()>0){const x=_.data,w=new DataView(m.rawDataArray().buffer,m.rawDataArray().byteOffset,m.rawDataLength()),T=n(m.dataType()),S=m.rawDataLength()/T;if(m.rawDataLength()%T!=0)throw new Error("invalid buffer length");if(x.length!==S)throw new Error("buffer length mismatch");for(let I=0;I<S;I++){const v=u(w,m.dataType(),I*T);x[I]=v}}return _}}function n(g){switch(g){case a.onnx.TensorProto.DataType.UINT8:case a.onnx.TensorProto.DataType.INT8:case a.onnx.TensorProto.DataType.BOOL:return 1;case a.onnx.TensorProto.DataType.UINT16:case a.onnx.TensorProto.DataType.INT16:return 2;case a.onnx.TensorProto.DataType.FLOAT:case a.onnx.TensorProto.DataType.INT32:case a.onnx.TensorProto.DataType.UINT32:return 4;case a.onnx.TensorProto.DataType.INT64:case a.onnx.TensorProto.DataType.DOUBLE:case a.onnx.TensorProto.DataType.UINT64:return 8;default:throw new Error(`cannot calculate sizeof() on type ${a.onnx.TensorProto.DataType[g]}`)}}function e(g){switch(g){case"bool":case"uint8":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"uint16":return Uint16Array;case"int32":return Int32Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;default:throw new Error("unspecified error")}}function o(g,m){if(m===a.onnx.TensorProto.DataType.INT64||m===d.TensorDataType.INT64){if(g.greaterThanOrEqual(2147483648)||g.lessThan(-2147483648))throw new TypeError("int64 is not supported")}else{if(m!==a.onnx.TensorProto.DataType.UINT32&&m!==d.TensorDataType.UINT32&&m!==a.onnx.TensorProto.DataType.UINT64&&m!==d.TensorDataType.UINT64)throw new TypeError(`not a LONG type: ${a.onnx.TensorProto.DataType[m]}`);if(g.greaterThanOrEqual(4294967296)||g.lessThan(0))throw new TypeError("uint64 is not supported")}return g.toNumber()}function u(g,m,y){switch(m){case a.onnx.TensorProto.DataType.BOOL:case a.onnx.TensorProto.DataType.UINT8:return g.getUint8(y);case a.onnx.TensorProto.DataType.INT8:return g.getInt8(y);case a.onnx.TensorProto.DataType.UINT16:return g.getUint16(y,!0);case a.onnx.TensorProto.DataType.INT16:return g.getInt16(y,!0);case a.onnx.TensorProto.DataType.FLOAT:return g.getFloat32(y,!0);case a.onnx.TensorProto.DataType.INT32:return g.getInt32(y,!0);case a.onnx.TensorProto.DataType.UINT32:return g.getUint32(y,!0);case a.onnx.TensorProto.DataType.INT64:return o(c.default.fromBits(g.getUint32(y,!0),g.getUint32(y+4,!0),!1),m);case a.onnx.TensorProto.DataType.DOUBLE:return g.getFloat64(y,!0);case a.onnx.TensorProto.DataType.UINT64:return o(c.default.fromBits(g.getUint32(y,!0),g.getUint32(y+4,!0),!0),m);default:throw new Error(`cannot read from DataView for type ${a.onnx.TensorProto.DataType[m]}`)}}t.Tensor=l},2517:function(f,t,r){var i=this&&this.__importDefault||function(m){return m&&m.__esModule?m:{default:m}};Object.defineProperty(t,"__esModule",{value:!0}),t.decodeUtf8String=t.MAX_CLIP=t.MIN_CLIP=t.PoolConvUtil=t.ReduceUtil=t.SplitUtil=t.MathUtil=t.ShapeUtil=t.LongUtil=t.ProtoUtil=t.GemmUtil=t.arrayCopyHelper=t.BroadcastUtil=t.MatMulUtil=t.ArrayUtil=t.assert=t.checkInputsShape=void 0;const s=r(5686),c=i(r(3720)),a=r(1446),h=r(9162);t.checkInputsShape=function(m,...y){if(!m||m.length!==y.length)return!1;for(let b=0;b<m.length;b++)if(!m[b].dims||m[b].dims.length!==y[b])return!1;return!0},t.assert=function(m,y){if(!m)throw new Error(typeof y=="string"?y:y())},t.ArrayUtil=class{static arraysEqual(m,y){if(m.length!==y.length)return!1;for(let b=0;b<m.length;b++)if(m[b]!==y[b])return!1;return!0}};class p{static preprocessInputShapes(y,b){return[y.length===1?[1,y[0]]:y,b.length===1?[b[0],1]:b]}static postprocessOutputShape(y,b,_){b===1&&y.splice(y.length-2,1),_===1&&y.pop()}static calcMatMulShape(y,b){return y[1]!==b[0]?void 0:[y[0],b[1]]}}t.MatMulUtil=p;class d{static calcShape(y,b,_=!1){const x=y.length,w=b.length;if(x===0)return b;if(w===0)return y;const T=Math.max(y.length,b.length),S=new Array(T);if(_){if(x<2||w<2)return;const I=p.calcMatMulShape([y[x-2],y[x-1]],[b[w-2],b[w-1]]);if(I===void 0)return;[S[T-2],S[T-1]]=I}for(let I=_?3:1;I<=T;I++){const v=x-I<0?1:y[x-I],A=w-I<0?1:b[w-I];if(v!==A&&v>1&&A>1)return;S[T-I]=Math.max(v,A)}return S}static index(y,b){const _=new Array(b.length);return d.fillIndex(y,b,_),_}static fillIndex(y,b,_){const x=y.length-b.length;for(let w=0;w<b.length;w++)_[w]=y[x+w]%b[w]}static calc(y,b,_,x,w){const T=d.calcShape(y.dims,b.dims);if(T){if(x&&!e.areEqual(T,y.dims))return;const S=e.size(T),I=x?y:new h.Tensor(T,w||y.type);if(T.length===0)I.set([],_(y.get([]),b.get([])));else{const v=new Array(T.length),A=new Array(y.dims.length),L=new Array(b.dims.length);let N,$=0,D=0,R=!1,O=!1;y.dims.length===0&&($=y.get([]),R=!0),b.dims.length===0&&(D=b.get([]),O=!0);for(let F=0;F<S;F++){N=F;for(let z=T.length-1;z>=0;z--)v[z]=N%T[z],N=Math.floor(N/T[z]);R||(d.fillIndex(v,y.dims,A),$=y.get(A)),O||(d.fillIndex(v,b.dims,L),D=b.get(L)),I.set(v,_($,D))}}return I}}static isValidBroadcast(y,b){const _=y.length,x=b.length;if(_>x)return!1;for(let w=1;w<=_;w++)if(y[_-w]!==1&&y[_-w]!==b[x-w])return!1;return!0}static getBroadcastDims(y,b){const _=y.length,x=[];for(let w=0;w<_;w++){const T=_-1-w,S=y[T]||1;(b[b.length-1-w]||1)>1&&S===1&&x.unshift(T)}return x}}t.BroadcastUtil=d,t.arrayCopyHelper=function(m,y,b,_,x){if(_<0||_>=y.length)throw new Error("sourceIndex out of bounds");if(b<0||b>=m.length)throw new Error("targetIndex out of bounds");if(_+x>y.length)throw new Error("source indices to be copied are outside bounds");if(b+x>m.length)throw new Error("target array is too small to hold result");for(let w=0;w<x;w++)m[b+w]=y[_+w]},t.GemmUtil=class{static getShapeOfGemmResult(m,y,b,_,x){if(m.length!==2||b.length!==2)throw new Error("shape need to be of size 2");let w,T,S;y?(w=m[1],T=m[0]):(w=m[0],T=m[1]);let I=-1;if(_?(S=b[0],I=1):(S=b[1],I=0),b[I]!==T)throw new Error("dimension mismatch");if(w<=0||S<=0||T<=0)throw new Error("invalid shape specified");if(x&&!d.isValidBroadcast(x,[w,S]))throw new Error("gemm: invalid bias shape for broadcast");return[w,S,T]}};class l{static tensorDataTypeFromProto(y){switch(y){case a.onnx.TensorProto.DataType.INT8:return"int8";case a.onnx.TensorProto.DataType.UINT8:return"uint8";case a.onnx.TensorProto.DataType.BOOL:return"bool";case a.onnx.TensorProto.DataType.INT16:return"int16";case a.onnx.TensorProto.DataType.UINT16:return"uint16";case a.onnx.TensorProto.DataType.INT32:return"int32";case a.onnx.TensorProto.DataType.UINT32:return"uint32";case a.onnx.TensorProto.DataType.FLOAT:return"float32";case a.onnx.TensorProto.DataType.DOUBLE:return"float64";case a.onnx.TensorProto.DataType.STRING:return"string";case a.onnx.TensorProto.DataType.INT64:return"int32";case a.onnx.TensorProto.DataType.UINT64:return"uint32";default:throw new Error(`unsupported data type: ${a.onnx.TensorProto.DataType[y]}`)}}static tensorDataTypeStringToEnum(y){switch(y){case"int8":return a.onnx.TensorProto.DataType.INT8;case"uint8":return a.onnx.TensorProto.DataType.UINT8;case"bool":return a.onnx.TensorProto.DataType.BOOL;case"int16":return a.onnx.TensorProto.DataType.INT16;case"uint16":return a.onnx.TensorProto.DataType.UINT16;case"int32":return a.onnx.TensorProto.DataType.INT32;case"uint32":return a.onnx.TensorProto.DataType.UINT32;case"float32":return a.onnx.TensorProto.DataType.FLOAT;case"float64":return a.onnx.TensorProto.DataType.DOUBLE;case"string":return a.onnx.TensorProto.DataType.STRING;case"int64":return a.onnx.TensorProto.DataType.INT64;case"uint64":return a.onnx.TensorProto.DataType.UINT64;default:throw new Error(`unsupported data type: ${y}`)}}static tensorDimsFromProto(y){return y.map(b=>c.default.isLong(b)?b.toNumber():b)}static tensorValueTypeFromProto(y){return{tensorType:l.tensorDataTypeFromProto(y.elemType),shape:{dims:l.tensorDimsFromProto(y.shape.dim.map(b=>b.dimValue))}}}static tensorDimsFromORTFormat(y){const b=[];for(let _=0;_<y.dimsLength();_++)b.push(n.longToNumber(y.dims(_)));return b}static tensorAttributesFromORTFormat(y){const b=[];for(let _=0;_<y.attributesLength();_++)b.push(y.attributes(_));return b}}t.ProtoUtil=l;class n{static longToNumber(y,b){return c.default.isLong(y)?y.toNumber():y instanceof s.flatbuffers.Long?c.default.fromValue({low:y.low,high:y.high,unsigned:b!=null&&b}).toNumber():y}static isLong(y){return c.default.isLong(y)||y instanceof s.flatbuffers.Long}}t.LongUtil=n;class e{static size(y){return e.getSizeFromDimensionRange(y,0,y.length)}static sizeFromDimension(y,b){if(b<0||b>y.length)throw new Error(`invalid dimension of ${b} for sizeFromDimension as Tensor has ${y.length} dimensions.`);return e.getSizeFromDimensionRange(y,b,y.length)}static sizeToDimension(y,b){if(b<0||b>y.length)throw new Error(`invalid dimension of ${b} for sizeToDimension as Tensor has ${y.length} dimensions.`);return e.getSizeFromDimensionRange(y,0,b)}static getSizeFromDimensionRange(y,b,_){let x=1;for(let w=b;w<_;w++){if(y[w]<=0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains 0 or negative values in them.");x*=y[w]}return x}static computeStrides(y){const b=y.length;if(b===0)return[];if(b===1)return[1];const _=new Array(b);_[b-1]=1,_[b-2]=y[b-1];for(let x=b-3;x>=0;--x)_[x]=_[x+1]*y[x+1];return _}static transpose(y){return y.slice().reverse()}static indicesToOffset(y,b,_){_===void 0&&(_=y.length);let x=0;for(let w=0;w<_;++w)x+=b[w]*y[w];return x}static offsetToIndices(y,b){const _=b.length;if(_===0)return[];if(_===1)return[y*b[0]];const x=new Array(b.length);for(let w=0;w<x.length-1;++w)x[w]=Math.floor(y/b[w]),y-=x[w]*b[w];return x[x.length-1]=y,x}static normalizeAxis(y,b){if(y<-b&&y>=b)throw new Error("unsupported axis for this operation.");return y<0?y+b:y}static normalizeAxes(y,b){return y.map(_=>this.normalizeAxis(_,b))}static incrementIndex(y,b,_){if(b.length===0||y.length===0)throw new Error("Index incrementing unsupported for scalar Tensor");if(_===void 0)_=b.length;else if(_<=0||_>b.length)throw new Error("Incorrect axis to increment on");for(let x=_-1;x>=0&&(y[x]++,!(y[x]<b[x]));--x)y[x]=0}static calculateReshapedDims(y,b){if(b.length===0){if(y.length===0||e.size(y)===1)return[];throw new Error("cannot reshape to a scalar Tensor")}const _=b.length,x=new Array(_);let w=-1,T=1;for(let I=0;I<_;I++){if(b[I]<-1)throw new Error("a dimension in shape hints cannot be less than -1");if(b[I]===-1){if(w!==-1)throw new Error("at most one dimension in shape hints can be -1");w=I}else{if(b[I]===0){if(I>=y.length)throw new Error("the dimension with value zero exceeds the dimension size of the input tensor");x[I]=y[I]}else x[I]=b[I];T*=x[I]}}const S=e.size(y);if(w!==-1){if(S%T!=0)throw new Error(`the input tensor cannot be reshaped to the requested shape. Input shape: [${y}] Output shape: [${b}]`);x[w]=S/T}else if(T!==S)throw new Error("reshapedDims and originalDims don't have matching sizes");return x}static sortBasedOnPerm(y,b){return b?b.map(_=>y[_]):y.slice().reverse()}static padShape(y,b){const _=y.length;return y.map((x,w)=>x+b[w]+b[w+_])}static areEqual(y,b){return y.length===b.length&&y.every((_,x)=>_===b[x])}static validateDimsAndCalcSize(y){if(y.length>6)throw new TypeError("Only rank 0 to 6 is supported for tensor shape.");let b=1;for(const _ of y){if(!Number.isInteger(_))throw new TypeError(`Invalid shape: ${_} is not an integer`);if(_<0||_>2147483647)throw new TypeError(`Invalid shape: length ${_} is not allowed`);b*=_}return b}static flattenShape(y,b){b<0&&(b+=y.length);const _=y.reduce((w,T)=>w*T,1),x=y.slice(b).reduce((w,T)=>w*T,1);return[_/x,x]}static squeezeShape(y,b){const _=new Array;b=e.normalizeAxes(b,y.length);for(let x=0;x<y.length;x++){const w=b.indexOf(x)>=0;if(w&&y[x]!==1)throw new Error("squeeze an axis of size different than 1");(b.length===0&&y[x]>1||b.length>0&&!w)&&_.push(y[x])}return _}static unsqueezeShape(y,b){const _=new Array(y.length+b.length);_.fill(0);for(let w=0;w<b.length;w++){const T=e.normalizeAxis(b[w],_.length);if(T>=_.length)throw new Error("'axes' has an out of range axis");if(_[T]!==0)throw new Error("'axes' has a duplicate axis");_[T]=1}let x=0;for(let w=0;w<_.length;w++)_[w]===0&&(_[w]=y[x++]);if(x!==y.length)throw new Error("the unsqueezed dimension could not be established");return _}}t.ShapeUtil=e,t.MathUtil=class{static sqr(m,y,b,_,x){if(_<0||_>=y.length)throw new Error("sourceIndex out of bounds");if(b<0||b>=m.length)throw new Error("targetIndex out of bounds");if(_+x>y.length)throw new Error("source indices to be copied are outside bounds");if(b+x>m.length)throw new Error("target array is too small to hold result");for(let w=0;w<x;w++)m[b+w]+=Math.pow(y[_+w],2)}static axpy(m,y,b,_,x,w){if(_<0||_>=y.length)throw new Error("sourceIndex out of bounds");if(b<0||b>=m.length)throw new Error("targetIndex out of bounds");if(_+x>y.length)throw new Error("source indices to be copied are outside bounds");if(b+x>m.length)throw new Error("target array is too small to hold result");for(let T=0;T<x;T++)m[b+T]+=w*y[_+T]}static powx(m,y,b,_,x,w){if(_<0||_>=y.length)throw new Error("sourceIndex out of bounds");if(b<0||b>=m.length)throw new Error("targetIndex out of bounds");if(_+x>y.length)throw new Error("source indices to be copied are outside bounds");if(b+x>m.length)throw new Error("target array is too small to hold result");for(let T=0;T<x;T++)m[b+T]=Math.pow(y[_+T],w)}static mul(m,y,b,_,x){if(_<0||_>=y.length)throw new Error("sourceIndex out of bounds");if(b<0||b>=m.length)throw new Error("targetIndex out of bounds");if(_+x>y.length)throw new Error("source indices to be copied are outside bounds");if(b+x>m.length)throw new Error("target array is too small to hold result");for(let w=0;w<x;w++)m[b+w]=y[_+w]*m[b+w]}};class o{static splitShape(y,b,_,x){if(_.length===0){if(!x)throw new Error("need to know number of outputs when the 'split' attribute is not specified");o.determineSplit(y[b],x,_)}const w=[],T=[0];for(let S=0;S<_.length;++S){S!==0&&T.push(T[S-1]+_[S-1]);const I=y.slice();I[b]=_[S],w.push(I)}return[w,T]}static determineSplit(y,b,_){if(y%b!=0)throw new Error("cannot split tensor to equal sized parts");for(let x=0;x<b;++x)_.push(y/b)}}t.SplitUtil=o;class u{static calcReduce(y,b,_,x,w){const T=y.dims.slice(0);b.length===0&&T.forEach(($,D)=>b.push(D));const S=u.calcReduceShape(T,b,!0),I=e.size(S),v=new h.Tensor(S,y.type),A=e.computeStrides(S),L=e.computeStrides(T),N=new Array(T.length);for(let $=0;$<I;$++){const D=e.offsetToIndices($,A);d.fillIndex(D,T,N),v.set(D,u.calcReduceByAxis(y.numberData,b,T,0,e.indicesToOffset(N,L),x,w))}return _?v:new h.Tensor(u.calcReduceShape(T,b,_),v.type,void 0,void 0,v.data,v.dataId)}static calcReduceByAxis(y,b,_,x,w,T,S){let I=0;if(x>=b.length)return T(y[w]);const v=b[x],A=v>=_.length?1:e.size(_.slice(v+1));for(let L=0;L<_[v];L++)I=L===0?u.calcReduceByAxis(y,b,_,x+1,w,T,S):S(I,u.calcReduceByAxis(y,b,_,x+1,w,T,S)),w+=A;return I}static calcReduceShape(y,b,_){const x=y.slice();for(let w=0;w<b.length;w++)x[b[w]]=_?1:0;return x.filter(w=>w!==0)}}t.ReduceUtil=u;class g{static adjustPoolAttributes(y,b,_,x,w,T){if(!y&&_.length!==b.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(y)for(let S=0;S<b.length-2;S++)S>=_.length?_.push(b[S+2]):_[S]=b[S+2];for(let S=0;S<_.length;S++)if(S<x.length){if(x[S]<0)throw new Error("strides should be greater than or equal to 1")}else x.push(1);for(let S=0;S<_.length;S++)if(S<w.length){if(w[S]<0)throw new Error("dilations should be greater than or equal to 1")}else w.push(1);for(let S=0;S<2*_.length;S++)if(S<T.length){if(T[S]<0)throw new Error("pad should be greater than or equal to 1")}else T.push(0);for(let S=0;S<_.length;S++){if(_[S]<=0)throw new Error("kernel shapes need to be greater than 0");if(T[S]>=_[S]||T[S+_.length]>=_[S])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(y,b,_,x,w,T){if(T){if(w.length!==2*(y.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(b.length!==y.length-2)throw new Error("length of strides should be the length of data dimensions");if(x.length!==y.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let S=0;S<y.length-2;S++)g.adjustPadAndReturnShape(y[S+2],b[S],_[S],x[S],w,S,S+y.length-2,T)}}static computePoolOutputShape(y,b,_,x,w,T,S){if(b.length<=0)throw new Error("input shape must be of size greater than 0");const I=[b[0],b[1]];return g.computeShapeHelper(y,b,I,_,x,w,T,S),I}static computeConvOutputShape(y,b,_,x,w,T,S){if(y.length<=0||b.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");const I=[y[0],b[0]];return g.computeShapeHelper(!1,y,I,_,x,w,T,S),I}static computeShapeHelper(y,b,_,x,w,T,S,I){if(y)for(let v=0;v<b.length-2;v++)_.push(1);else for(let v=0;v<b.length-2;v++)_.push(g.adjustPadAndReturnShape(b[v+2],x[v],w[v],T[v],S,v,v+b.length-2,I))}static adjustPadAndReturnShape(y,b,_,x,w,T,S,I){const v=_*(x-1)+1;if(!I||I==="NOTSET")return Math.floor((y+w[T]+w[S]-v)/b+1);switch(I){case"VALID":return w[T]=0,w[S]=0,Math.floor((y-v)/b+1);case"SAME_LOWER":case"SAME_UPPER":if(_!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{const A=((y+b-1)/b-1)*b+x-y;return w[T]=Math.floor(I==="SAME_LOWER"?(A+1)/2:A/2),w[S]=A-w[T],Math.floor((y+A-x)/b+1)}default:throw new Error("Unsupported AutoPad type")}}}t.PoolConvUtil=g,t.MIN_CLIP=-34028234663852886e22,t.MAX_CLIP=34028234663852886e22,t.decodeUtf8String=function(m){return new TextDecoder().decode(m)}},7967:(f,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.iterateExtraOptions=void 0,t.iterateExtraOptions=(r,i,s,c)=>{if(typeof r=="object"&&r!==null){if(s.has(r))throw new Error("Circular reference in options");s.add(r)}Object.entries(r).forEach(([a,h])=>{const p=i?i+a:a;if(typeof h=="object")(0,t.iterateExtraOptions)(h,p+".",s,c);else if(typeof h=="string"||typeof h=="number")c(p,h.toString());else{if(typeof h!="boolean")throw new Error("Can't handle extra config type: "+typeof h);c(p,h?"1":"0")}})}},2157:function(f,t,r){var i,s=this&&this.__createBinding||(Object.create?function(A,L,N,$){$===void 0&&($=N);var D=Object.getOwnPropertyDescriptor(L,N);D&&!("get"in D?!L.__esModule:D.writable||D.configurable)||(D={enumerable:!0,get:function(){return L[N]}}),Object.defineProperty(A,$,D)}:function(A,L,N,$){$===void 0&&($=N),A[$]=L[N]}),c=this&&this.__setModuleDefault||(Object.create?function(A,L){Object.defineProperty(A,"default",{enumerable:!0,value:L})}:function(A,L){A.default=L}),a=this&&this.__importStar||function(A){if(A&&A.__esModule)return A;var L={};if(A!=null)for(var N in A)N!=="default"&&Object.prototype.hasOwnProperty.call(A,N)&&s(L,A,N);return c(L,A),L};Object.defineProperty(t,"__esModule",{value:!0}),t.endProfiling=t.run=t.releaseSession=t.createSession=t.createSessionFinalize=t.createSessionAllocate=t.initOrt=t.initWasm=void 0;const h=r(1670),p=a(r(349)),d=r(6361),l=()=>!!h.env.wasm.proxy&&typeof document<"u";let n,e,o,u=!1,g=!1,m=!1;const y=[],b=[],_=[],x=[],w=[],T=[],S=()=>{if(u||!g||m||!n)throw new Error("worker not ready")},I=A=>{switch(A.data.type){case"init-wasm":u=!1,A.data.err?(m=!0,e[1](A.data.err)):(g=!0,e[0]());break;case"init-ort":A.data.err?o[1](A.data.err):o[0]();break;case"create_allocate":A.data.err?y.shift()[1](A.data.err):y.shift()[0](A.data.out);break;case"create_finalize":A.data.err?b.shift()[1](A.data.err):b.shift()[0](A.data.out);break;case"create":A.data.err?_.shift()[1](A.data.err):_.shift()[0](A.data.out);break;case"release":A.data.err?x.shift()[1](A.data.err):x.shift()[0]();break;case"run":A.data.err?w.shift()[1](A.data.err):w.shift()[0](A.data.out);break;case"end-profiling":A.data.err?T.shift()[1](A.data.err):T.shift()[0]()}},v=typeof document<"u"?(i=document==null?void 0:document.currentScript)===null||i===void 0?void 0:i.src:void 0;t.initWasm=async()=>{if(l()){if(g)return;if(u)throw new Error("multiple calls to 'initWasm()' detected.");if(m)throw new Error("previous call to 'initWasm()' failed.");return u=!0,h.env.wasm.wasmPaths===void 0&&v&&v.indexOf("blob:")!==0&&(h.env.wasm.wasmPaths=v.substr(0,+v.lastIndexOf("/")+1)),new Promise((A,L)=>{n==null||n.terminate(),n=r(9710).Z(),n.onmessage=I,e=[A,L];const N={type:"init-wasm",in:h.env.wasm};n.postMessage(N)})}return(0,d.initializeWebAssembly)(h.env.wasm)},t.initOrt=async(A,L)=>{if(l())return S(),new Promise((N,$)=>{o=[N,$];const D={type:"init-ort",in:{numThreads:A,loggingLevel:L}};n.postMessage(D)});p.initOrt(A,L)},t.createSessionAllocate=async A=>l()?(S(),new Promise((L,N)=>{y.push([L,N]);const $={type:"create_allocate",in:{model:A}};n.postMessage($,[A.buffer])})):p.createSessionAllocate(A),t.createSessionFinalize=async(A,L)=>l()?(S(),new Promise((N,$)=>{b.push([N,$]);const D={type:"create_finalize",in:{modeldata:A,options:L}};n.postMessage(D)})):p.createSessionFinalize(A,L),t.createSession=async(A,L)=>l()?(S(),new Promise((N,$)=>{_.push([N,$]);const D={type:"create",in:{model:A,options:L}};n.postMessage(D,[A.buffer])})):p.createSession(A,L),t.releaseSession=async A=>{if(l())return S(),new Promise((L,N)=>{x.push([L,N]);const $={type:"release",in:A};n.postMessage($)});p.releaseSession(A)},t.run=async(A,L,N,$,D)=>l()?(S(),new Promise((R,O)=>{w.push([R,O]);const F={type:"run",in:{sessionId:A,inputIndices:L,inputs:N,outputIndices:$,options:D}};n.postMessage(F,p.extractTransferableBuffers(N))})):p.run(A,L,N,$,D),t.endProfiling=async A=>{if(l())return S(),new Promise((L,N)=>{T.push([L,N]);const $={type:"end-profiling",in:A};n.postMessage($)});p.endProfiling(A)}},586:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setRunOptions=void 0;const i=r(7967),s=r(4983),c=r(6361);t.setRunOptions=a=>{const h=(0,c.getInstance)();let p=0;const d=[],l=a||{};try{if((a==null?void 0:a.logSeverityLevel)===void 0)l.logSeverityLevel=2;else if(typeof a.logSeverityLevel!="number"||!Number.isInteger(a.logSeverityLevel)||a.logSeverityLevel<0||a.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${a.logSeverityLevel}`);if((a==null?void 0:a.logVerbosityLevel)===void 0)l.logVerbosityLevel=0;else if(typeof a.logVerbosityLevel!="number"||!Number.isInteger(a.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${a.logVerbosityLevel}`);(a==null?void 0:a.terminate)===void 0&&(l.terminate=!1);let n=0;if((a==null?void 0:a.tag)!==void 0&&(n=(0,s.allocWasmString)(a.tag,d)),p=h._OrtCreateRunOptions(l.logSeverityLevel,l.logVerbosityLevel,!!l.terminate,n),p===0)throw new Error("Can't create run options");return(a==null?void 0:a.extra)!==void 0&&(0,i.iterateExtraOptions)(a.extra,"",new WeakSet,(e,o)=>{const u=(0,s.allocWasmString)(e,d),g=(0,s.allocWasmString)(o,d);if(h._OrtAddRunConfigEntry(p,u,g)!==0)throw new Error(`Can't set a run config entry: ${e} - ${o}`)}),[p,d]}catch(n){throw p!==0&&h._OrtReleaseRunOptions(p),d.forEach(h._free),n}}},2306:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OnnxruntimeWebAssemblySessionHandler=void 0;const i=r(2806),s=r(1670),c=r(2850),a=r(2157);let h;t.OnnxruntimeWebAssemblySessionHandler=class{async createSessionAllocate(p){const d=await fetch(p),l=await d.arrayBuffer();return(0,a.createSessionAllocate)(new Uint8Array(l))}async loadModel(p,d){if(h||(await(0,a.initOrt)(s.env.wasm.numThreads,(l=>{switch(l){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${l}`)}})(s.env.logLevel)),h=!0),typeof p=="string")if(typeof fetch>"u"){const l=await(0,c.promisify)(i.readFile)(p);[this.sessionId,this.inputNames,this.outputNames]=await(0,a.createSession)(l,d)}else{const l=await this.createSessionAllocate(p);[this.sessionId,this.inputNames,this.outputNames]=await(0,a.createSessionFinalize)(l,d)}else[this.sessionId,this.inputNames,this.outputNames]=await(0,a.createSession)(p,d)}async dispose(){return(0,a.releaseSession)(this.sessionId)}async run(p,d,l){const n=[],e=[];Object.entries(p).forEach(m=>{const y=m[0],b=m[1],_=this.inputNames.indexOf(y);if(_===-1)throw new Error(`invalid input '${y}'`);n.push(b),e.push(_)});const o=[];Object.entries(d).forEach(m=>{const y=m[0],b=this.outputNames.indexOf(y);if(b===-1)throw new Error(`invalid output '${y}'`);o.push(b)});const u=await(0,a.run)(this.sessionId,e,n.map(m=>[m.type,m.dims,m.data]),o,l),g={};for(let m=0;m<u.length;m++)g[this.outputNames[o[m]]]=new s.Tensor(u[m][0],u[m][2],u[m][1]);return g}startProfiling(){}endProfiling(){(0,a.endProfiling)(this.sessionId)}}},4919:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setSessionOptions=void 0;const i=r(7967),s=r(4983),c=r(6361);t.setSessionOptions=a=>{const h=(0,c.getInstance)();let p=0;const d=[],l=a||{};(n=>{n.extra||(n.extra={}),n.extra.session||(n.extra.session={});const e=n.extra.session;e.use_ort_model_bytes_directly||(e.use_ort_model_bytes_directly="1")})(l);try{(a==null?void 0:a.graphOptimizationLevel)===void 0&&(l.graphOptimizationLevel="all");const n=(u=>{switch(u){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${u}`)}})(l.graphOptimizationLevel);(a==null?void 0:a.enableCpuMemArena)===void 0&&(l.enableCpuMemArena=!0),(a==null?void 0:a.enableMemPattern)===void 0&&(l.enableMemPattern=!0),(a==null?void 0:a.executionMode)===void 0&&(l.executionMode="sequential");const e=(u=>{switch(u){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${u}`)}})(l.executionMode);let o=0;if((a==null?void 0:a.logId)!==void 0&&(o=(0,s.allocWasmString)(a.logId,d)),(a==null?void 0:a.logSeverityLevel)===void 0)l.logSeverityLevel=2;else if(typeof a.logSeverityLevel!="number"||!Number.isInteger(a.logSeverityLevel)||a.logSeverityLevel<0||a.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${a.logSeverityLevel}`);if((a==null?void 0:a.logVerbosityLevel)===void 0)l.logVerbosityLevel=0;else if(typeof a.logVerbosityLevel!="number"||!Number.isInteger(a.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${a.logVerbosityLevel}`);if((a==null?void 0:a.enableProfiling)===void 0&&(l.enableProfiling=!1),p=h._OrtCreateSessionOptions(n,!!l.enableCpuMemArena,!!l.enableMemPattern,e,!!l.enableProfiling,0,o,l.logSeverityLevel,l.logVerbosityLevel),p===0)throw new Error("Can't create session options");return a!=null&&a.executionProviders&&((u,g,m)=>{for(const y of g){let b=typeof y=="string"?y:y.name;switch(b){case"xnnpack":b="XNNPACK";break;case"wasm":case"cpu":continue;default:throw new Error(`not supported EP: ${b}`)}const _=(0,s.allocWasmString)(b,m);if((0,c.getInstance)()._OrtAppendExecutionProvider(u,_)!==0)throw new Error(`Can't append execution provider: ${b}`)}})(p,a.executionProviders,d),(a==null?void 0:a.extra)!==void 0&&(0,i.iterateExtraOptions)(a.extra,"",new WeakSet,(u,g)=>{const m=(0,s.allocWasmString)(u,d),y=(0,s.allocWasmString)(g,d);if(h._OrtAddSessionConfigEntry(p,m,y)!==0)throw new Error(`Can't set a session config entry: ${u} - ${g}`)}),[p,d]}catch(n){throw p!==0&&h._OrtReleaseSessionOptions(p),d.forEach(h._free),n}}},4983:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.allocWasmString=void 0;const i=r(6361);t.allocWasmString=(s,c)=>{const a=(0,i.getInstance)(),h=a.lengthBytesUTF8(s)+1,p=a._malloc(h);return a.stringToUTF8(s,p,h),c.push(p),p}},349:(f,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.extractTransferableBuffers=t.endProfiling=t.run=t.releaseSession=t.createSession=t.createSessionFinalize=t.createSessionAllocate=t.initOrt=void 0;const i=r(586),s=r(4919),c=r(4983),a=r(6361);t.initOrt=(n,e)=>{const o=(0,a.getInstance)()._OrtInit(n,e);if(o!==0)throw new Error(`Can't initialize onnxruntime. error code = ${o}`)};const h=new Map;t.createSessionAllocate=n=>{const e=(0,a.getInstance)(),o=e._malloc(n.byteLength);return e.HEAPU8.set(n,o),[o,n.byteLength]},t.createSessionFinalize=(n,e)=>{const o=(0,a.getInstance)();let u=0,g=0,m=[];try{if([g,m]=(0,s.setSessionOptions)(e),u=o._OrtCreateSession(n[0],n[1],g),u===0)throw new Error("Can't create a session")}finally{o._free(n[0]),o._OrtReleaseSessionOptions(g),m.forEach(o._free)}const y=o._OrtGetInputCount(u),b=o._OrtGetOutputCount(u),_=[],x=[],w=[],T=[];for(let S=0;S<y;S++){const I=o._OrtGetInputName(u,S);if(I===0)throw new Error("Can't get an input name");x.push(I),_.push(o.UTF8ToString(I))}for(let S=0;S<b;S++){const I=o._OrtGetOutputName(u,S);if(I===0)throw new Error("Can't get an output name");T.push(I),w.push(o.UTF8ToString(I))}return h.set(u,[u,x,T]),[u,_,w]},t.createSession=(n,e)=>{const o=(0,t.createSessionAllocate)(n);return(0,t.createSessionFinalize)(o,e)},t.releaseSession=n=>{const e=(0,a.getInstance)(),o=h.get(n);if(!o)throw new Error("invalid session id");const u=o[0],g=o[1],m=o[2];g.forEach(e._OrtFree),m.forEach(e._OrtFree),e._OrtReleaseSession(u),h.delete(n)};const p=n=>{switch(n){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${n}`)}},d=n=>{switch(n){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${n}`)}},l=n=>{switch(n){case"float32":return Float32Array;case"uint8":case"bool":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${n}`)}};t.run=(n,e,o,u,g)=>{const m=(0,a.getInstance)(),y=h.get(n);if(!y)throw new Error("invalid session id");const b=y[0],_=y[1],x=y[2],w=e.length,T=u.length;let S=0,I=[];const v=[],A=[];try{[S,I]=(0,i.setRunOptions)(g);for(let O=0;O<w;O++){const F=o[O][0],z=o[O][1],W=o[O][2];let Z,J;if(Array.isArray(W)){J=4*W.length,Z=m._malloc(J),A.push(Z);let K=Z/4;for(let st=0;st<W.length;st++){if(typeof W[st]!="string")throw new TypeError(`tensor data at index ${st} is not a string`);m.HEAPU32[K++]=(0,c.allocWasmString)(W[st],A)}}else J=W.byteLength,Z=m._malloc(J),A.push(Z),m.HEAPU8.set(new Uint8Array(W.buffer,W.byteOffset,J),Z);const nt=m.stackSave(),wt=m.stackAlloc(4*z.length);try{let K=wt/4;z.forEach(Tt=>m.HEAP32[K++]=Tt);const st=m._OrtCreateTensor(p(F),Z,J,wt,z.length);if(st===0)throw new Error("Can't create a tensor");v.push(st)}finally{m.stackRestore(nt)}}const L=m.stackSave(),N=m.stackAlloc(4*w),$=m.stackAlloc(4*w),D=m.stackAlloc(4*T),R=m.stackAlloc(4*T);try{let O=N/4,F=$/4,z=D/4,W=R/4;for(let nt=0;nt<w;nt++)m.HEAPU32[O++]=v[nt],m.HEAPU32[F++]=_[e[nt]];for(let nt=0;nt<T;nt++)m.HEAPU32[z++]=0,m.HEAPU32[W++]=x[u[nt]];let Z=m._OrtRun(b,$,N,w,R,T,D,S);const J=[];if(Z===0)for(let nt=0;nt<T;nt++){const wt=m.HEAPU32[D/4+nt],K=m.stackSave(),st=m.stackAlloc(16);let Tt,xt=0;try{if(Z=m._OrtGetTensorData(wt,st,st+4,st+8,st+12),Z!==0)throw new Error(`Can't access output tensor data. error code = ${Z}`);let $t=st/4;const Qt=m.HEAPU32[$t++];xt=m.HEAPU32[$t++];const Ot=m.HEAPU32[$t++],Ft=m.HEAPU32[$t++],Mt=[];for(let vt=0;vt<Ft;vt++)Mt.push(m.HEAPU32[Ot/4+vt]);m._OrtFree(Ot);const St=Mt.length===0?1:Mt.reduce((vt,jt)=>vt*jt);if(Tt=d(Qt),Tt==="string"){const vt=[];let jt=xt/4;for(let Gt=0;Gt<St;Gt++){const zt=m.HEAPU32[jt++],Xt=Gt===St-1?void 0:m.HEAPU32[jt]-zt;vt.push(m.UTF8ToString(zt,Xt))}J.push([Tt,Mt,vt])}else{const vt=new(l(Tt))(St);new Uint8Array(vt.buffer,vt.byteOffset,vt.byteLength).set(m.HEAPU8.subarray(xt,xt+vt.byteLength)),J.push([Tt,Mt,vt])}}finally{m.stackRestore(K),Tt==="string"&&xt&&m._free(xt),m._OrtReleaseTensor(wt)}}if(Z===0)return J;throw new Error(`failed to call OrtRun(). error code = ${Z}.`)}finally{m.stackRestore(L)}}finally{v.forEach(m._OrtReleaseTensor),A.forEach(m._free),m._OrtReleaseRunOptions(S),I.forEach(m._free)}},t.endProfiling=n=>{const e=(0,a.getInstance)(),o=h.get(n);if(!o)throw new Error("invalid session id");const u=o[0],g=e._OrtEndProfiling(u);if(g===0)throw new Error("Can't get an profile file name");e._OrtFree(g)},t.extractTransferableBuffers=n=>{const e=[];for(const o of n){const u=o[2];!Array.isArray(u)&&u.buffer&&e.push(u.buffer)}return e}},6361:function(f,t,r){var i=this&&this.__createBinding||(Object.create?function(g,m,y,b){b===void 0&&(b=y);var _=Object.getOwnPropertyDescriptor(m,y);_&&!("get"in _?!m.__esModule:_.writable||_.configurable)||(_={enumerable:!0,get:function(){return m[y]}}),Object.defineProperty(g,b,_)}:function(g,m,y,b){b===void 0&&(b=y),g[b]=m[y]}),s=this&&this.__setModuleDefault||(Object.create?function(g,m){Object.defineProperty(g,"default",{enumerable:!0,value:m})}:function(g,m){g.default=m}),c=this&&this.__importStar||function(g){if(g&&g.__esModule)return g;var m={};if(g!=null)for(var y in g)y!=="default"&&Object.prototype.hasOwnProperty.call(g,y)&&i(m,g,y);return s(m,g),m},a=this&&this.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(t,"__esModule",{value:!0}),t.dispose=t.getInstance=t.initializeWebAssembly=void 0;const h=c(r(6449)),p=a(r(932)),d=r(3474);let l,n=!1,e=!1,o=!1;const u=(g,m)=>m?g?"ort-wasm-simd-threaded.wasm":"ort-wasm-threaded.wasm":g?"ort-wasm-simd.wasm":"ort-wasm.wasm";t.initializeWebAssembly=async g=>{if(n)return Promise.resolve();if(e)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(o)throw new Error("previous call to 'initializeWebAssembly()' failed.");e=!0;const m=g.initTimeout,y=g.numThreads,b=g.simd,_=y>1&&(()=>{try{return typeof SharedArrayBuffer<"u"&&(typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])))}catch{return!1}})(),x=b&&(()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}})(),w=typeof g.wasmPaths=="string"?g.wasmPaths:void 0,T=u(!1,_),S=u(x,_),I=typeof g.wasmPaths=="object"?g.wasmPaths[S]:void 0;let v=!1;const A=[];if(m>0&&A.push(new Promise(L=>{setTimeout(()=>{v=!0,L()},m)})),A.push(new Promise((L,N)=>{const $=_?d:p.default,D={locateFile:(R,O)=>_&&R.endsWith(".worker.js")&&typeof Blob<"u"?URL.createObjectURL(new Blob([r(4154)],{type:"text/javascript"})):R===T?I??(w??O)+S:O+R};if(_)if(typeof Blob>"u")D.mainScriptUrlOrBlob=h.join("/","ort-wasm-threaded.js");else{const R=`var ortWasmThreaded=(function(){var _scriptDir;return ${$.toString()}})();`;D.mainScriptUrlOrBlob=new Blob([R],{type:"text/javascript"})}$(D).then(R=>{e=!1,n=!0,l=R,L()},R=>{e=!1,o=!0,N(R)})})),await Promise.race(A),v)throw new Error(`WebAssembly backend initializing failed due to timeout: ${m}ms`)},t.getInstance=()=>{if(n&&l)return l;throw new Error("WebAssembly is not initialized yet.")},t.dispose=()=>{var g;!n||e||o||(e=!0,(g=l.PThread)===null||g===void 0||g.terminateAllThreads(),l=void 0,e=!1,n=!1,o=!0)}},9710:(f,t,r)=>{r.d(t,{Z:()=>c});var i=r(477),s=r.n(i);function c(){return s()('/*!\n* ONNX Runtime Web v1.14.0\n* Copyright (c) Microsoft Corporation. All rights reserved.\n* Licensed under the MIT License.\n*/\n(()=>{var t={474:(t,e,n)=>{var _scriptDir,r=(_scriptDir=(_scriptDir="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(t){function e(){return j.buffer!=D&&N(j.buffer),P}function r(){return j.buffer!=D&&N(j.buffer),U}function a(){return j.buffer!=D&&N(j.buffer),F}function i(){return j.buffer!=D&&N(j.buffer),I}function o(){return j.buffer!=D&&N(j.buffer),W}var u,c,s;t=t||{},u||(u=void 0!==t?t:{}),u.ready=new Promise((function(t,e){c=t,s=e}));var l,f,p,h,d,y,b=Object.assign({},u),m="./this.program",g=(t,e)=>{throw e},v="object"==typeof window,w="function"==typeof importScripts,_="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,O=u.ENVIRONMENT_IS_PTHREAD||!1,A="";function S(t){return u.locateFile?u.locateFile(t,A):A+t}if(_){let e;A=w?n(908).dirname(A)+"/":"//",y=()=>{d||(h=n(384),d=n(908))},l=function(t,e){return y(),t=d.normalize(t),h.readFileSync(t,e?void 0:"utf8")},p=t=>((t=l(t,!0)).buffer||(t=new Uint8Array(t)),t),f=(t,e,n)=>{y(),t=d.normalize(t),h.readFile(t,(function(t,r){t?n(t):e(r.buffer)}))},1<process.argv.length&&(m=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",(function(t){if(!(t instanceof ct))throw t})),process.on("unhandledRejection",(function(t){throw t})),g=(t,e)=>{if(Q())throw process.exitCode=t,e;e instanceof ct||x("exiting due to exception: "+e),process.exit(t)},u.inspect=function(){return"[Emscripten Module object]"};try{e=n(925)}catch(t){throw console.error(\'The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?\'),t}n.g.Worker=e.Worker}else(v||w)&&(w?A=self.location.href:"undefined"!=typeof document&&document.currentScript&&(A=document.currentScript.src),_scriptDir&&(A=_scriptDir),A=0!==A.indexOf("blob:")?A.substr(0,A.replace(/[?#].*/,"").lastIndexOf("/")+1):"",_||(l=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},w&&(p=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),f=(t,e,n)=>{var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onload=()=>{200==r.status||0==r.status&&r.response?e(r.response):n()},r.onerror=n,r.send(null)}));_&&"undefined"==typeof performance&&(n.g.performance=n(953).performance);var T=console.log.bind(console),E=console.warn.bind(console);_&&(y(),T=t=>h.writeSync(1,t+"\\n"),E=t=>h.writeSync(2,t+"\\n"));var M,C=u.print||T,x=u.printErr||E;Object.assign(u,b),b=null,u.thisProgram&&(m=u.thisProgram),u.quit&&(g=u.quit),u.wasmBinary&&(M=u.wasmBinary);var R=u.noExitRuntime||!1;"object"!=typeof WebAssembly&&at("no native wasm support detected");var j,k,D,P,U,F,I,W,H=!1,L="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function z(t,e,n){var r=(e>>>=0)+n;for(n=e;t[n]&&!(n>=r);)++n;if(16<n-e&&t.buffer&&L)return L.decode(t.buffer instanceof SharedArrayBuffer?t.slice(e,n):t.subarray(e,n));for(r="";e<n;){var a=t[e++];if(128&a){var i=63&t[e++];if(192==(224&a))r+=String.fromCharCode((31&a)<<6|i);else{var o=63&t[e++];65536>(a=224==(240&a)?(15&a)<<12|i<<6|o:(7&a)<<18|i<<12|o<<6|63&t[e++])?r+=String.fromCharCode(a):(a-=65536,r+=String.fromCharCode(55296|a>>10,56320|1023&a))}}else r+=String.fromCharCode(a)}return r}function Y(t,e){return(t>>>=0)?z(r(),t,e):""}function B(t,e,n,r){if(!(0<r))return 0;var a=n>>>=0;r=n+r-1;for(var i=0;i<t.length;++i){var o=t.charCodeAt(i);if(55296<=o&&57343>=o&&(o=65536+((1023&o)<<10)|1023&t.charCodeAt(++i)),127>=o){if(n>=r)break;e[n++>>>0]=o}else{if(2047>=o){if(n+1>=r)break;e[n++>>>0]=192|o>>6}else{if(65535>=o){if(n+2>=r)break;e[n++>>>0]=224|o>>12}else{if(n+3>=r)break;e[n++>>>0]=240|o>>18,e[n++>>>0]=128|o>>12&63}e[n++>>>0]=128|o>>6&63}e[n++>>>0]=128|63&o}}return e[n>>>0]=0,n-a}function G(t){for(var e=0,n=0;n<t.length;++n){var r=t.charCodeAt(n);127>=r?e++:2047>=r?e+=2:55296<=r&&57343>=r?(e+=4,++n):e+=3}return e}function N(t){D=t,u.HEAP8=P=new Int8Array(t),u.HEAP16=new Int16Array(t),u.HEAP32=F=new Int32Array(t),u.HEAPU8=U=new Uint8Array(t),u.HEAPU16=new Uint16Array(t),u.HEAPU32=I=new Uint32Array(t),u.HEAPF32=new Float32Array(t),u.HEAPF64=W=new Float64Array(t)}O&&(D=u.buffer);var V=u.INITIAL_MEMORY||16777216;if(O)j=u.wasmMemory,D=u.buffer;else if(u.wasmMemory)j=u.wasmMemory;else if(!((j=new WebAssembly.Memory({initial:V/65536,maximum:65536,shared:!0})).buffer instanceof SharedArrayBuffer))throw x("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),_&&console.log("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and also use a recent version)"),Error("bad memory");j&&(D=j.buffer),V=D.byteLength,N(D);var $,q=[],X=[],J=[],Z=[];function Q(){return R||!1}function K(){var t=u.preRun.shift();q.unshift(t)}var tt,et=0,nt=null,rt=null;function at(t){throw O?postMessage({cmd:"onAbort",arg:t}):u.onAbort&&u.onAbort(t),x(t="Aborted("+t+")"),H=!0,t=new WebAssembly.RuntimeError(t+". Build with -sASSERTIONS for more info."),s(t),t}function it(){return tt.startsWith("data:application/octet-stream;base64,")}function ot(){var t=tt;try{if(t==tt&&M)return new Uint8Array(M);if(p)return p(t);throw"both async and sync fetching of the wasm failed"}catch(t){at(t)}}tt="ort-wasm-threaded.wasm",it()||(tt=S(tt));var ut={};function ct(t){this.name="ExitStatus",this.message="Program terminated with exit("+t+")",this.status=t}function st(t){(t=ht.Vb[t])||at(),ht.mc(t)}function lt(t){var e=ht.Cc();if(!e)return 6;ht.ac.push(e),ht.Vb[t.Ub]=e,e.Ub=t.Ub;var n={cmd:"run",start_routine:t.Ic,arg:t.zc,pthread_ptr:t.Ub};return e.$b=()=>{n.time=performance.now(),e.postMessage(n,t.Nc)},e.loaded&&(e.$b(),delete e.$b),0}function ft(t){if(O)return $t(1,1,t);Q()||(ht.oc(),u.onExit&&u.onExit(t),H=!0),g(t,new ct(t))}function pt(t,e){if(!e&&O)throw bt(t),"unwind";Q()||O||(me(),dt(J),be(0),re[1].length&&ae(1,10),re[2].length&&ae(2,10),ht.oc()),ft(t)}var ht={Yb:[],ac:[],qc:[],Vb:{},fc:function(){O&&ht.Ec()},Pc:function(){},Ec:function(){ht.receiveObjectTransfer=ht.Gc,ht.threadInitTLS=ht.pc,ht.setExitStatus=ht.nc,R=!1},nc:function(){},oc:function(){for(var t of Object.values(ht.Vb))ht.mc(t);for(t of ht.Yb)t.terminate();ht.Yb=[]},mc:function(t){var e=t.Ub;delete ht.Vb[e],ht.Yb.push(t),ht.ac.splice(ht.ac.indexOf(t),1),t.Ub=0,Oe(e)},Gc:function(){},pc:function(){ht.qc.forEach((t=>t()))},Fc:function(t,e){t.onmessage=n=>{var r=(n=n.data).cmd;if(t.Ub&&(ht.Bc=t.Ub),n.targetThread&&n.targetThread!=he()){var a=ht.Vb[n.Qc];a?a.postMessage(n,n.transferList):x(\'Internal error! Worker sent a message "\'+r+\'" to target pthread \'+n.targetThread+", but that thread no longer exists!")}else"processProxyingQueue"===r?zt(n.queue):"spawnThread"===r?lt(n):"cleanupThread"===r?st(n.thread):"killThread"===r?(n=n.thread,r=ht.Vb[n],delete ht.Vb[n],r.terminate(),Oe(n),ht.ac.splice(ht.ac.indexOf(r),1),r.Ub=0):"cancelThread"===r?ht.Vb[n.thread].postMessage({cmd:"cancel"}):"loaded"===r?(t.loaded=!0,e&&e(t),t.$b&&(t.$b(),delete t.$b)):"print"===r?C("Thread "+n.threadId+": "+n.text):"printErr"===r?x("Thread "+n.threadId+": "+n.text):"alert"===r?alert("Thread "+n.threadId+": "+n.text):"setimmediate"===n.target?t.postMessage(n):"onAbort"===r?u.onAbort&&u.onAbort(n.arg):r&&x("worker sent an unknown command "+r);ht.Bc=void 0},t.onerror=t=>{throw x("worker sent an error! "+t.filename+":"+t.lineno+": "+t.message),t},_&&(t.on("message",(function(e){t.onmessage({data:e})})),t.on("error",(function(e){t.onerror(e)})),t.on("detachedExit",(function(){}))),t.postMessage({cmd:"load",urlOrBlob:u.mainScriptUrlOrBlob||_scriptDir,wasmMemory:j,wasmModule:k})},yc:function(){var t=S("ort-wasm-threaded.worker.js");ht.Yb.push(new Worker(t))},Cc:function(){return 0==ht.Yb.length&&(ht.yc(),ht.Fc(ht.Yb[0])),ht.Yb.pop()}};function dt(t){for(;0<t.length;)t.shift()(u)}function yt(t){var e=Ee();return t=t(),Me(e),t}function bt(t){if(O)return $t(2,0,t);try{pt(t)}catch(t){t instanceof ct||"unwind"==t||g(1,t)}}u.PThread=ht,u.establishStackSpace=function(){var t=he(),e=a()[t+44>>2>>>0];t=a()[t+48>>2>>>0],Te(e,e-t),Me(e)};var mt=[];function gt(t){var e=mt[t];return e||(t>=mt.length&&(mt.length=t+1),mt[t]=e=$.get(t)),e}u.invokeEntryPoint=function(t,e){t=gt(t)(e),Q()?ht.nc(t):Ae(t)};var vt,wt,_t=[],Ot=0,At=0;function St(t){this.Zb=t,this.Sb=t-24,this.xc=function(t){i()[this.Sb+4>>2>>>0]=t},this.bc=function(){return i()[this.Sb+4>>2>>>0]},this.wc=function(t){i()[this.Sb+8>>2>>>0]=t},this.Dc=function(){return i()[this.Sb+8>>2>>>0]},this.rc=function(){a()[this.Sb>>2>>>0]=0},this.hc=function(t){t=t?1:0,e()[this.Sb+12>>0>>>0]=t},this.uc=function(){return 0!=e()[this.Sb+12>>0>>>0]},this.ic=function(t){t=t?1:0,e()[this.Sb+13>>0>>>0]=t},this.kc=function(){return 0!=e()[this.Sb+13>>0>>>0]},this.fc=function(t,e){this.cc(0),this.xc(t),this.wc(e),this.rc(),this.hc(!1),this.ic(!1)},this.sc=function(){Atomics.add(a(),this.Sb>>2,1)},this.Hc=function(){return 1===Atomics.sub(a(),this.Sb>>2,1)},this.cc=function(t){i()[this.Sb+16>>2>>>0]=t},this.tc=function(){return i()[this.Sb+16>>2>>>0]},this.vc=function(){if(Re(this.bc()))return i()[this.Zb>>2>>>0];var t=this.tc();return 0!==t?t:this.Zb}}function Tt(t){return ye(new St(t).Sb)}function Et(t,e,n,r){return O?$t(3,1,t,e,n,r):Mt(t,e,n,r)}function Mt(t,e,n,r){if("undefined"==typeof SharedArrayBuffer)return x("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var a=[];return O&&0===a.length?Et(t,e,n,r):(t={Ic:n,Ub:t,zc:r,Nc:a},O?(t.Oc="spawnThread",postMessage(t,a),0):lt(t))}function Ct(t,e,n){return O?$t(4,1,t,e,n):0}function xt(t,e){if(O)return $t(5,1,t,e)}function Rt(t,e){if(O)return $t(6,1,t,e)}function jt(t,e,n){if(O)return $t(7,1,t,e,n)}function kt(t,e,n){return O?$t(8,1,t,e,n):0}function Dt(t,e){if(O)return $t(9,1,t,e)}function Pt(t,e,n){if(O)return $t(10,1,t,e,n)}function Ut(t,e,n,r){if(O)return $t(11,1,t,e,n,r)}function Ft(t,e,n,r){if(O)return $t(12,1,t,e,n,r)}function It(t,e,n,r){if(O)return $t(13,1,t,e,n,r)}function Wt(t){if(O)return $t(14,1,t)}function Ht(t,e){if(O)return $t(15,1,t,e)}function Lt(t,e,n){if(O)return $t(16,1,t,e,n)}function zt(t){Atomics.store(a(),t>>2,1),he()&&_e(t),Atomics.compareExchange(a(),t>>2,1,0)}function Yt(t){return i()[t>>>2]+4294967296*a()[t+4>>>2]}function Bt(t,e,n,r,a,i){return O?$t(17,1,t,e,n,r,a,i):-52}function Gt(t,e,n,r,a,i){if(O)return $t(18,1,t,e,n,r,a,i)}function Nt(t){var n=G(t)+1,r=de(n);return r&&B(t,e(),r,n),r}function Vt(t,e,n){function r(t){return(t=t.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?t[1]:"GMT"}if(O)return $t(19,1,t,e,n);var o=(new Date).getFullYear(),u=new Date(o,0,1),c=new Date(o,6,1);o=u.getTimezoneOffset();var s=c.getTimezoneOffset(),l=Math.max(o,s);a()[t>>2>>>0]=60*l,a()[e>>2>>>0]=Number(o!=s),t=r(u),e=r(c),t=Nt(t),e=Nt(e),s<o?(i()[n>>2>>>0]=t,i()[n+4>>2>>>0]=e):(i()[n>>2>>>0]=e,i()[n+4>>2>>>0]=t)}function $t(t,e){var n=arguments.length-2,r=arguments;return yt((()=>{for(var a=Ce(8*n),i=a>>3,u=0;u<n;u++){var c=r[2+u];o()[i+u>>>0]=c}return we(t,n,a,e)}))}u.executeNotifiedProxyingQueue=zt,wt=_?()=>{var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:O?()=>performance.now()-u.__performance_now_clock_drift:()=>performance.now();var qt,Xt=[],Jt={};function Zt(){if(!qt){var t,e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:m||"./this.program"};for(t in Jt)void 0===Jt[t]?delete e[t]:e[t]=Jt[t];var n=[];for(t in e)n.push(t+"="+e[t]);qt=n}return qt}function Qt(t,n){if(O)return $t(20,1,t,n);var r=0;return Zt().forEach((function(a,o){var u=n+r;for(o=i()[t+4*o>>2>>>0]=u,u=0;u<a.length;++u)e()[o++>>0>>>0]=a.charCodeAt(u);e()[o>>0>>>0]=0,r+=a.length+1})),0}function Kt(t,e){if(O)return $t(21,1,t,e);var n=Zt();i()[t>>2>>>0]=n.length;var r=0;return n.forEach((function(t){r+=t.length+1})),i()[e>>2>>>0]=r,0}function te(t){return O?$t(22,1,t):52}function ee(t,e,n,r){return O?$t(23,1,t,e,n,r):52}function ne(t,e,n,r,a){return O?$t(24,1,t,e,n,r,a):70}var re=[null,[],[]];function ae(t,e){var n=re[t];0===e||10===e?((1===t?C:x)(z(n,0)),n.length=0):n.push(e)}function ie(t,e,n,a){if(O)return $t(25,1,t,e,n,a);for(var o=0,u=0;u<n;u++){var c=i()[e>>2>>>0],s=i()[e+4>>2>>>0];e+=8;for(var l=0;l<s;l++)ae(t,r()[c+l>>>0]);o+=s}return i()[a>>2>>>0]=o,0}var oe=0;function ue(t){return 0==t%4&&(0!=t%100||0==t%400)}var ce=[31,29,31,30,31,30,31,31,30,31,30,31],se=[31,28,31,30,31,30,31,31,30,31,30,31];function le(t,n,r,i){function o(t,e,n){for(t="number"==typeof t?t.toString():t||"";t.length<e;)t=n[0]+t;return t}function u(t,e){return o(t,e,"0")}function c(t,e){function n(t){return 0>t?-1:0<t?1:0}var r;return 0===(r=n(t.getFullYear()-e.getFullYear()))&&0===(r=n(t.getMonth()-e.getMonth()))&&(r=n(t.getDate()-e.getDate())),r}function s(t){switch(t.getDay()){case 0:return new Date(t.getFullYear()-1,11,29);case 1:return t;case 2:return new Date(t.getFullYear(),0,3);case 3:return new Date(t.getFullYear(),0,2);case 4:return new Date(t.getFullYear(),0,1);case 5:return new Date(t.getFullYear()-1,11,31);case 6:return new Date(t.getFullYear()-1,11,30)}}function l(t){var e=t.Wb;for(t=new Date(new Date(t.Xb+1900,0,1).getTime());0<e;){var n=t.getMonth(),r=(ue(t.getFullYear())?ce:se)[n];if(!(e>r-t.getDate())){t.setDate(t.getDate()+e);break}e-=r-t.getDate()+1,t.setDate(1),11>n?t.setMonth(n+1):(t.setMonth(0),t.setFullYear(t.getFullYear()+1))}return n=new Date(t.getFullYear()+1,0,4),e=s(new Date(t.getFullYear(),0,4)),n=s(n),0>=c(e,t)?0>=c(n,t)?t.getFullYear()+1:t.getFullYear():t.getFullYear()-1}var f=a()[i+40>>2>>>0];for(var p in i={Lc:a()[i>>2>>>0],Kc:a()[i+4>>2>>>0],dc:a()[i+8>>2>>>0],jc:a()[i+12>>2>>>0],ec:a()[i+16>>2>>>0],Xb:a()[i+20>>2>>>0],Tb:a()[i+24>>2>>>0],Wb:a()[i+28>>2>>>0],Rc:a()[i+32>>2>>>0],Jc:a()[i+36>>2>>>0],Mc:f?Y(f):""},r=Y(r),f={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})r=r.replace(new RegExp(p,"g"),f[p]);var h="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),d="January February March April May June July August September October November December".split(" ");for(p in f={"%a":function(t){return h[t.Tb].substring(0,3)},"%A":function(t){return h[t.Tb]},"%b":function(t){return d[t.ec].substring(0,3)},"%B":function(t){return d[t.ec]},"%C":function(t){return u((t.Xb+1900)/100|0,2)},"%d":function(t){return u(t.jc,2)},"%e":function(t){return o(t.jc,2," ")},"%g":function(t){return l(t).toString().substring(2)},"%G":function(t){return l(t)},"%H":function(t){return u(t.dc,2)},"%I":function(t){return 0==(t=t.dc)?t=12:12<t&&(t-=12),u(t,2)},"%j":function(t){for(var e=0,n=0;n<=t.ec-1;e+=(ue(t.Xb+1900)?ce:se)[n++]);return u(t.jc+e,3)},"%m":function(t){return u(t.ec+1,2)},"%M":function(t){return u(t.Kc,2)},"%n":function(){return"\\n"},"%p":function(t){return 0<=t.dc&&12>t.dc?"AM":"PM"},"%S":function(t){return u(t.Lc,2)},"%t":function(){return"\\t"},"%u":function(t){return t.Tb||7},"%U":function(t){return u(Math.floor((t.Wb+7-t.Tb)/7),2)},"%V":function(t){var e=Math.floor((t.Wb+7-(t.Tb+6)%7)/7);if(2>=(t.Tb+371-t.Wb-2)%7&&e++,e)53==e&&(4==(n=(t.Tb+371-t.Wb)%7)||3==n&&ue(t.Xb)||(e=1));else{e=52;var n=(t.Tb+7-t.Wb-1)%7;(4==n||5==n&&ue(t.Xb%400-1))&&e++}return u(e,2)},"%w":function(t){return t.Tb},"%W":function(t){return u(Math.floor((t.Wb+7-(t.Tb+6)%7)/7),2)},"%y":function(t){return(t.Xb+1900).toString().substring(2)},"%Y":function(t){return t.Xb+1900},"%z":function(t){var e=0<=(t=t.Jc);return t=Math.abs(t)/60,(e?"+":"-")+String("0000"+(t/60*100+t%60)).slice(-4)},"%Z":function(t){return t.Mc},"%%":function(){return"%"}},r=r.replace(/%%/g,"\\0\\0"),f)r.includes(p)&&(r=r.replace(new RegExp(p,"g"),f[p](i)));return p=function(t){var e=Array(G(t)+1);return B(t,e,0,e.length),e}(r=r.replace(/\\0\\0/g,"%")),p.length>n?0:(function(t,n){e().set(t,n>>>0)}(p,t),p.length-1)}ht.fc();var fe=[null,ft,bt,Et,Ct,xt,Rt,jt,kt,Dt,Pt,Ut,Ft,It,Wt,Ht,Lt,Bt,Gt,Vt,Qt,Kt,te,ee,ne,ie],pe={b:function(t){return de(t+24)+24},n:function(t){return(t=new St(t)).uc()||(t.hc(!0),Ot--),t.ic(!1),_t.push(t),t.sc(),t.vc()},ma:function(t){throw x("Unexpected exception thrown, this is not properly supported - aborting"),H=!0,t},x:function(){Se(0);var t=_t.pop();if(t.Hc()&&!t.kc()){var e=t.Dc();e&&gt(e)(t.Zb),Tt(t.Zb)}At=0},e:function(){var t=At;if(!t)return oe=0;var e=new St(t);e.cc(t);var n=e.bc();if(!n)return oe=0,t;for(var r=Array.prototype.slice.call(arguments),a=0;a<r.length;a++){var i=r[a];if(0===i||i===n)break;if(xe(i,n,e.Sb+16))return oe=i,t}return oe=n,t},l:function(){var t=At;if(!t)return oe=0;var e=new St(t);e.cc(t);var n=e.bc();if(!n)return oe=0,t;for(var r=Array.prototype.slice.call(arguments),a=0;a<r.length;a++){var i=r[a];if(0===i||i===n)break;if(xe(i,n,e.Sb+16))return oe=i,t}return oe=n,t},h:function(){var t=At;if(!t)return oe=0;var e=new St(t);e.cc(t);var n=e.bc();if(!n)return oe=0,t;for(var r=Array.prototype.slice.call(arguments),a=0;a<r.length;a++){var i=r[a];if(0===i||i===n)break;if(xe(i,n,e.Sb+16))return oe=i,t}return oe=n,t},t:Tt,M:function(){var t=_t.pop();t||at("no exception to throw");var e=t.Zb;throw t.kc()||(_t.push(t),t.ic(!0),t.hc(!1),Ot++),At=e,e},c:function(t,e,n){throw new St(t).fc(e,n),At=t,Ot++,t},pa:function(){return Ot},Fa:function(t){ge(t,!w,1,!v),ht.pc()},T:function(t){O?postMessage({cmd:"cleanupThread",thread:t}):st(t)},xa:Mt,j:function(t){throw At||(At=t),t},H:Ct,Ma:xt,ua:Rt,wa:jt,oa:kt,Ka:Dt,Ca:Pt,Ja:Ut,V:Ft,va:It,sa:Wt,La:Ht,ta:Lt,Ta:function(){},X:function(){at("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},Ua:function(){at("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},W:function(){return Date.now()},ya:function(){return 2097152},Oa:function(){return!0},za:function(t,e,n,r){if(t==e)setTimeout((()=>zt(r)));else if(O)postMessage({targetThread:t,cmd:"processProxyingQueue",queue:r});else{if(!(t=ht.Vb[t]))return;t.postMessage({cmd:"processProxyingQueue",queue:r})}return 1},Ea:function(){return-1},Pa:function(t,e){t=new Date(1e3*Yt(t)),a()[e>>2>>>0]=t.getUTCSeconds(),a()[e+4>>2>>>0]=t.getUTCMinutes(),a()[e+8>>2>>>0]=t.getUTCHours(),a()[e+12>>2>>>0]=t.getUTCDate(),a()[e+16>>2>>>0]=t.getUTCMonth(),a()[e+20>>2>>>0]=t.getUTCFullYear()-1900,a()[e+24>>2>>>0]=t.getUTCDay(),t=(t.getTime()-Date.UTC(t.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,a()[e+28>>2>>>0]=t},Qa:function(t,e){t=new Date(1e3*Yt(t)),a()[e>>2>>>0]=t.getSeconds(),a()[e+4>>2>>>0]=t.getMinutes(),a()[e+8>>2>>>0]=t.getHours(),a()[e+12>>2>>>0]=t.getDate(),a()[e+16>>2>>>0]=t.getMonth(),a()[e+20>>2>>>0]=t.getFullYear()-1900,a()[e+24>>2>>>0]=t.getDay();var n=new Date(t.getFullYear(),0,1),r=(t.getTime()-n.getTime())/864e5|0;a()[e+28>>2>>>0]=r,a()[e+36>>2>>>0]=-60*t.getTimezoneOffset(),r=new Date(t.getFullYear(),6,1).getTimezoneOffset(),t=0|(r!=(n=n.getTimezoneOffset())&&t.getTimezoneOffset()==Math.min(n,r)),a()[e+32>>2>>>0]=t},Ra:function(t){var e=new Date(a()[t+20>>2>>>0]+1900,a()[t+16>>2>>>0],a()[t+12>>2>>>0],a()[t+8>>2>>>0],a()[t+4>>2>>>0],a()[t>>2>>>0],0),n=a()[t+32>>2>>>0],r=e.getTimezoneOffset(),i=new Date(e.getFullYear(),0,1),o=new Date(e.getFullYear(),6,1).getTimezoneOffset(),u=i.getTimezoneOffset(),c=Math.min(u,o);return 0>n?a()[t+32>>2>>>0]=Number(o!=u&&c==r):0<n!=(c==r)&&(o=Math.max(u,o),e.setTime(e.getTime()+6e4*((0<n?c:o)-r))),a()[t+24>>2>>>0]=e.getDay(),n=(e.getTime()-i.getTime())/864e5|0,a()[t+28>>2>>>0]=n,a()[t>>2>>>0]=e.getSeconds(),a()[t+4>>2>>>0]=e.getMinutes(),a()[t+8>>2>>>0]=e.getHours(),a()[t+12>>2>>>0]=e.getDate(),a()[t+16>>2>>>0]=e.getMonth(),e.getTime()/1e3|0},Aa:Bt,Ba:Gt,Sa:function t(e,n,r){t.Ac||(t.Ac=!0,Vt(e,n,r))},y:function(){at("")},U:function(){if(!_&&!w){var t="Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread";vt||(vt={}),vt[t]||(vt[t]=1,_&&(t="warning: "+t),x(t))}},ra:function(){return 4294901760},B:wt,Ia:function(t,e,n){r().copyWithin(t>>>0,e>>>0,e+n>>>0)},F:function(){return _?n(993).cpus().length:navigator.hardwareConcurrency},Da:function(t,e,n){Xt.length=e,n>>=3;for(var r=0;r<e;r++)Xt[r]=o()[n+r>>>0];return(0>t?ut[-t-1]:fe[t]).apply(null,Xt)},qa:function(t){var e=r().length;if((t>>>=0)<=e||4294901760<t)return!1;for(var n=1;4>=n;n*=2){var a=e*(1+.2/n);a=Math.min(a,t+100663296);var i=Math;a=Math.max(t,a),i=i.min.call(i,4294901760,a+(65536-a%65536)%65536);t:{try{j.grow(i-D.byteLength+65535>>>16),N(j.buffer);var o=1;break t}catch(t){}o=void 0}if(o)return!0}return!1},Na:function(){throw"unwind"},Ga:Qt,Ha:Kt,J:pt,I:te,S:ee,ga:ne,R:ie,d:function(){return oe},na:function t(r,a){t.lc||(t.lc=function(){if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var t=new Uint8Array(1);return()=>(crypto.getRandomValues(t),t[0])}if(_)try{var e=n(Object(function(){var t=new Error("Cannot find module \'crypto\'");throw t.code="MODULE_NOT_FOUND",t}()));return()=>e.randomBytes(1)[0]}catch(t){}return()=>at("randomDevice")}());for(var i=0;i<a;i++)e()[r+i>>0>>>0]=t.lc();return 0},ia:function(t,e,n){var r=Ee();try{return gt(t)(e,n)}catch(t){if(Me(r),t!==t+0)throw t;Se(1,0)}},ja:function(t,e,n){var r=Ee();try{return gt(t)(e,n)}catch(t){if(Me(r),t!==t+0)throw t;Se(1,0)}},K:function(t){var e=Ee();try{return gt(t)()}catch(t){if(Me(e),t!==t+0)throw t;Se(1,0)}},f:function(t,e){var n=Ee();try{return gt(t)(e)}catch(t){if(Me(n),t!==t+0)throw t;Se(1,0)}},P:function(t,e,n){var r=Ee();try{return gt(t)(e,n)}catch(t){if(Me(r),t!==t+0)throw t;Se(1,0)}},Q:function(t,e,n){var r=Ee();try{return gt(t)(e,n)}catch(t){if(Me(r),t!==t+0)throw t;Se(1,0)}},k:function(t,e,n){var r=Ee();try{return gt(t)(e,n)}catch(t){if(Me(r),t!==t+0)throw t;Se(1,0)}},p:function(t,e,n,r){var a=Ee();try{return gt(t)(e,n,r)}catch(t){if(Me(a),t!==t+0)throw t;Se(1,0)}},q:function(t,e,n,r,a){var i=Ee();try{return gt(t)(e,n,r,a)}catch(t){if(Me(i),t!==t+0)throw t;Se(1,0)}},N:function(t,e,n,r,a,i){var o=Ee();try{return gt(t)(e,n,r,a,i)}catch(t){if(Me(o),t!==t+0)throw t;Se(1,0)}},s:function(t,e,n,r,a,i){var o=Ee();try{return gt(t)(e,n,r,a,i)}catch(t){if(Me(o),t!==t+0)throw t;Se(1,0)}},w:function(t,e,n,r,a,i,o){var u=Ee();try{return gt(t)(e,n,r,a,i,o)}catch(t){if(Me(u),t!==t+0)throw t;Se(1,0)}},L:function(t,e,n,r,a,i,o,u){var c=Ee();try{return gt(t)(e,n,r,a,i,o,u)}catch(t){if(Me(c),t!==t+0)throw t;Se(1,0)}},E:function(t,e,n,r,a,i,o,u,c,s,l,f){var p=Ee();try{return gt(t)(e,n,r,a,i,o,u,c,s,l,f)}catch(t){if(Me(p),t!==t+0)throw t;Se(1,0)}},aa:function(t,e,n,r,a,i,o,u){var c=Ee();try{return He(t,e,n,r,a,i,o,u)}catch(t){if(Me(c),t!==t+0)throw t;Se(1,0)}},_:function(t,e,n,r,a,i,o){var u=Ee();try{return ke(t,e,n,r,a,i,o)}catch(t){if(Me(u),t!==t+0)throw t;Se(1,0)}},Z:function(t,e,n,r,a){var i=Ee();try{return Le(t,e,n,r,a)}catch(t){if(Me(i),t!==t+0)throw t;Se(1,0)}},ca:function(t,e,n,r){var a=Ee();try{return Ie(t,e,n,r)}catch(t){if(Me(a),t!==t+0)throw t;Se(1,0)}},$:function(t){var e=Ee();try{return je(t)}catch(t){if(Me(e),t!==t+0)throw t;Se(1,0)}},ba:function(t,e){var n=Ee();try{return We(t,e)}catch(t){if(Me(n),t!==t+0)throw t;Se(1,0)}},Y:function(t,e,n){var r=Ee();try{return De(t,e,n)}catch(t){if(Me(r),t!==t+0)throw t;Se(1,0)}},g:function(t){var e=Ee();try{gt(t)()}catch(t){if(Me(e),t!==t+0)throw t;Se(1,0)}},r:function(t,e){var n=Ee();try{gt(t)(e)}catch(t){if(Me(n),t!==t+0)throw t;Se(1,0)}},i:function(t,e,n){var r=Ee();try{gt(t)(e,n)}catch(t){if(Me(r),t!==t+0)throw t;Se(1,0)}},ha:function(t,e,n,r){var a=Ee();try{gt(t)(e,n,r)}catch(t){if(Me(a),t!==t+0)throw t;Se(1,0)}},m:function(t,e,n,r){var a=Ee();try{gt(t)(e,n,r)}catch(t){if(Me(a),t!==t+0)throw t;Se(1,0)}},v:function(t,e,n,r,a){var i=Ee();try{gt(t)(e,n,r,a)}catch(t){if(Me(i),t!==t+0)throw t;Se(1,0)}},u:function(t,e,n,r,a,i){var o=Ee();try{gt(t)(e,n,r,a,i)}catch(t){if(Me(o),t!==t+0)throw t;Se(1,0)}},O:function(t,e,n,r,a,i,o){var u=Ee();try{gt(t)(e,n,r,a,i,o)}catch(t){if(Me(u),t!==t+0)throw t;Se(1,0)}},A:function(t,e,n,r,a,i,o,u){var c=Ee();try{gt(t)(e,n,r,a,i,o,u)}catch(t){if(Me(c),t!==t+0)throw t;Se(1,0)}},ka:function(t,e,n,r,a,i,o,u,c){var s=Ee();try{gt(t)(e,n,r,a,i,o,u,c)}catch(t){if(Me(s),t!==t+0)throw t;Se(1,0)}},C:function(t,e,n,r,a,i,o,u,c,s,l){var f=Ee();try{gt(t)(e,n,r,a,i,o,u,c,s,l)}catch(t){if(Me(f),t!==t+0)throw t;Se(1,0)}},D:function(t,e,n,r,a,i,o,u,c,s,l,f,p,h,d,y){var b=Ee();try{gt(t)(e,n,r,a,i,o,u,c,s,l,f,p,h,d,y)}catch(t){if(Me(b),t!==t+0)throw t;Se(1,0)}},fa:function(t,e,n,r,a,i,o,u){var c=Ee();try{Pe(t,e,n,r,a,i,o,u)}catch(t){if(Me(c),t!==t+0)throw t;Se(1,0)}},da:function(t,e,n,r,a,i,o,u,c,s,l,f){var p=Ee();try{Fe(t,e,n,r,a,i,o,u,c,s,l,f)}catch(t){if(Me(p),t!==t+0)throw t;Se(1,0)}},ea:function(t,e,n,r,a,i){var o=Ee();try{Ue(t,e,n,r,a,i)}catch(t){if(Me(o),t!==t+0)throw t;Se(1,0)}},o:function(t){return t},a:j||u.wasmMemory,G:function(t){oe=t},la:le,z:function(t,e,n,r){return le(t,e,n,r)}};!function(){function t(t,e){u.asm=t.exports,ht.qc.push(u.asm.sb),$=u.asm.ub,X.unshift(u.asm.Va),k=e,O||(et--,u.monitorRunDependencies&&u.monitorRunDependencies(et),0==et&&(null!==nt&&(clearInterval(nt),nt=null),rt&&(t=rt,rt=null,t())))}function e(e){t(e.instance,e.module)}function n(t){return function(){if(!M&&(v||w)){if("function"==typeof fetch&&!tt.startsWith("file://"))return fetch(tt,{credentials:"same-origin"}).then((function(t){if(!t.ok)throw"failed to load wasm binary file at \'"+tt+"\'";return t.arrayBuffer()})).catch((function(){return ot()}));if(f)return new Promise((function(t,e){f(tt,(function(e){t(new Uint8Array(e))}),e)}))}return Promise.resolve().then((function(){return ot()}))}().then((function(t){return WebAssembly.instantiate(t,r)})).then((function(t){return t})).then(t,(function(t){x("failed to asynchronously prepare wasm: "+t),at(t)}))}var r={a:pe};if(O||(et++,u.monitorRunDependencies&&u.monitorRunDependencies(et)),u.instantiateWasm)try{return u.instantiateWasm(r,t)}catch(t){return x("Module.instantiateWasm callback failed with error: "+t),!1}(M||"function"!=typeof WebAssembly.instantiateStreaming||it()||tt.startsWith("file://")||_||"function"!=typeof fetch?n(e):fetch(tt,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,r).then(e,(function(t){return x("wasm streaming compile failed: "+t),x("falling back to ArrayBuffer instantiation"),n(e)}))}))).catch(s)}(),u.___wasm_call_ctors=function(){return(u.___wasm_call_ctors=u.asm.Va).apply(null,arguments)},u._OrtInit=function(){return(u._OrtInit=u.asm.Wa).apply(null,arguments)},u._OrtCreateSessionOptions=function(){return(u._OrtCreateSessionOptions=u.asm.Xa).apply(null,arguments)},u._OrtAppendExecutionProvider=function(){return(u._OrtAppendExecutionProvider=u.asm.Ya).apply(null,arguments)},u._OrtAddSessionConfigEntry=function(){return(u._OrtAddSessionConfigEntry=u.asm.Za).apply(null,arguments)},u._OrtReleaseSessionOptions=function(){return(u._OrtReleaseSessionOptions=u.asm._a).apply(null,arguments)},u._OrtCreateSession=function(){return(u._OrtCreateSession=u.asm.$a).apply(null,arguments)},u._OrtReleaseSession=function(){return(u._OrtReleaseSession=u.asm.ab).apply(null,arguments)},u._OrtGetInputCount=function(){return(u._OrtGetInputCount=u.asm.bb).apply(null,arguments)},u._OrtGetOutputCount=function(){return(u._OrtGetOutputCount=u.asm.cb).apply(null,arguments)},u._OrtGetInputName=function(){return(u._OrtGetInputName=u.asm.db).apply(null,arguments)},u._OrtGetOutputName=function(){return(u._OrtGetOutputName=u.asm.eb).apply(null,arguments)},u._OrtFree=function(){return(u._OrtFree=u.asm.fb).apply(null,arguments)},u._OrtCreateTensor=function(){return(u._OrtCreateTensor=u.asm.gb).apply(null,arguments)},u._OrtGetTensorData=function(){return(u._OrtGetTensorData=u.asm.hb).apply(null,arguments)},u._OrtReleaseTensor=function(){return(u._OrtReleaseTensor=u.asm.ib).apply(null,arguments)},u._OrtCreateRunOptions=function(){return(u._OrtCreateRunOptions=u.asm.jb).apply(null,arguments)},u._OrtAddRunConfigEntry=function(){return(u._OrtAddRunConfigEntry=u.asm.kb).apply(null,arguments)},u._OrtReleaseRunOptions=function(){return(u._OrtReleaseRunOptions=u.asm.lb).apply(null,arguments)},u._OrtRun=function(){return(u._OrtRun=u.asm.mb).apply(null,arguments)},u._OrtEndProfiling=function(){return(u._OrtEndProfiling=u.asm.nb).apply(null,arguments)};var he=u._pthread_self=function(){return(he=u._pthread_self=u.asm.ob).apply(null,arguments)},de=u._malloc=function(){return(de=u._malloc=u.asm.pb).apply(null,arguments)},ye=u._free=function(){return(ye=u._free=u.asm.qb).apply(null,arguments)},be=u._fflush=function(){return(be=u._fflush=u.asm.rb).apply(null,arguments)};u.__emscripten_tls_init=function(){return(u.__emscripten_tls_init=u.asm.sb).apply(null,arguments)};var me=u.___funcs_on_exit=function(){return(me=u.___funcs_on_exit=u.asm.tb).apply(null,arguments)},ge=u.__emscripten_thread_init=function(){return(ge=u.__emscripten_thread_init=u.asm.vb).apply(null,arguments)};u.__emscripten_thread_crashed=function(){return(u.__emscripten_thread_crashed=u.asm.wb).apply(null,arguments)};var ve,we=u._emscripten_run_in_main_runtime_thread_js=function(){return(we=u._emscripten_run_in_main_runtime_thread_js=u.asm.xb).apply(null,arguments)},_e=u.__emscripten_proxy_execute_task_queue=function(){return(_e=u.__emscripten_proxy_execute_task_queue=u.asm.yb).apply(null,arguments)},Oe=u.__emscripten_thread_free_data=function(){return(Oe=u.__emscripten_thread_free_data=u.asm.zb).apply(null,arguments)},Ae=u.__emscripten_thread_exit=function(){return(Ae=u.__emscripten_thread_exit=u.asm.Ab).apply(null,arguments)},Se=u._setThrew=function(){return(Se=u._setThrew=u.asm.Bb).apply(null,arguments)},Te=u._emscripten_stack_set_limits=function(){return(Te=u._emscripten_stack_set_limits=u.asm.Cb).apply(null,arguments)},Ee=u.stackSave=function(){return(Ee=u.stackSave=u.asm.Db).apply(null,arguments)},Me=u.stackRestore=function(){return(Me=u.stackRestore=u.asm.Eb).apply(null,arguments)},Ce=u.stackAlloc=function(){return(Ce=u.stackAlloc=u.asm.Fb).apply(null,arguments)},xe=u.___cxa_can_catch=function(){return(xe=u.___cxa_can_catch=u.asm.Gb).apply(null,arguments)},Re=u.___cxa_is_pointer_type=function(){return(Re=u.___cxa_is_pointer_type=u.asm.Hb).apply(null,arguments)},je=u.dynCall_j=function(){return(je=u.dynCall_j=u.asm.Ib).apply(null,arguments)},ke=u.dynCall_iiiiij=function(){return(ke=u.dynCall_iiiiij=u.asm.Jb).apply(null,arguments)},De=u.dynCall_jii=function(){return(De=u.dynCall_jii=u.asm.Kb).apply(null,arguments)},Pe=u.dynCall_viiiiij=function(){return(Pe=u.dynCall_viiiiij=u.asm.Lb).apply(null,arguments)},Ue=u.dynCall_vjji=function(){return(Ue=u.dynCall_vjji=u.asm.Mb).apply(null,arguments)},Fe=u.dynCall_viiijjjii=function(){return(Fe=u.dynCall_viiijjjii=u.asm.Nb).apply(null,arguments)},Ie=u.dynCall_iij=function(){return(Ie=u.dynCall_iij=u.asm.Ob).apply(null,arguments)},We=u.dynCall_ji=function(){return(We=u.dynCall_ji=u.asm.Pb).apply(null,arguments)},He=u.dynCall_iiiiiij=function(){return(He=u.dynCall_iiiiiij=u.asm.Qb).apply(null,arguments)},Le=u.dynCall_iiij=function(){return(Le=u.dynCall_iiij=u.asm.Rb).apply(null,arguments)};function ze(){function t(){if(!ve&&(ve=!0,u.calledRun=!0,!H)&&(O||dt(X),c(u),u.onRuntimeInitialized&&u.onRuntimeInitialized(),!O)){if(u.postRun)for("function"==typeof u.postRun&&(u.postRun=[u.postRun]);u.postRun.length;){var t=u.postRun.shift();Z.unshift(t)}dt(Z)}}if(!(0<et))if(O)c(u),O||dt(X),postMessage({cmd:"loaded"});else{if(u.preRun)for("function"==typeof u.preRun&&(u.preRun=[u.preRun]);u.preRun.length;)K();dt(q),0<et||(u.setStatus?(u.setStatus("Running..."),setTimeout((function(){setTimeout((function(){u.setStatus("")}),1),t()}),1)):t())}}if(u.UTF8ToString=Y,u.stringToUTF8=function(t,e,n){return B(t,r(),e,n)},u.lengthBytesUTF8=G,u.keepRuntimeAlive=Q,u.wasmMemory=j,u.stackSave=Ee,u.stackRestore=Me,u.stackAlloc=Ce,u.ExitStatus=ct,u.PThread=ht,rt=function t(){ve||ze(),ve||(rt=t)},u.preInit)for("function"==typeof u.preInit&&(u.preInit=[u.preInit]);0<u.preInit.length;)u.preInit.pop()();return ze(),t.ready});t.exports=r},932:(t,e,n)=>{var _scriptDir,r=(_scriptDir=(_scriptDir="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(t){var e,r,a;t=t||{},e||(e=void 0!==t?t:{}),e.ready=new Promise((function(t,e){r=t,a=e}));var i,o,u,c,s,l,f=Object.assign({},e),p="./this.program",h=(t,e)=>{throw e},d="object"==typeof window,y="function"==typeof importScripts,b="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,m="";b?(m=y?n(908).dirname(m)+"/":"//",l=()=>{s||(c=n(384),s=n(908))},i=function(t,e){return l(),t=s.normalize(t),c.readFileSync(t,e?void 0:"utf8")},u=t=>((t=i(t,!0)).buffer||(t=new Uint8Array(t)),t),o=(t,e,n)=>{l(),t=s.normalize(t),c.readFile(t,(function(t,r){t?n(t):e(r.buffer)}))},1<process.argv.length&&(p=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",(function(t){if(!(t instanceof J))throw t})),process.on("unhandledRejection",(function(t){throw t})),h=(t,e)=>{if(_||0<L)throw process.exitCode=t,e;e instanceof J||w("exiting due to exception: "+e),process.exit(t)},e.inspect=function(){return"[Emscripten Module object]"}):(d||y)&&(y?m=self.location.href:"undefined"!=typeof document&&document.currentScript&&(m=document.currentScript.src),_scriptDir&&(m=_scriptDir),m=0!==m.indexOf("blob:")?m.substr(0,m.replace(/[?#].*/,"").lastIndexOf("/")+1):"",i=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},y&&(u=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),o=(t,e,n)=>{var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onload=()=>{200==r.status||0==r.status&&r.response?e(r.response):n()},r.onerror=n,r.send(null)});var g,v=e.print||console.log.bind(console),w=e.printErr||console.warn.bind(console);Object.assign(e,f),f=null,e.thisProgram&&(p=e.thisProgram),e.quit&&(h=e.quit),e.wasmBinary&&(g=e.wasmBinary);var _=e.noExitRuntime||!1;"object"!=typeof WebAssembly&&V("no native wasm support detected");var O,A,S,T,E,M,C=!1,x="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function R(t,e,n){var r=(e>>>=0)+n;for(n=e;t[n]&&!(n>=r);)++n;if(16<n-e&&t.buffer&&x)return x.decode(t.subarray(e,n));for(r="";e<n;){var a=t[e++];if(128&a){var i=63&t[e++];if(192==(224&a))r+=String.fromCharCode((31&a)<<6|i);else{var o=63&t[e++];65536>(a=224==(240&a)?(15&a)<<12|i<<6|o:(7&a)<<18|i<<12|o<<6|63&t[e++])?r+=String.fromCharCode(a):(a-=65536,r+=String.fromCharCode(55296|a>>10,56320|1023&a))}}else r+=String.fromCharCode(a)}return r}function j(t,e){return(t>>>=0)?R(T,t,e):""}function k(t,e,n,r){if(!(0<r))return 0;var a=n>>>=0;r=n+r-1;for(var i=0;i<t.length;++i){var o=t.charCodeAt(i);if(55296<=o&&57343>=o&&(o=65536+((1023&o)<<10)|1023&t.charCodeAt(++i)),127>=o){if(n>=r)break;e[n++>>>0]=o}else{if(2047>=o){if(n+1>=r)break;e[n++>>>0]=192|o>>6}else{if(65535>=o){if(n+2>=r)break;e[n++>>>0]=224|o>>12}else{if(n+3>=r)break;e[n++>>>0]=240|o>>18,e[n++>>>0]=128|o>>12&63}e[n++>>>0]=128|o>>6&63}e[n++>>>0]=128|63&o}}return e[n>>>0]=0,n-a}function D(t){for(var e=0,n=0;n<t.length;++n){var r=t.charCodeAt(n);127>=r?e++:2047>=r?e+=2:55296<=r&&57343>=r?(e+=4,++n):e+=3}return e}function P(){var t=O.buffer;A=t,e.HEAP8=S=new Int8Array(t),e.HEAP16=new Int16Array(t),e.HEAP32=E=new Int32Array(t),e.HEAPU8=T=new Uint8Array(t),e.HEAPU16=new Uint16Array(t),e.HEAPU32=M=new Uint32Array(t),e.HEAPF32=new Float32Array(t),e.HEAPF64=new Float64Array(t)}var U,F=[],I=[],W=[],H=[],L=0;function z(){var t=e.preRun.shift();F.unshift(t)}var Y,B=0,G=null,N=null;function V(t){throw e.onAbort&&e.onAbort(t),w(t="Aborted("+t+")"),C=!0,t=new WebAssembly.RuntimeError(t+". Build with -sASSERTIONS for more info."),a(t),t}function $(){return Y.startsWith("data:application/octet-stream;base64,")}if(Y="ort-wasm.wasm",!$()){var q=Y;Y=e.locateFile?e.locateFile(q,m):m+q}function X(){var t=Y;try{if(t==Y&&g)return new Uint8Array(g);if(u)return u(t);throw"both async and sync fetching of the wasm failed"}catch(t){V(t)}}function J(t){this.name="ExitStatus",this.message="Program terminated with exit("+t+")",this.status=t}function Z(t){for(;0<t.length;)t.shift()(e)}var Q=[],K=0,tt=0;function et(t){this.Db=t,this.zb=t-24,this.Ub=function(t){M[this.zb+4>>2>>>0]=t},this.Eb=function(){return M[this.zb+4>>2>>>0]},this.Sb=function(t){M[this.zb+8>>2>>>0]=t},this.Wb=function(){return M[this.zb+8>>2>>>0]},this.Tb=function(){E[this.zb>>2>>>0]=0},this.Ib=function(t){S[this.zb+12>>0>>>0]=t?1:0},this.Pb=function(){return 0!=S[this.zb+12>>0>>>0]},this.Jb=function(t){S[this.zb+13>>0>>>0]=t?1:0},this.Lb=function(){return 0!=S[this.zb+13>>0>>>0]},this.Rb=function(t,e){this.Fb(0),this.Ub(t),this.Sb(e),this.Tb(),this.Ib(!1),this.Jb(!1)},this.Nb=function(){E[this.zb>>2>>>0]+=1},this.Xb=function(){var t=E[this.zb>>2>>>0];return E[this.zb>>2>>>0]=t-1,1===t},this.Fb=function(t){M[this.zb+16>>2>>>0]=t},this.Ob=function(){return M[this.zb+16>>2>>>0]},this.Qb=function(){if(Mt(this.Eb()))return M[this.Db>>2>>>0];var t=this.Ob();return 0!==t?t:this.Db}}function nt(t){return vt(new et(t).zb)}var rt=[];function at(t){var e=rt[t];return e||(t>=rt.length&&(rt.length=t+1),rt[t]=e=U.get(t)),e}function it(t){var e=D(t)+1,n=gt(e);return n&&k(t,S,n,e),n}var ot={};function ut(){if(!ct){var t,e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:p||"./this.program"};for(t in ot)void 0===ot[t]?delete e[t]:e[t]=ot[t];var n=[];for(t in e)n.push(t+"="+e[t]);ct=n}return ct}var ct,st=[null,[],[]];function lt(t,e){var n=st[t];0===e||10===e?((1===t?v:w)(R(n,0)),n.length=0):n.push(e)}var ft=0;function pt(t){return 0==t%4&&(0!=t%100||0==t%400)}var ht=[31,29,31,30,31,30,31,31,30,31,30,31],dt=[31,28,31,30,31,30,31,31,30,31,30,31];function yt(t,e,n,r){function a(t,e,n){for(t="number"==typeof t?t.toString():t||"";t.length<e;)t=n[0]+t;return t}function i(t,e){return a(t,e,"0")}function o(t,e){function n(t){return 0>t?-1:0<t?1:0}var r;return 0===(r=n(t.getFullYear()-e.getFullYear()))&&0===(r=n(t.getMonth()-e.getMonth()))&&(r=n(t.getDate()-e.getDate())),r}function u(t){switch(t.getDay()){case 0:return new Date(t.getFullYear()-1,11,29);case 1:return t;case 2:return new Date(t.getFullYear(),0,3);case 3:return new Date(t.getFullYear(),0,2);case 4:return new Date(t.getFullYear(),0,1);case 5:return new Date(t.getFullYear()-1,11,31);case 6:return new Date(t.getFullYear()-1,11,30)}}function c(t){var e=t.Bb;for(t=new Date(new Date(t.Cb+1900,0,1).getTime());0<e;){var n=t.getMonth(),r=(pt(t.getFullYear())?ht:dt)[n];if(!(e>r-t.getDate())){t.setDate(t.getDate()+e);break}e-=r-t.getDate()+1,t.setDate(1),11>n?t.setMonth(n+1):(t.setMonth(0),t.setFullYear(t.getFullYear()+1))}return n=new Date(t.getFullYear()+1,0,4),e=u(new Date(t.getFullYear(),0,4)),n=u(n),0>=o(e,t)?0>=o(n,t)?t.getFullYear()+1:t.getFullYear():t.getFullYear()-1}var s=E[r+40>>2>>>0];for(var l in r={$b:E[r>>2>>>0],Zb:E[r+4>>2>>>0],Gb:E[r+8>>2>>>0],Kb:E[r+12>>2>>>0],Hb:E[r+16>>2>>>0],Cb:E[r+20>>2>>>0],Ab:E[r+24>>2>>>0],Bb:E[r+28>>2>>>0],bc:E[r+32>>2>>>0],Yb:E[r+36>>2>>>0],ac:s?j(s):""},n=j(n),s={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})n=n.replace(new RegExp(l,"g"),s[l]);var f="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),p="January February March April May June July August September October November December".split(" ");for(l in s={"%a":function(t){return f[t.Ab].substring(0,3)},"%A":function(t){return f[t.Ab]},"%b":function(t){return p[t.Hb].substring(0,3)},"%B":function(t){return p[t.Hb]},"%C":function(t){return i((t.Cb+1900)/100|0,2)},"%d":function(t){return i(t.Kb,2)},"%e":function(t){return a(t.Kb,2," ")},"%g":function(t){return c(t).toString().substring(2)},"%G":function(t){return c(t)},"%H":function(t){return i(t.Gb,2)},"%I":function(t){return 0==(t=t.Gb)?t=12:12<t&&(t-=12),i(t,2)},"%j":function(t){for(var e=0,n=0;n<=t.Hb-1;e+=(pt(t.Cb+1900)?ht:dt)[n++]);return i(t.Kb+e,3)},"%m":function(t){return i(t.Hb+1,2)},"%M":function(t){return i(t.Zb,2)},"%n":function(){return"\\n"},"%p":function(t){return 0<=t.Gb&&12>t.Gb?"AM":"PM"},"%S":function(t){return i(t.$b,2)},"%t":function(){return"\\t"},"%u":function(t){return t.Ab||7},"%U":function(t){return i(Math.floor((t.Bb+7-t.Ab)/7),2)},"%V":function(t){var e=Math.floor((t.Bb+7-(t.Ab+6)%7)/7);if(2>=(t.Ab+371-t.Bb-2)%7&&e++,e)53==e&&(4==(n=(t.Ab+371-t.Bb)%7)||3==n&&pt(t.Cb)||(e=1));else{e=52;var n=(t.Ab+7-t.Bb-1)%7;(4==n||5==n&&pt(t.Cb%400-1))&&e++}return i(e,2)},"%w":function(t){return t.Ab},"%W":function(t){return i(Math.floor((t.Bb+7-(t.Ab+6)%7)/7),2)},"%y":function(t){return(t.Cb+1900).toString().substring(2)},"%Y":function(t){return t.Cb+1900},"%z":function(t){var e=0<=(t=t.Yb);return t=Math.abs(t)/60,(e?"+":"-")+String("0000"+(t/60*100+t%60)).slice(-4)},"%Z":function(t){return t.ac},"%%":function(){return"%"}},n=n.replace(/%%/g,"\\0\\0"),s)n.includes(l)&&(n=n.replace(new RegExp(l,"g"),s[l](r)));return l=function(t){var e=Array(D(t)+1);return k(t,e,0,e.length),e}(n=n.replace(/\\0\\0/g,"%")),l.length>e?0:(S.set(l,t>>>0),l.length-1)}var bt={a:function(t){return gt(t+24)+24},m:function(t){return(t=new et(t)).Pb()||(t.Ib(!0),K--),t.Jb(!1),Q.push(t),t.Nb(),t.Qb()},ia:function(t){throw w("Unexpected exception thrown, this is not properly supported - aborting"),C=!0,t},w:function(){Ot(0);var t=Q.pop();if(t.Xb()&&!t.Lb()){var e=t.Wb();e&&at(e)(t.Db),nt(t.Db)}tt=0},d:function(){var t=tt;if(!t)return ft=0;var e=new et(t);e.Fb(t);var n=e.Eb();if(!n)return ft=0,t;for(var r=Array.prototype.slice.call(arguments),a=0;a<r.length;a++){var i=r[a];if(0===i||i===n)break;if(Et(i,n,e.zb+16))return ft=i,t}return ft=n,t},k:function(){var t=tt;if(!t)return ft=0;var e=new et(t);e.Fb(t);var n=e.Eb();if(!n)return ft=0,t;for(var r=Array.prototype.slice.call(arguments),a=0;a<r.length;a++){var i=r[a];if(0===i||i===n)break;if(Et(i,n,e.zb+16))return ft=i,t}return ft=n,t},g:function(){var t=tt;if(!t)return ft=0;var e=new et(t);e.Fb(t);var n=e.Eb();if(!n)return ft=0,t;for(var r=Array.prototype.slice.call(arguments),a=0;a<r.length;a++){var i=r[a];if(0===i||i===n)break;if(Et(i,n,e.zb+16))return ft=i,t}return ft=n,t},s:nt,L:function(){var t=Q.pop();t||V("no exception to throw");var e=t.Db;throw t.Lb()||(Q.push(t),t.Jb(!0),t.Ib(!1),K++),tt=e,e},b:function(t,e,n){throw new et(t).Rb(e,n),tt=t,K++,t},la:function(){return K},i:function(t){throw tt||(tt=t),t},H:function(){return 0},Ba:function(){},pa:function(){},ra:function(){},ka:function(){return 0},za:function(){},ua:function(){},ya:function(){},R:function(){},qa:function(){},na:function(){},Aa:function(){},oa:function(){},Ha:function(){},Ja:function(){V("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},Ia:function(){V("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},S:function(){return Date.now()},Ca:function(){return!0},Da:function(t,e){t=new Date(1e3*(M[t>>>2]+4294967296*E[t+4>>>2])),E[e>>2>>>0]=t.getUTCSeconds(),E[e+4>>2>>>0]=t.getUTCMinutes(),E[e+8>>2>>>0]=t.getUTCHours(),E[e+12>>2>>>0]=t.getUTCDate(),E[e+16>>2>>>0]=t.getUTCMonth(),E[e+20>>2>>>0]=t.getUTCFullYear()-1900,E[e+24>>2>>>0]=t.getUTCDay(),E[e+28>>2>>>0]=(t.getTime()-Date.UTC(t.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},Ea:function(t,e){t=new Date(1e3*(M[t>>>2]+4294967296*E[t+4>>>2])),E[e>>2>>>0]=t.getSeconds(),E[e+4>>2>>>0]=t.getMinutes(),E[e+8>>2>>>0]=t.getHours(),E[e+12>>2>>>0]=t.getDate(),E[e+16>>2>>>0]=t.getMonth(),E[e+20>>2>>>0]=t.getFullYear()-1900,E[e+24>>2>>>0]=t.getDay();var n=new Date(t.getFullYear(),0,1);E[e+28>>2>>>0]=(t.getTime()-n.getTime())/864e5|0,E[e+36>>2>>>0]=-60*t.getTimezoneOffset();var r=new Date(t.getFullYear(),6,1).getTimezoneOffset();n=n.getTimezoneOffset(),E[e+32>>2>>>0]=0|(r!=n&&t.getTimezoneOffset()==Math.min(n,r))},Fa:function(t){var e=new Date(E[t+20>>2>>>0]+1900,E[t+16>>2>>>0],E[t+12>>2>>>0],E[t+8>>2>>>0],E[t+4>>2>>>0],E[t>>2>>>0],0),n=E[t+32>>2>>>0],r=e.getTimezoneOffset(),a=new Date(e.getFullYear(),0,1),i=new Date(e.getFullYear(),6,1).getTimezoneOffset(),o=a.getTimezoneOffset(),u=Math.min(o,i);return 0>n?E[t+32>>2>>>0]=Number(i!=o&&u==r):0<n!=(u==r)&&(i=Math.max(o,i),e.setTime(e.getTime()+6e4*((0<n?u:i)-r))),E[t+24>>2>>>0]=e.getDay(),E[t+28>>2>>>0]=(e.getTime()-a.getTime())/864e5|0,E[t>>2>>>0]=e.getSeconds(),E[t+4>>2>>>0]=e.getMinutes(),E[t+8>>2>>>0]=e.getHours(),E[t+12>>2>>>0]=e.getDate(),E[t+16>>2>>>0]=e.getMonth(),e.getTime()/1e3|0},sa:function(){return-52},ta:function(){},Ga:function t(e,n,r){t.Vb||(t.Vb=!0,function(t,e,n){function r(t){return(t=t.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?t[1]:"GMT"}var a=(new Date).getFullYear(),i=new Date(a,0,1),o=new Date(a,6,1);a=i.getTimezoneOffset();var u=o.getTimezoneOffset();E[t>>2>>>0]=60*Math.max(a,u),E[e>>2>>>0]=Number(a!=u),t=r(i),e=r(o),t=it(t),e=it(e),u<a?(M[n>>2>>>0]=t,M[n+4>>2>>>0]=e):(M[n>>2>>>0]=e,M[n+4>>2>>>0]=t)}(e,n,r))},B:function(){V("")},ma:function(){return 4294901760},I:b?()=>{var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:()=>performance.now(),xa:function(t,e,n){T.copyWithin(t>>>0,e>>>0,e+n>>>0)},G:function(t){var e=T.length;if(4294901760<(t>>>=0))return!1;for(var n=1;4>=n;n*=2){var r=e*(1+.2/n);r=Math.min(r,t+100663296);var a=Math;r=Math.max(t,r),a=a.min.call(a,4294901760,r+(65536-r%65536)%65536);t:{try{O.grow(a-A.byteLength+65535>>>16),P();var i=1;break t}catch(t){}i=void 0}if(i)return!0}return!1},va:function(t,e){var n=0;return ut().forEach((function(r,a){var i=e+n;for(a=M[t+4*a>>2>>>0]=i,i=0;i<r.length;++i)S[a++>>0>>>0]=r.charCodeAt(i);S[a>>0>>>0]=0,n+=r.length+1})),0},wa:function(t,e){var n=ut();M[t>>2>>>0]=n.length;var r=0;return n.forEach((function(t){r+=t.length+1})),M[e>>2>>>0]=r,0},ba:function(t){_||0<L||(_t(),Z(W),wt(0),st[1].length&&lt(1,10),st[2].length&&lt(2,10)),_||0<L||(e.onExit&&e.onExit(t),C=!0),h(t,new J(t))},E:function(){return 52},Q:function(){return 52},ca:function(){return 70},P:function(t,e,n,r){for(var a=0,i=0;i<n;i++){var o=M[e>>2>>>0],u=M[e+4>>2>>>0];e+=8;for(var c=0;c<u;c++)lt(t,T[o+c>>>0]);a+=u}return M[r>>2>>>0]=a,0},c:function(){return ft},ja:function t(e,r){t.Mb||(t.Mb=function(){if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var t=new Uint8Array(1);return()=>(crypto.getRandomValues(t),t[0])}if(b)try{var e=n(Object(function(){var t=new Error("Cannot find module \'crypto\'");throw t.code="MODULE_NOT_FOUND",t}()));return()=>e.randomBytes(1)[0]}catch(t){}return()=>V("randomDevice")}());for(var a=0;a<r;a++)S[e+a>>0>>>0]=t.Mb();return 0},ea:function(t,e,n){var r=At();try{return at(t)(e,n)}catch(t){if(St(r),t!==t+0)throw t;Ot(1,0)}},fa:function(t,e,n){var r=At();try{return at(t)(e,n)}catch(t){if(St(r),t!==t+0)throw t;Ot(1,0)}},J:function(t){var e=At();try{return at(t)()}catch(t){if(St(e),t!==t+0)throw t;Ot(1,0)}},e:function(t,e){var n=At();try{return at(t)(e)}catch(t){if(St(n),t!==t+0)throw t;Ot(1,0)}},N:function(t,e,n){var r=At();try{return at(t)(e,n)}catch(t){if(St(r),t!==t+0)throw t;Ot(1,0)}},O:function(t,e,n){var r=At();try{return at(t)(e,n)}catch(t){if(St(r),t!==t+0)throw t;Ot(1,0)}},j:function(t,e,n){var r=At();try{return at(t)(e,n)}catch(t){if(St(r),t!==t+0)throw t;Ot(1,0)}},o:function(t,e,n,r){var a=At();try{return at(t)(e,n,r)}catch(t){if(St(a),t!==t+0)throw t;Ot(1,0)}},p:function(t,e,n,r,a){var i=At();try{return at(t)(e,n,r,a)}catch(t){if(St(i),t!==t+0)throw t;Ot(1,0)}},M:function(t,e,n,r,a,i){var o=At();try{return at(t)(e,n,r,a,i)}catch(t){if(St(o),t!==t+0)throw t;Ot(1,0)}},r:function(t,e,n,r,a,i){var o=At();try{return at(t)(e,n,r,a,i)}catch(t){if(St(o),t!==t+0)throw t;Ot(1,0)}},v:function(t,e,n,r,a,i,o){var u=At();try{return at(t)(e,n,r,a,i,o)}catch(t){if(St(u),t!==t+0)throw t;Ot(1,0)}},K:function(t,e,n,r,a,i,o,u){var c=At();try{return at(t)(e,n,r,a,i,o,u)}catch(t){if(St(c),t!==t+0)throw t;Ot(1,0)}},D:function(t,e,n,r,a,i,o,u,c,s,l,f){var p=At();try{return at(t)(e,n,r,a,i,o,u,c,s,l,f)}catch(t){if(St(p),t!==t+0)throw t;Ot(1,0)}},X:function(t,e,n,r,a,i,o,u){var c=At();try{return Ft(t,e,n,r,a,i,o,u)}catch(t){if(St(c),t!==t+0)throw t;Ot(1,0)}},V:function(t,e,n,r,a,i,o){var u=At();try{return xt(t,e,n,r,a,i,o)}catch(t){if(St(u),t!==t+0)throw t;Ot(1,0)}},U:function(t,e,n,r,a){var i=At();try{return It(t,e,n,r,a)}catch(t){if(St(i),t!==t+0)throw t;Ot(1,0)}},Z:function(t,e,n,r){var a=At();try{return Pt(t,e,n,r)}catch(t){if(St(a),t!==t+0)throw t;Ot(1,0)}},W:function(t){var e=At();try{return Ct(t)}catch(t){if(St(e),t!==t+0)throw t;Ot(1,0)}},Y:function(t,e){var n=At();try{return Ut(t,e)}catch(t){if(St(n),t!==t+0)throw t;Ot(1,0)}},T:function(t,e,n){var r=At();try{return Rt(t,e,n)}catch(t){if(St(r),t!==t+0)throw t;Ot(1,0)}},f:function(t){var e=At();try{at(t)()}catch(t){if(St(e),t!==t+0)throw t;Ot(1,0)}},q:function(t,e){var n=At();try{at(t)(e)}catch(t){if(St(n),t!==t+0)throw t;Ot(1,0)}},h:function(t,e,n){var r=At();try{at(t)(e,n)}catch(t){if(St(r),t!==t+0)throw t;Ot(1,0)}},da:function(t,e,n,r){var a=At();try{at(t)(e,n,r)}catch(t){if(St(a),t!==t+0)throw t;Ot(1,0)}},l:function(t,e,n,r){var a=At();try{at(t)(e,n,r)}catch(t){if(St(a),t!==t+0)throw t;Ot(1,0)}},t:function(t,e,n,r,a){var i=At();try{at(t)(e,n,r,a)}catch(t){if(St(i),t!==t+0)throw t;Ot(1,0)}},u:function(t,e,n,r,a,i){var o=At();try{at(t)(e,n,r,a,i)}catch(t){if(St(o),t!==t+0)throw t;Ot(1,0)}},x:function(t,e,n,r,a,i,o){var u=At();try{at(t)(e,n,r,a,i,o)}catch(t){if(St(u),t!==t+0)throw t;Ot(1,0)}},z:function(t,e,n,r,a,i,o,u){var c=At();try{at(t)(e,n,r,a,i,o,u)}catch(t){if(St(c),t!==t+0)throw t;Ot(1,0)}},ga:function(t,e,n,r,a,i,o,u,c){var s=At();try{at(t)(e,n,r,a,i,o,u,c)}catch(t){if(St(s),t!==t+0)throw t;Ot(1,0)}},A:function(t,e,n,r,a,i,o,u,c,s,l){var f=At();try{at(t)(e,n,r,a,i,o,u,c,s,l)}catch(t){if(St(f),t!==t+0)throw t;Ot(1,0)}},C:function(t,e,n,r,a,i,o,u,c,s,l,f,p,h,d,y){var b=At();try{at(t)(e,n,r,a,i,o,u,c,s,l,f,p,h,d,y)}catch(t){if(St(b),t!==t+0)throw t;Ot(1,0)}},aa:function(t,e,n,r,a,i,o,u){var c=At();try{jt(t,e,n,r,a,i,o,u)}catch(t){if(St(c),t!==t+0)throw t;Ot(1,0)}},_:function(t,e,n,r,a,i,o,u,c,s,l,f){var p=At();try{Dt(t,e,n,r,a,i,o,u,c,s,l,f)}catch(t){if(St(p),t!==t+0)throw t;Ot(1,0)}},$:function(t,e,n,r,a,i){var o=At();try{kt(t,e,n,r,a,i)}catch(t){if(St(o),t!==t+0)throw t;Ot(1,0)}},n:function(t){return t},F:function(t){ft=t},ha:yt,y:function(t,e,n,r){return yt(t,e,n,r)}};!function(){function t(t){e.asm=t.exports,O=e.asm.Ka,P(),U=e.asm.ib,I.unshift(e.asm.La),B--,e.monitorRunDependencies&&e.monitorRunDependencies(B),0==B&&(null!==G&&(clearInterval(G),G=null),N&&(t=N,N=null,t()))}function n(e){t(e.instance)}function r(t){return function(){if(!g&&(d||y)){if("function"==typeof fetch&&!Y.startsWith("file://"))return fetch(Y,{credentials:"same-origin"}).then((function(t){if(!t.ok)throw"failed to load wasm binary file at \'"+Y+"\'";return t.arrayBuffer()})).catch((function(){return X()}));if(o)return new Promise((function(t,e){o(Y,(function(e){t(new Uint8Array(e))}),e)}))}return Promise.resolve().then((function(){return X()}))}().then((function(t){return WebAssembly.instantiate(t,i)})).then((function(t){return t})).then(t,(function(t){w("failed to asynchronously prepare wasm: "+t),V(t)}))}var i={a:bt};if(B++,e.monitorRunDependencies&&e.monitorRunDependencies(B),e.instantiateWasm)try{return e.instantiateWasm(i,t)}catch(t){return w("Module.instantiateWasm callback failed with error: "+t),!1}(g||"function"!=typeof WebAssembly.instantiateStreaming||$()||Y.startsWith("file://")||b||"function"!=typeof fetch?r(n):fetch(Y,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,i).then(n,(function(t){return w("wasm streaming compile failed: "+t),w("falling back to ArrayBuffer instantiation"),r(n)}))}))).catch(a)}(),e.___wasm_call_ctors=function(){return(e.___wasm_call_ctors=e.asm.La).apply(null,arguments)},e._OrtInit=function(){return(e._OrtInit=e.asm.Ma).apply(null,arguments)},e._OrtCreateSessionOptions=function(){return(e._OrtCreateSessionOptions=e.asm.Na).apply(null,arguments)},e._OrtAppendExecutionProvider=function(){return(e._OrtAppendExecutionProvider=e.asm.Oa).apply(null,arguments)},e._OrtAddSessionConfigEntry=function(){return(e._OrtAddSessionConfigEntry=e.asm.Pa).apply(null,arguments)},e._OrtReleaseSessionOptions=function(){return(e._OrtReleaseSessionOptions=e.asm.Qa).apply(null,arguments)},e._OrtCreateSession=function(){return(e._OrtCreateSession=e.asm.Ra).apply(null,arguments)},e._OrtReleaseSession=function(){return(e._OrtReleaseSession=e.asm.Sa).apply(null,arguments)},e._OrtGetInputCount=function(){return(e._OrtGetInputCount=e.asm.Ta).apply(null,arguments)},e._OrtGetOutputCount=function(){return(e._OrtGetOutputCount=e.asm.Ua).apply(null,arguments)},e._OrtGetInputName=function(){return(e._OrtGetInputName=e.asm.Va).apply(null,arguments)},e._OrtGetOutputName=function(){return(e._OrtGetOutputName=e.asm.Wa).apply(null,arguments)},e._OrtFree=function(){return(e._OrtFree=e.asm.Xa).apply(null,arguments)},e._OrtCreateTensor=function(){return(e._OrtCreateTensor=e.asm.Ya).apply(null,arguments)},e._OrtGetTensorData=function(){return(e._OrtGetTensorData=e.asm.Za).apply(null,arguments)},e._OrtReleaseTensor=function(){return(e._OrtReleaseTensor=e.asm._a).apply(null,arguments)},e._OrtCreateRunOptions=function(){return(e._OrtCreateRunOptions=e.asm.$a).apply(null,arguments)},e._OrtAddRunConfigEntry=function(){return(e._OrtAddRunConfigEntry=e.asm.ab).apply(null,arguments)},e._OrtReleaseRunOptions=function(){return(e._OrtReleaseRunOptions=e.asm.bb).apply(null,arguments)},e._OrtRun=function(){return(e._OrtRun=e.asm.cb).apply(null,arguments)},e._OrtEndProfiling=function(){return(e._OrtEndProfiling=e.asm.db).apply(null,arguments)};var mt,gt=e._malloc=function(){return(gt=e._malloc=e.asm.eb).apply(null,arguments)},vt=e._free=function(){return(vt=e._free=e.asm.fb).apply(null,arguments)},wt=e._fflush=function(){return(wt=e._fflush=e.asm.gb).apply(null,arguments)},_t=e.___funcs_on_exit=function(){return(_t=e.___funcs_on_exit=e.asm.hb).apply(null,arguments)},Ot=e._setThrew=function(){return(Ot=e._setThrew=e.asm.jb).apply(null,arguments)},At=e.stackSave=function(){return(At=e.stackSave=e.asm.kb).apply(null,arguments)},St=e.stackRestore=function(){return(St=e.stackRestore=e.asm.lb).apply(null,arguments)},Tt=e.stackAlloc=function(){return(Tt=e.stackAlloc=e.asm.mb).apply(null,arguments)},Et=e.___cxa_can_catch=function(){return(Et=e.___cxa_can_catch=e.asm.nb).apply(null,arguments)},Mt=e.___cxa_is_pointer_type=function(){return(Mt=e.___cxa_is_pointer_type=e.asm.ob).apply(null,arguments)},Ct=e.dynCall_j=function(){return(Ct=e.dynCall_j=e.asm.pb).apply(null,arguments)},xt=e.dynCall_iiiiij=function(){return(xt=e.dynCall_iiiiij=e.asm.qb).apply(null,arguments)},Rt=e.dynCall_jii=function(){return(Rt=e.dynCall_jii=e.asm.rb).apply(null,arguments)},jt=e.dynCall_viiiiij=function(){return(jt=e.dynCall_viiiiij=e.asm.sb).apply(null,arguments)},kt=e.dynCall_vjji=function(){return(kt=e.dynCall_vjji=e.asm.tb).apply(null,arguments)},Dt=e.dynCall_viiijjjii=function(){return(Dt=e.dynCall_viiijjjii=e.asm.ub).apply(null,arguments)},Pt=e.dynCall_iij=function(){return(Pt=e.dynCall_iij=e.asm.vb).apply(null,arguments)},Ut=e.dynCall_ji=function(){return(Ut=e.dynCall_ji=e.asm.wb).apply(null,arguments)},Ft=e.dynCall_iiiiiij=function(){return(Ft=e.dynCall_iiiiiij=e.asm.xb).apply(null,arguments)},It=e.dynCall_iiij=function(){return(It=e.dynCall_iiij=e.asm.yb).apply(null,arguments)};function Wt(){function t(){if(!mt&&(mt=!0,e.calledRun=!0,!C)){if(Z(I),r(e),e.onRuntimeInitialized&&e.onRuntimeInitialized(),e.postRun)for("function"==typeof e.postRun&&(e.postRun=[e.postRun]);e.postRun.length;){var t=e.postRun.shift();H.unshift(t)}Z(H)}}if(!(0<B)){if(e.preRun)for("function"==typeof e.preRun&&(e.preRun=[e.preRun]);e.preRun.length;)z();Z(F),0<B||(e.setStatus?(e.setStatus("Running..."),setTimeout((function(){setTimeout((function(){e.setStatus("")}),1),t()}),1)):t())}}if(e.UTF8ToString=j,e.stringToUTF8=function(t,e,n){return k(t,T,e,n)},e.lengthBytesUTF8=D,e.stackSave=At,e.stackRestore=St,e.stackAlloc=Tt,N=function t(){mt||Wt(),mt||(N=t)},e.preInit)for("function"==typeof e.preInit&&(e.preInit=[e.preInit]);0<e.preInit.length;)e.preInit.pop()();return Wt(),t.ready});t.exports=r},967:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.iterateExtraOptions=void 0,e.iterateExtraOptions=(t,n,r,a)=>{if("object"==typeof t&&null!==t){if(r.has(t))throw new Error("Circular reference in options");r.add(t)}Object.entries(t).forEach((([t,i])=>{const o=n?n+t:t;if("object"==typeof i)(0,e.iterateExtraOptions)(i,o+".",r,a);else if("string"==typeof i||"number"==typeof i)a(o,i.toString());else{if("boolean"!=typeof i)throw new Error("Can\'t handle extra config type: "+typeof i);a(o,i?"1":"0")}}))}},586:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setRunOptions=void 0;const r=n(967),a=n(983),i=n(361);e.setRunOptions=t=>{const e=(0,i.getInstance)();let n=0;const o=[],u=t||{};try{if(void 0===(null==t?void 0:t.logSeverityLevel))u.logSeverityLevel=2;else if("number"!=typeof t.logSeverityLevel||!Number.isInteger(t.logSeverityLevel)||t.logSeverityLevel<0||t.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${t.logSeverityLevel}`);if(void 0===(null==t?void 0:t.logVerbosityLevel))u.logVerbosityLevel=0;else if("number"!=typeof t.logVerbosityLevel||!Number.isInteger(t.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${t.logVerbosityLevel}`);void 0===(null==t?void 0:t.terminate)&&(u.terminate=!1);let i=0;if(void 0!==(null==t?void 0:t.tag)&&(i=(0,a.allocWasmString)(t.tag,o)),n=e._OrtCreateRunOptions(u.logSeverityLevel,u.logVerbosityLevel,!!u.terminate,i),0===n)throw new Error("Can\'t create run options");return void 0!==(null==t?void 0:t.extra)&&(0,r.iterateExtraOptions)(t.extra,"",new WeakSet,((t,r)=>{const i=(0,a.allocWasmString)(t,o),u=(0,a.allocWasmString)(r,o);if(0!==e._OrtAddRunConfigEntry(n,i,u))throw new Error(`Can\'t set a run config entry: ${t} - ${r}`)})),[n,o]}catch(t){throw 0!==n&&e._OrtReleaseRunOptions(n),o.forEach(e._free),t}}},919:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setSessionOptions=void 0;const r=n(967),a=n(983),i=n(361);e.setSessionOptions=t=>{const e=(0,i.getInstance)();let n=0;const o=[],u=t||{};(t=>{t.extra||(t.extra={}),t.extra.session||(t.extra.session={});const e=t.extra.session;e.use_ort_model_bytes_directly||(e.use_ort_model_bytes_directly="1")})(u);try{void 0===(null==t?void 0:t.graphOptimizationLevel)&&(u.graphOptimizationLevel="all");const c=(t=>{switch(t){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${t}`)}})(u.graphOptimizationLevel);void 0===(null==t?void 0:t.enableCpuMemArena)&&(u.enableCpuMemArena=!0),void 0===(null==t?void 0:t.enableMemPattern)&&(u.enableMemPattern=!0),void 0===(null==t?void 0:t.executionMode)&&(u.executionMode="sequential");const s=(t=>{switch(t){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${t}`)}})(u.executionMode);let l=0;if(void 0!==(null==t?void 0:t.logId)&&(l=(0,a.allocWasmString)(t.logId,o)),void 0===(null==t?void 0:t.logSeverityLevel))u.logSeverityLevel=2;else if("number"!=typeof t.logSeverityLevel||!Number.isInteger(t.logSeverityLevel)||t.logSeverityLevel<0||t.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${t.logSeverityLevel}`);if(void 0===(null==t?void 0:t.logVerbosityLevel))u.logVerbosityLevel=0;else if("number"!=typeof t.logVerbosityLevel||!Number.isInteger(t.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${t.logVerbosityLevel}`);if(void 0===(null==t?void 0:t.enableProfiling)&&(u.enableProfiling=!1),n=e._OrtCreateSessionOptions(c,!!u.enableCpuMemArena,!!u.enableMemPattern,s,!!u.enableProfiling,0,l,u.logSeverityLevel,u.logVerbosityLevel),0===n)throw new Error("Can\'t create session options");return(null==t?void 0:t.executionProviders)&&((t,e,n)=>{for(const r of e){let e="string"==typeof r?r:r.name;switch(e){case"xnnpack":e="XNNPACK";break;case"wasm":case"cpu":continue;default:throw new Error(`not supported EP: ${e}`)}const o=(0,a.allocWasmString)(e,n);if(0!==(0,i.getInstance)()._OrtAppendExecutionProvider(t,o))throw new Error(`Can\'t append execution provider: ${e}`)}})(n,t.executionProviders,o),void 0!==(null==t?void 0:t.extra)&&(0,r.iterateExtraOptions)(t.extra,"",new WeakSet,((t,r)=>{const i=(0,a.allocWasmString)(t,o),u=(0,a.allocWasmString)(r,o);if(0!==e._OrtAddSessionConfigEntry(n,i,u))throw new Error(`Can\'t set a session config entry: ${t} - ${r}`)})),[n,o]}catch(t){throw 0!==n&&e._OrtReleaseSessionOptions(n),o.forEach(e._free),t}}},983:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.allocWasmString=void 0;const r=n(361);e.allocWasmString=(t,e)=>{const n=(0,r.getInstance)(),a=n.lengthBytesUTF8(t)+1,i=n._malloc(a);return n.stringToUTF8(t,i,a),e.push(i),i}},349:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.extractTransferableBuffers=e.endProfiling=e.run=e.releaseSession=e.createSession=e.createSessionFinalize=e.createSessionAllocate=e.initOrt=void 0;const r=n(586),a=n(919),i=n(983),o=n(361);e.initOrt=(t,e)=>{const n=(0,o.getInstance)()._OrtInit(t,e);if(0!==n)throw new Error(`Can\'t initialize onnxruntime. error code = ${n}`)};const u=new Map;e.createSessionAllocate=t=>{const e=(0,o.getInstance)(),n=e._malloc(t.byteLength);return e.HEAPU8.set(t,n),[n,t.byteLength]},e.createSessionFinalize=(t,e)=>{const n=(0,o.getInstance)();let r=0,i=0,c=[];try{if([i,c]=(0,a.setSessionOptions)(e),r=n._OrtCreateSession(t[0],t[1],i),0===r)throw new Error("Can\'t create a session")}finally{n._free(t[0]),n._OrtReleaseSessionOptions(i),c.forEach(n._free)}const s=n._OrtGetInputCount(r),l=n._OrtGetOutputCount(r),f=[],p=[],h=[],d=[];for(let t=0;t<s;t++){const e=n._OrtGetInputName(r,t);if(0===e)throw new Error("Can\'t get an input name");p.push(e),f.push(n.UTF8ToString(e))}for(let t=0;t<l;t++){const e=n._OrtGetOutputName(r,t);if(0===e)throw new Error("Can\'t get an output name");d.push(e),h.push(n.UTF8ToString(e))}return u.set(r,[r,p,d]),[r,f,h]},e.createSession=(t,n)=>{const r=(0,e.createSessionAllocate)(t);return(0,e.createSessionFinalize)(r,n)},e.releaseSession=t=>{const e=(0,o.getInstance)(),n=u.get(t);if(!n)throw new Error("invalid session id");const r=n[0],a=n[1],i=n[2];a.forEach(e._OrtFree),i.forEach(e._OrtFree),e._OrtReleaseSession(r),u.delete(t)};const c=t=>{switch(t){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${t}`)}},s=t=>{switch(t){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${t}`)}},l=t=>{switch(t){case"float32":return Float32Array;case"uint8":case"bool":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${t}`)}};e.run=(t,e,n,a,f)=>{const p=(0,o.getInstance)(),h=u.get(t);if(!h)throw new Error("invalid session id");const d=h[0],y=h[1],b=h[2],m=e.length,g=a.length;let v=0,w=[];const _=[],O=[];try{[v,w]=(0,r.setRunOptions)(f);for(let t=0;t<m;t++){const e=n[t][0],r=n[t][1],a=n[t][2];let o,u;if(Array.isArray(a)){u=4*a.length,o=p._malloc(u),O.push(o);let t=o/4;for(let e=0;e<a.length;e++){if("string"!=typeof a[e])throw new TypeError(`tensor data at index ${e} is not a string`);p.HEAPU32[t++]=(0,i.allocWasmString)(a[e],O)}}else u=a.byteLength,o=p._malloc(u),O.push(o),p.HEAPU8.set(new Uint8Array(a.buffer,a.byteOffset,u),o);const s=p.stackSave(),l=p.stackAlloc(4*r.length);try{let t=l/4;r.forEach((e=>p.HEAP32[t++]=e));const n=p._OrtCreateTensor(c(e),o,u,l,r.length);if(0===n)throw new Error("Can\'t create a tensor");_.push(n)}finally{p.stackRestore(s)}}const t=p.stackSave(),o=p.stackAlloc(4*m),u=p.stackAlloc(4*m),h=p.stackAlloc(4*g),A=p.stackAlloc(4*g);try{let n=o/4,r=u/4,i=h/4,c=A/4;for(let t=0;t<m;t++)p.HEAPU32[n++]=_[t],p.HEAPU32[r++]=y[e[t]];for(let t=0;t<g;t++)p.HEAPU32[i++]=0,p.HEAPU32[c++]=b[a[t]];let f=p._OrtRun(d,u,o,m,A,g,h,v);const w=[];if(0===f)for(let t=0;t<g;t++){const e=p.HEAPU32[h/4+t],n=p.stackSave(),r=p.stackAlloc(16);let a,i=0;try{if(f=p._OrtGetTensorData(e,r,r+4,r+8,r+12),0!==f)throw new Error(`Can\'t access output tensor data. error code = ${f}`);let t=r/4;const o=p.HEAPU32[t++];i=p.HEAPU32[t++];const u=p.HEAPU32[t++],c=p.HEAPU32[t++],h=[];for(let t=0;t<c;t++)h.push(p.HEAPU32[u/4+t]);p._OrtFree(u);const d=0===h.length?1:h.reduce(((t,e)=>t*e));if(a=s(o),"string"===a){const t=[];let e=i/4;for(let n=0;n<d;n++){const r=p.HEAPU32[e++],a=n===d-1?void 0:p.HEAPU32[e]-r;t.push(p.UTF8ToString(r,a))}w.push([a,h,t])}else{const t=new(l(a))(d);new Uint8Array(t.buffer,t.byteOffset,t.byteLength).set(p.HEAPU8.subarray(i,i+t.byteLength)),w.push([a,h,t])}}finally{p.stackRestore(n),"string"===a&&i&&p._free(i),p._OrtReleaseTensor(e)}}if(0===f)return w;throw new Error(`failed to call OrtRun(). error code = ${f}.`)}finally{p.stackRestore(t)}}finally{_.forEach(p._OrtReleaseTensor),O.forEach(p._free),p._OrtReleaseRunOptions(v),w.forEach(p._free)}},e.endProfiling=t=>{const e=(0,o.getInstance)(),n=u.get(t);if(!n)throw new Error("invalid session id");const r=n[0],a=e._OrtEndProfiling(r);if(0===a)throw new Error("Can\'t get an profile file name");e._OrtFree(a)},e.extractTransferableBuffers=t=>{const e=[];for(const n of t){const t=n[2];!Array.isArray(t)&&t.buffer&&e.push(t.buffer)}return e}},361:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(e,n);a&&!("get"in a?!e.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,a)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return a(e,t),e},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.dispose=e.getInstance=e.initializeWebAssembly=void 0;const u=i(n(449)),c=o(n(932)),s=n(474);let l,f=!1,p=!1,h=!1;const d=(t,e)=>e?t?"ort-wasm-simd-threaded.wasm":"ort-wasm-threaded.wasm":t?"ort-wasm-simd.wasm":"ort-wasm.wasm";e.initializeWebAssembly=async t=>{if(f)return Promise.resolve();if(p)throw new Error("multiple calls to \'initializeWebAssembly()\' detected.");if(h)throw new Error("previous call to \'initializeWebAssembly()\' failed.");p=!0;const e=t.initTimeout,r=t.numThreads,a=t.simd,i=r>1&&(()=>{try{return"undefined"!=typeof SharedArrayBuffer&&("undefined"!=typeof MessageChannel&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])))}catch(t){return!1}})(),o=a&&(()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch(t){return!1}})(),y="string"==typeof t.wasmPaths?t.wasmPaths:void 0,b=d(!1,i),m=d(o,i),g="object"==typeof t.wasmPaths?t.wasmPaths[m]:void 0;let v=!1;const w=[];if(e>0&&w.push(new Promise((t=>{setTimeout((()=>{v=!0,t()}),e)}))),w.push(new Promise(((t,e)=>{const r=i?s:c.default,a={locateFile:(t,e)=>i&&t.endsWith(".worker.js")&&"undefined"!=typeof Blob?URL.createObjectURL(new Blob([n(154)],{type:"text/javascript"})):t===b?null!=g?g:(null!=y?y:e)+m:e+t};if(i)if("undefined"==typeof Blob)a.mainScriptUrlOrBlob=u.join("/","ort-wasm-threaded.js");else{const t=`var ortWasmThreaded=(function(){var _scriptDir;return ${r.toString()}})();`;a.mainScriptUrlOrBlob=new Blob([t],{type:"text/javascript"})}r(a).then((e=>{p=!1,f=!0,l=e,t()}),(t=>{p=!1,h=!0,e(t)}))}))),await Promise.race(w),v)throw new Error(`WebAssembly backend initializing failed due to timeout: ${e}ms`)},e.getInstance=()=>{if(f&&l)return l;throw new Error("WebAssembly is not initialized yet.")},e.dispose=()=>{var t;!f||p||h||(p=!0,null===(t=l.PThread)||void 0===t||t.terminateAllThreads(),l=void 0,p=!1,f=!1,h=!0)}},154:t=>{"use strict";t.exports=\'"use strict";var e={},t="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node;if(t){var r=require("worker_threads"),a=r.parentPort;a.on("message",(e=>onmessage({data:e})));var o=require("fs");Object.assign(global,{self:global,require:require,Module:e,location:{href:__filename},Worker:r.Worker,importScripts:function(e){(0,eval)(o.readFileSync(e,"utf8"))},postMessage:function(e){a.postMessage(e)},performance:global.performance||{now:function(){return Date.now()}}})}var s=!1,n=[],i=function(){var e=Array.prototype.slice.call(arguments).join(" ");t?o.writeSync(2,e+"\\\\n"):console.error(e)};self.alert=function(){var t=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:t,threadId:e._pthread_self()})},e.instantiateWasm=(t,r)=>{var a=new WebAssembly.Instance(e.wasmModule,t);return r(a),e.wasmModule=null,a.exports},self.onunhandledrejection=e=>{throw e.reason??e},self.onmessage=t=>{try{if("load"===t.data.cmd){if(e.wasmModule=t.data.wasmModule,e.wasmMemory=t.data.wasmMemory,e.buffer=e.wasmMemory.buffer,e.ENVIRONMENT_IS_PTHREAD=!0,"string"==typeof t.data.urlOrBlob)importScripts(t.data.urlOrBlob);else{var r=URL.createObjectURL(t.data.urlOrBlob);importScripts(r),URL.revokeObjectURL(r)}ortWasmThreaded(e).then((function(t){e=t}))}else if("run"===t.data.cmd){e.__performance_now_clock_drift=performance.now()-t.data.time,e.__emscripten_thread_init(t.data.pthread_ptr,0,0,1),e.establishStackSpace(),e.PThread.receiveObjectTransfer(t.data),e.PThread.threadInitTLS(),s||(n.forEach((t=>{e.executeNotifiedProxyingQueue(t)})),n=[],s=!0);try{e.invokeEntryPoint(t.data.start_routine,t.data.arg)}catch(t){if("unwind"!=t){if(!(t instanceof e.ExitStatus))throw t;e.keepRuntimeAlive()||e.__emscripten_thread_exit(t.status)}}}else"cancel"===t.data.cmd?e._pthread_self()&&e.__emscripten_thread_exit(-1):"setimmediate"===t.data.target||("processProxyingQueue"===t.data.cmd?s?e.executeNotifiedProxyingQueue(t.data.queue):n.push(t.data.queue):(i("worker.js received unknown command "+t.data.cmd),i(t.data)))}catch(t){throw i("worker.js onmessage() captured an uncaught exception: "+t),t&&t.stack&&i(t.stack),e.__emscripten_thread_crashed&&e.__emscripten_thread_crashed(),t}};\\n\'},384:()=>{},993:()=>{},908:()=>{},953:()=>{},925:()=>{},449:()=>{}},e={};function n(r){var a=e[r];if(void 0!==a)return a.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{"use strict";const t=n(349),e=n(361);self.onmessage=n=>{switch(n.data.type){case"init-wasm":(0,e.initializeWebAssembly)(n.data.in).then((()=>postMessage({type:"init-wasm"})),(t=>postMessage({type:"init-wasm",err:t})));break;case"init-ort":try{const{numThreads:e,loggingLevel:r}=n.data.in;(0,t.initOrt)(e,r),postMessage({type:"init-ort"})}catch(t){postMessage({type:"init-ort",err:t})}break;case"create_allocate":try{const{model:e}=n.data.in,r=(0,t.createSessionAllocate)(e);postMessage({type:"create_allocate",out:r})}catch(t){postMessage({type:"create_allocate",err:t})}break;case"create_finalize":try{const{modeldata:e,options:r}=n.data.in,a=(0,t.createSessionFinalize)(e,r);postMessage({type:"create_finalize",out:a})}catch(t){postMessage({type:"create_finalize",err:t})}break;case"create":try{const{model:e,options:r}=n.data.in,a=(0,t.createSession)(e,r);postMessage({type:"create",out:a})}catch(t){postMessage({type:"create",err:t})}break;case"release":try{const e=n.data.in;(0,t.releaseSession)(e),postMessage({type:"release"})}catch(t){postMessage({type:"release",err:t})}break;case"run":try{const{sessionId:e,inputIndices:r,inputs:a,outputIndices:i,options:o}=n.data.in,u=(0,t.run)(e,r,a,i,o);postMessage({type:"run",out:u},(0,t.extractTransferableBuffers)(u))}catch(t){postMessage({type:"run",err:t})}break;case"end-profiling":try{const e=n.data.in;(0,t.endProfiling)(e),postMessage({type:"end-profiling"})}catch(t){postMessage({type:"end-profiling",err:t})}}}})()})();\n',"Worker",void 0,void 0)}},477:f=>{f.exports=function(t,r,i,s){var c=self||window;try{try{var a;try{a=new c.Blob([t])}catch{(a=new(c.BlobBuilder||c.WebKitBlobBuilder||c.MozBlobBuilder||c.MSBlobBuilder)).append(t),a=a.getBlob()}var h=c.URL||c.webkitURL,p=h.createObjectURL(a),d=new c[r](p,i);return h.revokeObjectURL(p),d}catch{return new c[r]("data:application/javascript,".concat(encodeURIComponent(t)),i)}}catch{if(!s)throw Error("Inline worker is not supported");return new c[r](s,i)}}},4154:f=>{f.exports=`"use strict";var e={},t="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node;if(t){var r=require("worker_threads"),a=r.parentPort;a.on("message",(e=>onmessage({data:e})));var o=require("fs");Object.assign(global,{self:global,require:require,Module:e,location:{href:__filename},Worker:r.Worker,importScripts:function(e){(0,eval)(o.readFileSync(e,"utf8"))},postMessage:function(e){a.postMessage(e)},performance:global.performance||{now:function(){return Date.now()}}})}var s=!1,n=[],i=function(){var e=Array.prototype.slice.call(arguments).join(" ");t?o.writeSync(2,e+"\\n"):console.error(e)};self.alert=function(){var t=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:t,threadId:e._pthread_self()})},e.instantiateWasm=(t,r)=>{var a=new WebAssembly.Instance(e.wasmModule,t);return r(a),e.wasmModule=null,a.exports},self.onunhandledrejection=e=>{throw e.reason??e},self.onmessage=t=>{try{if("load"===t.data.cmd){if(e.wasmModule=t.data.wasmModule,e.wasmMemory=t.data.wasmMemory,e.buffer=e.wasmMemory.buffer,e.ENVIRONMENT_IS_PTHREAD=!0,"string"==typeof t.data.urlOrBlob)importScripts(t.data.urlOrBlob);else{var r=URL.createObjectURL(t.data.urlOrBlob);importScripts(r),URL.revokeObjectURL(r)}ortWasmThreaded(e).then((function(t){e=t}))}else if("run"===t.data.cmd){e.__performance_now_clock_drift=performance.now()-t.data.time,e.__emscripten_thread_init(t.data.pthread_ptr,0,0,1),e.establishStackSpace(),e.PThread.receiveObjectTransfer(t.data),e.PThread.threadInitTLS(),s||(n.forEach((t=>{e.executeNotifiedProxyingQueue(t)})),n=[],s=!0);try{e.invokeEntryPoint(t.data.start_routine,t.data.arg)}catch(t){if("unwind"!=t){if(!(t instanceof e.ExitStatus))throw t;e.keepRuntimeAlive()||e.__emscripten_thread_exit(t.status)}}}else"cancel"===t.data.cmd?e._pthread_self()&&e.__emscripten_thread_exit(-1):"setimmediate"===t.data.target||("processProxyingQueue"===t.data.cmd?s?e.executeNotifiedProxyingQueue(t.data.queue):n.push(t.data.queue):(i("worker.js received unknown command "+t.data.cmd),i(t.data)))}catch(t){throw i("worker.js onmessage() captured an uncaught exception: "+t),t&&t.stack&&i(t.stack),e.__emscripten_thread_crashed&&e.__emscripten_thread_crashed(),t}};
`},1670:f=>{f.exports=__WEBPACK_EXTERNAL_MODULE__1670__},7067:()=>{},1296:()=>{},1384:()=>{},3993:()=>{},908:()=>{},6953:()=>{},9925:()=>{},2806:()=>{},6449:()=>{},2850:()=>{},5381:()=>{},5686:(f,t,r)=>{r.r(t),r.d(t,{flatbuffers:()=>i});var i={};i.Offset,i.Table,i.SIZEOF_SHORT=2,i.SIZEOF_INT=4,i.FILE_IDENTIFIER_LENGTH=4,i.SIZE_PREFIX_LENGTH=4,i.Encoding={UTF8_BYTES:1,UTF16_STRING:2},i.int32=new Int32Array(2),i.float32=new Float32Array(i.int32.buffer),i.float64=new Float64Array(i.int32.buffer),i.isLittleEndian=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1,i.Long=function(s,c){this.low=0|s,this.high=0|c},i.Long.create=function(s,c){return s==0&&c==0?i.Long.ZERO:new i.Long(s,c)},i.Long.prototype.toFloat64=function(){return(this.low>>>0)+4294967296*this.high},i.Long.prototype.equals=function(s){return this.low==s.low&&this.high==s.high},i.Long.ZERO=new i.Long(0,0),i.Builder=function(s){if(s)c=s;else var c=1024;this.bb=i.ByteBuffer.allocate(c),this.space=c,this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},i.Builder.prototype.clear=function(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},i.Builder.prototype.forceDefaults=function(s){this.force_defaults=s},i.Builder.prototype.dataBuffer=function(){return this.bb},i.Builder.prototype.asUint8Array=function(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())},i.Builder.prototype.prep=function(s,c){s>this.minalign&&(this.minalign=s);for(var a=1+~(this.bb.capacity()-this.space+c)&s-1;this.space<a+s+c;){var h=this.bb.capacity();this.bb=i.Builder.growByteBuffer(this.bb),this.space+=this.bb.capacity()-h}this.pad(a)},i.Builder.prototype.pad=function(s){for(var c=0;c<s;c++)this.bb.writeInt8(--this.space,0)},i.Builder.prototype.writeInt8=function(s){this.bb.writeInt8(this.space-=1,s)},i.Builder.prototype.writeInt16=function(s){this.bb.writeInt16(this.space-=2,s)},i.Builder.prototype.writeInt32=function(s){this.bb.writeInt32(this.space-=4,s)},i.Builder.prototype.writeInt64=function(s){this.bb.writeInt64(this.space-=8,s)},i.Builder.prototype.writeFloat32=function(s){this.bb.writeFloat32(this.space-=4,s)},i.Builder.prototype.writeFloat64=function(s){this.bb.writeFloat64(this.space-=8,s)},i.Builder.prototype.addInt8=function(s){this.prep(1,0),this.writeInt8(s)},i.Builder.prototype.addInt16=function(s){this.prep(2,0),this.writeInt16(s)},i.Builder.prototype.addInt32=function(s){this.prep(4,0),this.writeInt32(s)},i.Builder.prototype.addInt64=function(s){this.prep(8,0),this.writeInt64(s)},i.Builder.prototype.addFloat32=function(s){this.prep(4,0),this.writeFloat32(s)},i.Builder.prototype.addFloat64=function(s){this.prep(8,0),this.writeFloat64(s)},i.Builder.prototype.addFieldInt8=function(s,c,a){(this.force_defaults||c!=a)&&(this.addInt8(c),this.slot(s))},i.Builder.prototype.addFieldInt16=function(s,c,a){(this.force_defaults||c!=a)&&(this.addInt16(c),this.slot(s))},i.Builder.prototype.addFieldInt32=function(s,c,a){(this.force_defaults||c!=a)&&(this.addInt32(c),this.slot(s))},i.Builder.prototype.addFieldInt64=function(s,c,a){!this.force_defaults&&c.equals(a)||(this.addInt64(c),this.slot(s))},i.Builder.prototype.addFieldFloat32=function(s,c,a){(this.force_defaults||c!=a)&&(this.addFloat32(c),this.slot(s))},i.Builder.prototype.addFieldFloat64=function(s,c,a){(this.force_defaults||c!=a)&&(this.addFloat64(c),this.slot(s))},i.Builder.prototype.addFieldOffset=function(s,c,a){(this.force_defaults||c!=a)&&(this.addOffset(c),this.slot(s))},i.Builder.prototype.addFieldStruct=function(s,c,a){c!=a&&(this.nested(c),this.slot(s))},i.Builder.prototype.nested=function(s){if(s!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")},i.Builder.prototype.notNested=function(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")},i.Builder.prototype.slot=function(s){this.vtable[s]=this.offset()},i.Builder.prototype.offset=function(){return this.bb.capacity()-this.space},i.Builder.growByteBuffer=function(s){var c=s.capacity();if(3221225472&c)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");var a=c<<1,h=i.ByteBuffer.allocate(a);return h.setPosition(a-c),h.bytes().set(s.bytes(),a-c),h},i.Builder.prototype.addOffset=function(s){this.prep(i.SIZEOF_INT,0),this.writeInt32(this.offset()-s+i.SIZEOF_INT)},i.Builder.prototype.startObject=function(s){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=s;for(var c=0;c<s;c++)this.vtable[c]=0;this.isNested=!0,this.object_start=this.offset()},i.Builder.prototype.endObject=function(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);for(var s=this.offset(),c=this.vtable_in_use-1;c>=0&&this.vtable[c]==0;c--);for(var a=c+1;c>=0;c--)this.addInt16(this.vtable[c]!=0?s-this.vtable[c]:0);this.addInt16(s-this.object_start);var h=(a+2)*i.SIZEOF_SHORT;this.addInt16(h);var p=0,d=this.space;t:for(c=0;c<this.vtables.length;c++){var l=this.bb.capacity()-this.vtables[c];if(h==this.bb.readInt16(l)){for(var n=i.SIZEOF_SHORT;n<h;n+=i.SIZEOF_SHORT)if(this.bb.readInt16(d+n)!=this.bb.readInt16(l+n))continue t;p=this.vtables[c];break}}return p?(this.space=this.bb.capacity()-s,this.bb.writeInt32(this.space,p-s)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-s,this.offset()-s)),this.isNested=!1,s},i.Builder.prototype.finish=function(s,c,a){var h=a?i.SIZE_PREFIX_LENGTH:0;if(c){var p=c;if(this.prep(this.minalign,i.SIZEOF_INT+i.FILE_IDENTIFIER_LENGTH+h),p.length!=i.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+i.FILE_IDENTIFIER_LENGTH);for(var d=i.FILE_IDENTIFIER_LENGTH-1;d>=0;d--)this.writeInt8(p.charCodeAt(d))}this.prep(this.minalign,i.SIZEOF_INT+h),this.addOffset(s),h&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)},i.Builder.prototype.finishSizePrefixed=function(s,c){this.finish(s,c,!0)},i.Builder.prototype.requiredField=function(s,c){var a=this.bb.capacity()-s,h=a-this.bb.readInt32(a);if(this.bb.readInt16(h+c)==0)throw new Error("FlatBuffers: field "+c+" must be set")},i.Builder.prototype.startVector=function(s,c,a){this.notNested(),this.vector_num_elems=c,this.prep(i.SIZEOF_INT,s*c),this.prep(a,s*c)},i.Builder.prototype.endVector=function(){return this.writeInt32(this.vector_num_elems),this.offset()},i.Builder.prototype.createString=function(s){if(s instanceof Uint8Array)var c=s;else{c=[];for(var a=0;a<s.length;){var h,p=s.charCodeAt(a++);(h=p<55296||p>=56320?p:(p<<10)+s.charCodeAt(a++)+-56613888)<128?c.push(h):(h<2048?c.push(h>>6&31|192):(h<65536?c.push(h>>12&15|224):c.push(h>>18&7|240,h>>12&63|128),c.push(h>>6&63|128)),c.push(63&h|128))}}this.addInt8(0),this.startVector(1,c.length,1),this.bb.setPosition(this.space-=c.length),a=0;for(var d=this.space,l=this.bb.bytes();a<c.length;a++)l[d++]=c[a];return this.endVector()},i.Builder.prototype.createLong=function(s,c){return i.Long.create(s,c)},i.ByteBuffer=function(s){this.bytes_=s,this.position_=0},i.ByteBuffer.allocate=function(s){return new i.ByteBuffer(new Uint8Array(s))},i.ByteBuffer.prototype.clear=function(){this.position_=0},i.ByteBuffer.prototype.bytes=function(){return this.bytes_},i.ByteBuffer.prototype.position=function(){return this.position_},i.ByteBuffer.prototype.setPosition=function(s){this.position_=s},i.ByteBuffer.prototype.capacity=function(){return this.bytes_.length},i.ByteBuffer.prototype.readInt8=function(s){return this.readUint8(s)<<24>>24},i.ByteBuffer.prototype.readUint8=function(s){return this.bytes_[s]},i.ByteBuffer.prototype.readInt16=function(s){return this.readUint16(s)<<16>>16},i.ByteBuffer.prototype.readUint16=function(s){return this.bytes_[s]|this.bytes_[s+1]<<8},i.ByteBuffer.prototype.readInt32=function(s){return this.bytes_[s]|this.bytes_[s+1]<<8|this.bytes_[s+2]<<16|this.bytes_[s+3]<<24},i.ByteBuffer.prototype.readUint32=function(s){return this.readInt32(s)>>>0},i.ByteBuffer.prototype.readInt64=function(s){return new i.Long(this.readInt32(s),this.readInt32(s+4))},i.ByteBuffer.prototype.readUint64=function(s){return new i.Long(this.readUint32(s),this.readUint32(s+4))},i.ByteBuffer.prototype.readFloat32=function(s){return i.int32[0]=this.readInt32(s),i.float32[0]},i.ByteBuffer.prototype.readFloat64=function(s){return i.int32[i.isLittleEndian?0:1]=this.readInt32(s),i.int32[i.isLittleEndian?1:0]=this.readInt32(s+4),i.float64[0]},i.ByteBuffer.prototype.writeInt8=function(s,c){this.bytes_[s]=c},i.ByteBuffer.prototype.writeUint8=function(s,c){this.bytes_[s]=c},i.ByteBuffer.prototype.writeInt16=function(s,c){this.bytes_[s]=c,this.bytes_[s+1]=c>>8},i.ByteBuffer.prototype.writeUint16=function(s,c){this.bytes_[s]=c,this.bytes_[s+1]=c>>8},i.ByteBuffer.prototype.writeInt32=function(s,c){this.bytes_[s]=c,this.bytes_[s+1]=c>>8,this.bytes_[s+2]=c>>16,this.bytes_[s+3]=c>>24},i.ByteBuffer.prototype.writeUint32=function(s,c){this.bytes_[s]=c,this.bytes_[s+1]=c>>8,this.bytes_[s+2]=c>>16,this.bytes_[s+3]=c>>24},i.ByteBuffer.prototype.writeInt64=function(s,c){this.writeInt32(s,c.low),this.writeInt32(s+4,c.high)},i.ByteBuffer.prototype.writeUint64=function(s,c){this.writeUint32(s,c.low),this.writeUint32(s+4,c.high)},i.ByteBuffer.prototype.writeFloat32=function(s,c){i.float32[0]=c,this.writeInt32(s,i.int32[0])},i.ByteBuffer.prototype.writeFloat64=function(s,c){i.float64[0]=c,this.writeInt32(s,i.int32[i.isLittleEndian?0:1]),this.writeInt32(s+4,i.int32[i.isLittleEndian?1:0])},i.ByteBuffer.prototype.getBufferIdentifier=function(){if(this.bytes_.length<this.position_+i.SIZEOF_INT+i.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");for(var s="",c=0;c<i.FILE_IDENTIFIER_LENGTH;c++)s+=String.fromCharCode(this.readInt8(this.position_+i.SIZEOF_INT+c));return s},i.ByteBuffer.prototype.__offset=function(s,c){var a=s-this.readInt32(s);return c<this.readInt16(a)?this.readInt16(a+c):0},i.ByteBuffer.prototype.__union=function(s,c){return s.bb_pos=c+this.readInt32(c),s.bb=this,s},i.ByteBuffer.prototype.__string=function(s,c){s+=this.readInt32(s);var a=this.readInt32(s),h="",p=0;if(s+=i.SIZEOF_INT,c===i.Encoding.UTF8_BYTES)return this.bytes_.subarray(s,s+a);for(;p<a;){var d,l=this.readUint8(s+p++);if(l<192)d=l;else{var n=this.readUint8(s+p++);if(l<224)d=(31&l)<<6|63&n;else{var e=this.readUint8(s+p++);d=l<240?(15&l)<<12|(63&n)<<6|63&e:(7&l)<<18|(63&n)<<12|(63&e)<<6|63&this.readUint8(s+p++)}}d<65536?h+=String.fromCharCode(d):(d-=65536,h+=String.fromCharCode(55296+(d>>10),56320+(1023&d)))}return h},i.ByteBuffer.prototype.__indirect=function(s){return s+this.readInt32(s)},i.ByteBuffer.prototype.__vector=function(s){return s+this.readInt32(s)+i.SIZEOF_INT},i.ByteBuffer.prototype.__vector_len=function(s){return this.readInt32(s+this.readInt32(s))},i.ByteBuffer.prototype.__has_identifier=function(s){if(s.length!=i.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+i.FILE_IDENTIFIER_LENGTH);for(var c=0;c<i.FILE_IDENTIFIER_LENGTH;c++)if(s.charCodeAt(c)!=this.readInt8(this.position_+i.SIZEOF_INT+c))return!1;return!0},i.ByteBuffer.prototype.createLong=function(s,c){return i.Long.create(s,c)}}},__webpack_module_cache__={};function __webpack_require__(f){var t=__webpack_module_cache__[f];if(t!==void 0)return t.exports;var r=__webpack_module_cache__[f]={exports:{}};return __webpack_modules__[f].call(r.exports,r,r.exports,__webpack_require__),r.exports}__webpack_require__.n=f=>{var t=f&&f.__esModule?()=>f.default:()=>f;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(f,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(f,r)&&Object.defineProperty(f,r,{enumerable:!0,get:t[r]})},__webpack_require__.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),__webpack_require__.o=(f,t)=>Object.prototype.hasOwnProperty.call(f,t),__webpack_require__.r=f=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(f,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(f,"__esModule",{value:!0})};var __webpack_exports__=__webpack_require__(6018);return __webpack_exports__})())}(ortWeb_min)),ortWeb_min.exports}var ortWeb_minExports=requireOrtWeb_min();const LONG_SIDE_LENGTH=1024;function contourContainsPoint(f,t){let r=f.points.flatMap(c=>[c.x,c.y]),[i,s]=t;return linearRingContainsXY(r,0,r.length,2,i,s)}class MagicSamInteraction extends PointerInteraction{constructor(t){super(t),this.on("change:active",this.toggleActive),this.layer=t.layer,this.simplifyTolerant=t.simplifyTolerant===void 0?0:t.simplifyTolerant,this.simplifyCount=t.simplifyCount===void 0?3:t.simplifyCount,this.map=t.map,this.throttleInterval=t.throttleInterval||1e3,this.sketchFeature=null,this.source=t.source,this.source===void 0&&(this.source=new VectorSource,this.map.addLayer(new VectorLayer({source:this.source,zIndex:200})));let r=new VectorLayer({source:new VectorSource,map:this.map,zIndex:200});this.sketchSource=r.getSource(),this.sketchStyle=t.style===void 0?null:t.style,this.MASK_INPUT_TENSOR=new ortWeb_minExports.Tensor("float32",new Float32Array(256*256),[1,1,256,256]),this.HAS_MASK_INPUT_TENSOR=new ortWeb_minExports.Tensor("float32",[0]),this.POINT_LABELS_TENSOR=new ortWeb_minExports.Tensor("float32",new Float32Array([1,-1]),[1,2]),this.model=null,this.embedding=null,this.imageSizeTensor=null,this.samSizeTensor=null,this.imageSamScale=null,this.isDragging=!1,this.initPromise=ortWeb_minExports.InferenceSession.create(t.onnxUrl,{executionProviders:["wasm"]}).then(i=>this.model=i)}setThrottleInterval(t){this.throttleInterval=t}getThrottleInterval(){return this.throttleInterval}updateEmbedding(t,r){this.imageSizeTensor=new ortWeb_minExports.Tensor("float32",[t.height,t.width]),this.imageSamScale=LONG_SIDE_LENGTH/Math.max(t.height,t.width),this.samSizeTensor=new ortWeb_minExports.Tensor("float32",[Math.round(t.height*this.imageSamScale),Math.round(t.width*this.imageSamScale)]);let i=new npyjs;return Promise.all([i.load(r),this.initPromise]).then(([s])=>{this.embedding=new ortWeb_minExports.Tensor("float32",s.data,s.shape),this._runModelWarmup()})}handleUpEvent(){return this.sketchFeature&&!this.isDragging&&(this.source.addFeature(this.sketchFeature),this.sketchFeature.setStyle(null),this.dispatchEvent({type:"drawend",feature:this.sketchFeature}),this.sketchSource.removeFeature(this.sketchFeature),this.sketchFeature=null),this.isDragging=!1,!0}handleDownEvent(){return!0}stopDown(){return!1}handleDragEvent(){this.isDragging=!0}handleMoveEvent(t){this.model&&throttle(()=>{let[r]=this.imageSizeTensor.data,i=new Float32Array([t.coordinate[0]*this.imageSamScale,(r-t.coordinate[1])*this.imageSamScale,0,0]),s=new ortWeb_minExports.Tensor("float32",i,[1,2,2]);const c=this._getFeeds(s);this.model.run(c).then(this._processInferenceResult.bind(this,i))},this.throttleInterval,"magic-sam-move")}toggleActive(){!this.getActive()&&this.sketchFeature&&(this.sketchSource.hasFeature(this.sketchFeature)&&this.sketchSource.removeFeature(this.sketchFeature),this.sketchFeature=null)}_getFeeds(t){return{image_embeddings:this.embedding,point_coords:t,point_labels:this.POINT_LABELS_TENSOR,orig_im_size:this.samSizeTensor,mask_input:this.MASK_INPUT_TENSOR,has_mask_input:this.HAS_MASK_INPUT_TENSOR}}_runModelWarmup(){let t=new ortWeb_minExports.Tensor("float32",[0,0,0,0],[1,2,2]);const r=this._getFeeds(t);return this.model.run(r)}_processInferenceResult(t,r){if(!this.getActive())return;let[i]=this.imageSizeTensor.data,[s,c]=this.samSizeTensor.data;const h=r[this.model.outputNames[0]].data.map(n=>n>0?1:0);let p={data:new Uint8Array(h),width:c,height:s,bounds:{minX:0,maxX:c,minY:0,maxY:s}},d=MagicWand.traceContours(p).filter(n=>!n.inner).filter(n=>contourContainsPoint(n,t)).shift();if(!d)return;this.simplifyTolerant>0&&(d=MagicWand.simplifyContours([d],this.simplifyTolerant,this.simplifyCount).shift());let l=d.points.map(n=>[n.x,n.y]).map(([n,e])=>[n/this.imageSamScale,e/this.imageSamScale]).map(([n,e])=>[n,i-e]);this.sketchFeature?this.sketchFeature.getGeometry().setCoordinates([l]):(this.sketchFeature=new Feature(new Polygon([l])),this.sketchStyle&&this.sketchFeature.setStyle(this.sketchStyle)),this.sketchSource.hasFeature(this.sketchFeature)||this.sketchSource.addFeature(this.sketchFeature)}}let magicSamInteraction,loadedImageId,loadingImageId;const _sfc_main={data:function(){return{loadingMagicSam:!1,loadingMagicSamTakesLong:!1,throttleInterval:1e3}},computed:{isMagicSamming(){return this.interactionMode==="magicSam"},magicSamButtonClass(){return this.loadingMagicSamTakesLong?"loading-magic-sam-long":""},magicSamButtonTitle(){return this.loadingMagicSamTakesLong?"Preparing the magic for this image":"Draw a polygon using the magic SAM tool 𝗭"}},methods:{setThrottleInterval(f){this.throttleInterval=f,magicSamInteraction&&magicSamInteraction.setThrottleInterval(f)},startLoadingMagicSam(){this.loadingMagicSam=!0},finishLoadingMagicSam(){this.loadingMagicSam=!1,this.loadingMagicSamTakesLong=!1},toggleMagicSam(){this.isMagicSamming?this.resetInteractionMode():this.canAdd&&!this.image.tiled&&(magicSamInteraction||this.initMagicSamInteraction(),this.interactionMode="magicSam")},handleSamEmbeddingRequestSuccess(f){this.image.id===loadingImageId&&(f.body.url!==null?this.handleSamEmbeddingAvailable(f.body):this.loadingMagicSamTakesLong=!0)},handleSamEmbeddingRequestFailure(f){this.resetInteractionMode(),this.finishLoadingMagicSam(),handleErrorResponse(f)},handleSamEmbeddingAvailable(f){this.loadingMagicSam&&this.image.id===loadingImageId&&loadedImageId!==this.image.id&&(loadedImageId=this.image.id,magicSamInteraction.updateEmbedding(this.image,f.url).then(this.finishLoadingMagicSam).then(()=>{this.isMagicSamming&&magicSamInteraction.setActive(!0)}))},handleSamEmbeddingFailed(){this.loadingMagicSam&&(Messages.danger("Could not load the image embedding."),this.finishLoadingMagicSam(),this.resetInteractionMode())},initMagicSamInteraction(){magicSamInteraction=new MagicSamInteraction({map:this.map,source:this.annotationSource,style:Styles.editing,indicatorPointStyle:Styles.editing,indicatorCrossStyle:Styles.cross,onnxUrl:biigle.$require("magic-sam.onnx-url"),simplifyTolerant:.1,throttleInterval:this.throttleInterval}),magicSamInteraction.on("drawend",this.handleNewFeature),magicSamInteraction.setActive(!1),this.map.addInteraction(magicSamInteraction)}},watch:{image(f){this.loadingMagicSam&&loadingImageId!==f.id&&(this.finishLoadingMagicSam(),this.resetInteractionMode()),this.isMagicSamming&&this.resetInteractionMode()},isMagicSamming(f){if(!f){magicSamInteraction.setActive(!1);return}if(!this.hasSelectedLabel){this.requireSelectedLabel();return}if(loadedImageId===this.image.id){magicSamInteraction.setActive(!0);return}this.loadingMagicSam||(loadingImageId=this.image.id,this.startLoadingMagicSam(),ImageEmbeddingApi.save({id:this.image.id},{}).then(this.handleSamEmbeddingRequestSuccess,this.handleSamEmbeddingRequestFailure))},canAdd:{handler(f){f?Keyboard.on("z",this.toggleMagicSam,0,this.listenerSet):Keyboard.off("z",this.toggleMagicSam,0,this.listenerSet)},immediate:!0}},created(){Events.on("settings.samThrottleInterval",this.setThrottleInterval),Echo.getInstance().private(`user-${this.userId}`).listen(".Biigle\\Modules\\MagicSam\\Events\\EmbeddingAvailable",this.handleSamEmbeddingAvailable).listen(".Biigle\\Modules\\MagicSam\\Events\\EmbeddingFailed",this.handleSamEmbeddingFailed)}};annotationCanvasMixins.push(_sfc_main);ortWeb_minExports.env.wasm.wasmPaths="/vendor/magic-sam/";
